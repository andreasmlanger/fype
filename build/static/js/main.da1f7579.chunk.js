(this.webpackJsonpfype=this.webpackJsonpfype||[]).push([[0],{158:function(e,t,c){},165:function(e,t){},167:function(e,t){},178:function(e,t){},180:function(e,t){},207:function(e,t){},209:function(e,t){},210:function(e,t){},215:function(e,t){},217:function(e,t){},223:function(e,t){},225:function(e,t){},244:function(e,t){},256:function(e,t){},259:function(e,t){},273:function(e,t,c){"use strict";c.r(t);var n=c(0),i=c.n(n),a=c(37),s=c.n(a),o=(c(158),c(288)),r=c(22);const{RtcTokenBuilder:l,RtcRole:d}=c(162),u="45a5e17f89414f0782f73edf2281b16f",j="main",b=d.PUBLISHER,h=Math.floor(Date.now()/1e3)+3600,f={mode:"rtc",codec:"vp8",appId:u,token:l.buildTokenWithUid(u,"85a9ab8f46ce471384ac67030810920f",j,0,b,h)},O=Object(r.createClient)(f),x=Object(r.createMicrophoneAndCameraTracks)();var v=c(287),y=c(47),p=c(4);function k(e){const{users:t,tracks:c,screen:i}=e,[a,s]=Object(n.useState)([]),[o,l]=Object(n.useState)(!1),[d,u]=Object(n.useState)(12);function j(e){return Math.max(Math.floor(12/(e.length+1)),4)}return Object(n.useEffect)((()=>{s(t),y.isMobile?u(t.length>1?6:12):u(j(t))}),[t,c,i]),i?Object(p.jsx)(r.AgoraVideoPlayer,{videoTrack:c[1],style:{height:"100%",width:"100%"}}):Object(p.jsxs)(v.a,{container:!0,style:{height:"100%"},children:[!o&&Object(p.jsx)(v.a,{item:!0,xs:d,children:Object(p.jsx)(r.AgoraVideoPlayer,{videoTrack:c[1],style:{height:"100%",width:"100%"}})}),a.length>0&&a.map((e=>e.videoTrack?Object(p.jsx)(v.a,{item:!0,xs:d,onMouseDown:c=>function(e){if(!y.isMobile)return 12!==d?(s(t.filter((t=>t.uid===e))),l(!0),u(12)):(l(!1),u(j(t)))}(e.uid),children:Object(p.jsx)(r.AgoraVideoPlayer,{videoTrack:e.videoTrack,style:{height:"100%",width:"100%"}},e.uid)}):null))]})}var m=c(145),g=c.n(m),S=c(146),C=c.n(S),w=c(147),T=c.n(w),I=c(148),M=c.n(I),R=c(149),A=c.n(R),E=c(150),P=c.n(E),V=c(151),B=c.n(V);function J(e){const t=O(),{tracks:c,stream:i,setStart:a,setInCall:s,setScreen:r}=e,[l,d]=Object(n.useState)({video:!0,audio:!0,screen:!1}),u=async e=>{"audio"===e?(await c[0].setEnabled(!l.audio),d((e=>({...e,audio:!e.audio})))):"video"===e?(await c[1].setEnabled(!l.video),d((e=>({...e,video:!e.video})))):"screen"===e&&(r(!l.screen),d((e=>({...e,screen:!e.screen}))))};return Object(p.jsxs)("div",{style:{margin:"10px"},children:[Object(p.jsx)(o.a,{variant:"contained",style:{marginRight:"5px"},color:l.audio?"primary":"secondary",onClick:()=>u("audio"),children:l.audio?Object(p.jsx)(g.a,{}):Object(p.jsx)(C.a,{})}),Object(p.jsx)(o.a,{variant:"contained",style:{marginRight:"5px"},color:l.video?"primary":"secondary",onClick:()=>u("video"),children:l.video?Object(p.jsx)(T.a,{}):Object(p.jsx)(M.a,{})}),!y.isMobile&&Object(p.jsx)(o.a,{variant:"contained",style:{marginRight:"5px"},color:l.screen?"primary":"default",onClick:()=>u("screen"),children:l.screen?Object(p.jsx)(A.a,{}):Object(p.jsx)(P.a,{})}),Object(p.jsxs)(o.a,{variant:"contained",color:"default",onClick:()=>(async()=>{i&&i.close(),t.removeAllListeners(),a(!1),s(!1);for(const e of c)e.close();await t.leave()})(),children:["Leave",Object(p.jsx)(B.a,{})]})]})}function L(e){const{setInCall:t}=e,[c,i]=Object(n.useState)([]),[a,s]=Object(n.useState)(!1),[o,l]=Object(n.useState)(!1),d=O();var{ready:u,tracks:b}=x(),h=Object(r.createScreenVideoTrack)()().tracks;return o&&h&&(b=[b[0],h,b[1]]),Object(n.useEffect)((()=>{if(u&&b)try{(async e=>{d.on("user-published",(async(e,t)=>{await d.subscribe(e,t),"video"===t&&i((t=>t.includes(e)?t:[...t,e])),"audio"===t&&e.audioTrack.play()})),d.on("user-unpublished",((e,t)=>{"audio"===t&&e.audioTrack&&e.audioTrack.stop(),"video"===t&&i((t=>t.filter((t=>t.uid!==e.uid))))})),d.on("user-left",(e=>{i((t=>t.filter((t=>t.uid!==e.uid))))})),d._sessionId&&d.unpublish();try{await d.join(f.appId,e,f.token,null)}catch(t){console.log("error")}!b||b[0]._isClosed||b[1]._isClosed||await d.publish([b[0],b[1]]),s(!0)})(j)}catch(e){console.log(e)}}),[d,u,b]),Object(p.jsxs)(v.a,{container:!0,direction:"column",style:{height:"100%"},children:[Object(p.jsx)(v.a,{item:!0,style:{height:"0%",zIndex:1},children:u&&b&&Object(p.jsx)(J,{tracks:b,stream:h,setStart:s,setInCall:t,setScreen:l})}),Object(p.jsx)(v.a,{item:!0,style:{height:"100%"},children:a&&b&&Object(p.jsx)(k,{tracks:b,users:c,screen:o})})]})}var _=function(){const[e,t]=Object(n.useState)(!1);return Object(p.jsx)("div",{className:"App",style:{height:"100%"},children:e?Object(p.jsx)(L,{setInCall:t}):Object(p.jsx)("div",{className:"center",children:Object(p.jsx)(o.a,{variant:"contained",color:"primary",onClick:()=>t(!0),children:"Join Call"})})})};s.a.render(Object(p.jsx)(i.a.StrictMode,{children:Object(p.jsx)(_,{})}),document.getElementById("root"))}},[[273,1,2]]]);
//# sourceMappingURL=main.da1f7579.chunk.js.map