/*! For license information please see 2.77777690.chunk.js.LICENSE.txt */
(this.webpackJsonpfype=this.webpackJsonpfype||[]).push([[2],[function(e,t,i){"use strict";e.exports=i(154)},function(e,t,i){"use strict";function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n.apply(this,arguments)}i.d(t,"a",(function(){return n}))},function(e,t){"function"===typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},function(e,t,i){var n=i(7),r=n.Buffer;function o(e,t){for(var i in e)t[i]=e[i]}function s(e,t,i){return r(e,t,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=s),s.prototype=Object.create(r.prototype),o(r,s),s.from=function(e,t,i){if("number"===typeof e)throw new TypeError("Argument must not be a number");return r(e,t,i)},s.alloc=function(e,t,i){if("number"!==typeof e)throw new TypeError("Argument must be a number");var n=r(e);return void 0!==t?"string"===typeof i?n.fill(t,i):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return r(e)},s.allocUnsafeSlow=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,i){"use strict";e.exports=i(268)},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(38);function r(e,t){if(null==e)return{};var i,r,o=Object(n.a)(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)i=s[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}},function(e,t){var i,n,r=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(i===setTimeout)return setTimeout(e,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"===typeof setTimeout?setTimeout:o}catch(e){i=o}try{n="function"===typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var c,u=[],d=!1,l=-1;function h(){d&&c&&(d=!1,c.length?u=c.concat(u):l=-1,u.length&&f())}function f(){if(!d){var e=a(h);d=!0;for(var t=u.length;t;){for(c=u,u=[];++l<t;)c&&c[l].run();l=-1,t=u.length}c=null,d=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];u.push(new p(e,t)),1!==u.length||d||a(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,i){"use strict";(function(e){var n=i(159),r=i(160),o=i(161);function s(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(s()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,i){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(e,t,i);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return l(this,e)}return u(this,e,t,i)}function u(e,t,i,n){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,i,n){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===i&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,i):new Uint8Array(t,i,n);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,i,n):"string"===typeof t?function(e,t,i){"string"===typeof i&&""!==i||(i="utf8");if(!c.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,i);e=a(e,n);var r=e.write(t,i);r!==n&&(e=e.slice(0,r));return e}(e,t,i):function(e,t){if(c.isBuffer(t)){var i=0|f(t.length);return 0===(e=a(e,i)).length||t.copy(e,0,0,i),e}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(n=t.length)!==n?a(e,0):h(e,t);if("Buffer"===t.type&&o(t.data))return h(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function l(e,t){if(d(t),e=a(e,t<0?0:0|f(t)),!c.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function h(e,t){var i=t.length<0?0:0|f(t.length);e=a(e,i);for(var n=0;n<i;n+=1)e[n]=255&t[n];return e}function f(e){if(e>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return F(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return W(e).length;default:if(n)return F(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return M(this,t,i);case"utf8":case"utf-8":return C(this,t,i);case"ascii":return A(this,t,i);case"latin1":case"binary":return O(this,t,i);case"base64":return R(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function _(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function g(e,t,i,n,r){if(0===e.length)return-1;if("string"===typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(r)return-1;i=e.length-1}else if(i<0){if(!r)return-1;i=0}if("string"===typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:v(e,t,i,n,r);if("number"===typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):v(e,[t],i,n,r);throw new TypeError("val must be string, number or Buffer")}function v(e,t,i,n,r){var o,s=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,c/=2,i/=2}function u(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(r){var d=-1;for(o=i;o<a;o++)if(u(e,o)===u(t,-1===d?0:o-d)){if(-1===d&&(d=o),o-d+1===c)return d*s}else-1!==d&&(o-=o-d),d=-1}else for(i+c>a&&(i=a-c),o=i;o>=0;o--){for(var l=!0,h=0;h<c;h++)if(u(e,o+h)!==u(t,h)){l=!1;break}if(l)return o}return-1}function E(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?(n=Number(n))>r&&(n=r):n=r;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[i+s]=a}return s}function b(e,t,i,n){return G(F(t,e.length-i),e,i,n)}function y(e,t,i,n){return G(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function w(e,t,i,n){return y(e,t,i,n)}function S(e,t,i,n){return G(W(t),e,i,n)}function T(e,t,i,n){return G(function(e,t){for(var i,n,r,o=[],s=0;s<e.length&&!((t-=2)<0);++s)n=(i=e.charCodeAt(s))>>8,r=i%256,o.push(r),o.push(n);return o}(t,e.length-i),e,i,n)}function R(e,t,i){return 0===t&&i===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,i))}function C(e,t,i){i=Math.min(e.length,i);for(var n=[],r=t;r<i;){var o,s,a,c,u=e[r],d=null,l=u>239?4:u>223?3:u>191?2:1;if(r+l<=i)switch(l){case 1:u<128&&(d=u);break;case 2:128===(192&(o=e[r+1]))&&(c=(31&u)<<6|63&o)>127&&(d=c);break;case 3:o=e[r+1],s=e[r+2],128===(192&o)&&128===(192&s)&&(c=(15&u)<<12|(63&o)<<6|63&s)>2047&&(c<55296||c>57343)&&(d=c);break;case 4:o=e[r+1],s=e[r+2],a=e[r+3],128===(192&o)&&128===(192&s)&&128===(192&a)&&(c=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&c<1114112&&(d=c)}null===d?(d=65533,l=1):d>65535&&(d-=65536,n.push(d>>>10&1023|55296),d=56320|1023&d),n.push(d),r+=l}return function(e){var t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);var i="",n=0;for(;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=I));return i}(n)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=s(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,i){return u(null,e,t,i)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,i){return function(e,t,i,n){return d(t),t<=0?a(e,t):void 0!==i?"string"===typeof n?a(e,t).fill(i,n):a(e,t).fill(i):a(e,t)}(null,e,t,i)},c.allocUnsafe=function(e){return l(null,e)},c.allocUnsafeSlow=function(e){return l(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,n=t.length,r=0,o=Math.min(i,n);r<o;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=c.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var s=e[i];if(!c.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,i,n,r){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||i>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&t>=i)return 0;if(n>=r)return-1;if(t>=i)return 1;if(this===e)return 0;for(var o=(r>>>=0)-(n>>>=0),s=(i>>>=0)-(t>>>=0),a=Math.min(o,s),u=this.slice(n,r),d=e.slice(t,i),l=0;l<a;++l)if(u[l]!==d[l]){o=u[l],s=d[l];break}return o<s?-1:s<o?1:0},c.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},c.prototype.indexOf=function(e,t,i){return g(this,e,t,i,!0)},c.prototype.lastIndexOf=function(e,t,i){return g(this,e,t,i,!1)},c.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"===typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-t;if((void 0===i||i>r)&&(i=r),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return E(this,e,t,i);case"utf8":case"utf-8":return b(this,e,t,i);case"ascii":return y(this,e,t,i);case"latin1":case"binary":return w(this,e,t,i);case"base64":return S(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,i);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var I=4096;function A(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(127&e[r]);return n}function O(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(e[r]);return n}function M(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>n)&&(i=n);for(var r="",o=t;o<i;++o)r+=j(e[o]);return r}function N(e,t,i){for(var n=e.slice(t,i),r="",o=0;o<n.length;o+=2)r+=String.fromCharCode(n[o]+256*n[o+1]);return r}function k(e,t,i){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,i,n,r,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<o)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function D(e,t,i,n){t<0&&(t=65535+t+1);for(var r=0,o=Math.min(e.length-i,2);r<o;++r)e[i+r]=(t&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function L(e,t,i,n){t<0&&(t=4294967295+t+1);for(var r=0,o=Math.min(e.length-i,4);r<o;++r)e[i+r]=t>>>8*(n?r:3-r)&255}function x(e,t,i,n,r,o){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function U(e,t,i,n,o){return o||x(e,0,i,4),r.write(e,t,i,n,23,4),i+4}function V(e,t,i,n,o){return o||x(e,0,i,8),r.write(e,t,i,n,52,8),i+8}c.prototype.slice=function(e,t){var i,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=c.prototype;else{var r=t-e;i=new c(r,void 0);for(var o=0;o<r;++o)i[o]=this[o+e]}return i},c.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||k(e,t,this.length);for(var n=this[e],r=1,o=0;++o<t&&(r*=256);)n+=this[e+o]*r;return n},c.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||k(e,t,this.length);for(var n=this[e+--t],r=1;t>0&&(r*=256);)n+=this[e+--t]*r;return n},c.prototype.readUInt8=function(e,t){return t||k(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||k(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||k(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||k(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||k(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||k(e,t,this.length);for(var n=this[e],r=1,o=0;++o<t&&(r*=256);)n+=this[e+o]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||k(e,t,this.length);for(var n=t,r=1,o=this[e+--n];n>0&&(r*=256);)o+=this[e+--n]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||k(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||k(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},c.prototype.readInt16BE=function(e,t){t||k(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},c.prototype.readInt32LE=function(e,t){return t||k(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||k(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||k(e,4,this.length),r.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||k(e,4,this.length),r.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||k(e,8,this.length),r.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||k(e,8,this.length),r.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,i,n){(e=+e,t|=0,i|=0,n)||P(this,e,t,i,Math.pow(2,8*i)-1,0);var r=1,o=0;for(this[t]=255&e;++o<i&&(r*=256);)this[t+o]=e/r&255;return t+i},c.prototype.writeUIntBE=function(e,t,i,n){(e=+e,t|=0,i|=0,n)||P(this,e,t,i,Math.pow(2,8*i)-1,0);var r=i-1,o=1;for(this[t+r]=255&e;--r>=0&&(o*=256);)this[t+r]=e/o&255;return t+i},c.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t|=0,!n){var r=Math.pow(2,8*i-1);P(this,e,t,i,r-1,-r)}var o=0,s=1,a=0;for(this[t]=255&e;++o<i&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+i},c.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t|=0,!n){var r=Math.pow(2,8*i-1);P(this,e,t,i,r-1,-r)}var o=i-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+i},c.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,i){return U(this,e,t,!0,i)},c.prototype.writeFloatBE=function(e,t,i){return U(this,e,t,!1,i)},c.prototype.writeDoubleLE=function(e,t,i){return V(this,e,t,!0,i)},c.prototype.writeDoubleBE=function(e,t,i){return V(this,e,t,!1,i)},c.prototype.copy=function(e,t,i,n){if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r,o=n-i;if(this===e&&i<t&&t<n)for(r=o-1;r>=0;--r)e[r+t]=this[r+i];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)e[r+t]=this[r+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+o),t);return o},c.prototype.fill=function(e,t,i,n){if("string"===typeof e){if("string"===typeof t?(n=t,t=0,i=this.length):"string"===typeof i&&(n=i,i=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var o;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"===typeof e)for(o=t;o<i;++o)this[o]=e;else{var s=c.isBuffer(e)?e:F(new c(e,n).toString()),a=s.length;for(o=0;o<i-t;++o)this[o+t]=s[o%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function j(e){return e<16?"0"+e.toString(16):e.toString(16)}function F(e,t){var i;t=t||1/0;for(var n=e.length,r=null,o=[],s=0;s<n;++s){if((i=e.charCodeAt(s))>55295&&i<57344){if(!r){if(i>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(t-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(t-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((t-=1)<0)break;o.push(i)}else if(i<2048){if((t-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function W(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function G(e,t,i,n){for(var r=0;r<n&&!(r+i>=t.length||r>=e.length);++r)t[r+i]=e[r];return r}}).call(this,i(9))},function(e,t,i){"use strict";function n(e){var t,i,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(i=n(e[t]))&&(r&&(r+=" "),r+=i);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}t.a=function(){for(var e,t,i=0,r="";i<arguments.length;)(e=arguments[i++])&&(t=n(e))&&(r&&(r+=" "),r+=t);return r}},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(n){"object"===typeof window&&(i=window)}e.exports=i},,function(e,t){function i(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=i,i.equal=function(e,t,i){if(e!=t)throw new Error(i||"Assertion failed: "+e+" != "+t)}},function(e,t,i){"use strict";var n=t,r=i(20),o=i(11),s=i(124);n.assert=o,n.toArray=s.toArray,n.zero2=s.zero2,n.toHex=s.toHex,n.encode=s.encode,n.getNAF=function(e,t,i){var n=new Array(Math.max(e.bitLength(),i)+1);n.fill(0);for(var r=1<<t+1,o=e.clone(),s=0;s<n.length;s++){var a,c=o.andln(r-1);o.isOdd()?(a=c>(r>>1)-1?(r>>1)-c:c,o.isubn(a)):a=0,n[s]=a,o.iushrn(1)}return n},n.getJSF=function(e,t){var i=[[],[]];e=e.clone(),t=t.clone();for(var n,r=0,o=0;e.cmpn(-r)>0||t.cmpn(-o)>0;){var s,a,c=e.andln(3)+r&3,u=t.andln(3)+o&3;3===c&&(c=-1),3===u&&(u=-1),s=0===(1&c)?0:3!==(n=e.andln(7)+r&7)&&5!==n||2!==u?c:-c,i[0].push(s),a=0===(1&u)?0:3!==(n=t.andln(7)+o&7)&&5!==n||2!==c?u:-u,i[1].push(a),2*r===s+1&&(r=1-r),2*o===a+1&&(o=1-o),e.iushrn(1),t.iushrn(1)}return i},n.cachedProperty=function(e,t,i){var n="_"+t;e.prototype[t]=function(){return void 0!==this[n]?this[n]:this[n]=i.call(this)}},n.parseBytes=function(e){return"string"===typeof e?n.toArray(e,"hex"):e},n.intFromLE=function(e){return new r(e,"hex","le")}},function(e,t,i){(function(t,i,n){e.exports=function(){"use strict";function e(e,t){return t.forEach((function(t){t&&"string"!=typeof t&&!Array.isArray(t)&&Object.keys(t).forEach((function(i){if("default"!==i&&!(i in e)){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}}))})),Object.freeze(e)}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{};function o(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var s=function(e){try{return!!e()}catch(e){return!0}},a=!s((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),c=a,u=Function.prototype,d=u.call,l=c&&u.bind.bind(d,d),h=c?l:function(e){return function(){return d.apply(e,arguments)}},f=h({}.isPrototypeOf),p=function(e){return e&&e.Math==Math&&e},m=p("object"==typeof globalThis&&globalThis)||p("object"==typeof window&&window)||p("object"==typeof self&&self)||p("object"==typeof r&&r)||function(){return this}()||r||Function("return this")(),_=a,g=Function.prototype,v=g.apply,E=g.call,b="object"==typeof Reflect&&Reflect.apply||(_?E.bind(v):function(){return E.apply(v,arguments)}),y=h,w=y({}.toString),S=y("".slice),T=function(e){return S(w(e),8,-1)},R=T,C=h,I=function(e){if("Function"===R(e))return C(e)},A="object"==typeof document&&document.all,O={all:A,IS_HTMLDDA:void 0===A&&void 0!==A},M=O.all,N=O.IS_HTMLDDA?function(e){return"function"==typeof e||e===M}:function(e){return"function"==typeof e},k={},P=!s((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),D=a,L=Function.prototype.call,x=D?L.bind(L):function(){return L.apply(L,arguments)},U={},V={}.propertyIsEnumerable,B=Object.getOwnPropertyDescriptor,j=B&&!V.call({1:2},1);U.f=j?function(e){var t=B(this,e);return!!t&&t.enumerable}:V;var F,W,G=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},H=s,q=T,K=Object,z=h("".split),Y=H((function(){return!K("z").propertyIsEnumerable(0)}))?function(e){return"String"==q(e)?z(e,""):K(e)}:K,J=function(e){return null==e},X=J,Q=TypeError,Z=function(e){if(X(e))throw Q("Can't call method on "+e);return e},$=Y,ee=Z,te=function(e){return $(ee(e))},ie=N,ne=O.all,re=O.IS_HTMLDDA?function(e){return"object"==typeof e?null!==e:ie(e)||e===ne}:function(e){return"object"==typeof e?null!==e:ie(e)},oe={},se=oe,ae=m,ce=N,ue=function(e){return ce(e)?e:void 0},de=function(e,t){return arguments.length<2?ue(se[e])||ue(ae[e]):se[e]&&se[e][t]||ae[e]&&ae[e][t]},le="undefined"!=typeof navigator&&String(navigator.userAgent)||"",he=m,fe=le,pe=he.process,me=he.Deno,_e=pe&&pe.versions||me&&me.version,ge=_e&&_e.v8;ge&&(W=(F=ge.split("."))[0]>0&&F[0]<4?1:+(F[0]+F[1])),!W&&fe&&(!(F=fe.match(/Edge\/(\d+)/))||F[1]>=74)&&(F=fe.match(/Chrome\/(\d+)/))&&(W=+F[1]);var ve=W,Ee=ve,be=s,ye=m.String,we=!!Object.getOwnPropertySymbols&&!be((function(){var e=Symbol();return!ye(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Ee&&Ee<41})),Se=we&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Te=de,Re=N,Ce=f,Ie=Object,Ae=Se?function(e){return"symbol"==typeof e}:function(e){var t=Te("Symbol");return Re(t)&&Ce(t.prototype,Ie(e))},Oe=String,Me=function(e){try{return Oe(e)}catch(e){return"Object"}},Ne=N,ke=Me,Pe=TypeError,De=function(e){if(Ne(e))return e;throw Pe(ke(e)+" is not a function")},Le=De,xe=J,Ue=function(e,t){var i=e[t];return xe(i)?void 0:Le(i)},Ve=x,Be=N,je=re,Fe=TypeError,We={exports:{}},Ge=m,He=Object.defineProperty,qe=function(e,t){try{He(Ge,e,{value:t,configurable:!0,writable:!0})}catch(o){Ge[e]=t}return t},Ke="__core-js_shared__",ze=m[Ke]||qe(Ke,{}),Ye=ze;(We.exports=function(e,t){return Ye[e]||(Ye[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.31.1",mode:"pure",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.31.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Je=We.exports,Xe=Z,Qe=Object,Ze=function(e){return Qe(Xe(e))},$e=Ze,et=h({}.hasOwnProperty),tt=Object.hasOwn||function(e,t){return et($e(e),t)},it=h,nt=0,rt=Math.random(),ot=it(1..toString),st=function(e){return"Symbol("+(void 0===e?"":e)+")_"+ot(++nt+rt,36)},at=Je,ct=tt,ut=st,dt=we,lt=Se,ht=m.Symbol,ft=at("wks"),pt=lt?ht.for||ht:ht&&ht.withoutSetter||ut,mt=function(e){return ct(ft,e)||(ft[e]=dt&&ct(ht,e)?ht[e]:pt("Symbol."+e)),ft[e]},_t=x,gt=re,vt=Ae,Et=Ue,bt=function(e,t){var i,n;if("string"===t&&Be(i=e.toString)&&!je(n=Ve(i,e)))return n;if(Be(i=e.valueOf)&&!je(n=Ve(i,e)))return n;if("string"!==t&&Be(i=e.toString)&&!je(n=Ve(i,e)))return n;throw Fe("Can't convert object to primitive value")},yt=TypeError,wt=mt("toPrimitive"),St=function(e,t){if(!gt(e)||vt(e))return e;var i,n=Et(e,wt);if(n){if(void 0===t&&(t="default"),i=_t(n,e,t),!gt(i)||vt(i))return i;throw yt("Can't convert object to primitive value")}return void 0===t&&(t="number"),bt(e,t)},Tt=Ae,Rt=function(e){var t=St(e,"string");return Tt(t)?t:t+""},Ct=re,It=m.document,At=Ct(It)&&Ct(It.createElement),Ot=function(e){return At?It.createElement(e):{}},Mt=Ot,Nt=!P&&!s((function(){return 7!=Object.defineProperty(Mt("div"),"a",{get:function(){return 7}}).a})),kt=P,Pt=x,Dt=U,Lt=G,xt=te,Ut=Rt,Vt=tt,Bt=Nt,jt=Object.getOwnPropertyDescriptor;k.f=kt?jt:function(e,t){if(e=xt(e),t=Ut(t),Bt)try{return jt(e,t)}catch(e){}if(Vt(e,t))return Lt(!Pt(Dt.f,e,t),e[t])};var Ft=s,Wt=N,Gt=/#|\.prototype\./,Ht=function(e,t){var i=Kt[qt(e)];return i==Yt||i!=zt&&(Wt(t)?Ft(t):!!t)},qt=Ht.normalize=function(e){return String(e).replace(Gt,".").toLowerCase()},Kt=Ht.data={},zt=Ht.NATIVE="N",Yt=Ht.POLYFILL="P",Jt=Ht,Xt=De,Qt=a,Zt=I(I.bind),$t=function(e,t){return Xt(e),void 0===t?e:Qt?Zt(e,t):function(){return e.apply(t,arguments)}},ei={},ti=P&&s((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),ii=re,ni=String,ri=TypeError,oi=function(e){if(ii(e))return e;throw ri(ni(e)+" is not an object")},si=P,ai=Nt,ci=ti,ui=oi,di=Rt,li=TypeError,hi=Object.defineProperty,fi=Object.getOwnPropertyDescriptor,pi="enumerable",mi="configurable",_i="writable";ei.f=si?ci?function(e,t,i){if(ui(e),t=di(t),ui(i),"function"==typeof e&&"prototype"===t&&"value"in i&&_i in i&&!i[_i]){var n=fi(e,t);n&&n[_i]&&(e[t]=i.value,i={configurable:mi in i?i[mi]:n[mi],enumerable:pi in i?i[pi]:n[pi],writable:!1})}return hi(e,t,i)}:hi:function(e,t,i){if(ui(e),t=di(t),ui(i),ai)try{return hi(e,t,i)}catch(e){}if("get"in i||"set"in i)throw li("Accessors not supported");return"value"in i&&(e[t]=i.value),e};var gi=ei,vi=G,Ei=P?function(e,t,i){return gi.f(e,t,vi(1,i))}:function(e,t,i){return e[t]=i,e},bi=m,yi=b,wi=I,Si=N,Ti=k.f,Ri=Jt,Ci=oe,Ii=$t,Ai=Ei,Oi=tt,Mi=function(e){var t=function(i,n,r){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(i);case 2:return new e(i,n)}return new e(i,n,r)}return yi(e,this,arguments)};return t.prototype=e.prototype,t},Ni=function(e,t){var i,n,r,o,s,a,c,u,d,l=e.target,h=e.global,f=e.stat,p=e.proto,m=h?bi:f?bi[l]:(bi[l]||{}).prototype,_=h?Ci:Ci[l]||Ai(Ci,l,{})[l],g=_.prototype;for(o in t)n=!(i=Ri(h?o:l+(f?".":"#")+o,e.forced))&&m&&Oi(m,o),a=_[o],n&&(c=e.dontCallGetSet?(d=Ti(m,o))&&d.value:m[o]),s=n&&c?c:t[o],n&&typeof a==typeof s||(u=e.bind&&n?Ii(s,bi):e.wrap&&n?Mi(s):p&&Si(s)?wi(s):s,(e.sham||s&&s.sham||a&&a.sham)&&Ai(u,"sham",!0),Ai(_,o,u),p&&(Oi(Ci,r=l+"Prototype")||Ai(Ci,r,{}),Ai(Ci[r],o,s),e.real&&g&&(i||!g[o])&&Ai(g,o,s)))},ki=Math.ceil,Pi=Math.floor,Di=Math.trunc||function(e){var t=+e;return(t>0?Pi:ki)(t)},Li=function(e){var t=+e;return t!=t||0===t?0:Di(t)},xi=Li,Ui=Math.max,Vi=Math.min,Bi=function(e,t){var i=xi(e);return i<0?Ui(i+t,0):Vi(i,t)},ji=Li,Fi=Math.min,Wi=function(e){return e>0?Fi(ji(e),9007199254740991):0},Gi=function(e){return Wi(e.length)},Hi=te,qi=Bi,Ki=Gi,zi=function(e){return function(t,i,n){var r,o=Hi(t),s=Ki(o),a=qi(n,s);if(e&&i!=i){for(;s>a;)if((r=o[a++])!=r)return!0}else for(;s>a;a++)if((e||a in o)&&o[a]===i)return e||a||0;return!e&&-1}},Yi={includes:zi(!0),indexOf:zi(!1)},Ji=Yi.includes;Ni({target:"Array",proto:!0,forced:s((function(){return!Array(1).includes()}))},{includes:function(e){return Ji(this,e,arguments.length>1?arguments[1]:void 0)}});var Xi=oe,Qi=function(e){return Xi[e+"Prototype"]},Zi=Qi("Array").includes,$i=re,en=T,tn=mt("match"),nn=function(e){var t;return $i(e)&&(void 0!==(t=e[tn])?!!t:"RegExp"==en(e))},rn=TypeError,on={};on[mt("toStringTag")]="z";var sn="[object z]"===String(on),an=sn,cn=N,un=T,dn=mt("toStringTag"),ln=Object,hn="Arguments"==un(function(){return arguments}()),fn=an?un:function(e){var t,i,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=ln(e),dn))?i:hn?un(t):"Object"==(n=un(t))&&cn(t.callee)?"Arguments":n},pn=fn,mn=String,_n=function(e){if("Symbol"===pn(e))throw TypeError("Cannot convert a Symbol value to a string");return mn(e)},gn=mt("match"),vn=Ni,En=function(e){if(nn(e))throw rn("The method doesn't accept regular expressions");return e},bn=Z,yn=_n,wn=function(e){var t=/./;try{"/./"[e](t)}catch(o){try{return t[gn]=!1,"/./"[e](t)}catch(e){}}return!1},Sn=h("".indexOf);vn({target:"String",proto:!0,forced:!wn("includes")},{includes:function(e){return!!~Sn(yn(bn(this)),yn(En(e)),arguments.length>1?arguments[1]:void 0)}});var Tn=Qi("String").includes,Rn=f,Cn=Zi,In=Tn,An=Array.prototype,On=String.prototype,Mn=o((function(e){var t=e.includes;return e===An||Rn(An,e)&&t===An.includes?Cn:"string"==typeof e||e===On||Rn(On,e)&&t===On.includes?In:t}));let Nn=!0,kn=!0;function Pn(e,t,i){const n=e.match(t);return n&&n.length>=i&&parseInt(n[i],10)}function Dn(e,t,i){if(!e.RTCPeerConnection)return;const n=e.RTCPeerConnection.prototype,r=n.addEventListener;n.addEventListener=function(e,n){if(e!==t)return r.apply(this,arguments);const o=e=>{const t=i(e);t&&(n.handleEvent?n.handleEvent(t):n(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(n,o),r.apply(this,[e,o])};const o=n.removeEventListener;n.removeEventListener=function(e,i){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(i))return o.apply(this,arguments);const n=this._eventMap[t].get(i);return this._eventMap[t].delete(i),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,n])},Object.defineProperty(n,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function Ln(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Nn=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function xn(e){return"boolean"!=typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(kn=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Un(){if("object"==typeof window){if(Nn)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}}function Vn(e,t){kn&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Bn(e){return"[object Object]"===Object.prototype.toString.call(e)}function jn(e){return Bn(e)?Object.keys(e).reduce((function(t,i){const n=Bn(e[i]),r=n?jn(e[i]):e[i],o=n&&!Object.keys(r).length;return void 0===r||o?t:Object.assign(t,{[i]:r})}),{}):e}function Fn(e,t,i){t&&!i.has(t.id)&&(i.set(t.id,t),Object.keys(t).forEach((n=>{n.endsWith("Id")?Fn(e,e.get(t[n]),i):n.endsWith("Ids")&&t[n].forEach((t=>{Fn(e,e.get(t),i)}))})))}function Wn(e,t,i){const n=i?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const o=[];return e.forEach((e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),o.forEach((t=>{e.forEach((i=>{i.type===n&&i.trackId===t.id&&Fn(e,i,r)}))})),r}const Gn=Un;function Hn(e,t){const i=e&&e.navigator;if(!i.mediaDevices)return;const n=function(e){if("object"!=typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach((i=>{if("require"===i||"advanced"===i||"mediaSource"===i)return;const n="object"==typeof e[i]?e[i]:{ideal:e[i]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){t.optional=t.optional||[];let e={};"number"==typeof n.ideal?(e[r("min",i)]=n.ideal,t.optional.push(e),e={},e[r("max",i)]=n.ideal,t.optional.push(e)):(e[r("",i)]=n.ideal,t.optional.push(e))}void 0!==n.exact&&"number"!=typeof n.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",i)]=n.exact):["min","max"].forEach((e=>{void 0!==n[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,i)]=n[e])}))})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"==typeof e.audio){const t=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=n(e.audio)}if(e&&"object"==typeof e.video){let o=e.video.facingMode;o=o&&("object"==typeof o?o:{ideal:o});const s=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!i.mediaDevices.getSupportedConstraints||!i.mediaDevices.getSupportedConstraints().facingMode||s)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return i.mediaDevices.enumerateDevices().then((i=>{let s=(i=i.filter((e=>"videoinput"===e.kind))).find((e=>t.some((t=>e.label.toLowerCase().includes(t)))));return!s&&i.length&&t.includes("back")&&(s=i[i.length-1]),s&&(e.video.deviceId=o.exact?{exact:s.deviceId}:{ideal:s.deviceId}),e.video=n(e.video),Gn("chrome: "+JSON.stringify(e)),r(e)}))}e.video=n(e.video)}return Gn("chrome: "+JSON.stringify(e)),r(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(i.getUserMedia=function(e,t,n){r(e,(e=>{i.webkitGetUserMedia(e,t,(e=>{n&&n(o(e))}))}))}.bind(i),i.mediaDevices.getUserMedia){const e=i.mediaDevices.getUserMedia.bind(i.mediaDevices);i.mediaDevices.getUserMedia=function(t){return r(t,(t=>e(t).then((e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach((e=>{e.stop()})),new DOMException("","NotFoundError");return e}),(e=>Promise.reject(o(e))))))}}}function qn(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function Kn(e){if("object"==typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",(i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===i.track.id)):{track:i.track};const r=new Event("track");r.track=i.track,r.receiver=n,r.transceiver={receiver:n},r.streams=[t.stream],this.dispatchEvent(r)})),t.stream.getTracks().forEach((i=>{let n;n=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((e=>e.track&&e.track.id===i.id)):{track:i};const r=new Event("track");r.track=i,r.receiver=n,r.transceiver={receiver:n},r.streams=[t.stream],this.dispatchEvent(r)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Dn(e,"track",(e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e)))}function zn(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){let r=i.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){n.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach((e=>{this._senders.push(t(this,e))}))};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach((e=>{const t=this._senders.find((t=>t.track===e));t&&this._senders.splice(this._senders.indexOf(t),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Yn(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,i,n]=arguments;if(arguments.length>0&&"function"==typeof e)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof e))return t.apply(this,[]);const r=function(e){const t={};return e.result().forEach((e=>{const i={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((t=>{i[t]=e.stat(t)})),t[i.id]=i})),t},o=function(e){return new Map(Object.keys(e).map((t=>[t,e[t]])))};if(arguments.length>=2){const n=function(e){i(o(r(e)))};return t.apply(this,[n,e])}return new Promise(((e,i)=>{t.apply(this,[function(t){e(o(r(t)))},i])})).then(i,n)}}function Jn(e){if(!("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>Wn(t,e.track,!0)))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Dn(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then((t=>Wn(t,e.track,!1)))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,i,n;return this.getSenders().forEach((i=>{i.track===e&&(t?n=!0:t=i)})),this.getReceivers().forEach((t=>(t.track===e&&(i?n=!0:i=t),t.track===e))),n||t&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Xn(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((e=>this._shimmedLocalStreams[e][0]))};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){if(!i)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const n=t.apply(this,arguments);return this._shimmedLocalStreams[i.id]?-1===this._shimmedLocalStreams[i.id].indexOf(n)&&this._shimmedLocalStreams[i.id].push(n):this._shimmedLocalStreams[i.id]=[i,n],n};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")}));const t=this.getSenders();i.apply(this,arguments);const n=this.getSenders().filter((e=>-1===t.indexOf(e)));this._shimmedLocalStreams[e.id]=[e].concat(n)};const n=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],n.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((t=>{const i=this._shimmedLocalStreams[t].indexOf(e);-1!==i&&this._shimmedLocalStreams[t].splice(i,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]})),r.apply(this,arguments)}}function Qn(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Xn(e);const i=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=i.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map((e=>this._reverseStreams[e.id]))};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((e=>{if(this.getSenders().find((t=>t.track===e)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){const i=new e.MediaStream(t.getTracks());this._streams[t.id]=i,this._reverseStreams[i.id]=t,t=i}n.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],r=e._streams[n.id];i=i.replace(new RegExp(r.id,"g"),n.id)})),new RTCSessionDescription({type:t.type,sdp:i})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,i){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const n=[].slice.call(arguments,1);if(1!==n.length||!n[0].getTracks().find((e=>e===t)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((e=>e.track===t)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const r=this._streams[i.id];if(r)r.addTrack(t),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const n=new e.MediaStream([t]);this._streams[i.id]=n,this._reverseStreams[n.id]=i,this.addStream(n)}return this.getSenders().find((e=>e.track===t))},["createOffer","createAnswer"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){const e=arguments;return arguments.length&&"function"==typeof arguments[0]?i.apply(this,[t=>{const i=o(this,t);e[0].apply(null,[i])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):i.apply(this,arguments).then((e=>o(this,e)))}};e.RTCPeerConnection.prototype[t]=n[t]}));const s=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let i=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((t=>{const n=e._reverseStreams[t],r=e._streams[n.id];i=i.replace(new RegExp(n.id,"g"),r.id)})),new RTCSessionDescription({type:t.type,sdp:i})}(this,arguments[0]),s.apply(this,arguments)):s.apply(this,arguments)};const a=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=a.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach((i=>{this._streams[i].getTracks().find((t=>e.track===t))&&(t=this._streams[i])})),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Zn(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}))}function $n(e,t){Dn(e,"negotiationneeded",(e=>{const i=e.target;if(!(t.version<72||i.getConfiguration&&"plan-b"===i.getConfiguration().sdpSemantics)||"stable"===i.signalingState)return e}))}var er=Object.freeze({__proto__:null,fixNegotiationNeeded:$n,shimAddTrackRemoveTrack:Qn,shimAddTrackRemoveTrackWithNative:Xn,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(i){return t(i).then((t=>{const n=i.video&&i.video.width,r=i.video&&i.video.height,o=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:o||3}},n&&(i.video.mandatory.maxWidth=n),r&&(i.video.mandatory.maxHeight=r),e.navigator.mediaDevices.getUserMedia(i)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))},shimGetSendersWithDtmf:zn,shimGetStats:Yn,shimGetUserMedia:Hn,shimMediaStream:qn,shimOnTrack:Kn,shimPeerConnection:Zn,shimSenderReceiverGetStats:Jn});function tr(e,t){const i=e&&e.navigator,n=e&&e.MediaStreamTrack;if(i.getUserMedia=function(e,t,n){Vn("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),i.mediaDevices.getUserMedia(e).then(t,n)},!(t.version>55&&"autoGainControl"in i.mediaDevices.getSupportedConstraints())){const e=function(e,t,i){t in e&&!(i in e)&&(e[i]=e[t],delete e[t])},t=i.mediaDevices.getUserMedia.bind(i.mediaDevices);if(i.mediaDevices.getUserMedia=function(i){return"object"==typeof i&&"object"==typeof i.audio&&(i=JSON.parse(JSON.stringify(i)),e(i.audio,"autoGainControl","mozAutoGainControl"),e(i.audio,"noiseSuppression","mozNoiseSuppression")),t(i)},n&&n.prototype.getSettings){const t=n.prototype.getSettings;n.prototype.getSettings=function(){const i=t.apply(this,arguments);return e(i,"mozAutoGainControl","autoGainControl"),e(i,"mozNoiseSuppression","noiseSuppression"),i}}if(n&&n.prototype.applyConstraints){const t=n.prototype.applyConstraints;n.prototype.applyConstraints=function(i){return"audio"===this.kind&&"object"==typeof i&&(i=JSON.parse(JSON.stringify(i)),e(i,"autoGainControl","mozAutoGainControl"),e(i,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[i])}}}}function ir(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function nr(e,t){if("object"!=typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){const i=e.RTCPeerConnection.prototype[t],n={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=n[t]}));const i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},n=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,o]=arguments;return n.apply(this,[e||null]).then((e=>{if(t.version<53&&!r)try{e.forEach((e=>{e.type=i[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach(((t,n)=>{e.set(n,Object.assign({},t,{type:i[t.type]||t.type}))}))}return e})).then(r,o)}}function rr(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e});const i=e.RTCPeerConnection.prototype.addTrack;i&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=i.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function or(e){if("object"!=typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach((e=>e._pc=this)),e}),Dn(e,"track",(e=>(e.receiver._pc=e.srcElement,e))),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function sr(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){Vn("removeStream","removeTrack"),this.getSenders().forEach((t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)}))})}function ar(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function cr(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const i=e.length>0;i&&e.forEach((e=>{if("rid"in e&&!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const n=t.apply(this,arguments);if(i){const{sender:t}=n,i=t.getParameters();(!("encodings"in i)||1===i.encodings.length&&0===Object.keys(i.encodings[0]).length)&&(i.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(i).then((()=>{delete t.sendEncodings})).catch((()=>{delete t.sendEncodings}))))}return n})}function ur(e){if("object"!=typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function dr(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}function lr(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>t.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):t.apply(this,arguments)}}var hr=Object.freeze({__proto__:null,shimAddTransceiver:cr,shimCreateAnswer:lr,shimCreateOffer:dr,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(i){if(!i||!i.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===i.video?i.video={mediaSource:t}:i.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(i)})},shimGetParameters:ur,shimGetUserMedia:tr,shimOnTrack:ir,shimPeerConnection:nr,shimRTCDataChannel:ar,shimReceiverGetStats:or,shimRemoveStream:sr,shimSenderGetStats:rr});function fr(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((i=>t.call(this,i,e))),e.getVideoTracks().forEach((i=>t.call(this,i,e)))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];return n&&n.forEach((e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const i=e.getTracks();this.getSenders().forEach((e=>{i.includes(e.track)&&this.removeTrack(e)}))})}}function pr(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach((e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)}))})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const i=new Event("addstream");i.stream=t,e.dispatchEvent(i)}))}),t.apply(e,arguments)}}}function mr(e){if("object"!=typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,i=t.createOffer,n=t.createAnswer,r=t.setLocalDescription,o=t.setRemoteDescription,s=t.addIceCandidate;t.createOffer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r};let a=function(e,t,i){const n=r.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n};t.setLocalDescription=a,a=function(e,t,i){const n=o.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.setRemoteDescription=a,a=function(e,t,i){const n=s.apply(this,[e]);return i?(n.then(t,i),Promise.resolve()):n},t.addIceCandidate=a}function _r(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,i=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>i(gr(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,i,n){t.mediaDevices.getUserMedia(e).then(i,n)}.bind(t))}function gr(e){return e&&void 0!==e.video?Object.assign({},e,{video:jn(e.video)}):e}function vr(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,i){if(e&&e.iceServers){const t=[];for(let i=0;i<e.iceServers.length;i++){let n=e.iceServers[i];!n.hasOwnProperty("urls")&&n.hasOwnProperty("url")?(Vn("RTCIceServer.url","RTCIceServer.urls"),n=JSON.parse(JSON.stringify(n)),n.urls=n.url,delete n.url,t.push(n)):t.push(e.iceServers[i])}e.iceServers=t}return new t(e,i)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function Er(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function br(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find((e=>"audio"===e.receiver.track.kind));!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const i=this.getTransceivers().find((e=>"video"===e.receiver.track.kind));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function yr(e){"object"!=typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var wr=Object.freeze({__proto__:null,shimAudioContext:yr,shimCallbacksAPI:mr,shimConstraints:gr,shimCreateOfferLegacy:br,shimGetUserMedia:_r,shimLocalStreamsAPI:fr,shimRTCIceServerUrls:vr,shimRemoteStreamsAPI:pr,shimTrackEventTransceiver:Er}),Sr={exports:{}};!function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map((e=>e.trim()))},t.splitSections=function(e){return e.split("\nm=").map(((e,t)=>(t>0?"m="+e:e).trim()+"\r\n"))},t.getDescription=function(e){const i=t.splitSections(e);return i&&i[0]},t.getMediaSections=function(e){const i=t.splitSections(e);return i.shift(),i},t.matchPrefix=function(e,i){return t.splitLines(e).filter((e=>0===e.indexOf(i)))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const i={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let n=8;n<t.length;n+=2)switch(t[n]){case"raddr":i.relatedAddress=t[n+1];break;case"rport":i.relatedPort=parseInt(t[n+1],10);break;case"tcptype":i.tcpType=t[n+1];break;case"ufrag":i.ufrag=t[n+1],i.usernameFragment=t[n+1];break;default:void 0===i[t[n]]&&(i[t[n]]=t[n+1])}return i},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const i=e.component;"rtp"===i?t.push(1):"rtcp"===i?t.push(2):t.push(i),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const i={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),i.name=t[0],i.clockRate=parseInt(t[1],10),i.channels=3===t.length?parseInt(t[2],10):1,i.numChannels=i.channels,i},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const i=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==i?"/"+i:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let i;const n=e.substring(e.indexOf(" ")+1).split(";");for(let r=0;r<n.length;r++)i=n[r].trim().split("="),t[i[0].trim()]=i[1];return t},t.writeFmtp=function(e){let t="",i=e.payloadType;if(void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const n=[];Object.keys(e.parameters).forEach((t=>{void 0!==e.parameters[t]?n.push(t+"="+e.parameters[t]):n.push(t)})),t+="a=fmtp:"+i+" "+n.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",i=e.payloadType;return void 0!==e.preferredPayloadType&&(i=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((e=>{t+="a=rtcp-fb:"+i+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),i={ssrc:parseInt(e.substring(7,t),10)},n=e.indexOf(":",t);return n>-1?(i.attribute=e.substring(t+1,n),i.value=e.substring(n+1)):i.attribute=e.substring(t+1),i},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((e=>parseInt(e,10)))}},t.getMid=function(e){const i=t.matchPrefix(e,"a=mid:")[0];if(i)return i.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,i){return{role:"auto",fingerprints:t.matchPrefix(e+i,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let i="a=setup:"+t+"\r\n";return e.fingerprints.forEach((e=>{i+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),i},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,i){return t.matchPrefix(e+i,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,i){const n=t.matchPrefix(e+i,"a=ice-ufrag:")[0],r=t.matchPrefix(e+i,"a=ice-pwd:")[0];return n&&r?{usernameFragment:n.substring(12),password:r.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=t.splitLines(e)[0].split(" ");i.profile=n[2];for(let o=3;o<n.length;o++){const r=n[o],s=t.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(s){const n=t.parseRtpMap(s),o=t.matchPrefix(e,"a=fmtp:"+r+" ");switch(n.parameters=o.length?t.parseFmtp(o[0]):{},n.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(t.parseRtcpFb),i.codecs.push(n),n.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(n.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach((e=>{i.headerExtensions.push(t.parseExtmap(e))}));const r=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return i.codecs.forEach((e=>{r.forEach((t=>{e.rtcpFeedback.find((e=>e.type===t.type&&e.parameter===t.parameter))||e.rtcpFeedback.push(t)}))})),i},t.writeRtpDescription=function(e,i){let n="";n+="m="+e+" ",n+=i.codecs.length>0?"9":"0",n+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",n+=i.codecs.map((e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType)).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",i.codecs.forEach((e=>{n+=t.writeRtpMap(e),n+=t.writeFmtp(e),n+=t.writeRtcpFb(e)}));let r=0;return i.codecs.forEach((e=>{e.maxptime>r&&(r=e.maxptime)})),r>0&&(n+="a=maxptime:"+r+"\r\n"),i.headerExtensions&&i.headerExtensions.forEach((e=>{n+=t.writeExtmap(e)})),n},t.parseRtpEncodingParameters=function(e){const i=[],n=t.parseRtpParameters(e),r=-1!==n.fecMechanisms.indexOf("RED"),o=-1!==n.fecMechanisms.indexOf("ULPFEC"),s=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute)),a=s.length>0&&s[0].ssrc;let c;const u=t.matchPrefix(e,"a=ssrc-group:FID").map((e=>e.substring(17).split(" ").map((e=>parseInt(e,10)))));u.length>0&&u[0].length>1&&u[0][0]===a&&(c=u[0][1]),n.codecs.forEach((e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10)};a&&c&&(t.rtx={ssrc:c}),i.push(t),r&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:a,mechanism:o?"red+ulpfec":"red"},i.push(t))}})),0===i.length&&a&&i.push({ssrc:a});let d=t.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substring(7),10):0===d[0].indexOf("b=AS:")?1e3*parseInt(d[0].substring(5),10)*.95-16e3:void 0,i.forEach((e=>{e.maxBitrate=d}))),i},t.parseRtcpParameters=function(e){const i={},n=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"cname"===e.attribute))[0];n&&(i.cname=n.value,i.ssrc=n.ssrc);const r=t.matchPrefix(e,"a=rtcp-rsize");i.reducedSize=r.length>0,i.compound=0===r.length;const o=t.matchPrefix(e,"a=rtcp-mux");return i.mux=o.length>0,i},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let i;const n=t.matchPrefix(e,"a=msid:");if(1===n.length)return i=n[0].substring(7).split(" "),{stream:i[0],track:i[1]};const r=t.matchPrefix(e,"a=ssrc:").map((e=>t.parseSsrcMedia(e))).filter((e=>"msid"===e.attribute));return r.length>0?(i=r[0].value.split(" "),{stream:i[0],track:i[1]}):void 0},t.parseSctpDescription=function(e){const i=t.parseMLine(e),n=t.matchPrefix(e,"a=max-message-size:");let r;n.length>0&&(r=parseInt(n[0].substring(19),10)),isNaN(r)&&(r=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:i.fmt,maxMessageSize:r};const s=t.matchPrefix(e,"a=sctpmap:");if(s.length>0){const e=s[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){let i=[];return i="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&i.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),i.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,i,n){let r;const o=void 0!==i?i:2;return r=e||t.generateSessionId(),"v=0\r\no="+(n||"thisisadapterortc")+" "+r+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,i){const n=t.splitLines(e);for(let t=0;t<n.length;t++)switch(n[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[t].substring(2)}return i?t.getDirection(i):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const i=t.splitLines(e)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},t.parseOLine=function(e){const i=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;const i=t.splitLines(e);for(let t=0;t<i.length;t++)if(i[t].length<2||"="!==i[t].charAt(1))return!1;return!0},e.exports=t}(Sr);var Tr=Sr.exports,Rr=o(Tr),Cr=e({__proto__:null,default:Rr},[Tr]);function Ir(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"==typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){const i=new t(e),n=Rr.parseCandidate(e.candidate),r=Object.assign(i,n);return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Dn(e,"icecandidate",(t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t)))}function Ar(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Dn(e,"icecandidate",(e=>{if(e.candidate){const t=Rr.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e}))}function Or(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return void 0===this._sctp?null:this._sctp}});const i=function(e){if(!e||!e.sdp)return!1;const t=Rr.splitSections(e.sdp);return t.shift(),t.some((e=>{const t=Rr.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},n=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const i=parseInt(t[1],10);return i!=i?-1:i},r=function(e){let i=65536;return"firefox"===t.browser&&(i=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),i},o=function(e,i){let n=65536;"firefox"===t.browser&&57===t.version&&(n=65535);const r=Rr.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?n=parseInt(r[0].substr(19),10):"firefox"===t.browser&&-1!==i&&(n=2147483637),n},s=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(i(arguments[0])){const e=n(arguments[0]),t=r(e),i=o(arguments[0],e);let s;s=0===t&&0===i?Number.POSITIVE_INFINITY:0===t||0===i?Math.max(t,i):Math.min(t,i);const a={};Object.defineProperty(a,"maxMessageSize",{get:()=>s}),this._sctp=a}return s.apply(this,arguments)}}function Mr(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const i=e.send;e.send=function(){const n=arguments[0],r=n.length||n.size||n.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return i.apply(e,arguments)}}const i=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=i.apply(this,arguments);return t(e,this),e},Dn(e,"datachannel",(e=>(t(e.channel,e.target),e)))}function Nr(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((e=>{const i=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const i=new Event("connectionstatechange",e);t.dispatchEvent(i)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}}))}function kr(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;const i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const i=t.sdp.split("\n").filter((e=>"a=extmap-allow-mixed"!==e.trim())).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:i}):t.sdp=i}return i.apply(this,arguments)}}function Pr(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const i=e.RTCPeerConnection.prototype.addIceCandidate;i&&0!==i.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():i.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Dr(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const i=e.RTCPeerConnection.prototype.setLocalDescription;i&&0!==i.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!=typeof e||e.type&&e.sdp)return i.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}return e.sdp||"offer"!==e.type&&"answer"!==e.type?i.apply(this,[e]):("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then((e=>i.apply(this,[e])))})}var Lr=Object.freeze({__proto__:null,removeExtmapAllowMixed:kr,shimAddIceCandidateNullOrEmpty:Pr,shimConnectionState:Nr,shimMaxMessageSize:Or,shimParameterlessSetLocalDescription:Dr,shimRTCIceCandidate:Ir,shimRTCIceCandidateRelayProtocol:Ar,shimSendThrowTypeError:Mr});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const i=Un,n=function(e){const t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;const{navigator:i}=e;if(i.mozGetUserMedia)t.browser="firefox",t.version=Pn(i.userAgent,/Firefox\/(\d+)\./,1);else if(i.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=Pn(i.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!e.RTCPeerConnection||!i.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=Pn(i.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t}(e),r={browserDetails:n,commonShim:Lr,extractVersion:Pn,disableLog:Ln,disableWarnings:xn,sdp:Cr};switch(n.browser){case"chrome":if(!er||!Zn||!t.shimChrome)return i("Chrome shim is not included in this adapter release."),r;if(null===n.version)return i("Chrome shim can not determine version, not shimming."),r;i("adapter.js shimming chrome."),r.browserShim=er,Pr(e,n),Dr(e),Hn(e,n),qn(e),Zn(e,n),Kn(e),Qn(e,n),zn(e),Yn(e),Jn(e),$n(e,n),Ir(e),Ar(e),Nr(e),Or(e,n),Mr(e),kr(e,n);break;case"firefox":if(!hr||!nr||!t.shimFirefox)return i("Firefox shim is not included in this adapter release."),r;i("adapter.js shimming firefox."),r.browserShim=hr,Pr(e,n),Dr(e),tr(e,n),nr(e,n),ir(e),sr(e),rr(e),or(e),ar(e),cr(e),ur(e),dr(e),lr(e),Ir(e),Nr(e),Or(e,n),Mr(e);break;case"safari":if(!wr||!t.shimSafari)return i("Safari shim is not included in this adapter release."),r;i("adapter.js shimming safari."),r.browserShim=wr,Pr(e,n),Dr(e),vr(e),br(e),mr(e),fr(e),pr(e),Er(e),_r(e),yr(e),Ir(e),Ar(e),Or(e,n),Mr(e),kr(e,n);break;default:i("Unsupported browser!")}}({window:"undefined"==typeof window?void 0:window});var xr={exports:{}},Ur=Ni,Vr=P,Br=ei.f;Ur({target:"Object",stat:!0,forced:Object.defineProperty!==Br,sham:!Vr},{defineProperty:Br});var jr=oe.Object,Fr=xr.exports=function(e,t,i){return jr.defineProperty(e,t,i)};jr.defineProperty.sham&&(Fr.sham=!0);var Wr=o(xr.exports),Gr=T,Hr=Array.isArray||function(e){return"Array"==Gr(e)},qr=TypeError,Kr=Rt,zr=ei,Yr=G,Jr=function(e,t,i){var n=Kr(t);n in e?zr.f(e,n,Yr(0,i)):e[n]=i},Xr=N,Qr=ze,Zr=h(Function.toString);Xr(Qr.inspectSource)||(Qr.inspectSource=function(e){return Zr(e)});var $r=Qr.inspectSource,eo=h,to=s,io=N,no=fn,ro=$r,oo=function(){},so=[],ao=de("Reflect","construct"),co=/^\s*(?:class|function)\b/,uo=eo(co.exec),lo=!co.exec(oo),ho=function(e){if(!io(e))return!1;try{return ao(oo,so,e),!0}catch(e){return!1}},fo=function(e){if(!io(e))return!1;switch(no(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return lo||!!uo(co,ro(e))}catch(e){return!0}};fo.sham=!0;var po=!ao||to((function(){var e;return ho(ho.call)||!ho(Object)||!ho((function(){e=!0}))||e}))?fo:ho,mo=Hr,_o=po,go=re,vo=mt("species"),Eo=Array,bo=function(e){var t;return mo(e)&&(t=e.constructor,(_o(t)&&(t===Eo||mo(t.prototype))||go(t)&&null===(t=t[vo]))&&(t=void 0)),void 0===t?Eo:t},yo=function(e,t){return new(bo(e))(0===t?0:t)},wo=s,So=ve,To=mt("species"),Ro=Ni,Co=s,Io=Hr,Ao=re,Oo=Ze,Mo=Gi,No=function(e){if(e>9007199254740991)throw qr("Maximum allowed index exceeded");return e},ko=Jr,Po=yo,Do=function(e){return So>=51||!wo((function(){var t=[];return(t.constructor={})[To]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},Lo=ve,xo=mt("isConcatSpreadable"),Uo=Lo>=51||!Co((function(){var e=[];return e[xo]=!1,e.concat()[0]!==e})),Vo=function(e){if(!Ao(e))return!1;var t=e[xo];return void 0!==t?!!t:Io(e)};Ro({target:"Array",proto:!0,arity:1,forced:!Uo||!Do("concat")},{concat:function(e){var t,i,n,r,o,s=Oo(this),a=Po(s,0),c=0;for(t=-1,n=arguments.length;t<n;t++)if(Vo(o=-1===t?s:arguments[t]))for(r=Mo(o),No(c+r),i=0;i<r;i++,c++)i in o&&ko(a,c,o[i]);else No(c+1),ko(a,c++,o);return a.length=c,a}});var Bo={},jo={},Fo=tt,Wo=te,Go=Yi.indexOf,Ho=jo,qo=h([].push),Ko=function(e,t){var i,n=Wo(e),r=0,o=[];for(i in n)!Fo(Ho,i)&&Fo(n,i)&&qo(o,i);for(;t.length>r;)Fo(n,i=t[r++])&&(~Go(o,i)||qo(o,i));return o},zo=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Yo=Ko,Jo=zo,Xo=Object.keys||function(e){return Yo(e,Jo)},Qo=P,Zo=ti,$o=ei,es=oi,ts=te,is=Xo;Bo.f=Qo&&!Zo?Object.defineProperties:function(e,t){es(e);for(var i,n=ts(t),r=is(t),o=r.length,s=0;o>s;)$o.f(e,i=r[s++],n[i]);return e};var ns,rs=de("document","documentElement"),os=st,ss=Je("keys"),as=function(e){return ss[e]||(ss[e]=os(e))},cs=oi,us=Bo,ds=zo,ls=jo,hs=rs,fs=Ot,ps="prototype",ms="script",_s=as("IE_PROTO"),gs=function(){},vs=function(e){return"<"+ms+">"+e+"</"+ms+">"},Es=function(e){e.write(vs("")),e.close();var t=e.parentWindow.Object;return e=null,t},bs=function(){try{ns=new ActiveXObject("htmlfile")}catch(e){}var e,t,i;bs="undefined"!=typeof document?document.domain&&ns?Es(ns):(t=fs("iframe"),i="java"+ms+":",t.style.display="none",hs.appendChild(t),t.src=String(i),(e=t.contentWindow.document).open(),e.write(vs("document.F=Object")),e.close(),e.F):Es(ns);for(var n=ds.length;n--;)delete bs[ps][ds[n]];return bs()};ls[_s]=!0;var ys=Object.create||function(e,t){var i;return null!==e?(gs[ps]=cs(e),i=new gs,gs[ps]=null,i[_s]=e):i=bs(),void 0===t?i:us.f(i,t)},ws={},Ss=Ko,Ts=zo.concat("length","prototype");ws.f=Object.getOwnPropertyNames||function(e){return Ss(e,Ts)};var Rs={},Cs=Bi,Is=Gi,As=Jr,Os=Array,Ms=Math.max,Ns=function(e,t,i){for(var n=Is(e),r=Cs(t,n),o=Cs(void 0===i?n:i,n),s=Os(Ms(o-r,0)),a=0;r<o;r++,a++)As(s,a,e[r]);return s.length=a,s},ks=T,Ps=te,Ds=ws.f,Ls=Ns,xs="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Rs.f=function(e){return xs&&"Window"==ks(e)?function(e){try{return Ds(e)}catch(e){return Ls(xs)}}(e):Ds(Ps(e))};var Us={};Us.f=Object.getOwnPropertySymbols;var Vs=Ei,Bs=function(e,t,i,n){return n&&n.enumerable?e[t]=i:Vs(e,t,i),e},js=ei,Fs=function(e,t,i){return js.f(e,t,i)},Ws={},Gs=mt;Ws.f=Gs;var Hs,qs,Ks,zs=oe,Ys=tt,Js=Ws,Xs=ei.f,Qs=function(e){var t=zs.Symbol||(zs.Symbol={});Ys(t,e)||Xs(t,e,{value:Js.f(e)})},Zs=x,$s=de,ea=mt,ta=Bs,ia=function(){var e=$s("Symbol"),t=e&&e.prototype,i=t&&t.valueOf,n=ea("toPrimitive");t&&!t[n]&&ta(t,n,(function(e){return Zs(i,this)}),{arity:1})},na=fn,ra=sn?{}.toString:function(){return"[object "+na(this)+"]"},oa=sn,sa=ei.f,aa=Ei,ca=tt,ua=ra,da=mt("toStringTag"),la=function(e,t,i,n){if(e){var r=i?e:e.prototype;ca(r,da)||sa(r,da,{configurable:!0,value:t}),n&&!oa&&aa(r,"toString",ua)}},ha=N,fa=m.WeakMap,pa=ha(fa)&&/native code/.test(String(fa)),ma=m,_a=re,ga=Ei,va=tt,Ea=ze,ba=as,ya=jo,wa="Object already initialized",Sa=ma.TypeError,Ta=ma.WeakMap;if(pa||Ea.state){var Ra=Ea.state||(Ea.state=new Ta);Ra.get=Ra.get,Ra.has=Ra.has,Ra.set=Ra.set,Hs=function(e,t){if(Ra.has(e))throw Sa(wa);return t.facade=e,Ra.set(e,t),t},qs=function(e){return Ra.get(e)||{}},Ks=function(e){return Ra.has(e)}}else{var Ca=ba("state");ya[Ca]=!0,Hs=function(e,t){if(va(e,Ca))throw Sa(wa);return t.facade=e,ga(e,Ca,t),t},qs=function(e){return va(e,Ca)?e[Ca]:{}},Ks=function(e){return va(e,Ca)}}var Ia={set:Hs,get:qs,has:Ks,enforce:function(e){return Ks(e)?qs(e):Hs(e,{})},getterFor:function(e){return function(t){var i;if(!_a(t)||(i=qs(t)).type!==e)throw Sa("Incompatible receiver, "+e+" required");return i}}},Aa=$t,Oa=Y,Ma=Ze,Na=Gi,ka=yo,Pa=h([].push),Da=function(e){var t=1==e,i=2==e,n=3==e,r=4==e,o=6==e,s=7==e,a=5==e||o;return function(c,u,d,l){for(var h,f,p=Ma(c),m=Oa(p),_=Aa(u,d),g=Na(m),v=0,E=l||ka,b=t?E(c,g):i||s?E(c,0):void 0;g>v;v++)if((a||v in m)&&(f=_(h=m[v],v,p),e))if(t)b[v]=f;else if(f)switch(e){case 3:return!0;case 5:return h;case 6:return v;case 2:Pa(b,h)}else switch(e){case 4:return!1;case 7:Pa(b,h)}return o?-1:n||r?r:b}},La={forEach:Da(0),map:Da(1),filter:Da(2),some:Da(3),every:Da(4),find:Da(5),findIndex:Da(6),filterReject:Da(7)},xa=Ni,Ua=m,Va=x,Ba=h,ja=P,Fa=we,Wa=s,Ga=tt,Ha=f,qa=oi,Ka=te,za=Rt,Ya=_n,Ja=G,Xa=ys,Qa=Xo,Za=ws,$a=Rs,ec=Us,tc=k,ic=ei,nc=Bo,rc=U,oc=Bs,sc=Fs,ac=Je,cc=jo,uc=st,dc=mt,lc=Ws,hc=Qs,fc=ia,pc=la,mc=Ia,_c=La.forEach,gc=as("hidden"),vc="Symbol",Ec="prototype",bc=mc.set,yc=mc.getterFor(vc),wc=Object[Ec],Sc=Ua.Symbol,Tc=Sc&&Sc[Ec],Rc=Ua.TypeError,Cc=Ua.QObject,Ic=tc.f,Ac=ic.f,Oc=$a.f,Mc=rc.f,Nc=Ba([].push),kc=ac("symbols"),Pc=ac("op-symbols"),Dc=ac("wks"),Lc=!Cc||!Cc[Ec]||!Cc[Ec].findChild,xc=ja&&Wa((function(){return 7!=Xa(Ac({},"a",{get:function(){return Ac(this,"a",{value:7}).a}})).a}))?function(e,t,i){var n=Ic(wc,t);n&&delete wc[t],Ac(e,t,i),n&&e!==wc&&Ac(wc,t,n)}:Ac,Uc=function(e,t){var i=kc[e]=Xa(Tc);return bc(i,{type:vc,tag:e,description:t}),ja||(i.description=t),i},Vc=function(e,t,i){e===wc&&Vc(Pc,t,i),qa(e);var n=za(t);return qa(i),Ga(kc,n)?(i.enumerable?(Ga(e,gc)&&e[gc][n]&&(e[gc][n]=!1),i=Xa(i,{enumerable:Ja(0,!1)})):(Ga(e,gc)||Ac(e,gc,Ja(1,{})),e[gc][n]=!0),xc(e,n,i)):Ac(e,n,i)},Bc=function(e,t){qa(e);var i=Ka(t),n=Qa(i).concat(Gc(i));return _c(n,(function(t){ja&&!Va(jc,i,t)||Vc(e,t,i[t])})),e},jc=function(e){var t=za(e),i=Va(Mc,this,t);return!(this===wc&&Ga(kc,t)&&!Ga(Pc,t))&&(!(i||!Ga(this,t)||!Ga(kc,t)||Ga(this,gc)&&this[gc][t])||i)},Fc=function(e,t){var i=Ka(e),n=za(t);if(i!==wc||!Ga(kc,n)||Ga(Pc,n)){var r=Ic(i,n);return!r||!Ga(kc,n)||Ga(i,gc)&&i[gc][n]||(r.enumerable=!0),r}},Wc=function(e){var t=Oc(Ka(e)),i=[];return _c(t,(function(e){Ga(kc,e)||Ga(cc,e)||Nc(i,e)})),i},Gc=function(e){var t=e===wc,i=Oc(t?Pc:Ka(e)),n=[];return _c(i,(function(e){!Ga(kc,e)||t&&!Ga(wc,e)||Nc(n,kc[e])})),n};Fa||(Sc=function(){if(Ha(Tc,this))throw Rc("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?Ya(arguments[0]):void 0,t=uc(e),i=function(e){this===wc&&Va(i,Pc,e),Ga(this,gc)&&Ga(this[gc],t)&&(this[gc][t]=!1),xc(this,t,Ja(1,e))};return ja&&Lc&&xc(wc,t,{configurable:!0,set:i}),Uc(t,e)},oc(Tc=Sc[Ec],"toString",(function(){return yc(this).tag})),oc(Sc,"withoutSetter",(function(e){return Uc(uc(e),e)})),rc.f=jc,ic.f=Vc,nc.f=Bc,tc.f=Fc,Za.f=$a.f=Wc,ec.f=Gc,lc.f=function(e){return Uc(dc(e),e)},ja&&sc(Tc,"description",{configurable:!0,get:function(){return yc(this).description}})),xa({global:!0,constructor:!0,wrap:!0,forced:!Fa,sham:!Fa},{Symbol:Sc}),_c(Qa(Dc),(function(e){hc(e)})),xa({target:vc,stat:!0,forced:!Fa},{useSetter:function(){Lc=!0},useSimple:function(){Lc=!1}}),xa({target:"Object",stat:!0,forced:!Fa,sham:!ja},{create:function(e,t){return void 0===t?Xa(e):Bc(Xa(e),t)},defineProperty:Vc,defineProperties:Bc,getOwnPropertyDescriptor:Fc}),xa({target:"Object",stat:!0,forced:!Fa},{getOwnPropertyNames:Wc}),fc(),pc(Sc,vc),cc[gc]=!0;var Hc=we&&!!Symbol.for&&!!Symbol.keyFor,qc=Ni,Kc=de,zc=tt,Yc=_n,Jc=Je,Xc=Hc,Qc=Jc("string-to-symbol-registry"),Zc=Jc("symbol-to-string-registry");qc({target:"Symbol",stat:!0,forced:!Xc},{for:function(e){var t=Yc(e);if(zc(Qc,t))return Qc[t];var i=Kc("Symbol")(t);return Qc[t]=i,Zc[i]=t,i}});var $c=Ni,eu=tt,tu=Ae,iu=Me,nu=Hc,ru=Je("symbol-to-string-registry");$c({target:"Symbol",stat:!0,forced:!nu},{keyFor:function(e){if(!tu(e))throw TypeError(iu(e)+" is not a symbol");if(eu(ru,e))return ru[e]}});var ou=h([].slice),su=Hr,au=N,cu=T,uu=_n,du=h([].push),lu=Ni,hu=de,fu=b,pu=x,mu=h,_u=s,gu=N,vu=Ae,Eu=ou,bu=function(e){if(au(e))return e;if(su(e)){for(var t=e.length,i=[],n=0;n<t;n++){var r=e[n];"string"==typeof r?du(i,r):"number"!=typeof r&&"Number"!=cu(r)&&"String"!=cu(r)||du(i,uu(r))}var o=i.length,s=!0;return function(e,t){if(s)return s=!1,t;if(su(this))return t;for(var n=0;n<o;n++)if(i[n]===e)return t}}},yu=we,wu=String,Su=hu("JSON","stringify"),Tu=mu(/./.exec),Ru=mu("".charAt),Cu=mu("".charCodeAt),Iu=mu("".replace),Au=mu(1..toString),Ou=/[\uD800-\uDFFF]/g,Mu=/^[\uD800-\uDBFF]$/,Nu=/^[\uDC00-\uDFFF]$/,ku=!yu||_u((function(){var e=hu("Symbol")();return"[null]"!=Su([e])||"{}"!=Su({a:e})||"{}"!=Su(Object(e))})),Pu=_u((function(){return'"\\udf06\\ud834"'!==Su("\udf06\ud834")||'"\\udead"'!==Su("\udead")})),Du=function(e,t){var i=Eu(arguments),n=bu(t);if(gu(n)||void 0!==e&&!vu(e))return i[1]=function(e,t){if(gu(n)&&(t=pu(n,this,wu(e),t)),!vu(t))return t},fu(Su,null,i)},Lu=function(e,t,i){var n=Ru(i,t-1),r=Ru(i,t+1);return Tu(Mu,e)&&!Tu(Nu,r)||Tu(Nu,e)&&!Tu(Mu,n)?"\\u"+Au(Cu(e,0),16):e};Su&&lu({target:"JSON",stat:!0,arity:3,forced:ku||Pu},{stringify:function(e,t,i){var n=Eu(arguments),r=fu(ku?Du:Su,null,n);return Pu&&"string"==typeof r?Iu(r,Ou,Lu):r}});var xu=Us,Uu=Ze;Ni({target:"Object",stat:!0,forced:!we||s((function(){xu.f(1)}))},{getOwnPropertySymbols:function(e){var t=xu.f;return t?t(Uu(e)):[]}}),Qs("asyncIterator"),Qs("hasInstance"),Qs("isConcatSpreadable"),Qs("iterator"),Qs("match"),Qs("matchAll"),Qs("replace"),Qs("search"),Qs("species"),Qs("split");var Vu=ia;Qs("toPrimitive"),Vu();var Bu=de,ju=la;Qs("toStringTag"),ju(Bu("Symbol"),"Symbol"),Qs("unscopables"),la(m.JSON,"JSON",!0);var Fu,Wu,Gu,Hu=oe.Symbol,qu={},Ku=P,zu=tt,Yu=Function.prototype,Ju=Ku&&Object.getOwnPropertyDescriptor,Xu=zu(Yu,"name"),Qu={EXISTS:Xu,PROPER:Xu&&"something"===function(){}.name,CONFIGURABLE:Xu&&(!Ku||Ku&&Ju(Yu,"name").configurable)},Zu=!s((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),$u=tt,ed=N,td=Ze,id=Zu,nd=as("IE_PROTO"),rd=Object,od=rd.prototype,sd=id?rd.getPrototypeOf:function(e){var t=td(e);if($u(t,nd))return t[nd];var i=t.constructor;return ed(i)&&t instanceof i?i.prototype:t instanceof rd?od:null},ad=s,cd=N,ud=re,dd=ys,ld=sd,hd=Bs,fd=mt("iterator"),pd=!1;[].keys&&("next"in(Gu=[].keys())?(Wu=ld(ld(Gu)))!==Object.prototype&&(Fu=Wu):pd=!0);var md=!ud(Fu)||ad((function(){var e={};return Fu[fd].call(e)!==e}));cd((Fu=md?{}:dd(Fu))[fd])||hd(Fu,fd,(function(){return this}));var _d={IteratorPrototype:Fu,BUGGY_SAFARI_ITERATORS:pd},gd=_d.IteratorPrototype,vd=ys,Ed=G,bd=la,yd=qu,wd=function(){return this},Sd=h,Td=De,Rd=N,Cd=String,Id=TypeError,Ad=function(e,t,i){try{return Sd(Td(Object.getOwnPropertyDescriptor(e,t)[i]))}catch(e){}},Od=oi,Md=function(e){if("object"==typeof e||Rd(e))return e;throw Id("Can't set "+Cd(e)+" as a prototype")},Nd=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=Ad(Object.prototype,"__proto__","set"))(i,[]),t=i instanceof Array}catch(e){}return function(i,n){return Od(i),Md(n),t?e(i,n):i.__proto__=n,i}}():void 0),kd=Ni,Pd=x,Dd=function(e,t,i,n){var r=t+" Iterator";return e.prototype=vd(gd,{next:Ed(+!n,i)}),bd(e,r,!1,!0),yd[r]=wd,e},Ld=sd,xd=la,Ud=Bs,Vd=qu,Bd=_d,jd=Qu.PROPER,Fd=Bd.BUGGY_SAFARI_ITERATORS,Wd=mt("iterator"),Gd="keys",Hd="values",qd="entries",Kd=function(){return this},zd=function(e,t,i,n,r,o,s){Dd(i,t,n);var a,c,u,d=function(e){if(e===r&&m)return m;if(!Fd&&e in f)return f[e];switch(e){case Gd:case Hd:case qd:return function(){return new i(this,e)}}return function(){return new i(this)}},l=t+" Iterator",h=!1,f=e.prototype,p=f[Wd]||f["@@iterator"]||r&&f[r],m=!Fd&&p||d(r),_="Array"==t&&f.entries||p;if(_&&(a=Ld(_.call(new e)))!==Object.prototype&&a.next&&(xd(a,l,!0,!0),Vd[l]=Kd),jd&&r==Hd&&p&&p.name!==Hd&&(h=!0,m=function(){return Pd(p,this)}),r)if(c={values:d(Hd),keys:o?m:d(Gd),entries:d(qd)},s)for(u in c)(Fd||h||!(u in f))&&Ud(f,u,c[u]);else kd({target:t,proto:!0,forced:Fd||h},c);return s&&f[Wd]!==m&&Ud(f,Wd,m,{name:r}),Vd[t]=m,c},Yd=function(e,t){return{value:e,done:t}},Jd=te,Xd=qu,Qd=Ia;ei.f;var Zd=zd,$d=Yd,el="Array Iterator",tl=Qd.set,il=Qd.getterFor(el);Zd(Array,"Array",(function(e,t){tl(this,{type:el,target:Jd(e),index:0,kind:t})}),(function(){var e=il(this),t=e.target,i=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,$d(void 0,!0)):$d("keys"==i?n:"values"==i?t[n]:[n,t[n]],!1)}),"values"),Xd.Arguments=Xd.Array;var nl={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},rl=m,ol=fn,sl=Ei,al=qu,cl=mt("toStringTag");for(var ul in nl){var dl=rl[ul],ll=dl&&dl.prototype;ll&&ol(ll)!==cl&&sl(ll,cl,ul),al[ul]=al.Array}var hl=Hu,fl=mt,pl=ei.f,ml=fl("metadata"),_l=Function.prototype;void 0===_l[ml]&&pl(_l,ml,{value:null}),Qs("dispose"),Qs("metadata");var gl=hl;Qs("asyncDispose");var vl=h,El=de("Symbol"),bl=El.keyFor,yl=vl(El.prototype.valueOf),wl=El.isRegisteredSymbol||function(e){try{return void 0!==bl(yl(e))}catch(e){return!1}};Ni({target:"Symbol",stat:!0},{isRegisteredSymbol:wl});for(var Sl=Je,Tl=de,Rl=h,Cl=Ae,Il=mt,Al=Tl("Symbol"),Ol=Al.isWellKnownSymbol,Ml=Tl("Object","getOwnPropertyNames"),Nl=Rl(Al.prototype.valueOf),kl=Sl("wks"),Pl=0,Dl=Ml(Al),Ll=Dl.length;Pl<Ll;Pl++)try{var xl=Dl[Pl];Cl(Al[xl])&&Il(xl)}catch(e){}var Ul=function(e){if(Ol&&Ol(e))return!0;try{for(var t=Nl(e),i=0,n=Ml(kl),r=n.length;i<r;i++)if(kl[n[i]]==t)return!0}catch(e){}return!1};Ni({target:"Symbol",stat:!0,forced:!0},{isWellKnownSymbol:Ul}),Qs("matcher"),Qs("observable"),Ni({target:"Symbol",stat:!0,name:"isRegisteredSymbol"},{isRegistered:wl}),Ni({target:"Symbol",stat:!0,name:"isWellKnownSymbol",forced:!0},{isWellKnown:Ul}),Qs("metadataKey"),Qs("patternMatch"),Qs("replaceAll");var Vl=o(gl),Bl=h,jl=Li,Fl=_n,Wl=Z,Gl=Bl("".charAt),Hl=Bl("".charCodeAt),ql=Bl("".slice),Kl=function(e){return function(t,i){var n,r,o=Fl(Wl(t)),s=jl(i),a=o.length;return s<0||s>=a?e?"":void 0:(n=Hl(o,s))<55296||n>56319||s+1===a||(r=Hl(o,s+1))<56320||r>57343?e?Gl(o,s):n:e?ql(o,s,s+2):r-56320+(n-55296<<10)+65536}},zl=(Kl(!1),Kl(!0)),Yl=_n,Jl=Ia,Xl=zd,Ql=Yd,Zl="String Iterator",$l=Jl.set,eh=Jl.getterFor(Zl);Xl(String,"String",(function(e){$l(this,{type:Zl,string:Yl(e),index:0})}),(function(){var e,t=eh(this),i=t.string,n=t.index;return n>=i.length?Ql(void 0,!0):(e=zl(i,n),t.index+=e.length,Ql(e,!1))}));var th=o(Ws.f("iterator"));function ih(e){return ih="function"==typeof Vl&&"symbol"==typeof th?function(e){return typeof e}:function(e){return e&&"function"==typeof Vl&&e.constructor===Vl&&e!==Vl.prototype?"symbol":typeof e},ih(e)}var nh=o(Ws.f("toPrimitive"));function rh(e){var t=function(e,t){if("object"!==ih(e)||null===e)return e;var i=e[nh];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==ih(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===ih(t)?t:String(t)}function oh(e,t,i){return(t=rh(t))in e?Wr(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var sh=Qi("Array").keys,ah=fn,ch=tt,uh=f,dh=sh,lh=Array.prototype,hh={DOMTokenList:!0,NodeList:!0},fh=o((function(e){var t=e.keys;return e===lh||uh(lh,e)&&t===lh.keys||ch(hh,ah(e))?dh:t})),ph=Me,mh=TypeError,_h=Ns,gh=Math.floor,vh=function(e,t){var i=e.length,n=gh(i/2);return i<8?Eh(e,t):bh(e,vh(_h(e,0,n),t),vh(_h(e,n),t),t)},Eh=function(e,t){for(var i,n,r=e.length,o=1;o<r;){for(n=o,i=e[o];n&&t(e[n-1],i)>0;)e[n]=e[--n];n!==o++&&(e[n]=i)}return e},bh=function(e,t,i,n){for(var r=t.length,o=i.length,s=0,a=0;s<r||a<o;)e[s+a]=s<r&&a<o?n(t[s],i[a])<=0?t[s++]:i[a++]:s<r?t[s++]:i[a++];return e},yh=vh,wh=s,Sh=function(e,t){var i=[][e];return!!i&&wh((function(){i.call(null,t||function(){return 1},1)}))},Th=le.match(/firefox\/(\d+)/i),Rh=!!Th&&+Th[1],Ch=/MSIE|Trident/.test(le),Ih=le.match(/AppleWebKit\/(\d+)\./),Ah=!!Ih&&+Ih[1],Oh=Ni,Mh=h,Nh=De,kh=Ze,Ph=Gi,Dh=function(e,t){if(!delete e[t])throw mh("Cannot delete property "+ph(t)+" of "+ph(e))},Lh=_n,xh=s,Uh=yh,Vh=Sh,Bh=Rh,jh=Ch,Fh=ve,Wh=Ah,Gh=[],Hh=Mh(Gh.sort),qh=Mh(Gh.push),Kh=xh((function(){Gh.sort(void 0)})),zh=xh((function(){Gh.sort(null)})),Yh=Vh("sort"),Jh=!xh((function(){if(Fh)return Fh<70;if(!(Bh&&Bh>3)){if(jh)return!0;if(Wh)return Wh<603;var e,t,i,n,r="";for(e=65;e<76;e++){switch(t=String.fromCharCode(e),e){case 66:case 69:case 70:case 72:i=3;break;case 68:case 71:i=4;break;default:i=2}for(n=0;n<47;n++)Gh.push({k:t+n,v:i})}for(Gh.sort((function(e,t){return t.v-e.v})),n=0;n<Gh.length;n++)t=Gh[n].k.charAt(0),r.charAt(r.length-1)!==t&&(r+=t);return"DGBEFHACIJK"!==r}}));Oh({target:"Array",proto:!0,forced:Kh||!zh||!Yh||!Jh},{sort:function(e){void 0!==e&&Nh(e);var t=kh(this);if(Jh)return void 0===e?Hh(t):Hh(t,e);var i,n,r=[],o=Ph(t);for(n=0;n<o;n++)n in t&&qh(r,t[n]);for(Uh(r,function(e){return function(t,i){return void 0===i?-1:void 0===t?1:void 0!==e?+e(t,i)||0:Lh(t)>Lh(i)?1:-1}}(e)),i=Ph(r),n=0;n<i;)t[n]=r[n++];for(;n<o;)Dh(t,n++);return t}});var Xh=Qi("Array").sort,Qh=f,Zh=Xh,$h=Array.prototype,ef=o((function(e){var t=e.sort;return e===$h||Qh($h,e)&&t===$h.sort?Zh:t})),tf=de,nf=ws,rf=Us,of=oi,sf=h([].concat),af=tf("Reflect","ownKeys")||function(e){var t=nf.f(of(e)),i=rf.f;return i?sf(t,i(e)):t},cf=tt,uf=af,df=k,lf=ei,hf=re,ff=Ei,pf=Error,mf=h("".replace),_f=String(pf("zxcasd").stack),gf=/\n\s*at [^:]*:[^\n]*/,vf=gf.test(_f),Ef=G,bf=!s((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Ef(1,7)),7!==e.stack)})),yf=Ei,wf=function(e,t){if(vf&&"string"==typeof e&&!pf.prepareStackTrace)for(;t--;)e=mf(e,gf,"");return e},Sf=bf,Tf=Error.captureStackTrace,Rf=qu,Cf=mt("iterator"),If=Array.prototype,Af=fn,Of=Ue,Mf=J,Nf=qu,kf=mt("iterator"),Pf=function(e){if(!Mf(e))return Of(e,kf)||Of(e,"@@iterator")||Nf[Af(e)]},Df=x,Lf=De,xf=oi,Uf=Me,Vf=Pf,Bf=TypeError,jf=x,Ff=oi,Wf=Ue,Gf=$t,Hf=x,qf=oi,Kf=Me,zf=function(e){return void 0!==e&&(Rf.Array===e||If[Cf]===e)},Yf=Gi,Jf=f,Xf=function(e,t){var i=arguments.length<2?Vf(e):t;if(Lf(i))return xf(Df(i,e));throw Bf(Uf(e)+" is not iterable")},Qf=Pf,Zf=function(e,t,i){var n,r;Ff(e);try{if(!(n=Wf(e,"return"))){if("throw"===t)throw i;return i}n=jf(n,e)}catch(e){r=!0,n=e}if("throw"===t)throw i;if(r)throw n;return Ff(n),i},$f=TypeError,ep=function(e,t){this.stopped=e,this.result=t},tp=ep.prototype,ip=function(e,t,i){var n,r,o,s,a,c,u,d=i&&i.that,l=!(!i||!i.AS_ENTRIES),h=!(!i||!i.IS_RECORD),f=!(!i||!i.IS_ITERATOR),p=!(!i||!i.INTERRUPTED),m=Gf(t,d),_=function(e){return n&&Zf(n,"normal",e),new ep(!0,e)},g=function(e){return l?(qf(e),p?m(e[0],e[1],_):m(e[0],e[1])):p?m(e,_):m(e)};if(h)n=e.iterator;else if(f)n=e;else{if(!(r=Qf(e)))throw $f(Kf(e)+" is not iterable");if(zf(r)){for(o=0,s=Yf(e);s>o;o++)if((a=g(e[o]))&&Jf(tp,a))return a;return new ep(!1)}n=Xf(e,r)}for(c=h?e.next:n.next;!(u=Hf(c,n)).done;){try{a=g(u.value)}catch(e){Zf(n,"throw",e)}if("object"==typeof a&&a&&Jf(tp,a))return a}return new ep(!1)},np=_n,rp=Ni,op=f,sp=sd,ap=Nd,cp=function(e,t,i){for(var n=uf(t),r=lf.f,o=df.f,s=0;s<n.length;s++){var a=n[s];cf(e,a)||i&&cf(i,a)||r(e,a,o(t,a))}},up=ys,dp=Ei,lp=G,hp=function(e,t){hf(t)&&"cause"in t&&ff(e,"cause",t.cause)},fp=function(e,t,i,n){Sf&&(Tf?Tf(e,t):yf(e,"stack",wf(i,n)))},pp=ip,mp=function(e,t){return void 0===e?arguments.length<2?"":t:np(e)},_p=mt("toStringTag"),gp=Error,vp=[].push,Ep=function(e,t){var i,n=op(bp,this);ap?i=ap(gp(),n?sp(this):bp):(i=n?this:up(bp),dp(i,_p,"Error")),void 0!==t&&dp(i,"message",mp(t)),fp(i,Ep,i.stack,1),arguments.length>2&&hp(i,arguments[2]);var r=[];return pp(e,vp,{that:r}),dp(i,"errors",r),i};ap?ap(Ep,gp):cp(Ep,gp,{name:!0});var bp=Ep.prototype=up(gp.prototype,{constructor:lp(1,Ep),message:lp(1,""),name:lp(1,"AggregateError")});rp({global:!0,constructor:!0,arity:2},{AggregateError:Ep});var yp,wp,Sp,Tp,Rp="undefined"!=typeof i&&"process"==T(i),Cp=de,Ip=Fs,Ap=P,Op=mt("species"),Mp=f,Np=TypeError,kp=po,Pp=Me,Dp=TypeError,Lp=oi,xp=function(e){if(kp(e))return e;throw Dp(Pp(e)+" is not a constructor")},Up=J,Vp=mt("species"),Bp=function(e,t){var i,n=Lp(e).constructor;return void 0===n||Up(i=Lp(n)[Vp])?t:xp(i)},jp=TypeError,Fp=/(?:ipad|iphone|ipod).*applewebkit/i.test(le),Wp=m,Gp=b,Hp=$t,qp=N,Kp=tt,zp=s,Yp=rs,Jp=ou,Xp=Ot,Qp=function(e,t){if(e<t)throw jp("Not enough arguments");return e},Zp=Fp,$p=Rp,em=Wp.setImmediate,tm=Wp.clearImmediate,im=Wp.process,nm=Wp.Dispatch,rm=Wp.Function,om=Wp.MessageChannel,sm=Wp.String,am=0,cm={},um="onreadystatechange";zp((function(){yp=Wp.location}));var dm=function(e){if(Kp(cm,e)){var t=cm[e];delete cm[e],t()}},lm=function(e){return function(){dm(e)}},hm=function(e){dm(e.data)},fm=function(e){Wp.postMessage(sm(e),yp.protocol+"//"+yp.host)};em&&tm||(em=function(e){Qp(arguments.length,1);var t=qp(e)?e:rm(e),i=Jp(arguments,1);return cm[++am]=function(){Gp(t,void 0,i)},wp(am),am},tm=function(e){delete cm[e]},$p?wp=function(e){im.nextTick(lm(e))}:nm&&nm.now?wp=function(e){nm.now(lm(e))}:om&&!Zp?(Tp=(Sp=new om).port2,Sp.port1.onmessage=hm,wp=Hp(Tp.postMessage,Tp)):Wp.addEventListener&&qp(Wp.postMessage)&&!Wp.importScripts&&yp&&"file:"!==yp.protocol&&!zp(fm)?(wp=fm,Wp.addEventListener("message",hm,!1)):wp=um in Xp("script")?function(e){Yp.appendChild(Xp("script"))[um]=function(){Yp.removeChild(this),dm(e)}}:function(e){setTimeout(lm(e),0)});var pm={set:em,clear:tm},mm=function(){this.head=null,this.tail=null};mm.prototype={add:function(e){var t={item:e,next:null},i=this.tail;i?i.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return null===(this.head=e.next)&&(this.tail=null),e.item}};var _m,gm,vm,Em,bm,ym=mm,wm=/ipad|iphone|ipod/i.test(le)&&"undefined"!=typeof Pebble,Sm=/web0s(?!.*chrome)/i.test(le),Tm=m,Rm=$t,Cm=k.f,Im=pm.set,Am=ym,Om=Fp,Mm=wm,Nm=Sm,km=Rp,Pm=Tm.MutationObserver||Tm.WebKitMutationObserver,Dm=Tm.document,Lm=Tm.process,xm=Tm.Promise,Um=Cm(Tm,"queueMicrotask"),Vm=Um&&Um.value;if(!Vm){var Bm=new Am,jm=function(){var e,t;for(km&&(e=Lm.domain)&&e.exit();t=Bm.get();)try{t()}catch(e){throw Bm.head&&_m(),e}e&&e.enter()};Om||km||Nm||!Pm||!Dm?!Mm&&xm&&xm.resolve?((Em=xm.resolve(void 0)).constructor=xm,bm=Rm(Em.then,Em),_m=function(){bm(jm)}):km?_m=function(){Lm.nextTick(jm)}:(Im=Rm(Im,Tm),_m=function(){Im(jm)}):(gm=!0,vm=Dm.createTextNode(""),new Pm(jm).observe(vm,{characterData:!0}),_m=function(){vm.data=gm=!gm}),Vm=function(e){Bm.head||_m(),Bm.add(e)}}var Fm=Vm,Wm=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Gm=m.Promise,Hm="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,qm=!Hm&&!Rp&&"object"==typeof window&&"object"==typeof document,Km=m,zm=Gm,Ym=N,Jm=Jt,Xm=$r,Qm=mt,Zm=qm,$m=Hm,e_=ve,t_=zm&&zm.prototype,i_=Qm("species"),n_=!1,r_=Ym(Km.PromiseRejectionEvent),o_=Jm("Promise",(function(){var e=Xm(zm),t=e!==String(zm);if(!t&&66===e_)return!0;if(!t_.catch||!t_.finally)return!0;if(!e_||e_<51||!/native code/.test(e)){var i=new zm((function(e){e(1)})),n=function(e){e((function(){}),(function(){}))};if((i.constructor={})[i_]=n,!(n_=i.then((function(){}))instanceof n))return!0}return!t&&(Zm||$m)&&!r_})),s_={CONSTRUCTOR:o_,REJECTION_EVENT:r_,SUBCLASSING:n_},a_={},c_=De,u_=TypeError,d_=function(e){var t,i;this.promise=new e((function(e,n){if(void 0!==t||void 0!==i)throw u_("Bad Promise constructor");t=e,i=n})),this.resolve=c_(t),this.reject=c_(i)};a_.f=function(e){return new d_(e)};var l_,h_,f_=Ni,p_=Rp,m_=m,__=x,g_=Bs,v_=la,E_=function(e){var t=Cp(e);Ap&&t&&!t[Op]&&Ip(t,Op,{configurable:!0,get:function(){return this}})},b_=De,y_=N,w_=re,S_=function(e,t){if(Mp(t,e))return e;throw Np("Incorrect invocation")},T_=Bp,R_=pm.set,C_=Fm,I_=function(e,t){try{1==arguments.length?console.error(e):console.error(e,t)}catch(e){}},A_=Wm,O_=ym,M_=Ia,N_=Gm,k_=s_,P_=a_,D_="Promise",L_=k_.CONSTRUCTOR,x_=k_.REJECTION_EVENT,U_=M_.getterFor(D_),V_=M_.set,B_=N_&&N_.prototype,j_=N_,F_=B_,W_=m_.TypeError,G_=m_.document,H_=m_.process,q_=P_.f,K_=q_,z_=!!(G_&&G_.createEvent&&m_.dispatchEvent),Y_="unhandledrejection",J_=function(e){var t;return!(!w_(e)||!y_(t=e.then))&&t},X_=function(e,t){var i,n,r,o=t.value,s=1==t.state,a=s?e.ok:e.fail,c=e.resolve,u=e.reject,d=e.domain;try{a?(s||(2===t.rejection&&tg(t),t.rejection=1),!0===a?i=o:(d&&d.enter(),i=a(o),d&&(d.exit(),r=!0)),i===e.promise?u(W_("Promise-chain cycle")):(n=J_(i))?__(n,i,c,u):c(i)):u(o)}catch(e){d&&!r&&d.exit(),u(e)}},Q_=function(e,t){e.notified||(e.notified=!0,C_((function(){for(var i,n=e.reactions;i=n.get();)X_(i,e);e.notified=!1,t&&!e.rejection&&$_(e)})))},Z_=function(e,t,i){var n,r;z_?((n=G_.createEvent("Event")).promise=t,n.reason=i,n.initEvent(e,!1,!0),m_.dispatchEvent(n)):n={promise:t,reason:i},!x_&&(r=m_["on"+e])?r(n):e===Y_&&I_("Unhandled promise rejection",i)},$_=function(e){__(R_,m_,(function(){var t,i=e.facade,n=e.value;if(eg(e)&&(t=A_((function(){p_?H_.emit("unhandledRejection",n,i):Z_(Y_,i,n)})),e.rejection=p_||eg(e)?2:1,t.error))throw t.value}))},eg=function(e){return 1!==e.rejection&&!e.parent},tg=function(e){__(R_,m_,(function(){var t=e.facade;p_?H_.emit("rejectionHandled",t):Z_("rejectionhandled",t,e.value)}))},ig=function(e,t,i){return function(n){e(t,n,i)}},ng=function(e,t,i){e.done||(e.done=!0,i&&(e=i),e.value=t,e.state=2,Q_(e,!0))},rg=function(e,t,i){if(!e.done){e.done=!0,i&&(e=i);try{if(e.facade===t)throw W_("Promise can't be resolved itself");var n=J_(t);n?C_((function(){var i={done:!1};try{__(n,t,ig(rg,i,e),ig(ng,i,e))}catch(t){ng(i,t,e)}})):(e.value=t,e.state=1,Q_(e,!1))}catch(t){ng({done:!1},t,e)}}};L_&&(F_=(j_=function(e){S_(this,F_),b_(e),__(l_,this);var t=U_(this);try{e(ig(rg,t),ig(ng,t))}catch(e){ng(t,e)}}).prototype,(l_=function(e){V_(this,{type:D_,done:!1,notified:!1,parent:!1,reactions:new O_,rejection:!1,state:0,value:void 0})}).prototype=g_(F_,"then",(function(e,t){var i=U_(this),n=q_(T_(this,j_));return i.parent=!0,n.ok=!y_(e)||e,n.fail=y_(t)&&t,n.domain=p_?H_.domain:void 0,0==i.state?i.reactions.add(n):C_((function(){X_(n,i)})),n.promise})),h_=function(){var e=new l_,t=U_(e);this.promise=e,this.resolve=ig(rg,t),this.reject=ig(ng,t)},P_.f=q_=function(e){return e===j_||void 0===e?new h_(e):K_(e)}),f_({global:!0,constructor:!0,wrap:!0,forced:L_},{Promise:j_}),v_(j_,D_,!1,!0),E_(D_);var og=mt("iterator"),sg=!1;try{var ag=0,cg={next:function(){return{done:!!ag++}},return:function(){sg=!0}};cg[og]=function(){return this},Array.from(cg,(function(){throw 2}))}catch(e){}var ug=Gm,dg=function(e,t){if(!t&&!sg)return!1;var i=!1;try{var n={};n[og]=function(){return{next:function(){return{done:i=!0}}}},e(n)}catch(e){}return i},lg=s_.CONSTRUCTOR||!dg((function(e){ug.all(e).then(void 0,(function(){}))})),hg=x,fg=De,pg=a_,mg=Wm,_g=ip;Ni({target:"Promise",stat:!0,forced:lg},{all:function(e){var t=this,i=pg.f(t),n=i.resolve,r=i.reject,o=mg((function(){var i=fg(t.resolve),o=[],s=0,a=1;_g(e,(function(e){var c=s++,u=!1;a++,hg(i,t,e).then((function(e){u||(u=!0,o[c]=e,--a||n(o))}),r)})),--a||n(o)}));return o.error&&r(o.value),i.promise}});var gg=Ni,vg=s_.CONSTRUCTOR;Gm&&Gm.prototype,gg({target:"Promise",proto:!0,forced:vg,real:!0},{catch:function(e){return this.then(void 0,e)}});var Eg=x,bg=De,yg=a_,wg=Wm,Sg=ip;Ni({target:"Promise",stat:!0,forced:lg},{race:function(e){var t=this,i=yg.f(t),n=i.reject,r=wg((function(){var r=bg(t.resolve);Sg(e,(function(e){Eg(r,t,e).then(i.resolve,n)}))}));return r.error&&n(r.value),i.promise}});var Tg=x,Rg=a_;Ni({target:"Promise",stat:!0,forced:s_.CONSTRUCTOR},{reject:function(e){var t=Rg.f(this);return Tg(t.reject,void 0,e),t.promise}});var Cg=oi,Ig=re,Ag=a_,Og=function(e,t){if(Cg(e),Ig(t)&&t.constructor===e)return t;var i=Ag.f(e);return(0,i.resolve)(t),i.promise},Mg=Ni,Ng=Gm,kg=s_.CONSTRUCTOR,Pg=Og,Dg=de("Promise"),Lg=!kg;Mg({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return Pg(Lg&&this===Dg?Ng:this,e)}});var xg=x,Ug=De,Vg=a_,Bg=Wm,jg=ip;Ni({target:"Promise",stat:!0,forced:lg},{allSettled:function(e){var t=this,i=Vg.f(t),n=i.resolve,r=i.reject,o=Bg((function(){var i=Ug(t.resolve),r=[],o=0,s=1;jg(e,(function(e){var a=o++,c=!1;s++,xg(i,t,e).then((function(e){c||(c=!0,r[a]={status:"fulfilled",value:e},--s||n(r))}),(function(e){c||(c=!0,r[a]={status:"rejected",reason:e},--s||n(r))}))})),--s||n(r)}));return o.error&&r(o.value),i.promise}});var Fg=x,Wg=De,Gg=de,Hg=a_,qg=Wm,Kg=ip,zg="No one promise resolved";Ni({target:"Promise",stat:!0,forced:lg},{any:function(e){var t=this,i=Gg("AggregateError"),n=Hg.f(t),r=n.resolve,o=n.reject,s=qg((function(){var n=Wg(t.resolve),s=[],a=0,c=1,u=!1;Kg(e,(function(e){var d=a++,l=!1;c++,Fg(n,t,e).then((function(e){l||u||(u=!0,r(e))}),(function(e){l||u||(l=!0,s[d]=e,--c||o(new i(s,zg)))}))})),--c||o(new i(s,zg))}));return s.error&&o(s.value),n.promise}});var Yg=Ni,Jg=Gm,Xg=s,Qg=de,Zg=N,$g=Bp,ev=Og,tv=Jg&&Jg.prototype;Yg({target:"Promise",proto:!0,real:!0,forced:!!Jg&&Xg((function(){tv.finally.call({then:function(){}},(function(){}))}))},{finally:function(e){var t=$g(this,Qg("Promise")),i=Zg(e);return this.then(i?function(i){return ev(t,e()).then((function(){return i}))}:e,i?function(i){return ev(t,e()).then((function(){throw i}))}:e)}});var iv=oe.Promise,nv=o(iv);const rv=()=>{};function ov(){const e={promise:void 0,isResolved:!1,isRejected:!1,isFinished:!1,resolve:void 0,reject:void 0,cancel:rv};return e.promise=new nv(((t,i)=>{e.resolve=i=>{e.isFinished||(e.isResolved=!0,e.isFinished=!0,t(i),e.value=i)},e.reject=t=>{e.isFinished||(e.isRejected=!0,e.isFinished=!0,i(t))}})),e}const sv=new Map,av=new Map,cv=new Map;var uv,dv;!function(e){e.WIN_10="Windows 10",e.WIN_81="Windows 8.1",e.WIN_8="Windows 8",e.WIN_7="Windows 7",e.WIN_VISTA="Windows Vista",e.WIN_SERVER_2003="Windows Server 2003",e.WIN_XP="Windows XP",e.WIN_2000="Windows 2000",e.ANDROID="Android",e.HARMONY_OS="HarmonyOS",e.OPEN_BSD="Open BSD",e.SUN_OS="Sun OS",e.LINUX="Linux",e.IOS="iOS",e.MAC_OS="Mac OS",e.CHROMIUM_OS="Chromium OS",e.QNX="QNX",e.UNIX="UNIX",e.BEOS="BeOS",e.OS_2="OS/2",e.SEARCH_BOT="Search Bot"}(uv||(uv={})),function(e){e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger"}(dv||(dv={}));var lv={exports:{}};!function(e,t){!function(i,n){var r="function",o="undefined",s="object",a="string",c="major",u="model",d="name",l="type",h="vendor",f="version",p="architecture",m="console",_="mobile",g="tablet",v="smarttv",E="wearable",b="embedded",y="Amazon",w="Apple",S="ASUS",T="BlackBerry",R="Browser",C="Chrome",I="Firefox",A="Google",O="Huawei",M="LG",N="Microsoft",k="Motorola",P="Opera",D="Samsung",L="Sharp",x="Sony",U="Xiaomi",V="Zebra",B="Facebook",j="Chromium OS",F="Mac OS",W=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},G=function(e,t){return typeof e===a&&-1!==H(t).indexOf(H(e))},H=function(e){return e.toLowerCase()},q=function(e,t){if(typeof e===a)return e=e.replace(/^\s\s*/,""),typeof t===o?e:e.substring(0,350)},K=function(e,t){for(var i,o,a,c,u,d,l=0;l<t.length&&!u;){var h=t[l],f=t[l+1];for(i=o=0;i<h.length&&!u&&h[i];)if(u=h[i++].exec(e))for(a=0;a<f.length;a++)d=u[++o],typeof(c=f[a])===s&&c.length>0?2===c.length?typeof c[1]==r?this[c[0]]=c[1].call(this,d):this[c[0]]=c[1]:3===c.length?typeof c[1]!==r||c[1].exec&&c[1].test?this[c[0]]=d?d.replace(c[1],c[2]):n:this[c[0]]=d?c[1].call(this,d,c[2]):n:4===c.length&&(this[c[0]]=d?c[3].call(this,d.replace(c[1],c[2])):n):this[c]=d||n;l+=2}},z=function(e,t){for(var i in t)if(typeof t[i]===s&&t[i].length>0){for(var r=0;r<t[i].length;r++)if(G(t[i][r],e))return"?"===i?n:i}else if(G(t[i],e))return"?"===i?n:i;return e},Y={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},J={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[d,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[d,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[d,f],[/opios[\/ ]+([\w\.]+)/i],[f,[d,P+" Mini"]],[/\bopr\/([\w\.]+)/i],[f,[d,P]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[d,f],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[f,[d,"UC"+R]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[f,[d,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[f,[d,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[d,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[f,[d,"IE"]],[/yabrowser\/([\w\.]+)/i],[f,[d,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[d,/(.+)/,"$1 Secure "+R],f],[/\bfocus\/([\w\.]+)/i],[f,[d,I+" Focus"]],[/\bopt\/([\w\.]+)/i],[f,[d,P+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[f,[d,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[d,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[d,P+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[f,[d,"MIUI "+R]],[/fxios\/([-\w\.]+)/i],[f,[d,I]],[/\bqihu|(qi?ho?o?|360)browser/i],[[d,"360 "+R]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[d,/(.+)/,"$1 "+R],f],[/(comodo_dragon)\/([\w\.]+)/i],[[d,/_/g," "],f],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[d,f],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[d],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[d,B],f],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[d,f],[/\bgsa\/([\w\.]+) .*safari\//i],[f,[d,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[f,[d,C+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[d,C+" WebView"],f],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[f,[d,"Android "+R]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[d,f],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[f,[d,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[f,d],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[d,[f,z,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[d,f],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[d,"Netscape"],f],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[f,[d,I+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[d,f],[/(cobalt)\/([\w\.]+)/i],[d,[f,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,H]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",H]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,H]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[u,[h,D],[l,g]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[u,[h,D],[l,_]],[/\((ip(?:hone|od)[\w ]*);/i],[u,[h,w],[l,_]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[u,[h,w],[l,g]],[/(macintosh);/i],[u,[h,w]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[u,[h,L],[l,_]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[u,[h,O],[l,g]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[u,[h,O],[l,_]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[u,/_/g," "],[h,U],[l,_]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[u,/_/g," "],[h,U],[l,g]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[u,[h,"OPPO"],[l,_]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[u,[h,"Vivo"],[l,_]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[u,[h,"Realme"],[l,_]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[u,[h,k],[l,_]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[u,[h,k],[l,g]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[u,[h,M],[l,g]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[u,[h,M],[l,_]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[u,[h,"Lenovo"],[l,g]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[u,/_/g," "],[h,"Nokia"],[l,_]],[/(pixel c)\b/i],[u,[h,A],[l,g]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[u,[h,A],[l,_]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[u,[h,x],[l,_]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[u,"Xperia Tablet"],[h,x],[l,g]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[u,[h,"OnePlus"],[l,_]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[u,[h,y],[l,g]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[u,/(.+)/g,"Fire Phone $1"],[h,y],[l,_]],[/(playbook);[-\w\),; ]+(rim)/i],[u,h,[l,g]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[u,[h,T],[l,_]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[u,[h,S],[l,g]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[u,[h,S],[l,_]],[/(nexus 9)/i],[u,[h,"HTC"],[l,g]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[h,[u,/_/g," "],[l,_]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[u,[h,"Acer"],[l,g]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[u,[h,"Meizu"],[l,_]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[h,u,[l,_]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,u,[l,g]],[/(surface duo)/i],[u,[h,N],[l,g]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[u,[h,"Fairphone"],[l,_]],[/(u304aa)/i],[u,[h,"AT&T"],[l,_]],[/\bsie-(\w*)/i],[u,[h,"Siemens"],[l,_]],[/\b(rct\w+) b/i],[u,[h,"RCA"],[l,g]],[/\b(venue[\d ]{2,7}) b/i],[u,[h,"Dell"],[l,g]],[/\b(q(?:mv|ta)\w+) b/i],[u,[h,"Verizon"],[l,g]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[u,[h,"Barnes & Noble"],[l,g]],[/\b(tm\d{3}\w+) b/i],[u,[h,"NuVision"],[l,g]],[/\b(k88) b/i],[u,[h,"ZTE"],[l,g]],[/\b(nx\d{3}j) b/i],[u,[h,"ZTE"],[l,_]],[/\b(gen\d{3}) b.+49h/i],[u,[h,"Swiss"],[l,_]],[/\b(zur\d{3}) b/i],[u,[h,"Swiss"],[l,g]],[/\b((zeki)?tb.*\b) b/i],[u,[h,"Zeki"],[l,g]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],u,[l,g]],[/\b(ns-?\w{0,9}) b/i],[u,[h,"Insignia"],[l,g]],[/\b((nxa|next)-?\w{0,9}) b/i],[u,[h,"NextBook"],[l,g]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],u,[l,_]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],u,[l,_]],[/\b(ph-1) /i],[u,[h,"Essential"],[l,_]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[u,[h,"Envizen"],[l,g]],[/\b(trio[-\w\. ]+) b/i],[u,[h,"MachSpeed"],[l,g]],[/\btu_(1491) b/i],[u,[h,"Rotor"],[l,g]],[/(shield[\w ]+) b/i],[u,[h,"Nvidia"],[l,g]],[/(sprint) (\w+)/i],[h,u,[l,_]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[h,N],[l,_]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[u,[h,V],[l,g]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[u,[h,V],[l,_]],[/smart-tv.+(samsung)/i],[h,[l,v]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[h,D],[l,v]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,M],[l,v]],[/(apple) ?tv/i],[h,[u,w+" TV"],[l,v]],[/crkey/i],[[u,C+"cast"],[h,A],[l,v]],[/droid.+aft(\w)( bui|\))/i],[u,[h,y],[l,v]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[u,[h,L],[l,v]],[/(bravia[\w ]+)( bui|\))/i],[u,[h,x],[l,v]],[/(mitv-\w{5}) bui/i],[u,[h,U],[l,v]],[/Hbbtv.*(technisat) (.*);/i],[h,u,[l,v]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[h,q],[u,q],[l,v]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[l,v]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,u,[l,m]],[/droid.+; (shield) bui/i],[u,[h,"Nvidia"],[l,m]],[/(playstation [345portablevi]+)/i],[u,[h,x],[l,m]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[u,[h,N],[l,m]],[/((pebble))app/i],[h,u,[l,E]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[u,[h,w],[l,E]],[/droid.+; (glass) \d/i],[u,[h,A],[l,E]],[/droid.+; (wt63?0{2,3})\)/i],[u,[h,V],[l,E]],[/(quest( 2| pro)?)/i],[u,[h,B],[l,E]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[l,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[u,[l,_]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[u,[l,g]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,g]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[l,_]],[/(android[-\w\. ]{0,9});.+buil/i],[u,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[f,[d,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[d,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[d,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,d]],os:[[/microsoft (windows) (vista|xp)/i],[d,f],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[d,[f,z,Y]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[d,"Windows"],[f,z,Y]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[d,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[d,F],[f,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[f,d],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[d,f],[/\(bb(10);/i],[f,[d,T]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[f,[d,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[f,[d,I+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[d,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[f,[d,"watchOS"]],[/crkey\/([\d\.]+)/i],[f,[d,C+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[d,j],f],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[d,f],[/(sunos) ?([\w\.\d]*)/i],[[d,"Solaris"],f],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[d,f]]},X=function(e,t){if(typeof e===s&&(t=e,e=n),!(this instanceof X))return new X(e,t).getResult();var m=typeof i!==o&&i.navigator?i.navigator:n,v=e||(m&&m.userAgent?m.userAgent:""),E=m&&m.userAgentData?m.userAgentData:n,b=t?function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2==0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i}(J,t):J;return this.getBrowser=function(){var e={};return e[d]=n,e[f]=n,K.call(e,v,b.browser),e[c]=function(e){return typeof e===a?e.replace(/[^\d\.]/g,"").split(".")[0]:n}(e[f]),m&&m.brave&&typeof m.brave.isBrave==r&&(e[d]="Brave"),e},this.getCPU=function(){var e={};return e[p]=n,K.call(e,v,b.cpu),e},this.getDevice=function(){var e={};return e[h]=n,e[u]=n,e[l]=n,K.call(e,v,b.device),!e[l]&&E&&E.mobile&&(e[l]=_),"Macintosh"==e[u]&&m&&typeof m.standalone!==o&&m.maxTouchPoints&&m.maxTouchPoints>2&&(e[u]="iPad",e[l]=g),e},this.getEngine=function(){var e={};return e[d]=n,e[f]=n,K.call(e,v,b.engine),e},this.getOS=function(){var e={};return e[d]=n,e[f]=n,K.call(e,v,b.os),!e[d]&&E&&"Unknown"!=E.platform&&(e[d]=E.platform.replace(/chrome os/i,j).replace(/macos/i,F)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return v},this.setUA=function(e){return v=typeof e===a&&e.length>350?q(e,350):e,this},this.setUA(v),this};X.VERSION="0.7.34",X.BROWSER=W([d,f,c]),X.CPU=W([p]),X.DEVICE=W([u,h,l,m,_,v,g,E,b]),X.ENGINE=X.OS=W([d,f]),e.exports&&(t=e.exports=X),t.UAParser=X;var Q=typeof i!==o&&(i.jQuery||i.Zepto);if(Q&&!Q.ua){var Z=new X;Q.ua=Z.getResult(),Q.ua.get=function(){return Z.getUA()},Q.ua.set=function(e){Z.setUA(e);var t=Z.getResult();for(var i in t)Q.ua[i]=t[i]}}}("object"==typeof window?window:r)}(lv,lv.exports);const hv=new(o(lv.exports));let fv=hv.getResult(),pv=null;function mv(e){if(!pv){e&&hv.setUA(e),fv=hv.getResult();const t=function(e){if("Blink"===e.engine.name&&"WeChat"!==e.browser.name)return dv.CHROME;switch(e.browser.name){case"Chrome Headless":case"Chrome":case"Chromium":return dv.CHROME;case"Safari":case"Mobile Safari":return dv.SAFARI;case"Edge":return dv.EDGE;case"Firefox":return dv.FIREFOX;case"QQBrowser":return dv.QQ;case"Opera":return dv.OPERA;case"WeChat":return dv.WECHAT;default:return e.browser.name||""}}(fv),i=function(e){let t;return t="Blink"===e.engine.name?e.engine.version||"":e.browser.version||"",t.split(".")[0]}(fv),n=function(e){return"Windows"===e.os.name?e.os.version?e.os.name+" "+e.os.version:e.os.name:e.os.name||""}(fv),r=fv.os.version;if(!(t&&i&&n&&r))return{name:t,version:i,os:n,osVersion:r};pv={name:t,version:i,os:n,osVersion:r}}return pv}function _v(){return mv().os}function gv(){const e=mv();return"".concat(e.os," ").concat(e.osVersion)}function vv(){const e=mv();return!!("WebKit"===fv.engine.name&&e.os===uv.MAC_OS&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0&&e.name!==dv.SAFARI||Tv()&&e.name!==dv.SAFARI)}function Ev(){const e=mv();if(vv()){if(e.os===uv.MAC_OS)return!0;if(e.os===uv.IOS){const e=fv.os.version&&fv.os.version.split(".");if(e&&14===Number(e[0])&&e[1]&&Number(e[1])>=3)return!0;if(e&&Number(e[0])>14)return!0}}return!1}function bv(){return"WebKit"===fv.engine.name}function yv(){return mv().name===dv.CHROME}function wv(){return mv().name===dv.SAFARI}function Sv(){return mv().name===dv.FIREFOX}function Tv(){return mv().os===uv.IOS}function Rv(e){const t=mv();return!(t.name!==dv.CHROME||!t.osVersion)&&Number(t.version)>=e}function Cv(e){const t=mv();return!(t.name!==dv.EDGE||!t.osVersion)&&Number(t.version)>=e}function Iv(e){const t=mv();return!(t.name!==dv.OPERA||!t.osVersion)&&Number(t.version)>=e}function Av(){const e=mv();return!(e.name!==dv.CHROME||!e.osVersion)&&Number(e.version)<=90}function Ov(){const e=mv();if(e.os!==uv.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return Number(t[0])<14||14===Number(t[0])&&Number(t[1])<=6}function Mv(){const e=mv();if(e.os!==uv.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])}function Nv(){const e=mv();if(e.os!==uv.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 16===Number(t[0])}function kv(){const e=mv();if(e.os!==uv.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=1}function Pv(){return wv()&&navigator.maxTouchPoints>0}function Dv(){return mv().name===dv.WECHAT}function Lv(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]<=35}function xv(){const e=mv();return e.name!==dv.EDGE&&e.name!==dv.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function Uv(){return _v()===uv.ANDROID}function Vv(){const e=mv();return Uv()&&(e.name===dv.CHROME||e.name===dv.WECHAT||/chrome|chromium/i.test(navigator.userAgent))}var Bv;!function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.EXCHANGE_SDP_FAILED="EXCHANGE_SDP_FAILED",e.ADD_CANDIDATE_FAILED="ADD_CANDIDATE_FAILED",e.DATACHANNEL_FAILED="DATACHANNEL_FAILED",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.GET_VIDEO_ELEMENT_VISIBLE_ERROR="GET_VIDEO_ELEMENT_VISIBLE_ERROR",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.TRACK_STATE_UNREACHABLE="TRACK_STATE_UNREACHABLE",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.MULTI_UNILBS_RESPONSE_ERROR="MULTI_UNILBS_RESPONSE_ERROR",e.UPDATE_TICKET_FAILED="UPDATE_TICKET_FAILED",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GET_LOCAL_CAPABILITIES_FAILED="GET_LOCAL_CAPABILITIES_FAILED",e.GET_LOCAL_CONNECTION_PARAMS_FAILED="GET_LOCAL_CONNECTION_PARAMS_FAILED",e.SUBSCRIBE_FAILED="SUBSCRIBE_FAILED",e.UNSUBSCRIBE_FAILED="UNSUBSCRIBE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.EXTERNAL_SIGNAL_ABORT="EXTERNAL_SIGNAL_ABORT",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR",e.INVALID_PLUGIN="INVALID_PLUGIN",e.DISCONNECT_P2P="DISCONNECT_P2P",e.INIT_WEBSOCKET_TIMEOUT="INIT_WEBSOCKET_TIMEOUT",e.CONVERTING_IMAGEDATA_TO_BLOB_FAILED="CONVERTING_IMAGEDATA_TO_BLOB_FAILED",e.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED="CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED",e.INIT_DATACHANNEL_TIMEOUT="INIT_DATACHANNEL_TIMEOUT",e.DATACHANNEL_CONNECTION_TIMEOUT="DATACHANNEL_CONNECTION_TIMEOUT",e.PROHIBITED_OPERATION="PROHIBITED_OPERATION",e.IMAGE_MODERATION_UPLOAD_FAILED="IMAGE_MODERATION_UPLOAD_FAILED",e.P2P_MESSAGE_FAILED="P2P_MESSAGE_FAILED"}(Bv||(Bv={}));let jv=class extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;super(t),oh(this,"code",void 0),oh(this,"message",void 0),oh(this,"data",void 0),oh(this,"name","AgoraRTCException"),this.code=e,this.message="AgoraRTCError ".concat(this.code,": ").concat(t),this.data=i}toString(){return this.data?"data: ".concat(JSON.stringify(this.data),"\n").concat(this.stack):"".concat(this.stack)}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error",t=arguments.length>1?arguments[1]:void 0;return"error"===e&&(t||console).error(this.toString()),"warning"===e&&(t||console).warn(this.toString()),this}throw(e){throw this.print("error",e),this}};function Fv(e,t){if("boolean"!=typeof e)throw new jv(Bv.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function Wv(e,t,i){if(!Mn(i).call(i,e))throw new jv(Bv.INVALID_PARAMS,"".concat(t," can only be set as ").concat(JSON.stringify(i)))}function Gv(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;if(e<i||e>n||(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&!function(e){return"number"==typeof e&&e%1==0}(e))throw new jv(Bv.INVALID_PARAMS,"invalid ".concat(t,": the value range is [").concat(i,", ").concat(n,"]. integer only"))}function Hv(e,t){if("number"!=typeof e){if(!(e.min||e.max||e.ideal||e.exact))throw new jv(Bv.INVALID_PARAMS,"".concat(t," is not a valid ConstrainLong"));void 0!==e.min&&Gv(e.min,"".concat(t,".min"),0,1/0),void 0!==e.max&&Gv(e.max,"".concat(t,".max"),1,1/0),void 0!==e.exact&&Gv(e.exact,"".concat(t,".exact"),1,1/0),void 0!==e.ideal&&Gv(e.ideal,"".concat(t,".ideal"),1,1/0)}else Gv(e,t,1,1/0)}function qv(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null==e)throw new jv(Bv.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!Yv(e,i,n,r))throw new jv(Bv.INVALID_PARAMS,"Invalid ".concat(t||"string param",": Length of the string: [").concat(i,",").concat(n,"].").concat(r?" ASCII characters only.":""))}function Kv(e,t){if(!Array.isArray(e))throw new jv(Bv.INVALID_PARAMS,"".concat(t," should be an array"))}function zv(e){return null==e}function Yv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return"string"==typeof e&&e.length<=i&&e.length>=t&&(!n||function(e){if("string"!=typeof e)return!1;for(let t=0;t<e.length;t+=1){const i=e.charCodeAt(t);if(i<0||i>255)return!1}return!0}(e))}function Jv(e,t,i){if("getBigUint64"in DataView.prototype)return e.getBigUint64(t,i);const n=e.getUint32(t,i),r=e.getUint32(t+4,i),o=Number(!!i),s=Number(!i);return BigInt(n*s+r*o)<<BigInt(32)|BigInt(n*o+r*s)}function Xv(e,t,i,n){if("setBigUint64"in DataView.prototype)return e.setBigUint64(t,i,n);const r=Number(i>>BigInt(32)),o=Number(i&BigInt(4294967295));n?(e.setUint32(t+4,r,n),e.setUint32(t,o,n)):(e.setUint32(t,r,n),e.setUint32(t+4,o,n))}var Qv,Zv;!function(e){e.COVERED="COVERED",e.POSITION="POSITION",e.SIZE="SIZE",e.STYLE="STYLE"}(Qv||(Qv={})),function(e){e.UNMOUNTED="UNMOUNTED",e.INVALID_HTML_ELEMENT="INVALID_HTML_ELEMENT"}(Zv||(Zv={}));const $v=new class{constructor(){oh(this,"_clientSize",null),oh(this,"getClientWidth",(()=>document.documentElement?document.documentElement.clientWidth:document.body.clientWidth)),oh(this,"getClientHeight",(()=>document.documentElement?document.documentElement.clientHeight:document.body.clientHeight)),oh(this,"getStyle",(e=>window.getComputedStyle(e,null))),oh(this,"checkCssVisibleProperty",(e=>{var t;let i=!0;const n=this.getStyle(e),{display:r,visibility:o,opacity:s,filter:a}=n;return("none"===r||Mn(t=["hidden","collapse"]).call(t,o)||Number(s)<.1)&&(i=!1),!!i&&(a&&a.split(" ").filter((e=>{var t;const i=e.split("(")[0];return Mn(t=["brightness","blur","opacity"]).call(t,i)})).map((e=>{const[t,i]=e.split(/\(|\)/);return[t,Number(i.match(/^[0-9\.]+/))]})).forEach((e=>{const[t,n]=e;switch(t){case"brightness":(n<.1||n>3)&&(i=!1);break;case"blur":n>3&&(i=!1);break;case"opacity":n<.1&&(i=!1)}})),i)})),oh(this,"checkPropertyUpToAllParentNodes",((e,t)=>{let i=!0,n=!0;const r=e=>t(e);let o=e;for(;o&&n;)r(o)||(i=!1,n=!1),o=o.parentElement,o||(n=!1);return i})),oh(this,"checkActualCssVisibleIncludeInherit",(e=>this.checkPropertyUpToAllParentNodes(e,this.checkCssVisibleProperty))),oh(this,"getSizeAboutClient",(e=>{const{width:t,height:i,left:n,right:r,top:o,bottom:s}=e.getBoundingClientRect(),a=this.getClientWidth(),c=this.getClientHeight();return{width:t,height:i,left:n,right:r,top:o,bottom:s,clientWidth:a,clientHeight:c,clientMin:Math.min(a,c)}})),oh(this,"checkActualSize",(()=>{const{width:e,height:t,clientMin:i}=this._clientSize;return this.checkSizeIsVisible(e,t,i)})),oh(this,"elementFromPoint",((e,t)=>document.elementFromPoint?document.elementFromPoint(e,t):null)),oh(this,"checkCoverForAPoint",((e,t,i)=>{const n=this.elementFromPoint(e,t);return null!==n&&n!==i})),oh(this,"getPointPositionList",(()=>{const{width:e,height:t,left:i,top:n}=this._clientSize,r=e/6,o=t/6,s=[],a=10**6;for(let c=0;c<5;c++)for(let e=0;e<5;e++){const t=(i*a+(0===c?.1:4===c?(r*c*a-1e5)/a:r*c)*a)/a,u=(n*a+(0===e?.1:4===e?(o*e*a-1e5)/a:o*e)*a)/a;s.push({x:t,y:u})}return[...s]})),oh(this,"checkElementCover",(e=>this.getPointPositionList().map((t=>this.checkCoverForAPoint(t.x,t.y,e))).filter((e=>!!e)).length>6)),oh(this,"checkSizeIsVisible",((e,t,i)=>(e>50||i/e<=10)&&(t>50||i/t<=10))),oh(this,"checkSizeOfPartInClient",(()=>{const{left:e,right:t,top:i,bottom:n,clientHeight:r,clientWidth:o,clientMin:s}=this._clientSize;let a,c,u,d;if(e<0)a=0;else{if(!(e<o))return!1;a=e}if(t<0)return!1;if(c=t<o?t:o,i<0)u=0;else{if(!(i<r))return!1;u=i}if(n<0)return!1;d=n<r?n:r;const l=c-a,h=d-u;return this.checkSizeIsVisible(l,h,s)})),oh(this,"returnHiddenResult",(e=>(this._clientSize=null,{visible:!1,reason:e}))),oh(this,"checkOneElementVisible",(e=>{if(e instanceof HTMLElement){if(this.checkElementIsMountedOnDom(e)){if(this.checkActualCssVisibleIncludeInherit(e)){if(this._clientSize=this.getSizeAboutClient(e),this.checkElementCover(e))return this.returnHiddenResult(Qv.COVERED);{const e=this.checkActualSize(),t=this.checkSizeOfPartInClient();return e&&!t?this.returnHiddenResult(Qv.POSITION):e?(this._clientSize=null,{visible:!0}):this.returnHiddenResult(Qv.SIZE)}}return this.returnHiddenResult(Qv.STYLE)}return this.returnHiddenResult(Zv.UNMOUNTED)}return this.returnHiddenResult(Zv.INVALID_HTML_ELEMENT)})),oh(this,"checkElementIsMountedOnDom",(e=>this.checkPropertyUpToAllParentNodes(e,(e=>"HTML"!==e.nodeName.toUpperCase()?null!==e.parentElement:!!document.documentElement))))}};function eE(e){return(new TextEncoder).encode(e)}const tE=function(e,t){const i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e),0),i.set(new Uint8Array(t),e.byteLength),i},iE=async e=>{const t=function(e){const t=window.atob(e),i=new Uint8Array(new ArrayBuffer(t.length));for(let n=0;n<t.length;n+=1)i[n]=t.charCodeAt(n);return i}("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDCMnXAHkKIGAM+x4N22gCI+Wyu\nSTM9ztkT3uYslTT2PuKmZfPzhH6kVdO7PTjGCOZnAsyb3oTtWat0KcxQ4jxvqQV+\nHvYl3iI1Yd4vl2c3qRMJPLtRDfNxa2Mcxgq7e9aEUibzdd0st+OJAy3tOj/Y0aVy\nxQiYDz3vqa6bP29adwIDAQAB"),i=await window.crypto.subtle.importKey("spki",t,{name:"RSA-OAEP",hash:"SHA-256"},!0,["encrypt"]),n=eE(e),r=await window.crypto.subtle.encrypt({name:"RSA-OAEP"},i,n);return function(e){let t="";for(let i=0;i<e.length;i+=1)t+=String.fromCharCode(e[i]);return window.btoa(t)}(new Uint8Array(r))},nE=async e=>function(e,t){let i="";return new Uint8Array(e).forEach((e=>{i+=e.toString(t).padStart(2,"0")})),i}(await crypto.subtle.digest("SHA-256",eE(e)),16);class rE{constructor(){oh(this,"_events",{}),oh(this,"addListener",this.on)}getListeners(e){return this._events[e]?this._events[e].map((e=>e.listener)):[]}on(e,t){this._events[e]||(this._events[e]=[]);const i=this._events[e];-1===this._indexOfListener(i,t)&&i.push({listener:t,once:!1})}once(e,t){this._events[e]||(this._events[e]=[]);const i=this._events[e];-1===this._indexOfListener(i,t)&&i.push({listener:t,once:!0})}off(e,t){if(!this._events[e])return;const i=this._events[e],n=this._indexOfListener(i,t);-1!==n&&i.splice(n,1),0===this._events[e].length&&delete this._events[e]}removeAllListeners(e){e?delete this._events[e]:this._events={}}emit(e){this._events[e]||(this._events[e]=[]);const t=this._events[e].map((e=>e));for(var i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];for(let o=0;o<t.length;o+=1){const i=t[o];i.once&&this.off(e,i.listener),i.listener.apply(this,n||[])}}safeEmit(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];[...this._events[e]||[]].forEach((t=>{t.once&&this.off(e,t.listener);try{t.listener.apply(this,i)}catch(t){console.error("safeEmit event:".concat(e," error ").concat(null==t?void 0:t.toString()))}}))}_indexOfListener(e,t){let i=e.length;for(;i--;)if(e[i].listener===t)return i;return-1}}let oE=null;function sE(){if(oE)return oE;if(window.electron)return oE=window.electron;if(!window.require)return null;try{return oE=window.require("electron"),oE}catch(e){return null}}var aE,cE,uE,dE,lE,hE,fE,pE;function mE(e){return Gv(e.timeout,"config.timeout",0,1e5),Gv(e.timeoutFactor,"config.timeoutFactor",0,100,!1),Gv(e.maxRetryCount,"config.maxRetryConfig",0,1/0),Gv(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function _E(e){if(!Array.isArray(e)||e.length<1)return!1;try{e.forEach((e=>{if(!e.urls)throw Error()}))}catch(e){return!1}return!0}function gE(e){return qv(e.turnServerURL,"turnServerURL"),qv(e.username,"username"),qv(e.password,"password"),e.udpport&&Gv(e.udpport,"udpport",1,99999,!0),e.forceturn&&Fv(e.forceturn,"forceturn"),e.security&&Fv(e.security,"security"),e.tcpport&&Gv(e.tcpport,"tcpport",1,99999,!0),!0}function vE(e){return void 0!==e.level&&Wv(e.level,"level",[1,2,3]),void 0!==e.delay&&Gv(e.delay,"delay",0,3e3,!0),!0}function EE(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return 0===e.getListeners(t).length?nv.reject(new jv(Bv.UNEXPECTED_ERROR,"can not emit promise")):new nv(((i,r)=>{e.emit(t,...n,i,r)}))}function bE(e,t){if(0===e.getListeners(t).length)return nv.resolve();for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return EE(e,t,...n)}function yE(e,t){if(0===e.getListeners(t).length)return null;for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return wE(e,t,...n)}function wE(e,t){let i=null,n=null;for(var r=arguments.length,o=new Array(r>2?r-2:0),s=2;s<r;s++)o[s-2]=arguments[s];if(e.emit(t,...o,(e=>{i=e}),(e=>{n=e})),null!==n)throw n;if(null===i)throw new jv(Bv.UNEXPECTED_ERROR,"handler is not sync");return i}!function(e){e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.SET_AREA="setArea",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.MASS_SUBSCRIBE="Client.massSubscribe",e.MASS_UNSUBSCRIBE="Client.massUnsubscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.INSPECT_VIDEO_CONTENT="Client.inspectVideoContent",e.STOP_INSPECT_VIDEO_CONTENT="Client.stopInspectVideoContent",e.JOIN_FALLBACK_TO_PROXY="Client._joinFallbackToProxy",e.DATACHANNEL_FAILBACK="Client._datachannelFailback",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",e.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE="LocalVideoTrack.getVideoElementVisibleStatus",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE="RemoteVideoTrack.getVideoElementVisibleStatus",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.GET_MEDIA_STREAM_TRACK="Track.getMediaStreamTrack",e.STREAM_TYPE_CHANGE="streamTypeChange",e.CONNECTION_STATE_CHANGE="connectionStateChange",e.LOAD_CONFIG_FROM_LOCALSTORAGE="loadConfigFromLocalStorage",e.IMAGE_MODERATION_UPLOAD="imageModerationUpload"}(aE||(aE={})),function(e){e.TRACER="tracer"}(cE||(cE={})),function(e){e[e.AUDIENCE_LEVEL_LOW_LATENCY=1]="AUDIENCE_LEVEL_LOW_LATENCY",e[e.AUDIENCE_LEVEL_ULTRA_LOW_LATENCY=2]="AUDIENCE_LEVEL_ULTRA_LOW_LATENCY",e[e.AUDIENCE_LEVEL_SYNC_LATENCY=3]="AUDIENCE_LEVEL_SYNC_LATENCY"}(uE||(uE={})),function(e){e.LEAVE="LEAVE",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.UID_BANNED="UID_BANNED",e.IP_BANNED="IP_BANNED",e.CHANNEL_BANNED="CHANNEL_BANNED",e.FALLBACK="FALLBACK",e.LICENSE_MISSING="LICENSE_MISSING",e.LICENSE_EXPIRED="LICENSE_EXPIRED",e.LICENSE_MINUTES_EXCEEDED="LICENSE_MINUTES_EXCEEDED",e.LICENSE_PERIOD_INVALID="LICENSE_PERIOD_INVALID",e.LICENSE_MULTIPLE_SDK_SERVICE="LICENSE_MULTIPLE_SDK_SERVICE",e.LICENSE_ILLEGAL="LICENSE_ILLEGAL",e.TOKEN_EXPIRE="TOKEN_EXPIRE"}(dE||(dE={})),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.INJECT_STREAM_STATUS="stream-inject-status",e.EXCEPTION="exception",e.ERROR="error",e.P2P_LOST="p2p_lost",e.JOIN_FALLBACK_TO_PROXY="join-fallback-to-proxy",e.CHANNEL_FALLBACK_TO_WEBSOCKET="channel-fallback-to-websocket",e.MEDIA_CONNECTION_TYPE_CHANGE="media-connection-type-change",e.PUBLISHED_USER_LIST="published-user-list",e.CONTENT_INSPECT_CONNECTION_STATE_CHANGE="content-inspect-connection-state-change",e.CONTENT_INSPECT_ERROR="content-inspect-error",e.CONTENT_INSPECT_RESULT="content-inspect-result",e.IMAGE_MODERATION_CONNECTION_STATE_CHANGE="image-moderation-connection-state-change"}(lE||(lE={})),function(e){e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK"}(hE||(hE={})),function(e){e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(fE||(fE={})),function(e){e.NETWORK_STATE_CHANGE="NETWORK_STATE_CHANGE",e.ONLINE="ONLINE",e.OFFLINE="OFFLINE"}(pE||(pE={}));const SE=new class extends rE{set networkState(e){this.emit(pE.NETWORK_STATE_CHANGE,e,this._networkState),e===fE.ONLINE?this.emit(pE.ONLINE):e===fE.OFFLINE&&(this.onlineWaiter=new nv((e=>{this.once(pE.ONLINE,(()=>{this.onlineWaiter=void 0,e(fE.ONLINE)}))})),this.emit(pE.OFFLINE)),this._networkState=e}get networkState(){return this._networkState}get isOnline(){return this._networkState===fE.ONLINE}constructor(){super(),oh(this,"_moduleName","network-indicator"),oh(this,"_networkState",fE.ONLINE),oh(this,"onlineWaiter",void 0),window.addEventListener("online",(()=>{this.networkState=fE.ONLINE})),window.addEventListener("offline",(()=>{this.networkState=fE.OFFLINE}))}};function TE(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function RE(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?TE(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):TE(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function CE(e,t){const i=e.indexOf(t);-1!==i&&e.splice(i,1)}function IE(e){const t=[];return e.forEach((e=>{-1===t.indexOf(e)&&t.push(e)})),t}function AE(e){void 0!==nv?nv.resolve().then(e):setTimeout(e,0)}function OE(e){return JSON.parse(JSON.stringify(e))}function ME(e){try{return OE(e)}catch(r){return e}}const NE={};function kE(e,t){NE[t]||(NE[t]=!0,e())}function PE(e){const t=window.atob(e),i=new Uint8Array(new ArrayBuffer(t.length));for(let n=0;n<t.length;n+=1)i[n]=t.charCodeAt(n);return i}function DE(e){let t="";for(let i=0;i<e.length;i+=1)t+=String.fromCharCode(e[i]);return window.btoa(t)}function LE(e){return window.TextEncoder?(new TextEncoder).encode(e).length:e.length}function xE(e){let t=0;return/DingTalk/i.test(navigator.userAgent)&&e.realFormData&&(e=e.realFormData),e.forEach((e=>{t+="string"==typeof e?LE(e):e.size})),t+138}function UE(e){const t=new jv(Bv.TIMEOUT,"timeout");return new nv(((i,n)=>{window.setTimeout((()=>n(t)),e)}))}function VE(e){return new nv((t=>{window.setTimeout(t,e)}))}function BE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,t=arguments.length>1?arguments[1]:void 0;const i=Math.random().toString(16).substr(2,e).toLowerCase();return i.length===e?"".concat(t).concat(i):"".concat(t).concat(i)+BE(e-i.length,"")}function jE(){return BE(32,"").toUpperCase()}const FE=()=>{},WE=new class{constructor(){oh(this,"fnMap",new Map)}throttleByKey(e,t,i,n){for(var r=arguments.length,o=new Array(r>4?r-4:0),s=4;s<r;s++)o[s-4]=arguments[s];if(this.fnMap.has(t)){const r=this.fnMap.get(t);if(r.threshold!==i){r.fn(...r.args),clearTimeout(r.timer);const s=window.setTimeout((()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)}),i);this.fnMap.set(t,{fn:e,threshold:i,timer:s,args:o,skipFn:n})}else r.skipFn&&r.skipFn(...r.args),this.fnMap.set(t,RE(RE({},r),{},{fn:e,args:o,skipFn:n}))}else{const r=window.setTimeout((()=>{const e=this.fnMap.get(t);e&&e.fn(...e.args),this.fnMap.delete(t)}),i);this.fnMap.set(t,{fn:e,threshold:i,timer:r,args:o,skipFn:n})}}},GE=WE.throttleByKey.bind(WE);function HE(e){return"object"==typeof e&&null!==e&&!(e instanceof RegExp)}function qE(e,t){if(!HE(e)||!HE(t))return t;if(Array.isArray(e)&&!Array.isArray(t)||!Array.isArray(e)&&Array.isArray(t))return t;if(Array.isArray(t)&&Array.isArray(e)){const i=[...e];for(let n=0;n<t.length;n++)i[n]=qE(e[n],t[n]);return i}{const i=RE({},e);for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(Object.prototype.hasOwnProperty.call(e,n)?i[n]=qE(e[n],t[n]):i[n]=t[n]);return i}}let KE=1,zE=console;class YE{static setLogger(e){zE=e}constructor(e){oh(this,"lockingPromise",nv.resolve()),oh(this,"locks",0),oh(this,"name",""),oh(this,"lockId",void 0),this.lockId=KE++,e&&(this.name=e),zE.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is created."))}get isLocked(){return this.locks>0}lock(e){let t;this.locks+=1,zE.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is locked, current queue ").concat(this.locks,". ").concat("string"==typeof e?e:""));const i=new nv((i=>{t=()=>{this.locks-=1,zE.debug("[lock-".concat(this.name,"-").concat(this.lockId,"] is not locked, current queue ").concat(this.locks,". ").concat("string"==typeof e?e:"")),i()}})),n=this.lockingPromise.then((()=>t));return this.lockingPromise=this.lockingPromise.then((()=>i)),n}}function JE(e,t){return function(i,n,r){const o=r.value;if("function"!=typeof o)throw new Error("Cannot use mutex on object property.");return r.value=async function(){const i=this[t];if(!i)throw new Error("mutex property key ".concat(t," doesn't exist on ").concat(e));const r=await i.lock("From ".concat(e,".").concat(n));try{for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return await o.apply(this,a)}finally{r()}},r}}const XE={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4};function QE(e,t){const i=Math.floor(t.timeout*Math.pow(t.timeoutFactor,e));return Math.min(t.maxRetryTimeout,i)}function ZE(e,t,i,n){const r=Object.assign({},XE,n);let o=r.timeout;const s=async()=>{await function(e){return new nv((t=>{window.setTimeout(t,e)}))}(o),o*=r.timeoutFactor,o=Math.min(r.maxRetryTimeout,o)};let a=!1;const c=new nv((async(n,o)=>{t=t||(()=>!1),i=i||(()=>!0);for(let c=0;c<r.maxRetryCount;c+=1){if(a)return o(new jv(Bv.OPERATION_ABORTED));try{const i=await e();if(!t(i,c))return n(i);if(c+1===r.maxRetryCount)return n(i);await s()}catch(e){if(!i(e,c))return o(e);if(c+1===r.maxRetryCount)return o(e);await s()}}}));return c.cancel=()=>a=!0,c}var $E=De,eb=Ze,tb=Y,ib=Gi,nb=TypeError,rb=function(e){return function(t,i,n,r){$E(i);var o=eb(t),s=tb(o),a=ib(o),c=e?a-1:0,u=e?-1:1;if(n<2)for(;;){if(c in s){r=s[c],c+=u;break}if(c+=u,e?c<0:a<=c)throw nb("Reduce of empty array with no initial value")}for(;e?c>=0:a>c;c+=u)c in s&&(r=i(r,s[c],c,o));return r}},ob=[rb(!1),rb(!0)][0];Ni({target:"Array",proto:!0,forced:!Rp&&ve>79&&ve<83||!Sh("reduce")},{reduce:function(e){var t=arguments.length;return ob(this,e,t,t>1?arguments[1]:void 0)}});var sb=Qi("Array").reduce,ab=f,cb=sb,ub=Array.prototype,db=o((function(e){var t=e.reduce;return e===ub||ab(ub,e)&&t===ub.reduce?cb:t}));let lb=class{constructor(e){oh(this,"input",[]),oh(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}mean(){var e;return 0===this.input.length?0:db(e=this.input).call(e,((e,t)=>e+t))/this.input.length}};var hb,fb={exports:{}},pb=function(e,t){return function(){for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];return e.apply(t,i)}},mb=pb,_b=Object.prototype.toString,gb=(hb=Object.create(null),function(e){var t=_b.call(e);return hb[t]||(hb[t]=t.slice(8,-1).toLowerCase())});function vb(e){return e=e.toLowerCase(),function(t){return gb(t)===e}}function Eb(e){return Array.isArray(e)}function bb(e){return void 0===e}var yb=vb("ArrayBuffer");function wb(e){return null!==e&&"object"==typeof e}function Sb(e){if("object"!==gb(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}var Tb=vb("Date"),Rb=vb("File"),Cb=vb("Blob"),Ib=vb("FileList");function Ab(e){return"[object Function]"===_b.call(e)}var Ob=vb("URLSearchParams");function Mb(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),Eb(e))for(var i=0,n=e.length;i<n;i++)t.call(null,e[i],i,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}var Nb,kb=(Nb="undefined"!=typeof Uint8Array&&Object.getPrototypeOf(Uint8Array),function(e){return Nb&&e instanceof Nb}),Pb={isArray:Eb,isArrayBuffer:yb,isBuffer:function(e){return null!==e&&!bb(e)&&null!==e.constructor&&!bb(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){var t="[object FormData]";return e&&("function"==typeof FormData&&e instanceof FormData||_b.call(e)===t||Ab(e.toString)&&e.toString()===t)},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&yb(e.buffer)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:wb,isPlainObject:Sb,isUndefined:bb,isDate:Tb,isFile:Rb,isBlob:Cb,isFunction:Ab,isStream:function(e){return wb(e)&&Ab(e.pipe)},isURLSearchParams:Ob,isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:Mb,merge:function e(){var t={};function i(i,n){Sb(t[n])&&Sb(i)?t[n]=e(t[n],i):Sb(i)?t[n]=e({},i):Eb(i)?t[n]=i.slice():t[n]=i}for(var n=0,r=arguments.length;n<r;n++)Mb(arguments[n],i);return t},extend:function(e,t,i){return Mb(t,(function(t,n){e[n]=i&&"function"==typeof t?mb(t,i):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,i,n){e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,i&&Object.assign(e.prototype,i)},toFlatObject:function(e,t,i){var n,r,o,s={};t=t||{};do{for(r=(n=Object.getOwnPropertyNames(e)).length;r-- >0;)s[o=n[r]]||(t[o]=e[o],s[o]=!0);e=Object.getPrototypeOf(e)}while(e&&(!i||i(e,t))&&e!==Object.prototype);return t},kindOf:gb,kindOfTest:vb,endsWith:function(e,t,i){e=String(e),(void 0===i||i>e.length)&&(i=e.length),i-=t.length;var n=e.indexOf(t,i);return-1!==n&&n===i},toArray:function(e){if(!e)return null;var t=e.length;if(bb(t))return null;for(var i=new Array(t);t-- >0;)i[t]=e[t];return i},isTypedArray:kb,isFileList:Ib},Db=Pb;function Lb(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var xb=function(e,t,i){if(!t)return e;var n;if(i)n=i(t);else if(Db.isURLSearchParams(t))n=t.toString();else{var r=[];Db.forEach(t,(function(e,t){null!=e&&(Db.isArray(e)?t+="[]":e=[e],Db.forEach(e,(function(e){Db.isDate(e)?e=e.toISOString():Db.isObject(e)&&(e=JSON.stringify(e)),r.push(Lb(t)+"="+Lb(e))})))})),n=r.join("&")}if(n){var o=e.indexOf("#");-1!==o&&(e=e.slice(0,o)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e},Ub=Pb;function Vb(){this.handlers=[]}Vb.prototype.use=function(e,t,i){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!i&&i.synchronous,runWhen:i?i.runWhen:null}),this.handlers.length-1},Vb.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},Vb.prototype.forEach=function(e){Ub.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var Bb,jb,Fb=Vb,Wb=Pb;function Gb(){if(jb)return Bb;jb=1;var e=Pb;function t(e,t,i,n,r){Error.call(this),this.message=e,this.name="AxiosError",t&&(this.code=t),i&&(this.config=i),n&&(this.request=n),r&&(this.response=r)}e.inherits(t,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var i=t.prototype,n={};return["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(e){n[e]={value:e}})),Object.defineProperties(t,n),Object.defineProperty(i,"isAxiosError",{value:!0}),t.from=function(n,r,o,s,a,c){var u=Object.create(i);return e.toFlatObject(n,u,(function(e){return e!==Error.prototype})),t.call(u,n.message,r,o,s,a),u.name=n.name,c&&Object.assign(u,c),u},Bb=t}var Hb,qb,Kb,zb,Yb,Jb,Xb={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1};function Qb(){if(qb)return Hb;qb=1;var e=Pb;return Hb=function(t,i){i=i||new FormData;var r=[];function o(t){return null===t?"":e.isDate(t)?t.toISOString():e.isArrayBuffer(t)||e.isTypedArray(t)?"function"==typeof Blob?new Blob([t]):n.from(t):t}return function t(n,s){if(e.isPlainObject(n)||e.isArray(n)){if(-1!==r.indexOf(n))throw Error("Circular reference detected in "+s);r.push(n),e.forEach(n,(function(n,r){if(!e.isUndefined(n)){var a,c=s?s+"."+r:r;if(n&&!s&&"object"==typeof n)if(e.endsWith(r,"{}"))n=JSON.stringify(n);else if(e.endsWith(r,"[]")&&(a=e.toArray(n)))return void a.forEach((function(t){!e.isUndefined(t)&&i.append(c,o(t))}));t(n,c)}})),r.pop()}else i.append(s,o(n))}(t),i},Hb}function Zb(){if(zb)return Kb;zb=1;var e=Gb();return Kb=function(t,i,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?i(new e("Request failed with status code "+n.status,[e.ERR_BAD_REQUEST,e.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):t(n)}}function $b(){if(Jb)return Yb;Jb=1;var e=Pb;return Yb=e.isStandardBrowserEnv()?{write:function(t,i,n,r,o,s){var a=[];a.push(t+"="+encodeURIComponent(i)),e.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),e.isString(r)&&a.push("path="+r),e.isString(o)&&a.push("domain="+o),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},Yb}var ey,ty,iy,ny,ry,oy,sy,ay,cy,uy,dy,ly,hy=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)},fy=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e},py=function(e,t){return e&&!hy(t)?fy(e,t):t};function my(){if(ty)return ey;ty=1;var e=Pb,t=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return ey=function(i){var n,r,o,s={};return i?(e.forEach(i.split("\n"),(function(i){if(o=i.indexOf(":"),n=e.trim(i.substr(0,o)).toLowerCase(),r=e.trim(i.substr(o+1)),n){if(s[n]&&t.indexOf(n)>=0)return;s[n]="set-cookie"===n?(s[n]?s[n]:[]).concat([r]):s[n]?s[n]+", "+r:r}})),s):s},ey}function _y(){if(ny)return iy;ny=1;var e=Pb;return iy=e.isStandardBrowserEnv()?function(){var t,i=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var t=e;return i&&(n.setAttribute("href",t),t=n.href),n.setAttribute("href",t),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return t=r(window.location.href),function(i){var n=e.isString(i)?r(i):i;return n.protocol===t.protocol&&n.host===t.host}}():function(){return!0}}function gy(){if(oy)return ry;oy=1;var e=Gb();function t(t){e.call(this,null==t?"canceled":t,e.ERR_CANCELED),this.name="CanceledError"}return Pb.inherits(t,e,{__CANCEL__:!0}),ry=t}function vy(){return ay||(ay=1,sy=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}),sy}function Ey(){if(uy)return cy;uy=1;var e=Pb,t=Zb(),i=$b(),n=xb,r=py,o=my(),s=_y(),a=Xb,c=Gb(),u=gy(),d=vy();return cy=function(l){return new Promise((function(h,f){var p,m=l.data,_=l.headers,g=l.responseType;function v(){l.cancelToken&&l.cancelToken.unsubscribe(p),l.signal&&l.signal.removeEventListener("abort",p)}e.isFormData(m)&&e.isStandardBrowserEnv()&&delete _["Content-Type"];var E=new XMLHttpRequest;if(l.auth){var b=l.auth.username||"",y=l.auth.password?unescape(encodeURIComponent(l.auth.password)):"";_.Authorization="Basic "+btoa(b+":"+y)}var w=r(l.baseURL,l.url);function S(){if(E){var e="getAllResponseHeaders"in E?o(E.getAllResponseHeaders()):null,i={data:g&&"text"!==g&&"json"!==g?E.response:E.responseText,status:E.status,statusText:E.statusText,headers:e,config:l,request:E};t((function(e){h(e),v()}),(function(e){f(e),v()}),i),E=null}}if(E.open(l.method.toUpperCase(),n(w,l.params,l.paramsSerializer),!0),E.timeout=l.timeout,"onloadend"in E?E.onloadend=S:E.onreadystatechange=function(){E&&4===E.readyState&&(0!==E.status||E.responseURL&&0===E.responseURL.indexOf("file:"))&&setTimeout(S)},E.onabort=function(){E&&(f(new c("Request aborted",c.ECONNABORTED,l,E)),E=null)},E.onerror=function(){f(new c("Network Error",c.ERR_NETWORK,l,E,E)),E=null},E.ontimeout=function(){var e=l.timeout?"timeout of "+l.timeout+"ms exceeded":"timeout exceeded",t=l.transitional||a;l.timeoutErrorMessage&&(e=l.timeoutErrorMessage),f(new c(e,t.clarifyTimeoutError?c.ETIMEDOUT:c.ECONNABORTED,l,E)),E=null},e.isStandardBrowserEnv()){var T=(l.withCredentials||s(w))&&l.xsrfCookieName?i.read(l.xsrfCookieName):void 0;T&&(_[l.xsrfHeaderName]=T)}"setRequestHeader"in E&&e.forEach(_,(function(e,t){void 0===m&&"content-type"===t.toLowerCase()?delete _[t]:E.setRequestHeader(t,e)})),e.isUndefined(l.withCredentials)||(E.withCredentials=!!l.withCredentials),g&&"json"!==g&&(E.responseType=l.responseType),"function"==typeof l.onDownloadProgress&&E.addEventListener("progress",l.onDownloadProgress),"function"==typeof l.onUploadProgress&&E.upload&&E.upload.addEventListener("progress",l.onUploadProgress),(l.cancelToken||l.signal)&&(p=function(e){E&&(f(!e||e&&e.type?new u:e),E.abort(),E=null)},l.cancelToken&&l.cancelToken.subscribe(p),l.signal&&(l.signal.aborted?p():l.signal.addEventListener("abort",p))),m||(m=null);var R=d(w);R&&-1===["http","https","file"].indexOf(R)?f(new c("Unsupported protocol "+R+":",c.ERR_BAD_REQUEST,l)):E.send(m)}))},cy}var by=Pb,yy=function(e,t){Wb.forEach(e,(function(i,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=i,delete e[n])}))},wy=Gb(),Sy=Xb,Ty=Qb(),Ry={"Content-Type":"application/x-www-form-urlencoded"};function Cy(e,t){!by.isUndefined(e)&&by.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var Iy,Ay={transitional:Sy,adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof i&&"[object process]"===Object.prototype.toString.call(i))&&(Iy=Ey()),Iy),transformRequest:[function(e,t){if(yy(t,"Accept"),yy(t,"Content-Type"),by.isFormData(e)||by.isArrayBuffer(e)||by.isBuffer(e)||by.isStream(e)||by.isFile(e)||by.isBlob(e))return e;if(by.isArrayBufferView(e))return e.buffer;if(by.isURLSearchParams(e))return Cy(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var i,n=by.isObject(e),r=t&&t["Content-Type"];if((i=by.isFileList(e))||n&&"multipart/form-data"===r){var o=this.env&&this.env.FormData;return Ty(i?{"files[]":e}:e,o&&new o)}return n||"application/json"===r?(Cy(t,"application/json"),function(e,t,i){if(by.isString(e))try{return(t||JSON.parse)(e),by.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(i||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||Ay.transitional,i=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,r=!i&&"json"===this.responseType;if(r||n&&by.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(r){if("SyntaxError"===e.name)throw wy.from(e,wy.ERR_BAD_RESPONSE,this,null,this.response);throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ly?dy:(ly=1,dy=null)},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};by.forEach(["delete","get","head"],(function(e){Ay.headers[e]={}})),by.forEach(["post","put","patch"],(function(e){Ay.headers[e]=by.merge(Ry)}));var Oy,My,Ny=Ay,ky=Pb,Py=Ny;function Dy(){return My?Oy:(My=1,Oy=function(e){return!(!e||!e.__CANCEL__)})}var Ly=Pb,xy=function(e,t,i){var n=this||Py;return ky.forEach(i,(function(i){e=i.call(n,e,t)})),e},Uy=Dy(),Vy=Ny,By=gy();function jy(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new By}var Fy,Wy,Gy=Pb,Hy=function(e,t){t=t||{};var i={};function n(e,t){return Gy.isPlainObject(e)&&Gy.isPlainObject(t)?Gy.merge(e,t):Gy.isPlainObject(t)?Gy.merge({},t):Gy.isArray(t)?t.slice():t}function r(i){return Gy.isUndefined(t[i])?Gy.isUndefined(e[i])?void 0:n(void 0,e[i]):n(e[i],t[i])}function o(e){if(!Gy.isUndefined(t[e]))return n(void 0,t[e])}function s(i){return Gy.isUndefined(t[i])?Gy.isUndefined(e[i])?void 0:n(void 0,e[i]):n(void 0,t[i])}function a(i){return i in t?n(e[i],t[i]):i in e?n(void 0,e[i]):void 0}var c={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a};return Gy.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=c[e]||r,n=t(e);Gy.isUndefined(n)&&t!==a||(i[e]=n)})),i};function qy(){return Wy?Fy:(Wy=1,Fy={version:"0.27.2"})}var Ky=qy().version,zy=Gb(),Yy={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){Yy[e]=function(i){return typeof i===e||"a"+(t<1?"n ":" ")+e}}));var Jy={};Yy.transitional=function(e,t,i){function n(e,t){return"[Axios v"+Ky+"] Transitional option '"+e+"'"+t+(i?". "+i:"")}return function(i,r,o){if(!1===e)throw new zy(n(r," has been removed"+(t?" in "+t:"")),zy.ERR_DEPRECATED);return t&&!Jy[r]&&(Jy[r]=!0,console.warn(n(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(i,r,o)}};var Xy,Qy,Zy,$y,ew,tw,iw={assertOptions:function(e,t,i){if("object"!=typeof e)throw new zy("options must be an object",zy.ERR_BAD_OPTION_VALUE);for(var n=Object.keys(e),r=n.length;r-- >0;){var o=n[r],s=t[o];if(s){var a=e[o],c=void 0===a||s(a,o,e);if(!0!==c)throw new zy("option "+o+" must be "+c,zy.ERR_BAD_OPTION_VALUE)}else if(!0!==i)throw new zy("Unknown option "+o,zy.ERR_BAD_OPTION)}},validators:Yy},nw=Pb,rw=xb,ow=Fb,sw=function(e){return jy(e),e.headers=e.headers||{},e.data=xy.call(e,e.data,e.headers,e.transformRequest),e.headers=Ly.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Ly.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||Vy.adapter)(e).then((function(t){return jy(e),t.data=xy.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return Uy(t)||(jy(e),t&&t.response&&(t.response.data=xy.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},aw=Hy,cw=py,uw=iw,dw=uw.validators;function lw(e){this.defaults=e,this.interceptors={request:new ow,response:new ow}}lw.prototype.request=function(e,t){"string"==typeof e?(t=t||{}).url=e:t=e||{},(t=aw(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var i=t.transitional;void 0!==i&&uw.assertOptions(i,{silentJSONParsing:dw.transitional(dw.boolean),forcedJSONParsing:dw.transitional(dw.boolean),clarifyTimeoutError:dw.transitional(dw.boolean)},!1);var n=[],r=!0;this.interceptors.request.forEach((function(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(r=r&&e.synchronous,n.unshift(e.fulfilled,e.rejected))}));var o,s=[];if(this.interceptors.response.forEach((function(e){s.push(e.fulfilled,e.rejected)})),!r){var a=[sw,void 0];for(Array.prototype.unshift.apply(a,n),a=a.concat(s),o=Promise.resolve(t);a.length;)o=o.then(a.shift(),a.shift());return o}for(var c=t;n.length;){var u=n.shift(),d=n.shift();try{c=u(c)}catch(e){d(e);break}}try{o=sw(c)}catch(e){return Promise.reject(e)}for(;s.length;)o=o.then(s.shift(),s.shift());return o},lw.prototype.getUri=function(e){e=aw(this.defaults,e);var t=cw(e.baseURL,e.url);return rw(t,e.params,e.paramsSerializer)},nw.forEach(["delete","get","head","options"],(function(e){lw.prototype[e]=function(t,i){return this.request(aw(i||{},{method:e,url:t,data:(i||{}).data}))}})),nw.forEach(["post","put","patch"],(function(e){function t(t){return function(i,n,r){return this.request(aw(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:i,data:n}))}}lw.prototype[e]=t(),lw.prototype[e+"Form"]=t(!0)}));var hw=Pb,fw=pb,pw=lw,mw=Hy,_w=function e(t){var i=new pw(t),n=fw(pw.prototype.request,i);return hw.extend(n,pw.prototype,i),hw.extend(n,i),n.create=function(i){return e(mw(t,i))},n}(Ny);_w.Axios=pw,_w.CanceledError=gy(),_w.CancelToken=function(){if(Qy)return Xy;Qy=1;var e=gy();function t(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var i;this.promise=new Promise((function(e){i=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,i=n._listeners.length;for(t=0;t<i;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,i=new Promise((function(e){n.subscribe(e),t=e})).then(e);return i.cancel=function(){n.unsubscribe(t)},i},t((function(t){n.reason||(n.reason=new e(t),i(n.reason))}))}return t.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},t.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},t.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},t.source=function(){var e;return{token:new t((function(t){e=t})),cancel:e}},Xy=t}(),_w.isCancel=Dy(),_w.VERSION=qy().version,_w.toFormData=Qb(),_w.AxiosError=Gb(),_w.Cancel=_w.CanceledError,_w.all=function(e){return Promise.all(e)},_w.spread=$y?Zy:($y=1,Zy=function(e){return function(t){return e.apply(null,t)}}),_w.isAxiosError=function(){if(tw)return ew;tw=1;var e=Pb;return ew=function(t){return e.isObject(t)&&!0===t.isAxiosError}}(),fb.exports=_w,fb.exports.default=_w;var gw=o(fb.exports);function vw(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ew(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?vw(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):vw(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}let bw,yw=0,ww=0;function Sw(e,t,i,n){return new nv(((r,o)=>{t.responseType=t.responseType||"json",t.data&&!i?(t.data=JSON.stringify(t.data),yw+=LE(t.data)):i&&(t.data.size?yw+=t.data.size:t.data instanceof FormData?yw+=xE(t.data):yw+=LE(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,gw.request(t).then((e=>{"string"==typeof e.data?ww+=LE(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?ww+=e.data.byteLength:ww+=LE(JSON.stringify(e.data)),n&&r({data:e.data,headers:e.headers}),r(e.data)})).catch((e=>{gw.isCancel(e)?o(new jv(Bv.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?o(new jv(Bv.NETWORK_TIMEOUT,e.message)):e.response?o(new jv(Bv.NETWORK_RESPONSE_ERROR,e.response.status)):o(new jv(Bv.NETWORK_ERROR,e.message))}))}))}async function Tw(e,t){const i=new Blob([t.data],{type:"buffer"});return await Sw(e,Ew(Ew({},t),{},{data:i,headers:{"Content-Type":"application/octet-stream"}}),!0)}const Rw=()=>"HTTPS"===(bw||bw||(bw=(window.location.protocol.split(":")[0]||"").toUpperCase(),bw)),Cw=()=>void 0!==window.isSecureContext,Iw=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;const t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(t&&t[1]&&t[2]){const e=t[1],i=t[2];return"".concat(e,".").concat(i)}const i=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/);if(i&&i[1]&&i[2]){const e=i[1],t=i[2];return"".concat(e,".").concat(100*(Number(t)+1))}return"4.0.0.999"}("4.20.0"),Aw=function(){try{return!0===JSON.parse("true")}catch(e){return!0}}();var Ow;!function(e){e.Default="default",e.Auto="auto",e.Relay="relay",e.SdRtn="sd-rtn"}(Ow||(Ow={}));const Mw="v4.20.0-0-g334e514b-dirty(12/8/2023, 3:48:29 PM)",Nw={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",ENABLE_EVENT_REPORT:!0,GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",HTTP_CONNECT_TIMEOUT:5e3,SIGNAL_REQUEST_TIMEOUT:1e4,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],SUBSCRIBE_TWCC:!1,PUBLISH_TWCC:!1,PING_PONG_TIME_OUT:10,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,ENABLE_CONFIG_DISTRIBUTE:!0,CANDIDATE_TIMEOUT:5e3,SHOW_REPORT_INVOKER_LOG:!1,JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,GATEWAY_DOMAINS:["edge.agora.io","edge.sd-rtn.com"],CONNECT_GATEWAY_WITHOUT_DOMAIN:!1,WORKER_DOMAIN:"edge.agora.io",TURN_DOMAIN:"edge.agora.io",EVENT_REPORT_RETRY:!0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,VOLUME_VOICE_WEIGHT:10,GET_VOLUME_OF_MUTED_AUDIO_TRACK:!1,STATS_UPDATE_INTERVAL:250,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com","webrtc-cloud-proxy.agora.io"],CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high",REMOVE_NEW_CODECS:!0,FRAGEMENT_LENGTH:3,WEBSOCKET_COMPRESS:!1,SIMULCAST:!1,PRELOAD_MEDIA_COUNT:0,USE_PUB_RTX:!1,USE_SUB_RTX:!1,CHECK_VIDEO_VISIBLE_INTERVAL:3e4,CHECK_LOCAL_STATS_INTERVAL:100,PROFILE_SWITCH_INTERVAL:2e3,UNSUPPORTED_VIDEO_CODEC:[],ENUMERATE_DEVICES_INTERVAL:!1,ENUMERATE_DEVICES_INTERVAL_TIME:1e4,USE_NEW_TOKEN:!1,CLOSE_AFB_FOR_LOCAL_AP:!0,JOIN_MAX_CONCURRENCY:6,JOIN_WITH_FALLBACK_SIGNAL_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY:!0,JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE:!1,JOIN_GATEWAY_TRY_443PORT_DURATION:2e3,JOIN_GATEWAY_USE_443PORT_ONLY:!1,JOIN_GATEWAY_USE_DUAL_DOMAIN:!0,JOIN_GATEWAY_FALLBACK_PORT:443,USE_TURN_SERVER_OF_GATEWAY:!1,H264_PROFILE_LEVEL_ID:"",USE_NEW_LOG:!1,LOG_VERSION:3,MEDIA_DEVICE_CONSTRAINTS:null,ENCRYPT_PROXY_USERNAME_AND_PSW:!0,SDP_LOGGING:!1,CSP_DETECTED_HOSTNAME_LIST:["agora.io","sd-rtn.com"],REMOTE_AUDIO_TRACK_USES_WEB_AUDIO:!1,LOCAL_AUDIO_TRACK_USES_WEB_AUDIO:!0,BITRATE_ADAPTER_TYPE:"STANDARD_BITRATE",AI_DENOISER_PARAMETERS:{},ADJUST_3A_FROM_PLUGINS:!0,RAISE_H264_BASELINE_PRIORITY:!0,FILTER_SEND_H264_BASELINE:!1,ENABLE_PUBLISHED_USER_LIST:!0,MAX_SUBSCRIPTION:50,X_GOOGLE_START_BITRATE:void 0,NEW_REPORT_SERVER:!1,NEW_REPORT_SERVER_DOMAINS:["data-reporting.agora.io","data-reporting.agora.io"],VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT:3e5,VIDEO_INSPECT_INTERVAL_MINIMUM:1e3,VIDEO_INSPECT_QUALITY_RATIO:.9,VIDEO_INSPECT_WORKER_MANAGER_HOST:"edge.agora.io",VIDEO_INSPECT_WORKER_MANAGER_PORT:"",VIDEO_INSPECT_WORKER_PORT:"",SHOW_VIDEO_INSPECT_WORKER_MESSAGE:!1,STATS_COLLECTOR_PORT:443,FORCE_TURN_TCP:!1,SUBSCRIBE_AUDIO_FILTER_TOPN:void 0,ENABLE_PUBLISH_AUDIO_FILTER:void 0,DISABLE_FEC:void 0,WEBAUDIO_INIT_OPTIONS:void 0,FILTER_VIDEO_FEC:!0,FILTER_AUDIO_FEC:!1,CHROME_DUAL_STREAM_USE_ENCODING:!0,DISABLE_DUAL_STREAM_USE_ENCODING:!1,EXTENSION_USAGE_UPLOAD_INTERVAL:1e4,ICE_RESTART:!0,ICE_RESTART_INTERVAL:1e4,NEW_ICE_RESTART:!1,ENABLE_USER_LICENSE_CHECK:!0,SIGNAL_CHANNEL:0,TRANSMITTER_INITIAL_RTT:30,TRANSMITTER_INITIAL_RTO:30,TRANSMITTER_MAX_BATCH_ACK_COUNT:2,TRANSMITTER_MAX_RTO:500,DATACHANNEL_COMPRESS:!1,FINGERPRINT:null,DC_JOIN_WITH_FAILBACK:5e3,ENABLE_VIDEO_FRAME_CALLBACK:!0,VIDEO_FREEZE_DURATION:500,SPATIALIZER_PARAMETERS:{},UPLOAD_LOG_INTERVAL:3e3,UPLOAD_LOG_REQUEST_RETRY_INTERVAL:2e3,UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL:2e4,UPLOAD_LOG_TRY_INTERVAL_WHILE_OFF:5e3,UPLOAD_LOG_RETRY_INTERVAL_V1:1e4,UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1:200,UPLOAD_LOG_LENGTH_EACH_TIME:10,APP_TYPE:0,DISABLE_WEBAUDIO:!1,CHANNEL_MEDIA_RELAY_SERVERS:void 0,KEEP_LAST_FRAME:!0,FORWARD_P2P_CREATION:!0,SYNC_GROUP:!0,BLOCK_LOCAL_CLIENT:!1,AP_AREA:!0,SVC:[],ENABLE_ENCODED_TRANSFORM:!1,IMAGE_MODERATION_WORKER_HOST:"edge.agora.io",IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT:3e5,IMAGE_MODERATION_INTERVAL_MINIMUM:1e3,SHOW_IMAGE_MODERATION_WORKER_MESSAGE:!1,IMAGE_MODERATION_QUALITY_RATIO:.9,IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL:5e3,SHOW_GLOBAL_CLIENT_LIST:!1,ENABLE_DATASTREAM_2:!1,DATASTREAM_MAX_RETRANSMITS:10,ENABLE_USER_AUTO_REBALANCE_CHECK:!0,ENABLE_INSTANT_VIDEO:!1,ENABLE_NTP_REPORT:!1,USE_XR:!1,TCP_CANDIDATE_ONLY:!1,EXTERNAL_SIGNAL_REQUEST_TIMEOUT:3e3,SHOW_P2P_LOG:!1,MAX_P2P_TIMEOUT:3e4,P2P_TOKEN_INTERVAL:1e3,SHOW_DATASTREAM2_LOG:!1,RESTRICTION_SET_PLAYBACK_DEVICE:!0,ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,FILEPATH_LENMAX:255,DUALSTREAM_OPERATION_CHECK:!0,MEDIA_ELEMENT_EXISTS_DEPTH:3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,STATS_FILTER:{transportId:!0,googTrackId:!0},FILTER_VIDEO_CODEC:[],PLUGIN_INFO:[]};function kw(e,t,i){var n,r;Mn(n=Object.keys(Nw)).call(n,e)&&(!i&&Mn(r=Object.keys(Dw)).call(r,e)||(Nw[e]=t))}function Pw(e){return Nw[e]}const Dw={};function Lw(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function xw(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Lw(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Lw(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var Uw,Vw,Bw;!function(e){e.SET_SESSION_ID="SET_SESSION_ID",e.SET_P2P_ID="SET_P2P_id",e.SET_DC_ID="SET_DC_id",e.SET_UID="SET_UID",e.SET_INT_UID="SET_INT_UID",e.SET_PUB_ID="SET_PUB_ID",e.SET_CLOUD_PROXY_SERVER_MODE="SET_CLOUD_PROXY_SERVER_MODE",e.KEY_METRIC_CLIENT_CREATED="KEY_METRIC_CLIENT_CREATED",e.KEY_METRIC_JOIN_START="KEY_METRIC_JOIN_START",e.AVOID_JOIN_START="AVOID_JOIN_START",e.KEY_METRIC_JOIN_END="KEY_METRIC_JOIN_END",e.KEY_METRIC_REQUEST_AP_START="KEY_METRIC_REQUEST_AP_START",e.KEY_METRIC_REQUEST_AP_END="KEY_METRIC_REQUEST_AP_END",e.KEY_METRIC_JOIN_GATEWAY_START="KEY_METRIC_JOIN_GATEWAY_START",e.KEY_METRIC_JOIN_GATEWAY_END="KEY_METRIC_JOIN_GATEWAY_END",e.KEY_METRIC_PEER_CONNECTION_START="KEY_METRIC_PEER_CONNECTION_START",e.KEY_METRIC_PEER_CONNECTION_END="KEY_METRIC_PEER_CONNECTION_END",e.KEY_METRIC_DESCRIPTION_START="KEY_METRIC_DESCRIPTION_START",e.KEY_METRIC_ICE_CONNECTION_END="KEY_METRIC_ICE_CONNECTION_END",e.KEY_METRIC_SIGNAL_CHANNEL_OPEN="KEY_METRIC_SIGNAL_CHANNEL_OPEN",e.KEY_METRIC_PUBLISH="KEY_METRIC_PUBLISH",e.KEY_METRIC_SUBSCRIBE="KEY_METRIC_SUBSCRIBE",e.RECORD_JOIN_CHANNEL_SERVICE="RECORD_JOIN_CHANNEL_SERVICE",e.RESET_JOIN_CHANNEL_SERVICE_RECORDS="RESET_JOIN_CHANNEL_SERVICE_RECORDS",e.RESET_KEY_METRICS="RESET_KEY_METRICS",e.SET_USE_DATACHANNEL="SET_USE_DATACHANNEL",e.SET_USE_P2P="SET_USE_P2P",e.SET_TRANSPORT_TYPE="SET_TRANSPORT_TYPE"}(Uw||(Uw={}));class jw{constructor(e,t,i,n){oh(this,"state",void 0),this.state={codec:e,audioCodec:t,mode:i,clientId:n,sessionId:null,p2pId:0,dcId:0,pubId:0,subId:0,avoidJoinStart:0,keyMetrics:{publish:[],subscribe:[]},joinChannelServiceRecords:[],cloudProxyServerMode:"disabled",useDataChannel:!1,useP2P:!1,p2pTransport:Ow.Default}}dispatch(e){this.state=function(e,t){switch(t.type){case Uw.SET_SESSION_ID:return xw(xw({},e),{},{sessionId:t.sessionId});case Uw.SET_P2P_ID:return xw(xw({},e),{},{p2pId:t.p2pId});case Uw.SET_UID:return xw(xw({},e),{},{uid:t.uid});case Uw.SET_INT_UID:return xw(xw({},e),{},{intUid:t.intUid});case Uw.SET_PUB_ID:return xw(xw({},e),{},{pubId:t.pubId});case Uw.KEY_METRIC_CLIENT_CREATED:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{clientCreated:t.metric})});case Uw.KEY_METRIC_JOIN_START:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{joinStart:t.metric})});case Uw.AVOID_JOIN_START:return xw(xw({},e),{},{avoidJoinStart:t.avoidJoinStart});case Uw.KEY_METRIC_JOIN_END:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{joinEnd:t.metric})});case Uw.KEY_METRIC_REQUEST_AP_START:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{requestAPStart:t.metric})});case Uw.KEY_METRIC_REQUEST_AP_END:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{requestAPEnd:t.metric})});case Uw.KEY_METRIC_JOIN_GATEWAY_START:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{joinGatewayStart:t.metric})});case Uw.KEY_METRIC_JOIN_GATEWAY_END:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{joinGatewayEnd:t.metric})});case Uw.KEY_METRIC_PEER_CONNECTION_START:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{peerConnectionStart:t.metric})});case Uw.KEY_METRIC_PEER_CONNECTION_END:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{peerConnectionEnd:t.metric})});case Uw.KEY_METRIC_DESCRIPTION_START:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{descriptionStart:t.metric})});case Uw.KEY_METRIC_SIGNAL_CHANNEL_OPEN:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{signalChannelOpen:t.metric})});case Uw.KEY_METRIC_ICE_CONNECTION_END:return xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{iceConnectionEnd:t.metric})});case Uw.KEY_METRIC_PUBLISH:{const i=e.keyMetrics.publish,n=i.findIndex((e=>e.trackId===t.metric.trackId));return-1!==n?(i[n]=xw(xw({},i[n]),t.metric),xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{publish:[...i]})})):xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{publish:[...e.keyMetrics.publish,t.metric]})})}case Uw.KEY_METRIC_SUBSCRIBE:{const i=e.keyMetrics.subscribe,n=i.findIndex((e=>e.userId===t.metric.userId&&e.type===t.metric.type));return-1!==n?(i[n]=xw(xw({},i[n]),t.metric),xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{subscribe:[...i]})})):xw(xw({},e),{},{keyMetrics:xw(xw({},e.keyMetrics),{},{subscribe:[...e.keyMetrics.subscribe,t.metric]})})}case Uw.SET_CLOUD_PROXY_SERVER_MODE:return e.cloudProxyServerMode=t.mode,e;case Uw.RECORD_JOIN_CHANNEL_SERVICE:return"number"!=typeof t.index?e.joinChannelServiceRecords=[...e.joinChannelServiceRecords,t.record]:(e.joinChannelServiceRecords[t.index]=xw(xw({},e.joinChannelServiceRecords[t.index]),t.record),e.joinChannelServiceRecords=[...e.joinChannelServiceRecords]),e;case Uw.RESET_JOIN_CHANNEL_SERVICE_RECORDS:return e.joinChannelServiceRecords=[],e;case Uw.RESET_KEY_METRICS:return e.keyMetrics={publish:[],subscribe:[]},e;case Uw.SET_USE_DATACHANNEL:return xw(xw({},e),{},{useDataChannel:t.val});case Uw.SET_USE_P2P:return xw(xw({},e),{},{useP2P:t.val});case Uw.SET_TRANSPORT_TYPE:return xw(xw({},e),{},{p2pTransport:t.val});default:return e}}(this.state,e)}set sessionId(e){this.dispatch({type:Uw.SET_SESSION_ID,sessionId:e})}get sessionId(){return this.state.sessionId}set codec(e){this.state.codec=e}get codec(){return this.state.codec}get mode(){return this.state.mode}get audioCodec(){return this.state.audioCodec}get clientId(){return this.state.clientId}set p2pId(e){this.dispatch({type:Uw.SET_P2P_ID,p2pId:e})}get p2pId(){return this.state.p2pId}set dcId(e){this.dispatch({type:Uw.SET_DC_ID,dcId:e})}get dcId(){return this.state.dcId}set uid(e){this.dispatch({type:Uw.SET_UID,uid:e})}get uid(){return this.state.uid}set intUid(e){this.dispatch({type:Uw.SET_INT_UID,intUid:e})}get intUid(){return this.state.intUid}set pubId(e){this.dispatch({type:Uw.SET_PUB_ID,pubId:e})}get pubId(){return this.state.pubId}set cloudProxyServerMode(e){this.dispatch({type:Uw.SET_CLOUD_PROXY_SERVER_MODE,mode:e})}get cloudProxyServerMode(){return this.state.cloudProxyServerMode}set useDataChannel(e){this.dispatch({type:Uw.SET_USE_DATACHANNEL,val:e})}get useDataChannel(){return this.state.useDataChannel}set useP2P(e){this.dispatch({type:Uw.SET_USE_P2P,val:e})}get useP2P(){return this.state.useP2P}set p2pTransport(e){this.dispatch({type:Uw.SET_TRANSPORT_TYPE,val:e})}get p2pTransport(){return this.state.p2pTransport}clientCreated(){this.dispatch({type:Uw.KEY_METRIC_CLIENT_CREATED,metric:Date.now()})}joinStart(){this.dispatch({type:Uw.KEY_METRIC_JOIN_START,metric:Date.now()})}joinEnd(){this.dispatch({type:Uw.KEY_METRIC_JOIN_END,metric:Date.now()})}requestAPStart(){this.dispatch({type:Uw.KEY_METRIC_REQUEST_AP_START,metric:Date.now()})}requestAPEnd(){this.dispatch({type:Uw.KEY_METRIC_REQUEST_AP_END,metric:Date.now()})}joinGatewayStart(){this.dispatch({type:Uw.KEY_METRIC_JOIN_GATEWAY_START,metric:Date.now()})}joinGatewayEnd(){this.dispatch({type:Uw.KEY_METRIC_JOIN_GATEWAY_END,metric:Date.now()})}peerConnectionStart(){this.dispatch({type:Uw.KEY_METRIC_PEER_CONNECTION_START,metric:Date.now()})}peerConnectionEnd(){this.dispatch({type:Uw.KEY_METRIC_PEER_CONNECTION_END,metric:Date.now()})}descriptionStart(){this.dispatch({type:Uw.KEY_METRIC_DESCRIPTION_START,metric:Date.now()})}signalChannelOpen(){this.dispatch({type:Uw.KEY_METRIC_SIGNAL_CHANNEL_OPEN,metric:Date.now()})}iceConnectionEnd(){this.dispatch({type:Uw.KEY_METRIC_ICE_CONNECTION_END,metric:Date.now()})}publish(e,t,i,n){this.dispatch({type:Uw.KEY_METRIC_PUBLISH,metric:xw(xw({trackId:e,type:t},i&&{publishStart:i}),n&&{publishEnd:n})})}subscribe(e,t,i,n,r,o,s){this.dispatch({type:Uw.KEY_METRIC_SUBSCRIBE,metric:xw(xw(xw(xw(xw({userId:e,type:t},i&&{subscribeStart:i}),n&&{subscribeEnd:n}),r&&{firstFrame:r}),o&&{streamAdded:o}),s&&{firstDecoded:s})})}massSubscribe(e,t,i,n){e.forEach((e=>{this.dispatch({type:Uw.KEY_METRIC_SUBSCRIBE,metric:xw(xw(xw({userId:e.userId,type:e.type},t&&{subscribeStart:t}),i&&{subscribeEnd:i}),n&&{firstFrame:n})})}))}get keyMetrics(){return this.state.keyMetrics}recordJoinChannelService(e,t){"gateway"===e.service&&Array.isArray(e.urls)&&(e.urls=e.urls.map((e=>e.replace(/(\d+)-\d+-\d+-(\d+)/,"$1-*-*-$2"))));try{return"number"!=typeof t?(this.dispatch({type:Uw.RECORD_JOIN_CHANNEL_SERVICE,record:xw(xw({},e),{},{sessionId:this.sessionId,cloudProxyMode:this.cloudProxyServerMode,uid:this.uid})}),this.state.joinChannelServiceRecords.length-1):(t<0||t>=this.state.joinChannelServiceRecords.length||this.dispatch({type:Uw.RECORD_JOIN_CHANNEL_SERVICE,record:e,index:t}),t)}catch(e){return 0}}resetJoinChannelServiceRecords(){this.dispatch({type:Uw.RESET_JOIN_CHANNEL_SERVICE_RECORDS})}resetKeyMetrics(){this.dispatch({type:Uw.RESET_KEY_METRICS})}get joinChannelServiceRecords(){try{return this.state.joinChannelServiceRecords}catch(e){return[]}}get avoidJoinStart(){return this.state.avoidJoinStart}set avoidJoinStart(e){this.dispatch({type:Uw.AVOID_JOIN_START,avoidJoinStart:e})}}!function(e){e.h264="h264",e.h265="h265",e.vp8="vp8",e.vp9="vp9",e.av1="av1"}(Vw||(Vw={})),function(e){e.opus="opus",e.pcma="pcma",e.pcmu="pcmu",e.g722="g722"}(Bw||(Bw={}));const Fw=new class extends rE{reportLogUploadError(e){this.emit("REPORT_LOG_UPLOAD",e)}};class Ww{constructor(e){oh(this,"logger",void 0),oh(this,"prefixLists",[]),this.logger=e}debug(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.logger.debug(...this.prefixLists,...t)}info(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.logger.info(...this.prefixLists,...t)}warning(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.logger.warning(...this.prefixLists,...t)}error(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.logger.error(...this.prefixLists,...t)}prefix(e){return this.prefixLists.push(e),this}popPrefix(){return this.prefixLists.pop(),this}}function Gw(){const e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function Hw(){const e=new Date,t=/((\d+:){2}\d+)/.exec((new Date).toUTCString());return t?(null==t?void 0:t[0])+":"+e.getUTCMilliseconds():e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}const qw={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},Kw=Date.now(),zw=e=>{for(const t in qw)if(Object.prototype.hasOwnProperty.call(qw,t)&&qw[t]===e)return t;return"DEFAULT"},Yw=new class{constructor(){oh(this,"proxyServerURL",void 0),oh(this,"logLevel",qw.DEBUG),oh(this,"uploadState","collecting"),oh(this,"uploadLogWaitingList",[]),oh(this,"uploadLogUploadingList",[]),oh(this,"uploadErrorCount",0),oh(this,"currentLogID",0),oh(this,"url",void 0),oh(this,"extLog",((e,t)=>{this.appendLogToWaitingList(e,...t)}))}debug(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=[qw.DEBUG].concat(t);this.log.apply(this,n)}info(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=[qw.INFO].concat(t);this.log.apply(this,n)}warning(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=[qw.WARNING].concat(t);this.log.apply(this,n)}warn(){this.warning(...arguments)}error(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=[qw.ERROR].concat(t);this.log.apply(this,n)}upload(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const n=[qw.DEBUG].concat(t);this.uploadLog.apply(this,n)}setLogLevel(e){e=Math.min(Math.max(0,e),4),this.logLevel=e}enableLogUpload(){kw("UPLOAD_LOG",!0)}disableLogUpload(){kw("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}setProxyServer(e){this.proxyServerURL=e}prefix(e){return new Ww(this).prefix(e)}log(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(Date.now()-Kw<100)return void setTimeout((()=>{this.log(...t)}),Date.now()-Kw);const n=Math.max(0,Math.min(4,t[0]));if(t[0]=Gw()+" Agora-SDK [".concat(zw(n),"]:"),this.appendLogToWaitingList(n,...t),n<this.logLevel)return;const r=Gw()+" %cAgora-SDK [".concat(zw(n),"]:");let o=[];if(!Pw("USE_NEW_LOG"))switch(n){case qw.DEBUG:o=[r,"color: #64B5F6;"].concat(t.slice(1)),console.log.apply(console,o);break;case qw.INFO:o=[r,"color: #1E88E5; font-weight: bold;"].concat(t.slice(1)),console.log.apply(console,o);break;case qw.WARNING:o=[r,"color: #FB8C00; font-weight: bold;"].concat(t.slice(1)),console.warn.apply(console,o);break;case qw.ERROR:o=[r,"color: #B00020; font-weight: bold;"].concat(t.slice(1)),console.error.apply(console,o)}}uploadLog(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];if(Date.now()-Kw<100)return void setTimeout((()=>{this.uploadLog(...t)}),Date.now()-Kw);const n=Math.max(0,Math.min(4,t[0]));t[0]=Gw()+" Agora-SDK [".concat(zw(n),"]:"),this.appendLogToWaitingList(n,...t)}appendLogToWaitingList(e){if(!Pw("UPLOAD_LOG"))return;for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];Array.isArray(i[0])?i[0][0]=Hw()+" Agora-SDK [".concat(zw(e),"]:"):i[0]=Hw()+" Agora-SDK [".concat(zw(e),"]:");let r="";i.forEach((e=>{"object"==typeof e&&(e=JSON.stringify(e)),r+="".concat(e," ")})),this.uploadLogWaitingList.push({payload_str:r,log_level:e,log_item_id:this.currentLogID++}),"uploading"===this.uploadState&&0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}startUpload(){this.uploadState="uploading",0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}async uploadLogs(){const e=this.uploadLogUploadingList,t={sdk_version:Iw,process_id:Pw("PROCESS_ID"),payload:JSON.stringify(e)};return ZE((async()=>{const e=await gw.post(this.url||(this.proxyServerURL?"https://".concat(this.proxyServerURL,"/ls/?h=").concat(Pw("LOG_UPLOAD_SERVER"),"&p=443&d=upload/v1"):"https://".concat(Pw("LOG_UPLOAD_SERVER"),"/upload/v1")),t,{responseType:"text"});if("OK"!==e.data){const t=new Error("unexpected upload log response");throw t.response=e,t}}),(()=>(this.uploadLogUploadingList=[],!1)),(e=>(e.response?Fw.reportLogUploadError({status:e.response.status,data:e.response.data,headers:e.response.headers,message:e.message}):e.request?Fw.reportLogUploadError({status:e.request.status,message:e.message}):Fw.reportLogUploadError({status:-1,message:e.message}),!0)),{timeout:Pw("UPLOAD_LOG_REQUEST_RETRY_INTERVAL"),maxRetryTimeout:Pw("UPLOAD_LOG_REQUEST_MAX_RETRY_INTERVAL")})}uploadLogInterval(){0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=this.uploadLogWaitingList.splice(0,Pw("UPLOAD_LOG_LENGTH_EACH_TIME"))),this.uploadLogs().then((()=>{this.uploadErrorCount=0,this.uploadLogWaitingList.length>0&&window.setTimeout((()=>this.uploadLogInterval()),Pw("UPLOAD_LOG_INTERVAL"))})).catch((e=>{this.uploadErrorCount+=1,this.uploadErrorCount<2?window.setTimeout((()=>this.uploadLogInterval()),Pw("UPLOAD_LOG_TWICE_RETRY_INTERVAL_V1")):window.setTimeout((()=>this.uploadLogInterval()),Pw("UPLOAD_LOG_RETRY_INTERVAL_V1"))})))}};var Jw,Xw;function Qw(e){return qv(e.reportId,"params.reportId",0,100,!1),qv(e.category,"params.category",0,100,!1),qv(e.event,"params.event",0,100,!1),qv(e.label,"params.label",0,100,!1),Gv(e.value,"params.value",Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,!1),!0}!function(e){e.FREE="free",e.UPLOADING="uploading"}(Jw||(Jw={})),function(e){e[e.MISC=0]="MISC",e[e.INTERNAL_EVENT=1]="INTERNAL_EVENT",e[e.PUBLIC_EVENT=2]="PUBLIC_EVENT",e[e.WEB_EVENT=3]="WEB_EVENT",e[e.INTERNAL_API=4]="INTERNAL_API",e[e.WEB_API=5]="WEB_API",e[e.PUBLIC_API=6]="PUBLIC_API"}(Xw||(Xw={}));const Zw={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};var $w,eS,tS,iS;function nS(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function rS(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?nS(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):nS(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}!function(e){e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.WS_COMPRESSOR_INIT="ws_compressor_init",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.REJOIN_GATEWAY="rejoin_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics",e.PC_STATS="pc_stats",e.UPDATE_REMOTE_RTPCAPABILITIES="update_remote_rtpCapabilities"}($w||($w={})),function(e){e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAY="io.agora.pb.Wrtc.JoinGateway",e.RE_JOIN_GATEWAY="io.agora.pb.Wrtc.ReJoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.WS_COMPRESSOR_INIT="io.agora.pb.Wrtc.WsCompressorInit",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics",e.AUTOPLAY_FAILED="io.agora.pb.Wrtc.AutoplayFailed",e.PC_STATS="io.agora.pb.Wrtc.PCStats",e.UPDATE_REMOTE_RTPCAPABILITIES="io.agora.pb.Wrtc.UpdateRemoteRTPCapabilities"}(eS||(eS={})),function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(tS||(tS={})),function(e){e[e.SESSION=26]="SESSION",e[e.JOIN_CHOOSE_SERVER=27]="JOIN_CHOOSE_SERVER",e[e.REQ_USER_ACCOUNT=196]="REQ_USER_ACCOUNT",e[e.JOIN_GATEWAY=28]="JOIN_GATEWAY",e[e.PUBLISH=30]="PUBLISH",e[e.SUBSCRIBE=29]="SUBSCRIBE",e[e.WS_COMPRESSOR_INIT=9430]="WS_COMPRESSOR_INIT",e[e.STREAM_SWITCH=32]="STREAM_SWITCH",e[e.AUDIO_SENDING_STOPPED=33]="AUDIO_SENDING_STOPPED",e[e.VIDEO_SENDING_STOPPED=34]="VIDEO_SENDING_STOPPED",e[e.REQUEST_PROXY_APPCENTER=35]="REQUEST_PROXY_APPCENTER",e[e.REQUEST_PROXY_WORKER_MANAGER=36]="REQUEST_PROXY_WORKER_MANAGER",e[e.API_INVOKE=41]="API_INVOKE",e[e.FIRST_VIDEO_RECEIVED=348]="FIRST_VIDEO_RECEIVED",e[e.FIRST_AUDIO_RECEIVED=349]="FIRST_AUDIO_RECEIVED",e[e.FIRST_VIDEO_DECODE=350]="FIRST_VIDEO_DECODE",e[e.FIRST_AUDIO_DECODE=351]="FIRST_AUDIO_DECODE",e[e.ON_ADD_AUDIO_STREAM=352]="ON_ADD_AUDIO_STREAM",e[e.ON_ADD_VIDEO_STREAM=353]="ON_ADD_VIDEO_STREAM",e[e.ON_UPDATE_STREAM=356]="ON_UPDATE_STREAM",e[e.ON_REMOVE_STREAM=355]="ON_REMOVE_STREAM",e[e.JOIN_CHANNEL_TIMEOUT=407]="JOIN_CHANNEL_TIMEOUT",e[e.PEER_PUBLISH_STATUS=408]="PEER_PUBLISH_STATUS",e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT",e[e.JOIN_WEB_PROXY_AP=700]="JOIN_WEB_PROXY_AP",e[e.WEBSOCKET_QUIT=671]="WEBSOCKET_QUIT",e[e.USER_ANALYTICS=1e4]="USER_ANALYTICS",e[e.AUTOPLAY_FAILED=9178]="AUTOPLAY_FAILED"}(iS||(iS={}));class oS{constructor(){oh(this,"baseInfoMap",new Map),oh(this,"proxyServer",void 0),oh(this,"eventUploadTimer",void 0),oh(this,"setSessionIdTimer",void 0),oh(this,"url",void 0),oh(this,"backupUrl",void 0),oh(this,"_appId",void 0),oh(this,"keyEventUploadPendingItems",[]),oh(this,"normalEventUploadPendingItems",[]),oh(this,"apiInvokeUploadPendingItems",[]),oh(this,"apiInvokeCount",0),oh(this,"ltsList",[]),oh(this,"lastSendNormalEventTime",Date.now()),oh(this,"customReportCounterTimer",void 0),oh(this,"customReportCount",0),oh(this,"extApiInvoke",(async e=>{for(const t of e){const e=rS(rS({},t),{},{sid:null,invokeId:++this.apiInvokeCount,tag:cE.TRACER});this.sendApiInvoke(e)}})),this.eventUploadTimer=window.setInterval(this.doSend.bind(this),Pw("EVENT_REPORT_SEND_INTERVAL")),this.setSessionIdTimer=window.setInterval(this.appendSessionId.bind(this),Pw("EVENT_REPORT_SEND_INTERVAL"))}getBaseInfoBySessionId(e){return this.baseInfoMap.get(e)}adjustSessionStartTime(e){if(!this.baseInfoMap.has(e)&&!this.baseInfoMap.get(e))return void Yw.error("adjust session ".concat(e," start time, sid is not exist or info is undefined"));const t=this.baseInfoMap.get(e),i=Date.now(),n=t.startTime;t.startTime=i,Yw.debug("rewrite session ".concat(e," startTime: ").concat(i," , ").concat(i-n,"ms")),this.baseInfoMap.set(e,t)}setAppId(e){this._appId=e}reportApiInvoke(e,t,i){t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;const n=Date.now();this.apiInvokeCount+=1;const r=this.apiInvokeCount,o=()=>({tag:t.tag,invokeId:r,sid:e,name:t.name,apiInvokeTime:n,options:t.options,states:t.states||null}),s=!!Pw("SHOW_REPORT_INVOKER_LOG");s&&Yw.info("".concat(t.name," start"),t.options);let a=!1;VE(t.timeout).then((()=>{a||(this.sendApiInvoke(rS(rS({},o()),{},{error:Bv.API_INVOKE_TIMEOUT,success:!1})),Yw.debug("".concat(t.name," timeout")))}));const c=new jv(Bv.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:e=>{const n=()=>{if(a)throw c;return a=!0,this.sendApiInvoke(rS(rS({},o()),{},{success:!0},t.reportResult&&{result:e})),s&&Yw.info("".concat(t.name," onSuccess")),e};return i?GE(n,t.name+"Success",i,(()=>a=!0)):n()},onError:e=>{const n=()=>{if(a)throw e;a=!0,this.sendApiInvoke(rS(rS({},o()),{},{success:!1,error:e})),s&&Yw.info("".concat(t.name," onFailure"),e.toString())};return i?GE(n,t.name+"Error",i,(()=>a=!0)):n()}}}sessionInit(e,t){if(this.baseInfoMap.has(e))return;const i=Date.now(),n=this.createBaseInfo(e,i);n.cname=t.cname;const r=Object.assign({},{willUploadConsoleLog:Pw("UPLOAD_LOG"),maxTouchPoints:navigator.maxTouchPoints,areaVersion:Aw?"global":"oversea",areas:Pw("AREAS")&&Pw("AREAS").join(",")},t.extend),{stringUid:o,channelProfile:s,channelMode:a,isABTestSuccess:c,lsid:u,clientRole:d}=t,l=Date.now(),h=rS(rS({},n),{},{eventType:$w.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,build:Mw,lts:l,elapse:l-i,extend:JSON.stringify(r),mode:t.mode,process:Pw("PROCESS_ID"),appType:Pw("APP_TYPE"),success:!0,version:Iw,stringUid:o,channelProfile:s,channelMode:a,isABTestSuccess:c,lsid:u,clientType:20,clientRole:d,serviceId:Pw("PROCESS_ID"),extensionID:Pw("PLUGIN_INFO").join(",")||""});this.send({type:eS.SESSION,data:h},!0)}joinChooseServer(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS({},n),{},{eventType:$w.JOIN_CHOOSE_SERVER,lts:r,eventElapse:r-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:r-i.startTime,success:t.succ,chooseServerAddrList:JSON.stringify(t.serverList),uid:t.uid?parseInt(t.uid):null,cid:t.cid?parseInt(t.cid):null,chooseServerIp:t.csIp||"",opid:t.opid,unilbsServerIds:t.unilbsServerIds,extend:t.extend||void 0,isHttp3:t.isHttp3});this.send({type:eS.JOIN_CHOOSE_SERVER,data:o},!0)}reqUserAccount(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS({},n),{},{eventType:$w.REQ_USER_ACCOUNT,lts:r,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:r-i.startTime,eventElapse:r-t.lts,extend:JSON.stringify(t.extend)});this.send({type:eS.REQ_USER_ACCOUNT,data:o},!0)}joinGateway(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info;t.vid&&(n.vid=t.vid),n.uid=t.uid,n.cid=t.cid;const r=Date.now(),{firstSuccess:o,avoidJoinStartTime:s,isProxy:a,addr:c}=t,u=r-(o&&s?s:i.startTime),d=rS(rS({},n),{},{eventType:$w.JOIN_GATEWAY,lts:r,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,elapse:u,eventElapse:r-t.lts,firstSuccess:o,signalChannel:t.signalChannel}),l=d.success?1:0;if(t.succ&&(i.lastJoinSuccessTime=r),o)this.send({type:eS.JOIN_GATEWAY,data:d},!0);else{let e;if(c)if(a){const t=c.match(/h=(\d{1,3}-){3}\d{1,3}/g),i=c.match(/p=[0-9]{1,6}/g);e={isSuccess:l,gatewayIp:t&&t.length?t[0].split("=")[1].replace(/-/g,"."):"",port:i&&i.length?i[0].split("=")[1]:"",isProxy:a?1:0}}else{const t=c.match(/wss:\/\/(\d{1,3}-){3}\d{1,3}/g),i=c.match(/(:|p=)[0-9]{1,6}/g);e={isSuccess:l,gatewayIp:t&&t.length?t[0].split("//")[1].replace(/-/g,"."):"",port:i&&i.length?i[0].split(/:|p=/g)[1]:"",isProxy:a?1:0}}else e={isSuccess:l,gatewayIp:"",port:"",isProxy:a?1:0};delete d.success,delete d.eventType,delete d.firstSuccess,d.vid=Number(d.vid);const t=Object.assign({},d,e,{eventType:$w.REJOIN_GATEWAY});this.send({type:eS.RE_JOIN_GATEWAY,data:t},!0)}}joinChannelTimeout(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=Date.now(),r=rS(rS({},i.info),{},{lts:n,timeout:t,elapse:n-i.startTime});this.send({type:eS.JOIN_CHANNEL_TIMEOUT,data:r},!0)}publish(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS({},n),{},{eventType:$w.PUBLISH,lts:r,eventElapse:t.eventElapse,elapse:r-i.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid});this.send({type:eS.PUBLISH,data:o},!0)}subscribe(e,t,i){const n=this.baseInfoMap.get(e);if(!n)return;const r=n.info,o=Date.now(),s=rS(rS({},r),{},{eventType:$w.SUBSCRIBE,lts:o,eventElapse:t.eventElapse,elapse:o-n.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid},i&&{extend:JSON.stringify({isMassSubscribe:!0})});"string"==typeof t.peerid?s.peerSuid=t.peerid:s.peer=t.peerid,this.send({type:eS.SUBSCRIBE,data:s},!0)}wsCompressorInit(e){var t;const i=[...fh(t=this.baseInfoMap).call(t)],n=i.length?i[0]:"UnableToGetSid",r=this.baseInfoMap.get(n);if(!r)return;const o=r.info,s=Date.now(),a=rS(rS({},o),{},{eventType:$w.WS_COMPRESSOR_INIT,lts:s,eventElapse:e.eventElapse,elapse:s-r.startTime,status:e.status?1:2});this.send({type:eS.WS_COMPRESSOR_INIT,data:a},!0)}firstRemoteVideoDecode(e,t,i,n){const r=this.baseInfoMap.get(e);if(!r)return;const o=r.info,s=Date.now(),a=rS(rS(rS({},o),n),{},{elapse:s-r.startTime,eventType:t,lts:s,firstDecodeFrame:Math.max(s-r.startTime,0),apEnd:Math.max(n.apEnd-r.startTime,0),apStart:Math.max(n.apStart-r.startTime,0),joinGwEnd:Math.max(n.joinGwEnd-r.startTime,0),joinGwStart:Math.max(n.joinGwStart-r.startTime,0),pcEnd:Math.max(n.pcEnd-r.startTime,0),pcStart:Math.max(n.pcStart-r.startTime,0),subscriberEnd:Math.max(n.subscriberEnd-r.startTime,0),subscriberStart:Math.max(n.subscriberStart-r.startTime,0),videoAddNotify:Math.max(n.videoAddNotify-r.startTime,0)});this.send({type:i,data:a},!0)}firstRemoteFrame(e,t,i,n){const r=this.baseInfoMap.get(e);if(!r)return;const o=r.info,s=Date.now(),a=rS(rS(rS({},o),n),{},{elapse:s-r.startTime,eventType:t,lts:s});this.send({type:i,data:a},!0)}pcStats(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS(rS({},n),t),{},{vid:void 0===n.vid?0:Number(n.vid),elapse:r-i.startTime,eventType:$w.PC_STATS,lts:r});this.send({type:eS.PC_STATS,data:o},!0)}updateRemoteRTPCapabilities(e,t){if(e){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS(rS({},n),t),{},{vid:void 0===n.vid?0:Number(n.vid),eventType:$w.UPDATE_REMOTE_RTPCAPABILITIES,lts:r});this.send({type:eS.UPDATE_REMOTE_RTPCAPABILITIES,data:o},!0)}}onGatewayStream(e,t,i,n){const r=this.baseInfoMap.get(e);if(!r)return;const o=r.info,s=Date.now(),a=rS(rS(rS({},o),n),{},{eventType:t,lts:s});this.send({type:i,data:a},!0)}streamSwitch(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS({},n),{},{eventType:$w.STREAM_SWITCH,lts:r,isDual:t.isdual,elapse:r-i.startTime,success:t.succ});this.send({type:eS.STREAM_SWITCH,data:o},!0)}requestProxyAppCenter(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS({},n),{},{eventType:$w.REQUEST_PROXY_APPCENTER,lts:r,eventElapse:r-t.lts,elapse:r-i.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:eS.REQUEST_PROXY_APPCENTER,data:o},!0)}requestProxyWorkerManager(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS({},n),{},{eventType:$w.REQUEST_PROXY_WORKER_MANAGER,lts:r,eventElapse:r-t.lts,elapse:r-i.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ});this.send({type:eS.REQUEST_PROXY_WORKER_MANAGER,data:o},!0)}setProxyServer(e){this.proxyServer=e,e?Yw.debug("reportProxyServerurl: ".concat(e)):Yw.debug("disable reportProxyServerurl: ".concat(e))}peerPublishStatus(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS({},n),{},{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:t.audioPublishDuration>0?1:-1,videotag:t.videoPublishDuration>0?1:-1,lts:r,elapse:r-i.startTime,joinChannelSuccessElapse:r-(i.lastJoinSuccessTime||r),peerPublishDurationVideo:t.videoPublishDuration,peerPublishDurationAudio:t.audioPublishDuration});this.send({type:eS.PEER_PUBLISH_STATUS,data:o},!0)}workerEvent(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=function(e,t,i){const n=e[t];if(!n||"string"!=typeof n)return[e];e[t]="";const r=LE(JSON.stringify(e));let o=0;const s=[];let a=0;for(let c=0;c<n.length;c++)a+=n.charCodeAt(c)<=127?1:3,a<=i-r||(s[s.length]=RE(RE({},e),{},{[t]:n.substring(o,c)}),o=c,a=n.charCodeAt(c)<=127?1:3);return o!==n.length-1&&(s[s.length]=RE(RE({},e),{},{[t]:n.substring(o)})),s}(rS(rS(rS({},n),t),{},{elapse:r-i.startTime,lts:r,productType:"WebRTC"}),"payload",1300);o.forEach((e=>this.send({type:eS.WORKER_EVENT,data:e},!0)))}apworkerEvent(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS(rS({},n),t),{},{elapse:r-i.startTime,lts:r});this.send({type:eS.AP_WORKER_EVENT,data:o},!0)}joinWebProxyAP(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS(rS({},n),t),{},{elapse:r-i.startTime,lts:r,extend:t.extend||void 0});this.send({type:eS.JOIN_WEB_PROXY_AP,data:o},!0)}WebSocketQuit(e,t){const i=this.baseInfoMap.get(e);if(!i)return;const n=i.info,r=Date.now(),o=rS(rS(rS({},n),t),{},{elapse:r-i.startTime,lts:r});this.send({type:eS.WEBSOCKET_QUIT,data:o},!0)}async sendCustomReportMessage(e,t){if(this.customReportCount+=t.length,this.customReportCount>Pw("CUSTOM_REPORT_LIMIT"))throw new jv(Bv.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval((()=>{this.customReportCount=0}),5e3));const i=Date.now(),n=t.map((t=>({type:eS.USER_ANALYTICS,data:rS(rS({sid:e},t),{},{lts:i})})));try{Pw("NEW_REPORT_SERVER")?await this.postDataToStatsCollector2(n):await this.postDataToStatsCollector(n)}catch(e){throw Yw.error("send custom report message failed",e.toString()),new jv(Bv.CUSTOM_REPORT_SEND_FAILED,e.message)}}sendApiInvoke(e){const t=Pw("NOT_REPORT_EVENT");if(e.tag&&Mn(t)&&Mn(t).call(t,e.tag))return!1;if(null===e.sid)return this.apiInvokeUploadPendingItems.push(e),!1;const i=this.baseInfoMap.get(e.sid);if(!i)return this.apiInvokeUploadPendingItems.push(e),!1;const{cname:n,uid:r,cid:o}=i.info;let s;if(e.lts=e.lts||Date.now(),e.error)if(e.error instanceof jv){const{code:t,message:i}=e.error;s=t||i||e.error.toString()}else s=e.error.toString();const a={invokeId:e.invokeId,sid:e.sid,cname:n,cid:o,uid:r,lts:e.lts,success:e.success,elapse:e.lts-i.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?JSON.stringify(e.options):void 0,execStates:e.states?JSON.stringify(e.states):void 0,execResult:e.result?JSON.stringify(e.result):void 0,errorCode:e.error?s:void 0,errorMsg:e.error?JSON.stringify(e.error):void 0};return this.send({type:eS.API_INVOKE,data:a},!1),!0}appendSessionId(){oS.__CLIENT_LIST__.forEach((e=>{if(e._sessionId){const t=this.apiInvokeUploadPendingItems.length;for(let i=0;i<t;i++){const t=this.apiInvokeUploadPendingItems.shift();t&&(t.sid=e._sessionId,this.sendApiInvoke(Object.assign({},t)))}}}))}send(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>Pw("NORMAL_EVENT_QUEUE_CAPACITY")&&this.normalEventUploadPendingItems.splice(0,1),this.normalEventUploadPendingItems.length>=10&&this.sendItems(this.normalEventUploadPendingItems,!1)}doSend(){this.keyEventUploadPendingItems.length>0&&this.sendItems(this.keyEventUploadPendingItems,!0),this.normalEventUploadPendingItems.length>0&&Date.now()-this.lastSendNormalEventTime>=5e3&&this.sendItems(this.normalEventUploadPendingItems,!1)}sendItems(e,t){const i=[],n=[];for(;e.length;){const t=e.shift();i.length<20?i.push(t):n.push(t)}e.push(...n);for(const o of[...i]){var r;-1!==this.ltsList.indexOf(o.data.lts)?(o.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(o.data.lts)):(this.ltsList.push(o.data.lts),ef(r=this.ltsList).call(r,((e,t)=>e-t)))}return t||(this.lastSendNormalEventTime=Date.now()),Pw("ENABLE_EVENT_REPORT")?(i.length&&(Pw("NEW_REPORT_SERVER")?this.postDataToStatsCollector2(i):this.postDataToStatsCollector(i)).catch((e=>i=>{Pw("EVENT_REPORT_RETRY")&&(t?this.keyEventUploadPendingItems=this.keyEventUploadPendingItems.concat(e):(this.normalEventUploadPendingItems=this.normalEventUploadPendingItems.concat(e),this.normalEventUploadPendingItems.length>Pw("NORMAL_EVENT_QUEUE_CAPACITY")&&(this.normalEventUploadPendingItems.splice(0,this.normalEventUploadPendingItems.length-Pw("NORMAL_EVENT_QUEUE_CAPACITY")),Yw.warning("report: drop normal events"))))})(i)),e):e}async postDataToStatsCollector2(e){SE.networkState===fE.OFFLINE&&await nv.race([SE.onlineWaiter,VE(2*XE.maxRetryTimeout)]);const t=e=>{let t=new Uint8Array;return e.forEach((e=>{const i=eE(JSON.stringify(e.data)),n=new ArrayBuffer(5),r=(e=>{let t=0;return Object.entries(eS).forEach((i=>{let[n,r]=i;r===e.type&&(t=EventNameToID[n])})),t})(e),o=new DataView(n);o.setUint16(0,i.byteLength,!0),o.setUint8(2,255&r),o.setUint8(3,r>>>8&255),o.setUint8(4,r>>>16&255),t=tE(t,new Uint8Array(n)),t=tE(t,i)})),t},i="event";let n=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Pw("NEW_REPORT_SERVER_DOMAINS")[0],"&p=443&d=").concat(i):"https://".concat(Pw("NEW_REPORT_SERVER_DOMAINS")[0],"/").concat(i);for(let r=0;r<2;r+=1){1===r&&(n=this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Pw("NEW_REPORT_SERVER_DOMAINS")[1],"&p=443&d=").concat(i):"https://".concat(Pw("NEW_REPORT_SERVER_DOMAINS")[1],"/").concat(i));try{await Sw(n,{timeout:1e4,data:t(e),headers:rS(rS({biz:"webrtc",sendts:Math.round(Date.now()/1e3),debug:"false"},this._appId&&{appid:this._appId}),{},{"Content-Type":"application/octet-stream"})},!0)}catch(e){if(1===r)throw e;continue}return}}async postDataToStatsCollector(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i={msgType:"EventMessages",sentTs:Math.round(Date.now()/1e3),payloads:e.map((e=>JSON.stringify(e))),vid:(e=>{const t=e&&e.data.sid&&this.baseInfoMap.get(e.data.sid);return t&&t.info.vid&&+t.info.vid||0})(e[0])};SE.networkState===fE.OFFLINE&&await nv.race([SE.onlineWaiter,VE(2*XE.maxRetryTimeout)]);const n=t?"/events/proto-raws":"/events/messages";let r=this.url||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Pw("EVENT_REPORT_DOMAIN"),"&p=").concat(Pw("STATS_COLLECTOR_PORT"),"&d=").concat(n):"https://".concat(Pw("EVENT_REPORT_DOMAIN"),":").concat(Pw("STATS_COLLECTOR_PORT")).concat(n));for(let o=0;o<2;o+=1){1===o&&(r=this.backupUrl||(this.proxyServer?"https://".concat(this.proxyServer,"/rs/?h=").concat(Pw("EVENT_REPORT_BACKUP_DOMAIN"),"&p=").concat(Pw("STATS_COLLECTOR_PORT"),"&d=").concat(n):"https://".concat(Pw("EVENT_REPORT_BACKUP_DOMAIN"),":").concat(Pw("STATS_COLLECTOR_PORT")).concat(n)));try{t?await Tw(r,{timeout:1e4,data:i}):await Sw(r,{timeout:1e4,data:i})}catch(t){if(1===o)throw t;continue}return}}createBaseInfo(e,t){const i=Object.assign({},Zw);return i.sid=e,this.baseInfoMap.set(e,{info:i,startTime:t}),i}reportResourceTiming(e,t){const i=performance.getEntriesByName(e),n=i[i.length-1];n&&this.reportApiInvoke(t,{name:"Client.resourceTiming",options:n,tag:cE.TRACER}).onSuccess()}}function sS(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t,i,n){const r=n.value;if("function"==typeof r){const o=e.className||t.__className__||("AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name);n.value=function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];let a=n;if(e.argsMap)try{a=e.argsMap(this,...n)}catch(e){Yw.warning(e),a=[]}try{JSON.stringify(a)}catch(e){Yw.warning("arguments for method ".concat(o,".").concat(String(i)," not serializable for apiInvoke.")),a=[]}const c=(e.report||aS).reportApiInvoke(this._sessionId||null,{name:"".concat(o,".").concat(String(i)),options:a,tag:cE.TRACER,reportResult:e.reportResult},e.throttleTime);try{const t=r.apply(this,n);return t instanceof nv?t.then((t=>(c.onSuccess(e.reportResult&&t),t))).catch((e=>{throw c.onError(e),e})):(c.onSuccess(e.reportResult&&t),t)}catch(e){throw c.onError(e),e}}}return n}}oh(oS,"__CLIENT_LIST__",[]);const aS=new oS;Fw.on("REPORT_LOG_UPLOAD",(e=>{e.networkState=SE.networkState,aS.reportApiInvoke(null,{name:"logUploadError",options:e,tag:cE.TRACER})}));const cS=["CHINA","GLOBAL"],uS=function(){const e="us".concat("erna","me"),t="pa".concat("sswo","rd"),i=["t","s","t"];i.splice(1,0,"e");const n=i.join(""),r=[];for(let a=0;a<6;a++)r.push("1");const o=r.join(""),s={};return s[e]=n,s[t]=o,Object.assign(s,{turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1})}();window.DEFAULT_TURN_CONFIG=uS,Aw||(Nw.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Nw.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Nw.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Nw.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Nw.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Nw.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Nw.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Nw.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Nw.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Nw.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Nw.AREAS=["NORTH_AMERICA","OVERSEA"]);const dS=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],lS=[];function hS(e,t){return!!t&&lS.some((i=>i.uid===e&&i.channelName===t))}oS.__CLIENT_LIST__=lS;var fS,pS,mS,_S,gS,vS,ES,bS,yS,wS,SS,TS,RS,CS,IS,AS,OS,MS=Qi("Array").values,NS=fn,kS=tt,PS=f,DS=MS,LS=Array.prototype,xS={DOMTokenList:!0,NodeList:!0},US=o((function(e){var t=e.values;return e===LS||PS(LS,e)&&t===LS.values||kS(xS,NS(e))?DS:t}));function VS(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s}function BS(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}!function(e){e.L1T1="L1T1",e.L1T2="L1T2",e.L1T3="L1T3",e.L2T1_KEY="L2T1_KEY",e.L2T2_KEY="L2T2_KEY",e.L2T3_KEY="L2T3_KEY",e.L3T1_KEY="L3T1_KEY",e.L3T2_KEY="L3T2_KEY",e.L3T3_KEY="L3T3_KEY"}(fS||(fS={})),function(e){e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver"}(pS||(pS={})),function(e){e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(mS||(mS={})),function(e){e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(_S||(_S={})),function(e){e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(gS||(gS={})),function(e){e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.FLAG_SET_BUT_NO_RE=103]="FLAG_SET_BUT_NO_RE",e[e.INVALID_SERVICE_ID=104]="INVALID_SERVICE_ID",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(vS||(vS={})),function(e){e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.K_AUTO_REBALANCE=28]="K_AUTO_REBALANCE",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TOO_MANY_BROADCASTERS=2031]="ERR_TOO_MANY_BROADCASTERS",e[e.ERR_TOO_MANY_SUBSCRIBERS=2032]="ERR_TOO_MANY_SUBSCRIBERS",e[e.ERR_LICENSE_MISSING=32769]="ERR_LICENSE_MISSING",e[e.ERR_LICENSE_EXPIRED=32771]="ERR_LICENSE_EXPIRED",e[e.ERR_LICENSE_MINUTES_EXCEEDED=32773]="ERR_LICENSE_MINUTES_EXCEEDED",e[e.ERR_LICENSE_PERIOD_INVALID=32774]="ERR_LICENSE_PERIOD_INVALID",e[e.ERR_LICENSE_MULTIPLE_SDK_SERVICE=32778]="ERR_LICENSE_MULTIPLE_SDK_SERVICE",e[e.ERR_LICENSE_ILLEGAL=32783]="ERR_LICENSE_ILLEGAL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(ES||(ES={})),function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed"}(bS||(bS={})),function(e){e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.WS_RECONNECT_WAITTING_FINISH="ws_reconnect_waitting_finish",e.WS_RECONNECT_CREATE_CONNECTION="ws_reconnect_create_connection",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.ABORT_P2P_EXECUTION="abort_p2p_execution",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success",e.JOIN_RESPONSE="join_response",e.DATACHANNEL_PRECONNECT="datachannel_preconnect",e.DATACHANNEL_CONNECTING="datachannel_connecting",e.DATACHANNEL_FAILBACK="datachannel_failback",e.P2P_CONNECTION="p2p_connection",e.P2P_REMOTE_CANDIDATE_UPDATE="p2p_remote_candidate_update",e.P2P_SUBSCRIBE="p2p_subscribe",e.P2P_UNSUBSCRIBE="p2p_unsubscribe",e.P2P_EXCHANGE_SDP="p2p_exchange_sdp",e.P2P_ON_ADD_VIDEO_STREAM="p2p_on_add_video_stream",e.P2P_ON_ADD_AUDIO_STREAM="p2p_on_add_audio_stream"}(yS||(yS={})),function(e){e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v3",e.REJOIN="rejoin_v3",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.PUBLISH_DATASTREAM="publish_datastream",e.UNPUBLISH="unpublish",e.UNPUBLISH_DATASTREAM="unpublish_datastream",e.SUBSCRIBE="subscribe",e.PRE_SUBSCRIBE="pre_subscribe",e.SUBSCRIBE_DATASTREAM="subscribe_datastream",e.SUBSCRIBE_STREAMS="subscribe_streams",e.UNSUBSCRIBE="unsubscribe",e.UNSUBSCRIBE_DATASTREAM="unsubscribe_datastream",e.UNSUBSCRIBE_STREAMS="unsubscribe_streams",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.DEFAULT_VIDEO_STREAM="default_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer",e.RESTART_ICE="restart_ice",e.CONNECT_PC="connect_pc",e.SET_VIDEO_PROFILE="set_video_profile",e.SET_PARAMETER="set_parameter",e.SET_RTM2_FLAG="set_rtm2_flag"}(wS||(wS={})),function(e){e.WRTC_STATS="wrtc_stats",e.WS_INFLATE_DATA_LENGTH="ws_inflate_data_length",e.DENOISER_STATS="denoiser_stats",e.EXTENSION_USAGE_STATS="extension_usage_stats"}(SS||(SS={})),function(e){e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_USER_LICENSE_BANNED="on_user_license_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.ON_P2P_OK="on_p2p_ok",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ON_RTP_CAPABILITY_CHANGE="on_rtp_capability_change",e.ON_REMOTE_DATASTREAM_UPDATE="on_remote_datastream_update",e.ON_REMOTE_FULL_DATASTREAM_INFO="on_remote_full_datastream_info",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio",e.ON_PUBLISHED_USER_LIST="on_published_user_list"}(TS||(TS={})),function(e){e.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",e.NEED_ANSWER="NEED_ANSWER",e.NEED_RENEGOTIATE="NEED_RENEGOTIATE",e.P2P_LOST="P2P_LOST",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NEED_UNPUB="NEED_UNPUB",e.NEED_UNSUB="NEED_UNSUB",e.NEED_UPLOAD="NEED_UPLOAD",e.NEED_CONTROL="NEED_CONTROL",e.START_RECONNECT="START_RECONNECT",e.END_RECONNECT="END_RECONNECT",e.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(RS||(RS={})),function(e){e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY"}(CS||(CS={})),function(e){e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls",e.RECONNECT_WAITTING_FINISH="websocket:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="websocket:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="websocket:on_token_privilege_did_expire"}(IS||(IS={}));class jS extends jv{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",arguments.length>2?arguments[2]:void 0),oh(this,"name","AgoraRTCException")}print(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error";return super.print(e,Yw)}throw(){super.throw(Yw)}}function FS(e){if("string"!=typeof e||!/^[a-zA-Z0-9 \!\#\$\%\&\(\)\+\-\:\;\<\=\.\>\?\@\[\]\^\_\{\}\|\~\,]{1,64}$/.test(e))throw Yw.error("Invalid Channel Name ".concat(e)),new jS(Bv.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function WS(e){if(!("number"==typeof(t=e)&&Math.floor(t)===t&&0<=t&&t<=4294967295||Yv(e,1,255)))throw new jS(Bv.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]");var t;"string"==typeof e&&Yw.warn("You input a string as the user ID, to ensure better end-user experience, Agora highly suggests not using a string as the user ID.")}!function(e){e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e.INJECT="inject_streaming"}(AS||(AS={})),function(e){e[e.INJECT_STREAM_STATUS_START_SUCCESS=0]="INJECT_STREAM_STATUS_START_SUCCESS",e[e.INJECT_STREAM_STATUS_START_ALREADY_EXISTS=1]="INJECT_STREAM_STATUS_START_ALREADY_EXISTS",e[e.INJECT_STREAM_STATUS_START_UNAUTHORIZED=2]="INJECT_STREAM_STATUS_START_UNAUTHORIZED",e[e.INJECT_STREAM_STATUS_START_TIMEOUT=3]="INJECT_STREAM_STATUS_START_TIMEOUT",e[e.INJECT_STREAM_STATUS_START_FAILED=4]="INJECT_STREAM_STATUS_START_FAILED",e[e.INJECT_STREAM_STATUS_STOP_SUCCESS=5]="INJECT_STREAM_STATUS_STOP_SUCCESS",e[e.INJECT_STREAM_STATUS_STOP_NOT_FOUND=6]="INJECT_STREAM_STATUS_STOP_NOT_FOUND",e[e.INJECT_STREAM_STATUS_STOP_UNAUTHORIZED=7]="INJECT_STREAM_STATUS_STOP_UNAUTHORIZED",e[e.INJECT_STREAM_STATUS_STOP_TIMEOUT=8]="INJECT_STREAM_STATUS_STOP_TIMEOUT",e[e.INJECT_STREAM_STATUS_STOP_FAILED=9]="INJECT_STREAM_STATUS_STOP_FAILED",e[e.INJECT_STREAM_STATUS_BROKEN=10]="INJECT_STREAM_STATUS_BROKEN"}(OS||(OS={}));const GS={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},HS={x:0,y:0,width:160,height:160,zOrder:255,alpha:1};function qS(e,t){qv(e.url,"".concat(t,".url"),1,1e3,!1),zv(e.x)||Gv(e.x,"".concat(t,".x"),0,1e4),zv(e.y)||Gv(e.y,"".concat(t,".y"),0,1e4),zv(e.width)||Gv(e.width,"".concat(t,".width"),0,1e4),zv(e.height)||Gv(e.height,"".concat(t,".height"),0,1e4),zv(e.zOrder)||Gv(e.zOrder,"".concat(t,".zOrder"),0,255),zv(e.alpha)||Gv(e.alpha,"".concat(t,".alpha"),0,1,!1)}const KS={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},zS={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};var YS,JS,XS,QS,ZS,$S,eT,tT,iT,nT,rT,oT,sT,aT;function cT(e){if(!e.channelName)throw new jS(Bv.INVALID_PARAMS,"invalid channelName in info");if("number"!=typeof e.uid)throw new jS(Bv.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&qv(e.token,"info.token",1,2047),WS(e.uid),FS(e.channelName),!0}!function(e){e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.INJECT_STREAM_STATUS="@live_uap-inject-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address"}(YS||(YS={})),function(e){e.REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager"}(JS||(JS={})),function(e){e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(XS||(XS={})),function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(QS||(QS={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(ZS||(ZS={})),function(e){e.NETWORK_DISCONNECTED="NETWORK_DISCONNECTED",e.NETWORK_CONNECTED="NETWORK_CONNECTED",e.PACKET_JOINED_SRC_CHANNEL="PACKET_JOINED_SRC_CHANNEL",e.PACKET_JOINED_DEST_CHANNEL="PACKET_JOINED_DEST_CHANNEL",e.PACKET_SENT_TO_DEST_CHANNEL="PACKET_SENT_TO_DEST_CHANNEL",e.PACKET_RECEIVED_VIDEO_FROM_SRC="PACKET_RECEIVED_VIDEO_FROM_SRC",e.PACKET_RECEIVED_AUDIO_FROM_SRC="PACKET_RECEIVED_AUDIO_FROM_SRC",e.PACKET_UPDATE_DEST_CHANNEL="PACKET_UPDATE_DEST_CHANNEL",e.PACKET_UPDATE_DEST_CHANNEL_REFUSED="PACKET_UPDATE_DEST_CHANNEL_REFUSED",e.PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE="PACKET_UPDATE_DEST_CHANNEL_NOT_CHANGE"}($S||($S={})),function(e){e.RELAY_STATE_IDLE="RELAY_STATE_IDLE",e.RELAY_STATE_CONNECTING="RELAY_STATE_CONNECTING",e.RELAY_STATE_RUNNING="RELAY_STATE_RUNNING",e.RELAY_STATE_FAILURE="RELAY_STATE_FAILURE"}(eT||(eT={})),function(e){e.RELAY_OK="RELAY_OK",e.SERVER_CONNECTION_LOST="SERVER_CONNECTION_LOST",e.SRC_TOKEN_EXPIRED="SRC_TOKEN_EXPIRED",e.DEST_TOKEN_EXPIRED="DEST_TOKEN_EXPIRED"}(tT||(tT={})),function(e){e.High="high",e.Low="low",e.Audio="audio",e.Screen="screen",e.ScreenLow="screen_low"}(iT||(iT={})),function(e){e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid",e.REQUEST_P2P_CONNECTION_PARAMS="request-p2p-connection-params",e.JOIN_RESPONSE="join-response",e.REQUEST_DC_CONNECTION_PARAMS="request-dc-connection-params",e.RESET_CONNECTION_EVENTS="reset-connection-events",e.DATACHANNEL_PRECONNECT="datachannel_preconnect",e.DATACHANNEL_FAILBACK="datachannel_failback",e.RESET_SIGNAL="reset-signal"}(nT||(nT={})),function(e){e.P2P_DISCONNECTED="P2P_DISCONNECTED",e.A_ROUND_WS_FAILED="A_ROUND_WS_FAILED",e.TIMEOUT="TIMEOUT",e.UNKNOWN_REASON="UNKNOWN_REASON"}(rT||(rT={})),function(e){e[e.Nothing=0]="Nothing",e[e.Audio=1]="Audio",e[e.LwoVideo=2]="LwoVideo",e[e.Video=4]="Video",e[e.Data=8]="Data",e[e.DataStream0=256]="DataStream0",e[e.DataStream1=512]="DataStream1",e[e.DataStream2=1024]="DataStream2",e[e.DataStream3=2048]="DataStream3",e[e.DataStream4=4096]="DataStream4",e[e.DataStream5=8192]="DataStream5",e[e.DataStream6=16384]="DataStream6",e[e.DataStream7=32768]="DataStream7"}(oT||(oT={})),function(e){e[e.websocket=0]="websocket",e[e.datachannel=1]="datachannel"}(sT||(sT={})),function(e){e.CHINA="CHINA",e.ASIA="ASIA",e.NORTH_AMERICA="NORTH_AMERICA",e.EUROPE="EUROPE",e.JAPAN="JAPAN",e.INDIA="INDIA",e.KOREA="KOREA",e.HKMC="HKMC",e.US="US",e.OCEANIA="OCEANIA",e.SOUTH_AMERICA="SOUTH_AMERICA",e.AFRICA="AFRICA",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="EXTENSIONS"}(aT||(aT={}));const uT=[aT.AFRICA,aT.ASIA,aT.CHINA,aT.EUROPE,aT.GLOBAL,aT.INDIA,aT.JAPAN,aT.NORTH_AMERICA,aT.OCEANIA,aT.OVERSEA,aT.SOUTH_AMERICA];var dT;!function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.KOREA="KR",e.HKMC="HK",e.US="US",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL",e.EXTENSIONS="GLOBAL"}(dT||(dT={}));const lT={CHINA:{},ASIA:{CODE:dT.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:dT.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:dT.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:dT.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","uap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:dT.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},KOREA:{CODE:dT.KOREA,WEBCS_DOMAIN:["ap-web-1-korea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-korea.agora.io"],PROXY_CS:["proxy-ap-web-korea.agora.io"],CDS_AP:["cds-ap-web-korea.agora.io","cds-ap-web-korea2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-korea.agora.io","sua-ap-web-korea2.agora.io"],UAP_AP:["uap-ap-web-korea.agora.io","uap-ap-web-korea2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-korea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-korea.agora.io"],LOG_UPLOAD_SERVER:["logservice-korea.agora.io"],PROXY_SERVER_TYPE3:["korea.webrtc-cloud-proxy.sd-rtn.com"]},HKMC:{CODE:dT.HKMC,WEBCS_DOMAIN:["ap-web-1-hkmc.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-hkmc.agora.io"],PROXY_CS:["proxy-ap-web-hkmc.agora.io"],CDS_AP:["cds-ap-web-hkmc.agora.io","cds-ap-web-hkmc2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-hkmc.agora.io","sua-ap-web-hkmc2.agora.io"],UAP_AP:["uap-ap-web-hkmc.agora.io","uap-ap-web-hkmc2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-hkmc.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-hkmc.agora.io"],LOG_UPLOAD_SERVER:["logservice-hkmc.agora.io"],PROXY_SERVER_TYPE3:["hkmc.webrtc-cloud-proxy.sd-rtn.com"]},US:{CODE:dT.US,WEBCS_DOMAIN:["ap-web-1-us.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-us.agora.io"],PROXY_CS:["proxy-ap-web-us.agora.io"],CDS_AP:["cds-ap-web-us.agora.io","cds-ap-web-us2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-us.agora.io","sua-ap-web-us2.agora.io"],UAP_AP:["uap-ap-web-us.agora.io","uap-ap-web-us2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-us.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-us.agora.io"],LOG_UPLOAD_SERVER:["logservice-us.agora.io"],PROXY_SERVER_TYPE3:["us.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:dT.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:dT.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:dT.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:dT.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:dT.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]},EXTENSIONS:{}};var hT,fT,pT,mT,_T,gT,vT,ET,bT,yT,wT,ST,TT,RT,CT,IT,AT,OT,MT,NT,kT,PT,DT,LT;Aw&&(lT.CHINA={CODE:dT.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),function(e){e.UPDATE_BITRATE_LIMIT="update_bitrate_limit"}(hT||(hT={}));class xT extends rE{constructor(e,t){super(),oh(this,"onICEConnectionStateChange",void 0),oh(this,"onConnectionStateChange",void 0),oh(this,"onDTLSTransportStateChange",void 0),oh(this,"onDTLSTransportError",void 0),oh(this,"onICETransportStateChange",void 0),oh(this,"onFirstAudioReceived",void 0),oh(this,"onFirstVideoReceived",void 0),oh(this,"onFirstAudioDecoded",void 0),oh(this,"onFirstVideoDecoded",void 0),oh(this,"onFirstVideoDecodedTimeout",void 0),oh(this,"onSelectedLocalCandidateChanged",void 0),oh(this,"onSelectedRemoteCandidateChanged",void 0)}}class UT extends xT{constructor(e,t){super(e,t)}}!function(e){e.SEND="sendonly",e.RECV="recvonly",e.SENDRECV="sendrecv",e.INACTIVE="inactive"}(fT||(fT={})),function(e){e.VIDEO="video",e.AUDIO="audio"}(pT||(pT={})),function(e){e[e.UDP=0]="UDP",e[e.TCP=1]="TCP",e[e.RELAY=2]="RELAY"}(mT||(mT={})),function(e){e[e.FIRST_CONNECTION=0]="FIRST_CONNECTION",e[e.TCP_RESTART=1]="TCP_RESTART",e[e.RELAY_RESTART=2]="RELAY_RESTART",e[e.OLD_FIRST_CONNECTION=10]="OLD_FIRST_CONNECTION",e[e.OLD_RESTART=11]="OLD_RESTART",e[e.DISCONNECTED_OR_FAILED=20]="DISCONNECTED_OR_FAILED"}(_T||(_T={})),function(e){e.LocalVideoTrack="videoTrack",e.LocalAudioTrack="audioTrack",e.LocalVideoLowTrack="videoLowTrack"}(gT||(gT={})),function(e){e.New="new",e.Connected="connected",e.Reconnecting="reconnecting",e.Disconnected="disconnected"}(vT||(vT={})),function(e){e.StateChange="stateChange",e.IceConnectionStateChange="iceConnectionStateChange",e.RequestMuteLocal="requestMuteLocal",e.RequestUnmuteLocal="requestUnmuteLocal",e.RequestRePublish="requestRePublish",e.RequestRePublishDataChannel="requestRePublishDataChannel",e.RequestReSubscribe="requestReSubscribe",e.RequestUploadStats="requestUploadStats",e.RequestUpload="requestUpload",e.MediaReconnectStart="MediaReconnectStart",e.MediaReconnectEnd="MediaReconnectEnd",e.NeedSignalRTT="NeedSignalRTT",e.RequestRestartICE="RequestRestartIce",e.PeerConnectionStateChange="PeerConnectionStateChange",e.RequestReconnect="RequestReconnect",e.RequestReconnectPC="RequestReconnectPC",e.RequestUnpublishForReconnectPC="RequestUnpublishForReconnectPC",e.P2PLost="P2PLost",e.UpdateVideoEncoder="UpdateVideoEncoder",e.ConnectionTypeChange="ConnectionTypeChange",e.RequestLowStreamParameter="RequestLowStreamParameter",e.QueryClientConnectionState="QueryClientConnectionState",e.LocalCandidate="LocalCandidate",e.RequestP2PMuteLocal="requestP2PMuteLocal",e.RequestP2PUnPublish="RequestP2PUnPublish",e.RequestP2PUnmuteRemote="RequestP2PUnmuteRemote",e.RequestP2PMuteRemote="RequestP2PMuteRemote",e.RequestP2PRestartICE="RequestP2PRestartICE"}(ET||(ET={})),function(e){e.MUTE_LOCAL_VIDEO="mute_local_video",e.MUTE_LOCAL_AUDIO="mute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.MUTE_REMOTE_VIDEO="mute_remote_video",e.MUTE_REMOTE_AUDIO="mute_remote_audio",e.UNMUTE_REMOTE_VIDEO="unmute_remote_video",e.UNMUTE_REMOTE_AUDIO="unmute_remote_audio"}(bT||(bT={})),function(e){e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED"}(yT||(yT={})),function(e){e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED"}(wT||(wT={})),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(ST||(ST={})),function(e){e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE",e.P2P_FAILED="P2P_FAILED",e.FALLBACK="FALLBACK"}(TT||(TT={})),function(e){e.CONNECTED="transmitter:connected",e.RECONNECTING="transmitter:reconnecting",e.WILL_RECONNECT="transmitter:will_reconnect",e.CLOSED="transmitter:closed",e.FAILED="transmitter:failed",e.ON_MESSAGE="transmitter:on_message",e.REQUEST_NEW_URLS="transmitter:request_new_urls",e.RECONNECT_WAITTING_FINISH="transmitter:reconnect_waitting_finish",e.RECONNECT_CREATE_CONNECTION="transmitter:reconnect_create_connection",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="transmitter:on_token_privilege_did_expire",e.TO_CONNECT_DATACHANNEL="transmitter:to_connect_datachannel",e.FAILBACK="transmitter:failback"}(RT||(RT={})),function(e){e.CAMERA_CHANGED="camera-changed",e.MICROPHONE_CHANGED="microphone-changed",e.PLAYBACK_DEVICE_CHANGED="playback-device-changed",e.AUDIO_AUTOPLAY_FAILED="audio-autoplay-failed",e.AUTOPLAY_FAILED="autoplay-failed",e.AUDIO_CONTEXT_STATE_CHANGED="audio-context-state-changed",e.SECURITY_POLICY_VIOLATION="security-policy-violation"}(CT||(CT={})),function(e){e[e.APP_TYPE_INVALID_VALUE=-1]="APP_TYPE_INVALID_VALUE",e[e.APP_TYPE_NATIVE=0]="APP_TYPE_NATIVE",e[e.APP_TYPE_NATIVE_COCOS=1]="APP_TYPE_NATIVE_COCOS",e[e.APP_TYPE_NATIVE_UNITY=2]="APP_TYPE_NATIVE_UNITY",e[e.APP_TYPE_NATIVE_ELECTRON=3]="APP_TYPE_NATIVE_ELECTRON",e[e.APP_TYPE_NATIVE_FLUTTER=4]="APP_TYPE_NATIVE_FLUTTER",e[e.APP_TYPE_NATIVE_UNREAL=5]="APP_TYPE_NATIVE_UNREAL",e[e.APP_TYPE_NATIVE_XAMARIN=6]="APP_TYPE_NATIVE_XAMARIN",e[e.APP_TYPE_NATIVE_API_CLOUD=7]="APP_TYPE_NATIVE_API_CLOUD",e[e.APP_TYPE_NATIVE_REACT_NATIVE=8]="APP_TYPE_NATIVE_REACT_NATIVE",e[e.APP_TYPE_NATIVE_PYTHON=9]="APP_TYPE_NATIVE_PYTHON",e[e.APP_TYPE_NATIVE_COCOS_CREATOR=10]="APP_TYPE_NATIVE_COCOS_CREATOR",e[e.APP_TYPE_NATIVE_RUST=11]="APP_TYPE_NATIVE_RUST",e[e.APP_TYPE_NATIVE_C_SHARP=12]="APP_TYPE_NATIVE_C_SHARP",e[e.APP_TYPE_NATIVE_CEF=13]="APP_TYPE_NATIVE_CEF",e[e.APP_TYPE_NATIVE_UNI_APP=14]="APP_TYPE_NATIVE_UNI_APP",e[e.APP_TYPE_WEBRTC=1e3]="APP_TYPE_WEBRTC",e[e.APP_TYPE_WEBRTC_REACT=1001]="APP_TYPE_WEBRTC_REACT",e[e.APP_TYPE_WEBRTC_VUE=1002]="APP_TYPE_WEBRTC_VUE",e[e.APP_TYPE_WEBRTC_ANGULAR=1003]="APP_TYPE_WEBRTC_ANGULAR"}(IT||(IT={})),function(e){e.CONNECTING="CONNECTING",e.RECONNECTING="RECONNECTING",e.CONNECTED="CONNECTED",e.CLOSED="CLOSED"}(AT||(AT={})),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.STATE_CHANGE="state-change",e.INSPECT_RESULT="inspect-result",e.CLIENT_LOCAL_VIDEO_TRACK="client-local-video-track",e.REQUEST_NEW_WORKER_URL="request-new-worker-url"}(OT||(OT={})),function(e){e[e.CONNECT_AP=0]="CONNECT_AP",e[e.AP_CONNECTED=1]="AP_CONNECTED",e[e.CONNECT_WORKER_MANAGER=2]="CONNECT_WORKER_MANAGER",e[e.WORKER_MANAGER_CONNECTED=3]="WORKER_MANAGER_CONNECTED",e[e.GET_WORKER_MANAGER_RESPONSE=4]="GET_WORKER_MANAGER_RESPONSE",e[e.CONNECT_WORKER=5]="CONNECT_WORKER",e[e.WORKER_CONNECTED=6]="WORKER_CONNECTED",e[e.CLOSED=7]="CLOSED"}(MT||(MT={})),function(e){e.CALL="call",e.CANDIDATE="candidate",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.CONTROL="control",e.RESTART_ICE="restart_ice",e.ACK="ack",e.RESPONSE="response",e.JOIN="join",e.CHECK="check"}(NT||(NT={})),function(e){e.ABORT="abort"}(kT||(kT={})),function(e){e.MUTE_LOCAL_AUDIO="mute_local_audio",e.MUTE_LOCAL_VIDEO="mute_local_video",e.UNMUTE_LOCAL_AUDIO="unmute_local_audio",e.UNMUTE_LOCAL_VIDEO="unmute_local_video"}(PT||(PT={})),function(e){e[e.SUCCESS=1]="SUCCESS",e[e.FAILED=0]="FAILED"}(DT||(DT={})),function(e){e.P2P_TOKEN_TIMEOUT="p2p_token_timeout",e.P2P_TOKEN_CHANGED="p2p_token_changed"}(LT||(LT={}));const VT={[mS.ACCESS_POINT]:{[vS.NO_FLAG_SET]:{desc:"flag is zero",retry:!1},[vS.FLAG_SET_BUT_EMPTY]:{desc:"flag is empty",retry:!1},[vS.INVALID_FALG_SET]:{desc:"invalid flag",retry:!1},[vS.FLAG_SET_BUT_NO_RE]:{desc:"flag set unilbs but no request",retry:!1},[vS.INVALID_SERVICE_ID]:{desc:"invalid service id",retry:!1},[vS.NO_SERVICE_AVAILABLE]:{desc:"no service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_P2P]:{desc:"no unilbs p2p service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_VOICE]:{desc:"no unilbs voice service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_WEBRTC]:{desc:"no unilbs webrtc service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_CDS]:{desc:"no cds service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_CDN]:{desc:"no cdn dispatcher service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_TDS]:{desc:"no tds service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_REPORT]:{desc:"no unilbs report service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_APP_CENTER]:{desc:"no app center service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_ENV0]:{desc:"no unilbs sig env0 service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_VOET]:{desc:"no unilbs voet service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_STRING_UID]:{desc:"no string uid service available",retry:!0},[vS.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS]:{desc:"no webrtc unilbs service available",retry:!0}},[mS.UNILBS]:{[gS.INVALID_VENDOR_KEY]:{desc:"invalid vendor key, can not find appid",retry:!1},[gS.INVALID_CHANNEL_NAME]:{desc:"invalid channel name",retry:!1},[gS.INTERNAL_ERROR]:{desc:"unilbs internal error",retry:!1},[gS.NO_AUTHORIZED]:{desc:"invalid token, authorized failed",retry:!1},[gS.DYNAMIC_KEY_TIMEOUT]:{desc:"dynamic key or token timeout",retry:!1},[gS.NO_ACTIVE_STATUS]:{desc:"no active status",retry:!1},[gS.DYNAMIC_KEY_EXPIRED]:{desc:"dynamic key expired",retry:!1},[gS.STATIC_USE_DYNAMIC_KEY]:{desc:"static use dynamic key",retry:!1},[gS.DYNAMIC_USE_STATIC_KEY]:{desc:"dynamic use static key",retry:!1},[gS.USER_OVERLOAD]:{desc:"amount of users over load",retry:!1},[gS.FORBIDDEN_REGION]:{desc:"the request is forbidden in this area",retry:!1},[gS.CANNOT_MEET_AREA_DEMAND]:{desc:"unable to allocate services in this area",retry:!1}},[mS.STRING_UID_ALLOCATOR]:{[_S.IIIEGAL_APPID]:{desc:"invalid appid",retry:!1},[_S.IIIEGAL_UID]:{desc:"invalid string uid",retry:!1},[_S.INTERNAL_ERROR]:{desc:"string uid allocator internal error",retry:!0}}};function BT(e){const t=VT[Math.floor(e/1e4)];if(!t)return{desc:"unkonw error",retry:!1};const i=t[e%1e4];if(!i){if(Math.floor(e/1e4)===mS.ACCESS_POINT){const t=e%1e4;if("1"===t.toString()[0])return{desc:e.toString(),retry:!1};if("2"===t.toString()[0])return{desc:e.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return i}const jT={[ES.K_TIMESTAMP_EXPIRED]:{desc:"K_TIMESTAMP_EXPIRED",action:"failed"},[ES.K_CHANNEL_PERMISSION_INVALID]:{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"},[ES.K_CERTIFICATE_INVALID]:{desc:"K_CERTIFICATE_INVALID",action:"failed"},[ES.K_CHANNEL_NAME_EMPTY]:{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"},[ES.K_CHANNEL_NOT_FOUND]:{desc:"K_CHANNEL_NOT_FOUND",action:"failed"},[ES.K_TICKET_INVALID]:{desc:"K_TICKET_INVALID",action:"failed"},[ES.K_CHANNEL_CONFLICTED]:{desc:"K_CHANNEL_CONFLICTED",action:"failed"},[ES.K_SERVICE_NOT_READY]:{desc:"K_SERVICE_NOT_READY",action:"tryNext"},[ES.K_SERVICE_TOO_HEAVY]:{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"},[ES.K_UID_BANNED]:{desc:"K_UID_BANNED",action:"failed"},[ES.K_IP_BANNED]:{desc:"K_IP_BANNED",action:"failed"},[ES.K_AUTO_REBALANCE]:{desc:"k_AUTO_REBALANCE",action:"recover"},[ES.ERR_INVALID_VENDOR_KEY]:{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"},[ES.ERR_INVALID_CHANNEL_NAME]:{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"},[ES.WARN_NO_AVAILABLE_CHANNEL]:{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"},[ES.WARN_LOOKUP_CHANNEL_TIMEOUT]:{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"},[ES.WARN_LOOKUP_CHANNEL_REJECTED]:{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"},[ES.WARN_OPEN_CHANNEL_TIMEOUT]:{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"},[ES.WARN_OPEN_CHANNEL_REJECTED]:{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"},[ES.WARN_REQUEST_DEFERRED]:{desc:"WARN_REQUEST_DEFERRED",action:"failed"},[ES.ERR_DYNAMIC_KEY_TIMEOUT]:{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"},[ES.ERR_NO_AUTHORIZED]:{desc:"ERR_NO_AUTHORIZED",action:"failed"},[ES.ERR_VOM_SERVICE_UNAVAILABLE]:{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"},[ES.ERR_NO_CHANNEL_AVAILABLE_CODE]:{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"},[ES.ERR_MASTER_VOCS_UNAVAILABLE]:{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"},[ES.ERR_INTERNAL_ERROR]:{desc:"ERR_INTERNAL_ERROR",action:"tryNext"},[ES.ERR_NO_ACTIVE_STATUS]:{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"},[ES.ERR_INVALID_UID]:{desc:"ERR_INVALID_UID",action:"failed"},[ES.ERR_DYNAMIC_KEY_EXPIRED]:{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"},[ES.ERR_STATIC_USE_DYANMIC_KE]:{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"},[ES.ERR_DYNAMIC_USE_STATIC_KE]:{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"},[ES.ERR_NO_VOCS_AVAILABLE]:{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"},[ES.ERR_NO_VOS_AVAILABLE]:{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"},[ES.ERR_JOIN_CHANNEL_TIMEOUT]:{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"},[ES.ERR_JOIN_BY_MULTI_IP]:{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"},[ES.ERR_NOT_JOINED]:{desc:"ERR_NOT_JOINED",action:"failed"},[ES.ERR_REPEAT_JOIN_REQUEST]:{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"},[ES.ERR_REPEAT_JOIN_CHANNEL]:{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"},[ES.ERR_INVALID_STRINGUID]:{desc:"ERR_INVALID_STRINGUID",action:"failed"},[ES.ERR_TOO_MANY_USERS]:{desc:"ERR_TOO_MANY_USERS",action:"tryNext"},[ES.ERR_SET_CLIENT_ROLE_TIMEOUT]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[ES.ERR_SET_CLIENT_ROLE_NO_PERMISSION]:{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"},[ES.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE]:{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"},[ES.ERR_PUBLISH_REQUEST_INVALID]:{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"},[ES.ERR_SUBSCRIBE_REQUEST_INVALID]:{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"},[ES.ERR_NOT_SUPPORTED_MESSAGE]:{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"},[ES.ERR_ILLEAGAL_PLUGIN]:{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"},[ES.ILLEGAL_CLIENT_ROLE_LEVEL]:{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"},[ES.ERR_REJOIN_TOKEN_INVALID]:{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"},[ES.ERR_REJOIN_USER_NOT_JOINED]:{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"},[ES.ERR_INVALID_OPTIONAL_INFO]:{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"},[ES.ERR_TEST_RECOVER]:{desc:"ERR_TEST_RECOVER",action:"recover"},[ES.ERR_TEST_TRYNEXT]:{desc:"ERR_TEST_TRYNEXT",action:"recover"},[ES.ERR_TEST_RETRY]:{desc:"ERR_TEST_RETRY",action:"recover"},[ES.ILLEGAL_AES_PASSWORD]:{desc:"ERR_TEST_RETRY",action:"failed"},[ES.ERR_TOO_MANY_BROADCASTERS]:{desc:"ERR_TOO_MANY_BROADCASTERS",action:"failed"},[ES.ERR_TOO_MANY_SUBSCRIBERS]:{desc:"ERR_TOO_MANY_SUBSCRIBERS",action:"failed"},[ES.ERR_LICENSE_ILLEGAL]:{desc:"ERR_LICENSE_ILLEGAL",action:"quit"},[ES.ERR_LICENSE_MISSING]:{desc:"ERR_LICENSE_MISSING",action:"quit"},[ES.ERR_LICENSE_EXPIRED]:{desc:"ERR_LICENSE_EXPIRED",action:"quit"},[ES.ERR_LICENSE_MINUTES_EXCEEDED]:{desc:"ERR_LICENSE_MINUTES_EXCEEDED",action:"quit"},[ES.ERR_LICENSE_PERIOD_INVALID]:{desc:"ERR_LICENSE_PERIOD_INVALID",action:"quit"},[ES.ERR_LICENSE_MULTIPLE_SDK_SERVICE]:{desc:"ERR_LICENSE_MULTIPLE_SDK_SERVICE",action:"quit"}};function FT(e){return jT[e]||{desc:"UNKNOW_ERROR_".concat(e),action:"failed"}}function WT(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function GT(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?WT(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):WT(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function HT(e){return e.every((e=>e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING))}function qT(e,t){if("string"==typeof e)return e;const{proxy:i,host:n,port:r}=e;if(t){const e=Pw("JOIN_GATEWAY_FALLBACK_PORT")||443;return 443===e?"wss://".concat(n,"/ws/?p=").concat(Number(r)+150):"wss://".concat(n,":").concat(e,"/ws/?p=").concat(Number(r)+150)}return i?"wss://".concat(i,"/ws/?h=").concat(n,"&p=").concat(r):"wss://".concat(n,":").concat(r)}const KT=/wss:\/\/(.+)\/ws\/\?h=(.+)&p=([0-9]+)\/?/,zT=/wss:\/\/(.+)\/ws\/\?p=([0-9]+)\/?/,YT=/wss:\/\/(.+):([0-9]+)\/?/,JT=/wss:\/\/(.[^\/]+)\/?/;let XT=0;class QT{constructor(e,t){oh(this,"id",0),oh(this,"store",void 0),oh(this,"recordIndex",void 0),oh(this,"websockets",[]),oh(this,"try443PortDuration",2e3),oh(this,"forceCloseWSDuration",5e3),oh(this,"try443PortTimeout",null),oh(this,"forceCloseTimeout",null),oh(this,"isTry443PortFailed",!1),oh(this,"isNormalPortFailed",!1),oh(this,"useDoubleDomain",!1),oh(this,"useProxy",!1),oh(this,"startTime",Date.now()),this.id=++XT,this.try443PortDuration=Pw("JOIN_GATEWAY_TRY_443PORT_DURATION")||2e3,this.forceCloseWSDuration=e||5e3,this.store=t}closeAllWebsockets(){this.websockets.forEach((e=>{e.onopen=null,e.onclose=null,e.onmessage=null,e.close()})),this.websockets.length=0}clearTimeout(){this.forceCloseTimeout&&clearTimeout(this.forceCloseTimeout),this.try443PortTimeout&&clearTimeout(this.try443PortTimeout)}logger(){var e;const t=Date.now()-this.startTime;for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];Yw.debug("[choose-best-ws ".concat(null===(e=this.store)||void 0===e?void 0:e.clientId," ").concat(this.id,"] ").concat(t,"ms:"),...n)}createWebSocket(e,t,i){this.logger("createWebSocket:",e,{isTry443Port:t,hasTimeoutDetection:i});const n=Pw("GATEWAY_DOMAINS"),r=Date.now(),o=[],s=n.find((t=>{var i;return Mn(i=e.host).call(i,t)}));s||(this.useDoubleDomain=!1);const a=[];if(this.useDoubleDomain)n.forEach((i=>{a.push(qT(GT(GT({},e),{},{host:e.host.replace(s,i)}),t))}));else{const i=GT({},e);if(t&&s){const e=n.find((e=>e!==s));e&&(i.host=i.host.replace(s,e))}a.push(qT(i,t))}try{a.forEach((e=>{const t=new WebSocket(e);t.binaryType="arraybuffer",o.push(t),this.logger("ws is connecting:",t.url)}))}catch(n){if(this.logger("ws create failed"),o.forEach((e=>e.close())),o.length=0,this.useDoubleDomain)return this.useDoubleDomain=!1,this.createWebSocket(e,t,i);if(!t&&443!==Number(e.port))return this.createWebSocket(e,!0,i);throw new jS(Bv.WS_ERR,"init websocket failed! Error: ".concat(n.toString()))}const c=ov();return this.store&&this.store.recordJoinChannelService({urls:o.map((e=>e.url)),service:"gateway"},this.recordIndex),o.forEach((e=>{e.onopen=()=>{this.logger("onopen: ws ".concat(e.url," open cost ").concat(Date.now()-r,"ms")),this.websockets.forEach((t=>{t!==e&&(t.onopen=null,t.onclose=null,t.onmessage=null,t.close(),this.logger("close backup websocket: ".concat(t.url)))})),this.websockets.length=0,c.resolve(e)},e.onclose=i=>{this.logger("onclose: ws ".concat(e.url," closed cost ").concat(Date.now()-r,"ms state: ").concat(e.readyState)),t?this.isTry443PortFailed=HT(o):this.isNormalPortFailed=HT(o),this.logger("443: ".concat(this.useProxy?"not try":this.isTry443PortFailed?"failed":"trying"," 47xx: ").concat(this.isNormalPortFailed?"failed":"trying")),(t&&this.isTry443PortFailed||!t&&(this.isTry443PortFailed||this.useProxy)&&this.isNormalPortFailed)&&(this.logger("onclose: all websocket is closed, ".concat(i.reason)),c.reject({code:i.code,reason:rT.A_ROUND_WS_FAILED}))},e.onmessage=t=>this.logger("".concat(e.url," onmessage: ").concat(t.data))})),this.websockets.push(...o),i||(()=>{const i=()=>{this.logger("5s timeout close un-opens, isWebsocket created: ",c.isResolved),this.websockets.forEach((e=>e.readyState!==WebSocket.OPEN&&e.close()))};if(t||this.useProxy)return this.logger("add 5s timeout at ".concat(t?"try-443":"proxy"," condition")),this.forceCloseTimeout=window.setTimeout(i,this.forceCloseWSDuration);this.try443PortTimeout=window.setTimeout((()=>{if(this.logger("2s timeout, isWebsocket created: ",c.isResolved),c.isResolved)return i();mv().os===uv.MAC_OS&&Sv()&&i(),this.createWebSocket(e,!0,!0).then((e=>c.resolve(e))).catch((e=>{this.isNormalPortFailed&&c.reject(e),this.logger("try 443 port to create ws failed")})),this.forceCloseTimeout=window.setTimeout(i,this.forceCloseWSDuration)}),this.try443PortDuration)})(),c.promise}chooseBestWebsocket(e,t,i,n){return this.useDoubleDomain=!!t,"string"==typeof e&&(e=function(e){let t,i,n;return[,t,i,n]=e.match(KT)||[],t||([,i,n]=e.match(zT)||[]),i&&n||([,i,n]=e.match(YT)||[]),i&&n||([,i]=e.match(JT)||[]),i||Yw.warning("un-destructible url: ",e),{proxy:t,host:i,port:n||"443"}}(e)),this.recordIndex=n,this.useProxy=!!e.proxy,i&&this.useProxy&&(Yw.warn("cannot use 443 only when use proxy"),i=!1),this.createWebSocket(e,!!i,!1).finally((()=>this.clearTimeout()))}}function ZT(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}class $T extends rE{get url(){return this.websocket&&this.websocket.url||null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){var t;Mn(t=["tryNext","recover"]).call(t,e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(IS.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(IS.CONNECTED):"closed"===this._state?this.emit(IS.CLOSED):"failed"===this._state&&this.emit(IS.FAILED))}resetReconnectCount(e){Yw.debug("websocket reset reconnect count, reason: "+e),this.reconnectCount=0}constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5?arguments[5]:void 0;super(),oh(this,"connectionID",0),oh(this,"currentURLIndex",0),oh(this,"urls",[]),oh(this,"_reconnectMode","tryNext"),oh(this,"reconnectReason",void 0),oh(this,"_initMutex",new YE("websocket")),oh(this,"name",void 0),oh(this,"_state","closed"),oh(this,"reconnectInterrupter",void 0),oh(this,"websocket",void 0),oh(this,"retryConfig",void 0),oh(this,"reconnectCount",0),oh(this,"forceCloseTimeout",5e3),oh(this,"onlineReconnectListener",void 0),oh(this,"useCompress",void 0),oh(this,"tryDoubleDomain",!1),oh(this,"use443PortOnly",!1),oh(this,"wsInflateLength",0),oh(this,"wsDeflateLength",0),oh(this,"closeEstablishingWs",(()=>{})),oh(this,"store",void 0),oh(this,"joinGatewayRecordIndex",void 0),this.store=o,this.name=e,this.retryConfig=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ZT(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ZT(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t),this.useCompress=i,this.tryDoubleDomain=n,this.use443PortOnly=r;const{timeout:s,timeoutFactor:a}=t,c=Math.max(300,Math.floor(3*s/5)),u=Math.max(1.2,Math.floor(8*a)/10);fE.ONLINE&&(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=u),SE.on(pE.NETWORK_STATE_CHANGE,((e,t)=>{e!==t&&(this.resetReconnectCount("network state change: ".concat(t," -> ").concat(e)),e===fE.ONLINE?(this.retryConfig.timeout=c,this.retryConfig.timeoutFactor=u):(this.retryConfig.timeout=s,this.retryConfig.timeoutFactor=a))}))}getConnection(){return this.websocket||void 0}async init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const i=await this._initMutex.lock();this.forceCloseTimeout=t,this.urls=e,this.state="connecting";try{const e=ov(),t=this.urls[this.currentURLIndex];this.createWebSocketConnection(t).then(e.resolve).catch(e.reject),this.once(IS.CLOSED,(()=>{e.reject(new jv(Bv.WS_DISCONNECT))})),this.once(IS.CONNECTED,e.resolve),await e.promise}catch(e){}finally{i()}}close(e,t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this.reconnectInterrupter&&this.reconnectInterrupter(),this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;const e=this.websocket;t?setTimeout((()=>e.close()),500):e.close(),this.websocket=void 0}this.state=e?"failed":"closed",this.closeEstablishingWs&&this.closeEstablishingWs()}reconnect(e,t){if(!this.websocket)return void Yw.warning("[".concat(this.name,"] can not reconnect, no websocket"));void 0!==e&&(this.reconnectMode=e),Yw.debug("[".concat(this.name,"] reconnect is triggered initiative")),"number"==typeof this.joinGatewayRecordIndex&&this.store&&this.store.recordJoinChannelService({status:"error",errors:[new Error(t)]},this.joinGatewayRecordIndex);const i=this.websocket.onclose;this.websocket.onclose=null,this.websocket.close(),i&&i.bind(this.websocket)({code:9999,reason:t})}sendMessage(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new jv(Bv.WS_ABORT,"websocket is not ready");try{t||(e=JSON.stringify(e)),this.websocket.send(e)}catch(e){throw new jv(Bv.WS_ERR,"send websocket message error"+e.toString())}}setWsInflateData(e){this.wsDeflateLength=this.wsDeflateLength+e.originLength,this.wsInflateLength=this.wsInflateLength+e.compressedLength}getWsInflateData(){const e=this.wsInflateLength,t=this.wsDeflateLength;return this.clearWsInflateData(),{wsInflateLength:e,wsDeflateLength:t}}clearWsInflateData(){this.wsInflateLength=0,this.wsDeflateLength=0}async createWebSocketConnection(e){var t;const i=ov();this.connectionID+=1,this.joinGatewayRecordIndex=void 0;const n=e=>{var t;null===(t=this.store)||void 0===t||t.signalChannelOpen(),Yw.debug("[".concat(this.name,"] websocket opened:"),e),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),i.resolve()},r=async e=>{var t;if(Yw.debug("[".concat(this.name,"] websocket close ").concat(null===(t=this.websocket)||void 0===t?void 0:t.url,", code: ").concat(e.code,", reason: ").concat(e.reason,", current mode: ").concat(this.reconnectMode)),this.reconnectCount>=this.retryConfig.maxRetryCount)i.reject(new jv(Bv.WS_DISCONNECT,"websocket close: ".concat(e.code))),this.close();else{"connected"===this.state&&(this.reconnectReason=e.reason,this.state="reconnecting");const t=yE(this,IS.WILL_RECONNECT,this.reconnectMode,e.reason)||this.reconnectMode,n=await this.reconnectWithAction(t);if("closed"===this.state)return void Yw.debug("[".concat(this.connectionID,"] ws is closed, no need to reconnect"));if(!n)return i.reject(new jv(Bv.WS_DISCONNECT,"websocket reconnect failed: ".concat(e.code))),this.close(!0);i.resolve()}},o=e=>{this.emit(IS.ON_MESSAGE,e)},s=e=>{Yw.warn("[".concat(this.connectionID,"] ws open error ").concat(e))};this.websocket&&(this.websocket.onclose=null,this.websocket.close()),Pw("GATEWAY_WSS_ADDRESS")&&this.name.startsWith("gateway")&&(e=Pw("GATEWAY_WSS_ADDRESS")),Yw.debug("[".concat(this.name,"] start connect, url:"),e);const a=null===(t=this.store)||void 0===t?void 0:t.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"});try{var c;const t=await this.chooseBestWebsocketConnection(e);this.websocket=t,n&&n(this.websocket.url),this.websocket.onclose=r,this.websocket.onmessage=o,this.websocket.onerror=s,null===(c=this.store)||void 0===c||c.recordJoinChannelService({endTs:Date.now(),status:"success"},a),this.joinGatewayRecordIndex=a}catch(e){const t="closed"===this.state,n=e instanceof jv,o=n&&e.code===Bv.WS_ABORT,s=n&&e.code===Bv.WS_ERR,c=n?e.message:e&&(e.reason||e.toString());Yw.warning("[choose-best-ws] chooseBestWebsocket error: ".concat(c)),this.store&&this.store.recordJoinChannelService({endTs:Date.now(),status:o?"aborted":"error",errors:[e]},a),t||s?(i.reject(t?new jv(Bv.WS_DISCONNECT,"websocket is closed: ".concat(c)):new jv(Bv.WS_ERR,"init websocket failed: ".concat(c))),s&&Yw.error("[".concat(this.name,"] init websocket failed: ").concat(c))):r&&r(e)}return i.promise}async reconnectWithAction(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.reconnectCount>=this.retryConfig.maxRetryCount)return!1;if(0===this.urls.length)return!1;if("closed"===this.state)return!1;Yw.warning("[choose-best-ws] action: =>",e),this.onlineReconnectListener||SE.isOnline||!SE.onlineWaiter||(this.onlineReconnectListener=SE.onlineWaiter.then((()=>{this.onlineReconnectListener=void 0})));let i=!0;if(this.reconnectInterrupter=()=>i=!1,t){const t=QE(this.reconnectCount,this.retryConfig);Yw.debug("[".concat(this.name,"] wait ").concat(t,"ms to reconnect websocket, mode: ").concat(e)),await nv.race([VE(t),this.onlineReconnectListener||new nv((()=>{}))])}if("closed"===this._state||!i)return!1;this.reconnectCount+=1;const n=async(e,t)=>{this.emit(IS.RECONNECT_CREATE_CONNECTION,t),await this.createWebSocketConnection(e)};try{if("retry"===e)this.emit(IS.RECONNECT_WAITTING_FINISH,e),await n(this.urls[this.currentURLIndex],e);else if("tryNext"===e){if(this.currentURLIndex+=1,this.currentURLIndex>=this.urls.length)return this.reconnectWithAction("recover",!1);Yw.debug("[".concat(this.name,"] websocket url length: ").concat(this.urls.length," current index: ").concat(this.currentURLIndex)),this.emit(IS.RECONNECT_WAITTING_FINISH,e),await n(this.urls[this.currentURLIndex],e)}else"recover"===e&&(Yw.debug("[".concat(this.name,"] request new urls")),this.resetReconnectCount("recover mode"),this.emit(IS.RECONNECT_WAITTING_FINISH,e),this.urls=await EE(this,IS.REQUEST_NEW_URLS),this.currentURLIndex=0,await n(this.urls[this.currentURLIndex],e))}catch(i){var r;Yw.error("[".concat(this.name,"] reconnect failed ").concat(i&&i.toString()));const n=null==i||null===(r=i.data)||void 0===r?void 0:r.desc;return Array.isArray(n)&&Mn(n).call(n,"dynamic key expired")?(this.emit(IS.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):this.reconnectWithAction(e,t)}return!0}}class eR extends $T{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){const i=ov(),n=function(e,t){return new QT(e,t)}(this.forceCloseTimeout,this.store);this.closeEstablishingWs=()=>{Yw.debug("[choose-best-ws] close establishing websockets"),n.closeAllWebsockets(),i.reject(new jv(Bv.WS_ABORT,"choose best websocket aborted"))};const r=Pw("GATEWAY_DOMAINS");return Yw.debug("[choose-best-ws] currentDomain: ",e,", domains: ",r,"total: ".concat(this.urls.length),"current: ".concat(this.currentURLIndex+1)),n.chooseBestWebsocket(e,this.tryDoubleDomain,this.use443PortOnly,t).then(i.resolve).catch(i.reject),i.promise.finally((()=>{this.closeEstablishingWs=void 0}))}}class tR extends $T{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3&&void 0!==arguments[3]&&arguments[3],arguments.length>4&&void 0!==arguments[4]&&arguments[4],arguments.length>5?arguments[5]:void 0)}async chooseBestWebsocketConnection(e,t){return new nv(((i,n)=>{let r=!1;const o=[];this.closeEstablishingWs=()=>{Yw.debug("[choose-best-ws] close establishing websockets"),o.forEach((e=>{e.onclose=null,e.onopen=null,e.onmessage=null,e.close()})),n(new jv(Bv.WS_ABORT,"choose best websocket aborted"))};const s=Pw("GATEWAY_DOMAINS");let a;const c=e.indexOf("?h="),u=s.find((t=>-1!==c?Mn(e).call(e,t,c):Mn(e).call(e,t)));Yw.debug("[choose-best-ws] currentDomain: ",u,", domains: ",s);let d=!this.tryDoubleDomain||!u;if(!d&&u){var l;const h=Date.now();try{s.forEach((t=>{const i=-1===c?e.replace(u,t):e.substr(0,c)+e.substr(c).replace(u,t),n=new WebSocket(i);n.binaryType="arraybuffer",o.push(n),Yw.debug("[choose-best-ws] ws is connecting:",n.url)}))}catch(e){for(Yw.debug("[choose-best-ws] ws create failed, fallback to single url"),o.forEach((e=>e.close()));o.length;)o.pop();d=!0}null===(l=this.store)||void 0===l||l.recordJoinChannelService({urls:o.map((e=>e.url)),service:"gateway"},t),o.forEach((e=>{e.onopen=()=>{if(r)return;const t=Date.now()-h;Yw.debug("[choose-best-ws] ws open cost ".concat(t,"ms")),o.filter((t=>t!==e)).forEach((e=>{Yw.debug("[choose-best-ws]close backup websocket: ".concat(e.url)),e.close()})),r=!0,i(e)},e.onclose=e=>{a=e,r||o.find((e=>!(e.readyState===WebSocket.CLOSED||e.readyState===WebSocket.CLOSING)))||(Yw.debug("[choose-best-ws] all websocket is closed"),r=!0,n(a))},e.onmessage=t=>{Yw.debug("[choose-best-ws]".concat(e.url," onmessage: ").concat(t.data))}})),VE(this.forceCloseTimeout).then((()=>{o.forEach((e=>{e.readyState!==WebSocket.OPEN&&e.close()}))}))}if(d){var h;let r;Yw.debug("[choose-best-ws] use single url: ",e),null===(h=this.store)||void 0===h||h.recordJoinChannelService({urls:[e],service:"gateway"},t);try{r=new WebSocket(e),o.push(r),r.binaryType="arraybuffer"}catch(e){const i=new jv(Bv.WS_ERR,"init websocket failed! Error: ".concat(e.toString()));return Yw.error("[".concat(this.name,"]").concat(i)),void n(i)}r.onopen=()=>{i(r)},r.onclose=e=>{n(e)},r.onmessage=e=>{Yw.debug("[choose-best-ws]".concat(r.url," onmessage: ").concat(e.data))},VE(this.forceCloseTimeout).then((()=>{r&&r.readyState!==WebSocket.OPEN&&r.close()}))}})).then((e=>(this.closeEstablishingWs=void 0,e))).catch((e=>{throw this.closeEstablishingWs=void 0,e}))}}class iR extends rE{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===bS.CONNECTED?this.emit(yS.WS_CONNECTED):e===bS.RECONNECTING?this.emit(yS.WS_RECONNECTING,this._websocketReconnectReason):e===bS.CLOSED&&this.emit(yS.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),oh(this,"_disconnectedReason",void 0),oh(this,"_websocketReconnectReason",void 0),oh(this,"_connectionState",bS.CLOSED),oh(this,"reconnectToken",void 0),oh(this,"websocket",void 0),oh(this,"openConnectionTime",void 0),oh(this,"clientId",void 0),oh(this,"lastMsgTime",Date.now()),oh(this,"uploadCache",[]),oh(this,"uploadCacheInterval",void 0),oh(this,"rttRolling",new lb(5)),oh(this,"pingpongTimer",void 0),oh(this,"wsInflateDataTimer",void 0),oh(this,"pingpongTimeoutCount",0),oh(this,"joinResponse",void 0),oh(this,"multiIpOption",void 0),oh(this,"initError",void 0),oh(this,"spec",void 0),oh(this,"store",void 0),oh(this,"onWebsocketMessage",(e=>{if(e.data instanceof ArrayBuffer)return void this.emit(yS.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")){if(this.emit(t._type,t._message),t._type===TS.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===TS.ON_USER_BANNED)switch(t._message.error_code){case 14:this.close(dE.UID_BANNED);break;case 15:this.close(dE.IP_BANNED);break;case 16:this.close(dE.CHANNEL_BANNED)}if(t._type===TS.ON_USER_LICENSE_BANNED)switch(t._message.error_code){case ES.ERR_LICENSE_MISSING:this.close(dE.LICENSE_MISSING);break;case ES.ERR_LICENSE_EXPIRED:this.close(dE.LICENSE_EXPIRED);break;case ES.ERR_LICENSE_MINUTES_EXCEEDED:this.close(dE.LICENSE_MINUTES_EXCEEDED);break;case ES.ERR_LICENSE_PERIOD_INVALID:this.close(dE.LICENSE_PERIOD_INVALID);break;case ES.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(dE.LICENSE_MULTIPLE_SDK_SERVICE);break;case ES.ERR_LICENSE_ILLEGAL:this.close(dE.LICENSE_ILLEGAL);break;default:this.close()}}})),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new eR("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Pw("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Pw("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",(()=>{this.connectionState===bS.CONNECTED&&this.reconnect("retry",hE.OFFLINE)}))}async request(e,t,i,n){const r=BE(6,""),o={_id:r,_type:e,_message:t},s=this.websocket.connectionID,a=()=>new nv(((t,i)=>{if(this.connectionState===bS.CONNECTED)return t();const n=()=>{this.off(yS.WS_CLOSED,r),t()},r=()=>{this.off(yS.WS_CONNECTED,n),i(new jS(Bv.WS_ABORT))};this.once(yS.WS_CONNECTED,n),this.once(yS.WS_CLOSED,r),e!==wS.PUBLISH&&e!==wS.SUBSCRIBE&&e!==wS.UNSUBSCRIBE&&e!==wS.UNPUBLISH&&e!==wS.CONTROL&&e!==wS.RESTART_ICE||this.once(yS.DISCONNECT_P2P,(()=>{i(new jS(Bv.DISCONNECT_P2P))})),e!==wS.PUBLISH&&e!==wS.RESTART_ICE||this.once(yS.ABORT_P2P_EXECUTION,(()=>{i(new jS(Bv.DISCONNECT_P2P))}))}));if(this.connectionState!==bS.CONNECTING&&this.connectionState!==bS.RECONNECTING||e===wS.JOIN||e===wS.REJOIN||await a(),this.websocket.sendMessage(o,!0),n)return;const c=new nv(((i,n)=>{let o=!1;const a=(n,r)=>{o=!0,i({isSuccess:"success"===n,message:r||{}}),this.off(yS.WS_CLOSED,c),this.off(yS.WS_RECONNECTING,c),this.emit(yS.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(r),a);const c=()=>{n(new jS(Bv.WS_ABORT,"type: ".concat(e))),this.off(yS.WS_CLOSED,c),this.off(yS.WS_RECONNECTING,c),this.off("res-@".concat(r),a)};this.once(yS.WS_CLOSED,c),this.once(yS.WS_RECONNECTING,c),VE(Pw("SIGNAL_REQUEST_TIMEOUT")).then((()=>{this.websocket.connectionID!==s||o||(Yw.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(yS.REQUEST_TIMEOUT,e,t))}))}));let u=null;try{u=await c}catch(n){if(this.connectionState===bS.CLOSED||e===wS.LEAVE)throw new jS(Bv.WS_ABORT);return!this.spec.forceWaitGatewayResponse||i?n.throw():e===wS.JOIN||e===wS.REJOIN?null:(await a(),await this.request(e,t))}if(u.isSuccess)return u.message;const d=Number(u.message.error_code||u.message.code),l=FT(d),h=new jS(Bv.UNEXPECTED_RESPONSE,"".concat(l.desc,": ").concat(u.message.error_str),{code:d,data:u.message});return"success"===l.action?u.message:(Yw.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(l.desc,", action: ").concat(l.action)),d===ES.ERR_TOO_MANY_BROADCASTERS?e===wS.JOIN||e===wS.REJOIN?(this.initError=h,this.close(),h.throw()):h.throw():"failed"===l.action?h.throw():"quit"===l.action?(this.initError=h,this.close(),h.throw()):(d===ES.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=u.message.option,Yw.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",hE.MULTI_IP)):this.reconnect(l.action,hE.SERVER_ERROR),e===wS.JOIN||e===wS.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new nv((i=>{const n=r=>{(!t||t(r))&&(this.off(e,n),i(r))};this.on(e,n)}))}uploadWRTCStats(e){if(!this.store.sessionId)return void Yw.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(SS.WRTC_STATS,t)}upload(e,t){const i={_type:e,_message:t};try{this.websocket.sendMessage(i)}catch(e){const t=Pw("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(i),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval((()=>{if(this.connectionState!==bS.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)}),Pw("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const i={_type:e,_message:t};this.websocket.sendMessage(i)}init(e,t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new nv(((t,i)=>{this.once(yS.WS_CONNECTED,(()=>t(this.joinResponse))),this.once(yS.WS_CLOSED,(()=>i(this.initError||new jS(Bv.WS_ABORT)))),this.connectionState=bS.CONNECTING,this.websocket.init(e).catch(i),this.wsInflateDataTimer&&window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=window.setInterval((()=>{this.handleWsInflateData()}),2e4)}))}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.wsInflateDataTimer&&(this.handleWsInflateData(),window.clearInterval(this.wsInflateDataTimer),this.wsInflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||dE.LEAVE,this.connectionState=bS.CLOSED,Yw.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),e===dE.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new eR("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Pw("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Pw("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(yS.ABORT_P2P_EXECUTION);const e=await EE(this,yS.REQUEST_JOIN_INFO),t=await this.request(wS.JOIN,e);if(!t)return this.emit(yS.REPORT_JOIN_GATEWAY,rT.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(yS.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=bS.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new jS(Bv.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=wE(this,yS.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const t=await this.request(wS.REJOIN,e);return!!t&&(this.connectionState=bS.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),t.peers&&t.peers.forEach((e=>{this.emit(TS.ON_USER_ONLINE,{uid:e.uid}),e.audio&&this.emit(TS.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0,ssrcId:e.audio_ssrc}),e.video&&this.emit(TS.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0,ssrcId:e.video_ssrc}),e.audio_mute?this.emit(TS.MUTE_AUDIO,{uid:e.uid}):this.emit(TS.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?this.emit(TS.MUTE_VIDEO,{uid:e.uid}):this.emit(TS.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?this.emit(TS.ENABLE_LOCAL_AUDIO,{uid:e.uid}):this.emit(TS.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?this.emit(TS.ENABLE_LOCAL_VIDEO,{uid:e.uid}):this.emit(TS.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||this.emit(TS.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id})})),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleNotification(e){Yw.debug("[".concat(this.clientId,"] receive notification: "),e);const t=FT(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(dE.UID_BANNED),void this.close()):void this.reconnect(t.action,hE.SERVER_ERROR);Yw.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=Pw("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(Yw.warning("[".concat(this.clientId,"] PING-PONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>Pw("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",hE.TIMEOUT):this.request(wS.PING,void 0,!0).then((()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),Pw("REPORT_STATS")&&this.send(wS.PING_BACK,{pingpongElapse:e})})).catch((e=>{}))}handleWsInflateData(){const{wsInflateLength:e,wsDeflateLength:t}=this.websocket.getWsInflateData();0!==e&&0!==t&&this.upload(SS.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(IS.RECONNECT_WAITTING_FINISH,(e=>{this.emit(yS.WS_RECONNECT_WAITTING_FINISH,e)})),this.websocket.on(IS.RECONNECT_CREATE_CONNECTION,(e=>{this.emit(yS.WS_RECONNECT_CREATE_CONNECTION,e)})),this.websocket.on(IS.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(IS.CLOSED,(()=>{this.connectionState=bS.CLOSED})),this.websocket.on(IS.FAILED,(()=>{this._disconnectedReason=dE.NETWORK_ERROR,this.connectionState=bS.CLOSED})),this.websocket.on(IS.RECONNECTING,(e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===bS.CONNECTED?this.connectionState=bS.RECONNECTING:this.connectionState=bS.CONNECTING})),this.websocket.on(IS.WILL_RECONNECT,((e,t,i)=>{const n=wE(this,yS.IS_P2P_DISCONNECTED),r=n||"retry"!==e;n&&"retry"===e&&(Yw.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),e="tryNext",t=rT.P2P_DISCONNECTED),r&&(Yw.debug("".concat(this.clientId," will renewSession, reconnect mode: ").concat(e)),this.emit(yS.REPORT_JOIN_GATEWAY,t||rT.UNKNOWN_REASON,this.url||""),this.reconnectToken=void 0,this.emit(yS.NEED_RENEW_SESSION),this.emit(yS.DISCONNECT_P2P)),i(e)})),this.websocket.on(IS.CONNECTED,(()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch((e=>{Yw.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),this.reconnect("tryNext",hE.SERVER_ERROR)})):this.join().catch((e=>{if(this.emit(yS.REPORT_JOIN_GATEWAY,e.message||e.code||rT.UNKNOWN_REASON,this.url||""),e instanceof jS&&e.code===Bv.UNEXPECTED_RESPONSE&&e.data.code===ES.ERR_NO_AUTHORIZED)return Yw.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",hE.SERVER_ERROR);Yw.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",hE.SERVER_ERROR):(this.initError=e,this.close())}))})),this.websocket.on(IS.REQUEST_NEW_URLS,((e,t)=>{EE(this,yS.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})),this.websocket.on(IS.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{this.emit(TS.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}))}}var nR="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",rR=Z,oR=_n,sR=nR,aR=h("".replace),cR=RegExp("^["+sR+"]+"),uR=RegExp("(^|[^"+sR+"])["+sR+"]+$"),dR=function(e){return function(t){var i=oR(rR(t));return 1&e&&(i=aR(i,cR,"")),2&e&&(i=aR(i,uR,"$1")),i}},lR={start:dR(1),end:dR(2),trim:dR(3)},hR=Qu.PROPER,fR=s,pR=nR,mR=lR.trim;Ni({target:"String",proto:!0,forced:function(e){return fR((function(){return!!pR[e]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[e]()||hR&&pR[e].name!==e}))}("trim")},{trim:function(){return mR(this)}});var _R,gR,vR=Qi("String").trim,ER=f,bR=vR,yR=String.prototype,wR=o((function(e){var t=e.trim;return"string"==typeof e||e===yR||ER(yR,e)&&t===yR.trim?bR:t}));function SR(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function TR(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?SR(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):SR(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function RR(e){return e.match(/^[\.\:\d]+$/)?"".concat(e.replace(/[^\d]/g,"-"),".").concat(Pw("TURN_DOMAIN")):(Yw.info("Unidentified as ip: ".concat(e,", use as host")),e)}function CR(e,t){e.addresses||(e.addresses=[]);const i=function(e,t){if(Pw("CONNECT_GATEWAY_WITHOUT_DOMAIN"))return e.map((e=>{let{ip:t,port:i}=e;return{address:"".concat(t,":").concat(i)}}));const i=Pw("GATEWAY_DOMAINS");let n=i[1]&&Mn(t).call(t,i[1])?1:0;return e.map((e=>{let{domain_prefix:t,port:r,ip:o}=e;if(t)return{address:"".concat(t,".").concat(i[n++%i.length],":").concat(r)};const s=/^[\.\:\d]+$/.test(o),a=s?"".concat(o.replace(/[^\d]/g,"-"),".").concat(i[n++%i.length],":").concat(r):"".concat(o,":").concat(r);return s||Yw.info("Unidentified as ip: ".concat(o,", use as host")),{ip:o,port:r,address:a}}))}(e.addresses,t),n=Array.isArray(e.detail)&&e.detail[18];if(n&&"string"==typeof n){const e=n.split(";");for(let t=0;t<e.length;t++){var r;const n=wR(r=e[t]).call(r);i[t]&&n&&(i[t].ip6=n)}}return{gatewayAddrs:i,uid:e.uid,cid:e.cid,cert:e.cert,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e,csIp:e.detail&&e.detail[502]}}function IR(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function AR(e){const t=e._encoderConfig;if(!t)return{};const i={resolution:t.width&&t.height?"".concat(IR(t.width),"x").concat(IR(t.height)):void 0,maxVideoBW:t.bitrateMax,minVideoBW:t.bitrateMin};return"number"==typeof t.frameRate?(i.maxFrameRate=t.frameRate,i.minFrameRate=t.frameRate):t.frameRate&&(i.maxFrameRate=t.frameRate.max||t.frameRate.ideal||t.frameRate.exact||t.frameRate.min,i.minFrameRate=t.frameRate.min||t.frameRate.ideal||t.frameRate.exact||t.frameRate.max),i}function OR(e){return e>=0&&e<.17?1:e>=.17&&e<.36?2:e>=.36&&e<.59?3:e>=.59&&e<=1?4:e>1?5:0}function MR(e,t){let i,n,r;switch(t){case _R.CHOOSE_SERVER:n=4096,r="choose server";break;case _R.CLOUD_PROXY:n=1048576,r="proxy";break;case _R.CLOUD_PROXY_5:n=4194304,r="proxy5";break;case _R.CLOUD_PROXY_FALLBACK:n=4194310,r="proxy fallback";break;default:throw new jS(Bv.UNEXPECTED_ERROR,"multi unlibs response transformer get unknown service id",{csIp:e.detail&&e.detail[502],retry:!1})}if(e.response_body.forEach((t=>{t.buffer&&t.buffer.flag===n&&(i={code:t.buffer.code,addresses:(t.buffer.edges_services||[]).map((e=>TR(TR({},e),{},{ticket:t.buffer.cert}))),server_ts:e.enter_ts,uid:t.buffer.uid,cid:t.buffer.cid,cname:t.buffer.cname,detail:TR(TR({},t.buffer.detail),e.detail),flag:t.buffer.flag,opid:e.opid,cert:t.buffer.cert})})),!i)throw new jS(Bv.MULTI_UNILBS_RESPONSE_ERROR,"cannot parse response ".concat(r," from multi unilbs response"),{csIp:e.detail&&e.detail[502]});return i}async function NR(e,t){return await nv.all(e.addresses.map((async e=>({address:RR(e.ip),tcpport:e.port,udpport:e.port,username:t&&Pw("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?t.toString():uS.username,password:t&&Pw("ENCRYPT_PROXY_USERNAME_AND_PSW")&&window.isSecureContext?await nE(t.toString()):uS.password}))))}function kR(e,t){const i=t._videoHeight||t.getMediaStreamTrack(!0).getSettings().height;return i?Math.max(i/IR(e.height),1):(Yw.warning("can't get ori-track's height, default scale down 4 times for low stream"),4)}function PR(e){let{candidateType:t,relayProtocol:i,type:n,address:r,port:o,protocol:s}=e;return"local-candidate"===n?{candidateType:t,relayProtocol:i,protocol:s}:{candidateType:t,relayProtocol:i,address:r,port:o,protocol:s}}function DR(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}!function(e){e[e.CHOOSE_SERVER=11]="CHOOSE_SERVER",e[e.CLOUD_PROXY=18]="CLOUD_PROXY",e[e.CLOUD_PROXY_5=20]="CLOUD_PROXY_5",e[e.CLOUD_PROXY_FALLBACK=26]="CLOUD_PROXY_FALLBACK"}(_R||(_R={}));class LR extends rE{get url(){return this._url?this._url:null}get reconnectMode(){return this._reconnectMode}set reconnectMode(e){var t;Mn(t=["tryNext","recover"]).call(t,e)&&this.resetReconnectCount(e),this._reconnectMode=e}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(RT.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(RT.CONNECTED):"closed"===this._state?this.emit(RT.CLOSED):"failed"===this._state&&this.emit(RT.FAILED))}constructor(e,t,i,n){super(),oh(this,"connectionID",0),oh(this,"currentURLIndex",0),oh(this,"reconnectReason",void 0),oh(this,"_reconnectMode","tryNext"),oh(this,"_name",void 0),oh(this,"_state","closed"),oh(this,"_retryConfig",void 0),oh(this,"_reconnectCount",0),oh(this,"_forceCloseTimeout",5e3),oh(this,"_onlineReconnectListener",void 0),oh(this,"_closeEstablishingTransmitter",(()=>{})),oh(this,"_store",void 0),oh(this,"_joinChannelServiceRecordIndex",void 0),oh(this,"_useCompress",void 0),oh(this,"_inflateLength",0),oh(this,"_deflateLength",0),this._store=n,this._name=e,this._retryConfig=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?DR(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):DR(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t),this._useCompress=i}resetReconnectCount(e){Yw.debug("".concat(this._name," reset reconnect count, reason: ").concat(e)),this._reconnectCount=0}close(e,t){if(this.currentURLIndex=0,this.resetReconnectCount("close"),this._reconnectInterrupter&&this._reconnectInterrupter(),this._transmitter){this._transmitter.onclose=null,this._transmitter.onopen=null,this._transmitter.onmessage=null;const e=this._transmitter;t?setTimeout((()=>e.close()),500):e.close(),this._transmitter=void 0}this.state=e?"failed":"closed",this._closeEstablishingTransmitter&&this._closeEstablishingTransmitter()}reconnect(e,t){if(!this._transmitter)return void Yw.warning("[".concat(this._name,"] can not reconnect, no websocket"));var i;void 0!==e&&(this.reconnectMode=e),Yw.debug("[".concat(this._name,"] reconnect is triggered initiative")),"number"==typeof this._joinChannelServiceRecordIndex&&(null===(i=this._store)||void 0===i||i.recordJoinChannelService({status:"error",errors:[new Error(t)]},this._joinChannelServiceRecordIndex));const n=this._transmitter.onclose;this._transmitter.onclose=null,this._transmitter.close(),n&&n.bind(this._transmitter)({code:9999,reason:t})}getInflateData(){const e=this._inflateLength,t=this._deflateLength;return this.clearInflateData(),{inflateLength:e,deflateLength:t}}setInflateData(e){this._deflateLength=this._deflateLength+e.originLength,this._inflateLength=this._inflateLength+e.compressedLength}clearInflateData(){this._inflateLength=0,this._deflateLength=0}}!function(e){e[e.Default=0]="Default",e[e.Ack=1]="Ack"}(gR||(gR={}));class xR{constructor(e,t,i){oh(this,"version",1),oh(this,"initialRTO",void 0),oh(this,"maxBatchAckCount",void 0),oh(this,"maxRTO",void 0),oh(this,"initialRTT",void 0),oh(this,"ID",void 0),oh(this,"rtt",void 0),oh(this,"packetNumber",1),oh(this,"rtoRatioMap",new Map),oh(this,"timeoutMap",new Map),oh(this,"unorderedPacketQueue",[]),oh(this,"batchAckPacketQueue",[]),oh(this,"lastOrderedPacketNumber",0),oh(this,"batchAckTimer",void 0),oh(this,"sendImpl",void 0),oh(this,"receiveImpl",void 0),this.sendImpl=e,this.receiveImpl=t,this.ID=BE(7,"transmitter-"),this.initialRTO=void 0!==(null==i?void 0:i.initialRTO)?i.initialRTO:Pw("TRANSMITTER_INITIAL_RTO"),this.initialRTT=void 0!==(null==i?void 0:i.initialRTT)?i.initialRTT:Pw("TRANSMITTER_INITIAL_RTT"),this.rtt=void 0!==(null==i?void 0:i.initialRTT)?i.initialRTT:Pw("TRANSMITTER_INITIAL_RTT"),this.maxBatchAckCount=void 0!==(null==i?void 0:i.maxBatchAckCount)?i.maxBatchAckCount:Pw("TRANSMITTER_MAX_BATCH_ACK_COUNT"),this.maxRTO=void 0!==(null==i?void 0:i.maxRTO)?i.maxRTO:Pw("TRANSMITTER_MAX_RTO")}packetize(e,t){return{type:gR.Default,version:this.version,packetNumber:t,payload:e}}serialize(e){switch(e.type){case gR.Default:{let t;t="string"==typeof e.payload?(new TextEncoder).encode(e.payload):e.payload;const i=new ArrayBuffer(t.length+15),n=new DataView(i);return n.setUint16(0,e.version),n.setUint8(2,e.type),n.setUint32(3,e.packetNumber),Xv(n,7,BigInt(e.sendTs)),new Uint8Array(n.buffer).set(t,15),i}case gR.Ack:{const t=new ArrayBuffer(16),i=new DataView(t);return i.setUint16(0,e.version),i.setUint8(2,e.type),i.setUint32(3,e.maxAckPacketNumber),i.setUint8(7,e.shift),Xv(i,8,BigInt(e.ackSendTs)),t}}}deserialize(e){const t=new DataView(e),i=t.getUint16(0),n=t.getUint8(2);switch(n){case gR.Default:{const r=t.getUint32(3),o=Jv(t,7),s=e.slice(15),a=(new TextDecoder).decode(s);return{version:i,type:n,packetNumber:r,sendTs:Number(o),payload:a}}case gR.Ack:{const e=t.getUint32(3),r=t.getUint8(7),o=Jv(t,8);return{version:i,type:n,maxAckPacketNumber:e,shift:r,ackSendTs:Number(o)}}default:throw Yw.error("[".concat(this.ID,"] Unrecognized packet type ").concat(n)),new Error("Unrecognized packet type ".concat(n))}}sendMessage(e){const t=this.packetize(e,this.packetNumber);this.packetNumber=4294967295===this.packetNumber?1:this.packetNumber+1;const i=this.calculateRTO(t),n=window.setTimeout((()=>{this.resendMessage(t)}),i);this.timeoutMap.set(t.packetNumber,n),this.sendPacket(t)}onData(e){const t=this.deserialize(e);t.type===gR.Default?this.ack(t):t.type===gR.Ack&&(this.updateRTT(t,Math.round(performance.now())),this.clearRTO(t))}close(){this.rtt=this.initialRTT,this.packetNumber=1,Array.from(this.timeoutMap.entries()).forEach((e=>{let[t,i]=e;window.clearTimeout(i)})),this.timeoutMap=new Map,this.rtoRatioMap=new Map,this.unorderedPacketQueue=[],this.batchAckPacketQueue=[],this.lastOrderedPacketNumber=0,void 0!==this.batchAckTimer&&window.clearTimeout(this.batchAckTimer)}resendMessage(e){const t=this.calculateRTO(e),i=window.setTimeout((()=>{this.resendMessage(e)}),t);this.timeoutMap.set(e.packetNumber,i),this.sendPacket(e)}calculateRTO(e){const t=this.rtoRatioMap.get(e.packetNumber);if(void 0===t)return this.rtoRatioMap.set(e.packetNumber,1),this.initialRTO;{const i=9*this.rtt/8*t;return this.rtoRatioMap.set(e.packetNumber,t+1),i>this.maxRTO?this.maxRTO:i}}updateRTT(e,t){const i=e.ackSendTs;this.rtt=this.rtt*(7/8)+(t-i-this.rtt)/8}ack(e){if(e.packetNumber===this.lastOrderedPacketNumber+1)for(this.batchAckPacketQueue.length>=this.maxBatchAckCount&&this.batchAck(),this.batchAckTimer?this.batchAckPacketQueue.push(e):(this.batchAckPacketQueue.push(e),this.batchAckTimer=window.setTimeout((()=>{this.batchAck()}),this.rtt/8)),this.lastOrderedPacketNumber+=1,this.receiveImpl(e.payload);;){const e=this.unorderedPacketQueue[0];if(!e){this.unorderedPacketQueue.shift();break}this.batchAckTimer&&this.batchAck(),this.receiveImpl(e.payload),this.unorderedPacketQueue.shift(),this.lastOrderedPacketNumber+=1}else if(e.packetNumber<=this.lastOrderedPacketNumber){const t={ackSendTs:e.sendTs,maxAckPacketNumber:e.packetNumber,shift:0,type:gR.Ack,version:this.version};this.sendPacket(t)}else if(e.packetNumber>this.lastOrderedPacketNumber){this.unorderedPacketQueue[e.packetNumber-this.lastOrderedPacketNumber-2]=e;const t={ackSendTs:e.sendTs,maxAckPacketNumber:e.packetNumber,shift:0,type:gR.Ack,version:this.version};this.sendPacket(t)}}batchAck(){window.clearTimeout(this.batchAckTimer),this.batchAckTimer=void 0;const e={ackSendTs:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].sendTs,maxAckPacketNumber:this.batchAckPacketQueue[this.batchAckPacketQueue.length-1].packetNumber,shift:this.batchAckPacketQueue.length-1,type:gR.Ack,version:this.version};this.sendPacket(e),this.batchAckPacketQueue=[]}sendPacket(e){e.type===gR.Default&&(e.sendTs=Math.round(performance.now()));const t=this.serialize(e);this.sendImpl(t)}clearRTO(e){for(let t=e.maxAckPacketNumber-e.shift;t<=e.maxAckPacketNumber;t++){const e=this.timeoutMap.get(t);void 0!==e&&window.clearTimeout(e),this.timeoutMap.delete(t),this.rtoRatioMap.delete(t)}}}class UR extends LR{constructor(e,t){super(e,t,arguments.length>2&&void 0!==arguments[2]&&arguments[2],arguments.length>3?arguments[3]:void 0),oh(this,"_initMutex",void 0),oh(this,"_reconnectInterrupter",void 0),oh(this,"_url",void 0),oh(this,"_transmitter",void 0),oh(this,"_addresses",void 0),oh(this,"_reliableTransmission",void 0),this._initMutex=new YE("datachannel");const{timeout:i,timeoutFactor:n}=t,r=Math.max(300,Math.floor(3*i/5)),o=Math.max(1.2,Math.floor(8*n)/10);fE.ONLINE&&(this._retryConfig.timeout=r,this._retryConfig.timeoutFactor=o),SE.on(pE.NETWORK_STATE_CHANGE,((e,t)=>{e!==t&&(this.resetReconnectCount("network state change: ".concat(t," -> ").concat(e)),e===fE.ONLINE?(this._retryConfig.timeout=r,this._retryConfig.timeoutFactor=o):(this._retryConfig.timeout=i,this._retryConfig.timeoutFactor=n))}))}getConnection(){if(this._reliableTransmission)return this._reliableTransmission}async init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;this._forceCloseTimeout=t;const i=(t,i)=>{this._addresses=e,this.currentURLIndex=this._addresses.findIndex((e=>e.fingerprint||Pw("FINGERPRINT")));const n=this._addresses[this.currentURLIndex];this.state="connecting",this.createTransmitterConnection(n).then(t).catch(i),this.once(RT.CLOSED,(()=>i(new jS(Bv.WS_DISCONNECT)))),this.once(RT.CONNECTED,(()=>t()))};return this._initMutex.lock().then((e=>new nv(((e,t)=>{i(e,t)})).then((()=>{e()})).catch((()=>{e()}))))}sendMessage(e){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this._transmitter||!this._reliableTransmission)throw new jS(Bv.WS_ABORT,"datachannel is not ready");try{t||(e=JSON.stringify(e)),this._reliableTransmission.sendMessage(e)}catch(e){throw new jS(Bv.WS_ERR,"send datachannel signal message error"+e.toString())}}unbindDcCloseEventListener(){this._transmitter&&(this._transmitter.onclose=null)}sendMessageWithJSON(e){const t=JSON.stringify(e);return{compressed:t,compressedLength:t.length,origin:e}}sendMessageWithUint8Array(e){return{compressed:e,compressedLength:e.byteLength,origin:e}}createTransmitterConnection(e){return this.connectionID+=1,this._joinChannelServiceRecordIndex=void 0,this._url="dc://".concat(e.ip,":").concat(e.port),new nv(((t,i)=>{var n;const r=()=>{Yw.debug("[".concat(this._name,"] datachannel opened:"),this._url),this.reconnectMode="retry",this.state="connected",this.resetReconnectCount("opened"),t()},o=async e=>{var n;if(null===(n=this._closeEstablishingTransmitter)||void 0===n||n.call(this),Yw.debug("[".concat(this._name,"] datachannel close ").concat(this._url,", code: ").concat(e.code,", reason: ").concat(e.reason,", current mode: ").concat(this.reconnectMode)),this._reconnectCount<this._retryConfig.maxRetryCount){"connected"===this.state&&(this.reconnectReason=e.reason,this.state="reconnecting");const n=yE(this,RT.WILL_RECONNECT,this.reconnectMode)||this.reconnectMode,r=await this.reconnectWithAction(n);if("closed"===this.state)return void Yw.debug("[".concat(this.connectionID,"] dc is closed, no need to reconnect"));if(!r)return i(new jS(Bv.WS_DISCONNECT,"datachannel reconnect failed: ".concat(e.code))),void this.close(!0);t()}else i(new jS(Bv.WS_DISCONNECT,"datachannel close: ".concat(e.code))),this.close()},s=e=>{var t;null===(t=this._reliableTransmission)||void 0===t||t.onData(e.data)};this._transmitter&&(this._transmitter.onclose=null,this._transmitter.close()),this._reliableTransmission&&(this._reliableTransmission.close(),this._reliableTransmission=void 0),Yw.debug("[".concat(this._name,"] start connect, address: ").concat(JSON.stringify(e)));const a=null===(n=this._store)||void 0===n?void 0:n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"gateway"}),c=Date.now();EE(this,RT.TO_CONNECT_DATACHANNEL,e).then((e=>{var t,i;if(!e)throw new Error("transmissonInfo not exist yet");const{transmitter:n,close:u}=e;this._transmitter=n,null===(t=this._store)||void 0===t||t.signalChannelOpen();const d=Date.now()-c;Yw.debug("[choose dc] dc open cost ".concat(d,"ms")),this._reliableTransmission=new xR((e=>{var t;this._transmitter&&"open"===this._transmitter.readyState&&(null===(t=this._transmitter)||void 0===t||t.send(e))}),(e=>{"string"==typeof e&&this.emit(RT.ON_MESSAGE,e)})),this._closeEstablishingTransmitter=()=>{var e;null===(e=this._reliableTransmission)||void 0===e||e.close(),this._reliableTransmission=void 0,u()},r&&r(),n.onclose=o,n.onmessage=s,null===(i=this._store)||void 0===i||i.recordJoinChannelService({endTs:Date.now(),status:"success"},a),this._joinChannelServiceRecordIndex=a})).catch((e=>{var t;if(null===(t=this._store)||void 0===t||t.recordJoinChannelService({endTs:Date.now(),status:e instanceof jS&&e.code===Bv.WS_ABORT?"aborted":"error",errors:[e]},a),"closed"!==this.state){if(e instanceof jS&&e.code===Bv.WS_ERR){const t=new jS(Bv.WS_ERR,"init datachannel failed! Error: ".concat(e.toString()));return Yw.error("[".concat(this._name,"]").concat(t)),void i(t)}o&&o(e)}else i(new jS(Bv.WS_DISCONNECT,"datachannel is closed: ".concat(e.toString())))}))}))}async reconnectWithAction(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this._reconnectCount>=this._retryConfig.maxRetryCount)return!1;if(!this._addresses)return!1;if("closed"===this.state)return!1;this._onlineReconnectListener||SE.networkState!==fE.OFFLINE||(this._onlineReconnectListener=SE.onlineWaiter&&SE.onlineWaiter.then((()=>{this._onlineReconnectListener=void 0})));let i=!0;if(this._reconnectInterrupter=()=>{i=!1},t){const t=QE(this._reconnectCount,this._retryConfig);Yw.debug("[".concat(this._name,"] wait ").concat(t,"ms to reconnect datachannel, mode: ").concat(e)),await nv.race([VE(t),this._onlineReconnectListener||new nv((()=>{}))])}if("closed"===this.state||!i)return!1;this._reconnectCount+=1;const n=async(e,t)=>{this.emit(RT.RECONNECT_CREATE_CONNECTION,t),await this.createTransmitterConnection(e)};try{if("retry"===e){const t=this._addresses[this.currentURLIndex];this.emit(RT.RECONNECT_WAITTING_FINISH,e),await n(t,e)}else if("tryNext"===e){this.currentURLIndex+=1;for(let e=this.currentURLIndex;e<this._addresses.length;e++){if(this._addresses[e].fingerprint||Pw("FINGERPRINT")){this.currentURLIndex=e;break}this.currentURLIndex+=1}if(this.currentURLIndex>=this._addresses.length)return Yw.debug("[".concat(this._name,"] the available addresses are exhausted, change to recover")),await this.reconnectWithAction("recover",!1);Yw.debug("[".concat(this._name,"] datachannel url length: ").concat(this._addresses.length," current index: ").concat(this.currentURLIndex));const t=this._addresses[this.currentURLIndex];this.emit(RT.RECONNECT_WAITTING_FINISH,e),await n(t,e)}else"recover"===e&&(Yw.debug("[".concat(this._name,"] start to failback to websocket")),this.resetReconnectCount("recover mode"),this.emit(RT.RECONNECT_WAITTING_FINISH,e),this.emit(RT.FAILBACK));return!0}catch(i){var r,o;return Yw.error("[".concat(this._name,"] reconnect failed"),i.toString()),null!=i&&null!==(r=i.data)&&void 0!==r&&r.desc&&Array.isArray(i.data.desc)&&i.data.desc.length&&Mn(o=i.data.desc).call(o,"dynamic key expired")?(this.emit(RT.ON_TOKEN_PRIVILEGE_DID_EXPIRE),!1):await this.reconnectWithAction(e,t)}}}class VR extends rE{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===bS.CONNECTED?this.emit(yS.WS_CONNECTED):e===bS.RECONNECTING?this.emit(yS.WS_RECONNECTING,this._websocketReconnectReason):e===bS.CLOSED&&this.emit(yS.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket?this.websocket.url:null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),oh(this,"_disconnectedReason",void 0),oh(this,"_websocketReconnectReason",void 0),oh(this,"_connectionState",bS.CLOSED),oh(this,"reconnectToken",void 0),oh(this,"websocket",void 0),oh(this,"openConnectionTime",void 0),oh(this,"clientId",void 0),oh(this,"lastMsgTime",Date.now()),oh(this,"uploadCache",[]),oh(this,"uploadCacheInterval",void 0),oh(this,"rttRolling",new lb(5)),oh(this,"pingpongTimer",void 0),oh(this,"inflateDataTimer",void 0),oh(this,"pingpongTimeoutCount",0),oh(this,"joinResponse",void 0),oh(this,"multiIpOption",void 0),oh(this,"initError",void 0),oh(this,"spec",void 0),oh(this,"store",void 0),oh(this,"onWebsocketMessage",(e=>{if(e instanceof ArrayBuffer)return void this.emit(yS.ON_BINARY_DATA,e);const t=JSON.parse(e);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")&&(this.emit(t._type,t._message),t._type===TS.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===TS.ON_USER_BANNED))switch(t._message.error_code){case 14:this.close(dE.UID_BANNED);break;case 15:this.close(dE.IP_BANNED);break;case 16:this.close(dE.CHANNEL_BANNED)}})),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new UR("gateway-".concat(this.clientId),this.spec.retryConfig,!0,t),this.handleWebsocketEvents(),window.addEventListener("offline",(()=>{this.connectionState===bS.CONNECTED&&this.reconnect("retry",TT.OFFLINE)}))}async request(e,t,i,n){const r=BE(6,""),o={_id:r,_type:e,_message:t},s=this.websocket.connectionID,a=()=>new nv(((t,i)=>{if(this.connectionState===bS.CONNECTED)return t();const n=()=>{this.off(yS.WS_CLOSED,r),t()},r=()=>{this.off(yS.WS_CONNECTED,n),i(new jS(Bv.WS_ABORT))};this.once(yS.WS_CONNECTED,n),this.once(yS.WS_CLOSED,r),e!==wS.PUBLISH&&e!==wS.SUBSCRIBE&&e!==wS.UNSUBSCRIBE&&e!==wS.UNPUBLISH&&e!==wS.CONTROL&&e!==wS.RESTART_ICE||this.once(yS.DISCONNECT_P2P,(()=>{i(new jS(Bv.DISCONNECT_P2P))})),e!==wS.PUBLISH&&e!==wS.RESTART_ICE||this.once(yS.ABORT_P2P_EXECUTION,(()=>{i(new jS(Bv.DISCONNECT_P2P))}))}));if(this.connectionState!==bS.CONNECTING&&this.connectionState!==bS.RECONNECTING||e===wS.JOIN||e===wS.REJOIN||await a(),e===wS.LEAVE&&(this.websocket.unbindDcCloseEventListener(),n=!0),this.websocket.sendMessage(o,!0,!1),n)return;const c=new nv(((i,n)=>{let o=!1;const a=(n,r)=>{o=!0,i({isSuccess:"success"===n,message:r||{}}),this.off(yS.WS_CLOSED,c),this.off(yS.WS_RECONNECTING,c),this.emit(yS.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(r),a);const c=()=>{n(new jS(Bv.WS_ABORT,"type: ".concat(e))),this.off(yS.WS_CLOSED,c),this.off(yS.WS_RECONNECTING,c),this.off("res-@".concat(r),a)};this.once(yS.WS_CLOSED,c),this.once(yS.WS_RECONNECTING,c),VE(Pw("SIGNAL_REQUEST_TIMEOUT")).then((()=>{this.websocket.connectionID!==s||o||(Yw.warning("dc request timeout, type: ".concat(e)),this.emit(yS.REQUEST_TIMEOUT,e,t))}))}));let u=null;try{u=await c}catch(n){if(this.connectionState===bS.CLOSED||e===wS.LEAVE)throw new jS(Bv.WS_ABORT);return!this.spec.forceWaitGatewayResponse||i?n.throw():e===wS.JOIN||e===wS.REJOIN?null:(await a(),await this.request(e,t))}if(u.isSuccess)return u.message;const d=Number(u.message.error_code||u.message.code),l=FT(d),h=new jS(Bv.UNEXPECTED_RESPONSE,"".concat(l.desc,": ").concat(u.message.error_str),{code:d,data:u.message});return"success"===l.action?u.message:(Yw.warning("[".concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(l.desc,", action: ").concat(l.action)),d===ES.ERR_TOO_MANY_BROADCASTERS?e===wS.JOIN||e===wS.REJOIN?(this.initError=h,this.close(),h.throw()):h.throw():"failed"===l.action?h.throw():"quit"===l.action?(this.initError=h,this.close(),h.throw()):(d===ES.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=u.message.option,Yw.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",TT.MULTI_IP)):this.reconnect(l.action,TT.SERVER_ERROR),e===wS.JOIN||e===wS.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new nv((i=>{const n=r=>{(!t||t(r))&&(this.off(e,n),i(r))};this.on(e,n)}))}uploadWRTCStats(e){if(!this.store.sessionId)return void Yw.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(SS.WRTC_STATS,t)}upload(e,t){const i={_type:e,_message:t};try{this.websocket.sendMessage(i)}catch(e){const t=Pw("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(i),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval((()=>{if(this.connectionState!==bS.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)}),Pw("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const i={_type:e,_message:t};this.websocket.sendMessage(i)}init(e,t){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new nv(((i,n)=>{this.once(yS.WS_CONNECTED,(()=>i(this.joinResponse))),this.once(yS.WS_CLOSED,(()=>n(this.initError||new jS(Bv.WS_ABORT)))),this.connectionState=bS.CONNECTING,this.websocket.init(e).catch(n),this.websocket.once(RT.FAILBACK,(()=>{void 0===this.openConnectionTime&&n(new jS(Bv.INIT_DATACHANNEL_TIMEOUT))})),this.inflateDataTimer&&window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=window.setInterval((()=>{this.handleInflateData()}),2e4),setTimeout((()=>{t&&void 0===this.openConnectionTime&&(Yw.debug("[".concat(this.clientId,"] init datachannel timeout while join with failback to websocket")),n(new jS(Bv.INIT_DATACHANNEL_TIMEOUT)))}),Pw("DC_JOIN_WITH_FAILBACK"))}))}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.inflateDataTimer&&(this.handleInflateData(),window.clearInterval(this.inflateDataTimer),this.inflateDataTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._disconnectedReason=e||dE.LEAVE,this.connectionState=bS.CLOSED,Yw.debug("[".concat(this.clientId,"] ")+"will close datachannel in signal"),this.websocket.close(),e===dE.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new UR("gateway-".concat(this.clientId),this.spec.retryConfig,!0,this.store),this.handleWebsocketEvents())}async join(){if(!this.joinResponse){this.emit(yS.ABORT_P2P_EXECUTION);const e=await EE(this,yS.DATACHANNEL_CONNECTING),t=await this.request(wS.JOIN,e);if(!t)return this.emit(yS.REPORT_JOIN_GATEWAY,Bv.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(yS.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=bS.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}async rejoin(){if(!this.reconnectToken)throw new jS(Bv.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");const e=wE(this,yS.REQUEST_REJOIN_INFO);e.token=this.reconnectToken;const t=await this.request(wS.REJOIN,e);return!!t&&(this.connectionState=bS.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),t.peers&&t.peers.forEach((e=>{this.emit(TS.ON_USER_ONLINE,{uid:e.uid}),e.audio&&this.emit(TS.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0,ssrcId:e.audio_ssrc}),e.video&&this.emit(TS.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0,ssrcId:e.video_ssrc}),e.audio_mute?this.emit(TS.MUTE_AUDIO,{uid:e.uid}):this.emit(TS.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?this.emit(TS.MUTE_VIDEO,{uid:e.uid}):this.emit(TS.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?this.emit(TS.ENABLE_LOCAL_AUDIO,{uid:e.uid}):this.emit(TS.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?this.emit(TS.ENABLE_LOCAL_VIDEO,{uid:e.uid}):this.emit(TS.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||this.emit(TS.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id})})),!0)}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleNotification(e){Yw.debug("[".concat(this.clientId,"] receive notification: "),e);const t=FT(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(dE.UID_BANNED),void this.close()):void this.reconnect(t.action,TT.SERVER_ERROR);Yw.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=Pw("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(Yw.warning("PINGPONG Timeout. Last Socket Message: ".concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>Pw("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",TT.TIMEOUT):this.request(wS.PING,void 0,!0).then((()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),Pw("REPORT_STATS")&&this.send(wS.PING_BACK,{pingpongElapse:e})})).catch((e=>{}))}handleInflateData(){const{inflateLength:e,deflateLength:t}=this.websocket.getInflateData();0!==e&&0!==t&&this.upload(SS.WS_INFLATE_DATA_LENGTH,{ws_deflate_length:t,ws_inflate_length:e})}handleWebsocketEvents(){this.websocket.on(RT.RECONNECT_WAITTING_FINISH,(e=>{this.emit(yS.WS_RECONNECT_WAITTING_FINISH,e)})),this.websocket.on(RT.RECONNECT_CREATE_CONNECTION,(e=>{this.emit(yS.WS_RECONNECT_CREATE_CONNECTION,e)})),this.websocket.on(RT.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(RT.CLOSED,(()=>{this.connectionState=bS.CLOSED})),this.websocket.on(RT.FAILED,(()=>{this._disconnectedReason=dE.NETWORK_ERROR,this.connectionState=bS.CLOSED})),this.websocket.on(RT.RECONNECTING,(e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===bS.CONNECTED?this.connectionState=bS.RECONNECTING:this.connectionState=bS.CONNECTING})),this.websocket.on(RT.WILL_RECONNECT,((e,t)=>{if(wE(this,yS.IS_P2P_DISCONNECTED)&&"retry"===e)return Yw.debug("".concat(this.clientId," reconnect mode is retry, but p2p lost, change to tryNext")),this.reconnectToken=void 0,this.emit(yS.NEED_RENEW_SESSION),this.emit(yS.DISCONNECT_P2P),t("tryNext");"retry"!==e&&(Yw.debug("".concat(this.clientId," websockt will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0,this.emit(yS.NEED_RENEW_SESSION),this.emit(yS.DISCONNECT_P2P)),t(e)})),this.websocket.on(RT.CONNECTED,(()=>{this.openConnectionTime=Date.now(),this.reconnectToken?this.rejoin().catch((e=>{Yw.warning("[".concat(this.clientId,"] rejoin failed ").concat(e)),this.reconnect("tryNext",TT.SERVER_ERROR)})):this.join().catch((e=>{if(this.emit(yS.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof jS&&e.code===Bv.UNEXPECTED_RESPONSE&&e.data.code===ES.ERR_NO_AUTHORIZED)return Yw.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",TT.SERVER_ERROR);Yw.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",TT.SERVER_ERROR):(this.initError=e,this.close())}))})),this.websocket.on(RT.REQUEST_NEW_URLS,((e,t)=>{EE(this,yS.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})),this.websocket.on(RT.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{this.emit(TS.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})),this.websocket.on(RT.TO_CONNECT_DATACHANNEL,(async(e,t,i)=>EE(this,yS.DATACHANNEL_PRECONNECT,e).then(t).catch(i))),this.websocket.on(RT.FAILBACK,(()=>{void 0!==this.openConnectionTime&&this.emit(yS.DATACHANNEL_FAILBACK)}))}}class BR extends rE{constructor(e,t){super(),oh(this,"signal",void 0),oh(this,"token",void 0),oh(this,"tokenTimeout",void 0),oh(this,"tokenInterval",void 0),oh(this,"_sequence",0),oh(this,"userMap",new Map),oh(this,"encoder",new TextEncoder),this.signal=e,this.token=t;const i=()=>{this.signal.connectionState===bS.CONNECTED&&this.check(),0===this.userMap.size?this.tokenInterval=window.setTimeout(i,1e3):this.tokenInterval=window.setTimeout(i,3*Pw("P2P_TOKEN_INTERVAL"))};i()}async send(e,t,i,n,r){var o,s,a;if(0===this.userMap.size)return;const c=Array.from(US(o=this.userMap).call(o))[0].token;"string"!=typeof t&&(t=JSON.stringify(t)),n=null!==(s=n)&&void 0!==s?s:BE(6,""),r=null!==(a=r)&&void 0!==a?a:this._sequence++;const u={_id:n,_type:e,_seq:r,_message:t,token:"".concat(this.token,"_").concat(c)};Pw("SHOW_P2P_LOG")&&Yw.debug("send message",u,"noNeedResponse : ".concat(i)),this.splitMessage(JSON.stringify(u)).forEach((e=>{this.signal.request(wS.DATA_STREAM,{payload:DE(this.encoder.encode(e))})}));const d=new nv(((t,r)=>{const o=window.setTimeout((()=>{this.off("res-@".concat(n,"_ack"),s),this.off("res-@".concat(n),c),this.off(kT.ABORT,a),Yw.debug("[external-signal] request timeout, type: ".concat(e,", requestId: ").concat(n)),0===this.userMap.size?r(new jv(Bv.INVALID_REMOTE_USER)):r(new jv(Bv.TIMEOUT))}),Pw("EXTERNAL_SIGNAL_REQUEST_TIMEOUT")),s=()=>{o&&window.clearTimeout(o),this.off(kT.ABORT,a),i&&t()},a=()=>{o&&window.clearTimeout(o),this.off("res-@".concat(n,"_ack"),s),this.off("res-@".concat(n),c),r(new jv(Bv.EXTERNAL_SIGNAL_ABORT,"type: ".concat(e,", requestId: ").concat(n)))};this.once(kT.ABORT,a),this.once("res-@".concat(n,"_ack"),s);const c=(i,c)=>{d=!0,o&&window.clearTimeout(o),this.off("res-@".concat(n,"_ack"),s),this.off(kT.ABORT,a),"success"===i?t(c):r(new jv(Bv.P2P_MESSAGE_FAILED,"request ".concat(e," failed, requestId: ").concat(n)))};let d=!1;i||(this.once("res-@".concat(n),c),VE(Pw("SIGNAL_REQUEST_TIMEOUT")).then((()=>{d||Yw.warning("external_signal request timeout, type: ".concat(e,", requestId: ").concat(n,", ").concat(u))})))}));try{return await d}catch(o){if(o.code===Bv.TIMEOUT)return await this.send(e,t,i,n,r);throw o}}onMessage(e){var t;const{_uid:i}=e;let n,r=this.userMap.get(i);if(r)n=r.splitMessageMap;else{if(this.userMap.size>0||!("_type"in e)||e._type!==NT.CHECK)return;const{token:t}=e;n=new Map,r={uid:i,isStart:!0,token:t,splitMessageMap:n,nextExpectedSequenceNumber:0,receivedMessagesMap:new Map},this.userMap.set(i,r),this.signal.emit(TS.ON_USER_ONLINE,{uid:i}),this.handleUserOnline()}if("id"in e&&"total"in e){var o;const{id:t,total:r}=e,s=null!==(o=n.get(t))&&void 0!==o?o:[];if(s.push(e),n.has(t)||n.set(t,s),s.length!==r)return;{const r=ef(s).call(s,((e,t)=>e.index-t.index)).map((e=>e.payload)).join("");n.delete(t),(e=JSON.parse(r))._uid=i}}const{_type:s,token:a}=e;if(Mn(t=[NT.ACK,NT.CHECK]).call(t,s))return s===NT.CHECK&&this.handleCheckToken(r,a),void this.receiveMessage(e);a==="".concat(r.token,"_").concat(this.token)?this.handleReceivedMessage(e):Yw.debug('Receive unexpected message", '.concat(a,", cur_token: ").concat(r.token,"_").concat(this.token),e)}check(){const e={_id:BE(6,""),token:this.token,_type:NT.CHECK};Pw("SHOW_P2P_LOG")&&Yw.debug("send message",e),this.signal.request(wS.DATA_STREAM,{payload:DE(this.encoder.encode(JSON.stringify(e)))})}ack(e){const t={_id:e,_type:NT.ACK,token:this.token};Pw("SHOW_P2P_LOG")&&Yw.debug("send message",t),this.signal.request(wS.DATA_STREAM,{payload:DE(this.encoder.encode(JSON.stringify(t)))})}response(e,t,i){this.send(NT.RESPONSE,JSON.stringify({success:!i,message:t}),!0,e)}handleReceivedMessage(e){const t=()=>{this.userMap.forEach((e=>{const{receivedMessagesMap:t,nextExpectedSequenceNumber:i}=e;for(;t.has(i);){const n=t.get(i);t.delete(i),this.receiveMessage(n),e.nextExpectedSequenceNumber++}}))};if(!e)return void t();const{_uid:i,_seq:n}=e,r=this.userMap.get(i),{receivedMessagesMap:o,isStart:s,nextExpectedSequenceNumber:a}=r;if(n<a)return this.ack(e._id),void Yw.debug("[external-signal] receive old message, seq: ".concat(n,", ").concat(e._message));o.set(n,e),s&&n===a&&(this.receiveMessage(e),o.delete(a),r.nextExpectedSequenceNumber++,t())}receiveMessage(e){const{_id:t,_type:i,_message:n,_uid:r}=e;if(Pw("SHOW_P2P_LOG")&&Yw.debug("receive message",e),t){let o;switch(e._type!==NT.ACK&&(n&&(o=JSON.parse(n)),this.ack(e._id)),e._type){case NT.CANDIDATE:case NT.CONTROL:this.signal.emit(i,o,r);break;case NT.PUBLISH:case NT.UNPUBLISH:case NT.RESTART_ICE:case NT.CALL:o.uid=r,EE(this.signal,i,o).then((t=>{this.response(e._id,t)})).catch((()=>{this.response(e._id,void 0,!0)}));break;case NT.ACK:this.getListeners("res-@".concat(t,"_ack")).length>0&&this.emit("res-@".concat(t,"_ack"));break;case NT.RESPONSE:{const{success:e,message:i}=o;this.emit("res-@".concat(t),e?"success":"failed",i);break}}}}splitMessage(e){if(e.length<BR.MAX_MESSAGE_SIZE)return[e];const t=[],{remoteToken:i}=JSON.parse(e),n=BE(6,"");let r=0,o=800;const s=Math.ceil(e.length/o);for(;e.length>0;){r++;const a={id:n,index:r,total:s,payload:e.slice(0,o),token:"".concat(this.token,"_").concat(i)};JSON.stringify(a).length>BR.MAX_MESSAGE_SIZE?o-=50:(t.push(a),e=e.slice(o))}return t.map((e=>JSON.stringify(e)))}handleCheckToken(e,t){return e.token!==t?(Yw.debug("token changed, from ".concat(e.token," to ").concat(t)),this.reset(e.uid,t),!1):(this.tokenTimeout&&(window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0),this.tokenTimeout=window.setTimeout((()=>{Yw.debug("token timeout, ".concat(t)),this.reset(e.uid)}),Pw("MAX_P2P_TIMEOUT")),!0)}async handleUserOnline(){const e=await EE(this.signal,NT.CALL,void 0),t=await this.send(NT.CALL,e);this.signal.emit(yS.P2P_CONNECTION,t,!0)}async reset(e,t){const i=this.userMap.get(e);i&&(this.emit(kT.ABORT),this.signal.emit(TS.ON_USER_OFFLINE,{uid:i.uid,reason:LT.P2P_TOKEN_CHANGED}),this._sequence=0,this.userMap.clear(),t||(Yw.debug("change local token from ".concat(t," to ").concat(t)),this.token=BE(6,"")))}clear(){this._sequence=0,this.userMap.clear(),this.tokenInterval&&window.clearTimeout(this.tokenInterval),this.tokenInterval=void 0,this.tokenTimeout&&window.clearTimeout(this.tokenTimeout),this.tokenTimeout=void 0,this.emit(kT.ABORT)}}oh(BR,"MAX_SIZE",1),oh(BR,"MAX_MESSAGE_SIZE",1024);class jR extends rE{get connectionState(){return this._connectionState}set connectionState(e){e!==this._connectionState&&(this._connectionState=e,e===bS.CONNECTED?this.emit(yS.WS_CONNECTED):e===bS.RECONNECTING?this.emit(yS.WS_RECONNECTING,this._websocketReconnectReason):e===bS.CLOSED&&this.emit(yS.WS_CLOSED,this._disconnectedReason))}get currentURLIndex(){return this.websocket.currentURLIndex}get url(){return this.websocket&&this.websocket.url||null}get rtt(){return this.rttRolling.mean()}constructor(e,t){super(),oh(this,"_disconnectedReason",void 0),oh(this,"_websocketReconnectReason",void 0),oh(this,"_connectionState",bS.CLOSED),oh(this,"reconnectToken",void 0),oh(this,"p2pToken",void 0),oh(this,"websocket",void 0),oh(this,"openConnectionTime",void 0),oh(this,"clientId",void 0),oh(this,"lastMsgTime",Date.now()),oh(this,"uploadCache",[]),oh(this,"uploadCacheInterval",void 0),oh(this,"rttRolling",new lb(5)),oh(this,"pingpongTimer",void 0),oh(this,"pingpongTimeoutCount",0),oh(this,"joinResponse",void 0),oh(this,"multiIpOption",void 0),oh(this,"initError",void 0),oh(this,"spec",void 0),oh(this,"store",void 0),oh(this,"_external_signal",void 0),oh(this,"onWebsocketMessage",(e=>{if(e.data instanceof ArrayBuffer)return void this.emit(yS.ON_BINARY_DATA,e.data);const t=JSON.parse(e.data);if(this.lastMsgTime=Date.now(),Object.prototype.hasOwnProperty.call(t,"_id")){const e="res-@".concat(t._id);this.emit(e,t._result,t._message)}else if(Object.prototype.hasOwnProperty.call(t,"_type")){switch(t._type){case TS.ON_DATA_STREAM:return void this.handleDataStream(t._message);case TS.MUTE_AUDIO:case TS.MUTE_VIDEO:case TS.ON_P2P_LOST:case TS.ON_USER_ONLINE:return;case TS.ON_USER_OFFLINE:const{uid:e}=t._message;return Yw.debug("[".concat(this.clientId,"] user-offline uid: ").concat(e)),void this._external_signal.reset(e)}if(this.emit(t._type,t._message),t._type===TS.ON_NOTIFICATION&&this.handleNotification(t._message),t._type===TS.ON_USER_BANNED)switch(t._message.error_code){case 14:this.close(dE.UID_BANNED);break;case 15:this.close(dE.IP_BANNED);break;case 16:this.close(dE.CHANNEL_BANNED)}if(t._type===TS.ON_USER_LICENSE_BANNED)switch(t._message.error_code){case ES.ERR_LICENSE_MISSING:this.close(dE.LICENSE_MISSING);break;case ES.ERR_LICENSE_EXPIRED:this.close(dE.LICENSE_EXPIRED);break;case ES.ERR_LICENSE_MINUTES_EXCEEDED:this.close(dE.LICENSE_MINUTES_EXCEEDED);break;case ES.ERR_LICENSE_PERIOD_INVALID:this.close(dE.LICENSE_PERIOD_INVALID);break;case ES.ERR_LICENSE_MULTIPLE_SDK_SERVICE:this.close(dE.LICENSE_MULTIPLE_SDK_SERVICE);break;case ES.ERR_LICENSE_ILLEGAL:this.close(dE.LICENSE_ILLEGAL);break;default:this.close()}}})),this.clientId=e.clientId,this.spec=e,this.store=t,this.websocket=new eR("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Pw("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Pw("JOIN_GATEWAY_USE_443PORT_ONLY"),t),this.handleWebsocketEvents(),window.addEventListener("offline",(()=>{this.connectionState===bS.CONNECTED&&this.reconnect("retry",hE.OFFLINE)})),this.p2pToken=BE(6,""),this._external_signal=new BR(this,this.p2pToken)}async request(e,t,i,n){const r=BE(6,""),o={_id:r,_type:e,_message:t},s=this.websocket.connectionID,a=()=>new nv(((e,t)=>{if(this.connectionState===bS.CONNECTED)return e();const i=()=>{this.off(yS.WS_CLOSED,n),e()},n=()=>{this.off(yS.WS_CONNECTED,i),t(new jv(Bv.WS_ABORT))};this.once(yS.WS_CONNECTED,i),this.once(yS.WS_CLOSED,n)}));if(this.connectionState!==bS.CONNECTING&&this.connectionState!==bS.RECONNECTING||e===wS.JOIN||e===wS.REJOIN||await a(),this.websocket.sendMessage(o,!0),n)return;const c=new nv(((i,n)=>{let o=!1;const a=(n,r)=>{o=!0,i({isSuccess:"success"===n,message:r||{}}),this.off(yS.WS_CLOSED,c),this.off(yS.WS_RECONNECTING,c),this.emit(yS.REQUEST_SUCCESS,e,t)};this.once("res-@".concat(r),a);const c=()=>{n(new jv(Bv.WS_ABORT,"type: ".concat(e))),this.off(yS.WS_CLOSED,c),this.off(yS.WS_RECONNECTING,c),this.off("res-@".concat(r),a)};this.once(yS.WS_CLOSED,c),this.once(yS.WS_RECONNECTING,c),VE(Pw("SIGNAL_REQUEST_TIMEOUT")).then((()=>{this.websocket.connectionID!==s||o||(Yw.warning("[".concat(this.clientId,"] ws request timeout, type: ").concat(e)),this.emit(yS.REQUEST_TIMEOUT,e,t))}))}));let u=null;try{u=await c}catch(n){if(this.connectionState===bS.CLOSED||e===wS.LEAVE)throw new jv(Bv.WS_ABORT);return!this.spec.forceWaitGatewayResponse||i?n.throw():e===wS.JOIN||e===wS.REJOIN?null:(await a(),await this.request(e,t))}if(u.isSuccess)return u.message;const d=Number(u.message.error_code||u.message.code),l=FT(d),h=new jv(Bv.UNEXPECTED_RESPONSE,"".concat(l.desc,": ").concat(u.message.error_str),{code:d,data:u.message});return"success"===l.action?u.message:(Yw.warning("[".concat(this.clientId,"] [").concat(this.websocket.connectionID,"] unexpected response from type ").concat(e,", error_code: ").concat(d,", message: ").concat(l.desc,", action: ").concat(l.action)),d===ES.ERR_TOO_MANY_BROADCASTERS?e===wS.JOIN||e===wS.REJOIN?(this.initError=h,this.close(),h.throw()):h.throw():"failed"===l.action?h.throw():"quit"===l.action?(this.initError=h,this.close(),h.throw()):(d===ES.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=u.message.option,Yw.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",hE.MULTI_IP)):this.reconnect(l.action,hE.SERVER_ERROR),e===wS.JOIN||e===wS.REJOIN?null:await this.request(e,t)))}waitMessage(e,t){return new nv((i=>{const n=r=>{(!t||t(r))&&(this.off(e,n),i(r))};this.on(e,n)}))}uploadWRTCStats(e){if(!this.store.sessionId)return void Yw.warn("[".concat(this.clientId,"] no session id when upload wrtc stats"));const t={lts:Date.now(),sid:this.store.sessionId,uid:this.store.intUid,stats:e};this.upload(SS.WRTC_STATS,t)}upload(e,t){const i={_type:e,_message:t};try{this.websocket.sendMessage(i)}catch(e){const t=Pw("MAX_UPLOAD_CACHE")||50;this.uploadCache.push(i),this.uploadCache.length>t&&this.uploadCache.splice(0,1),this.uploadCache.length>0&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval((()=>{if(this.connectionState!==bS.CONNECTED)return;const e=this.uploadCache.splice(0,1)[0];0===this.uploadCache.length&&(window.clearInterval(this.uploadCacheInterval),this.uploadCacheInterval=void 0),this.upload(e._type,e._message)}),Pw("UPLOAD_CACHE_INTERVAL")||2e3))}}send(e,t){const i={_type:e,_message:t};this.websocket.sendMessage(i)}async sendExtensionMessage(e,t,i){return await this._external_signal.send(e,t,i)}init(e){return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,this.openConnectionTime=void 0,new nv(((t,i)=>{this.once(yS.WS_CONNECTED,(()=>t(this.joinResponse))),this.once(yS.WS_CLOSED,(()=>i(this.initError||new jv(Bv.WS_ABORT)))),this.connectionState=bS.CONNECTING,this.websocket.init(e).catch(i)}))}close(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.reconnectToken=void 0,this.joinResponse=void 0,this._external_signal.clear(),this._disconnectedReason=e||dE.LEAVE,this.connectionState=bS.CLOSED,Yw.debug("[".concat(this.clientId,"] ")+"will close websocket in signal"),this.websocket.close(),e===dE.FALLBACK&&(this.websocket.removeAllListeners(),this.websocket=new eR("gateway-".concat(this.clientId),this.spec.retryConfig,!0,Pw("JOIN_GATEWAY_USE_DUAL_DOMAIN"),Pw("JOIN_GATEWAY_USE_443PORT_ONLY"),this.store),this.handleWebsocketEvents()),this.p2pToken=BE(6,""),this._external_signal.clear(),this._external_signal=new BR(this,this.p2pToken)}async join(){if(!this.joinResponse){this.emit(yS.ABORT_P2P_EXECUTION);const e=await EE(this,yS.REQUEST_JOIN_INFO),t=await this.request(wS.JOIN,e);if(!t)return this.emit(yS.REPORT_JOIN_GATEWAY,Bv.TIMEOUT,this.url||""),!1;this.joinResponse=t,this.emit(yS.JOIN_RESPONSE,this.joinResponse),this.reconnectToken=this.joinResponse.rejoin_token}return this.connectionState=bS.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(this.handlePingPong.bind(this),3e3),!0}reconnect(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}handleDataStream(e){try{var t;const i=PE(e.payload),n=(new TextDecoder).decode(i),r=JSON.parse(n);"total"in r&&"id"in r||Mn(t=Object.values(NT)).call(t,r._type)?(r._uid=e.uid,this._external_signal.onMessage(r)):this.emit(TS.ON_DATA_STREAM,e)}catch(t){this.emit(TS.ON_DATA_STREAM,e)}}handleNotification(e){Yw.debug("[".concat(this.clientId,"] receive notification: "),e);const t=FT(e.code);if("success"!==t.action){if("failed"!==t.action)return"quit"===t.action?("ERR_REPEAT_JOIN_CHANNEL"===t.desc&&this.close(dE.UID_BANNED),void this.close()):void this.reconnect(t.action,hE.SERVER_ERROR);Yw.error("[".concat(this.clientId,"] ignore error: "),t.desc)}}handlePingPong(){if(!this.websocket||"connected"!==this.websocket.state)return;this.pingpongTimeoutCount>0&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;const e=Pw("PING_PONG_TIME_OUT"),t=Date.now();this.pingpongTimeoutCount>=e&&(Yw.warning("[".concat(this.clientId,"] PINGPONG Timeout. Last Socket Message: ").concat(t-this.lastMsgTime,"ms")),t-this.lastMsgTime>Pw("WEBSOCKET_TIMEOUT_MIN"))?this.reconnect("retry",hE.TIMEOUT):this.request(wS.PING,void 0,!0).then((()=>{this.pingpongTimeoutCount=0;const e=Date.now()-t;this.rttRolling.add(e),Pw("REPORT_STATS")&&this.send(wS.PING_BACK,{pingpongElapse:e})})).catch((e=>{}))}handleWebsocketEvents(){this.websocket.on(IS.RECONNECT_WAITTING_FINISH,(e=>{this.emit(yS.WS_RECONNECT_WAITTING_FINISH,e)})),this.websocket.on(IS.RECONNECT_CREATE_CONNECTION,(e=>{this.emit(yS.WS_RECONNECT_CREATE_CONNECTION,e)})),this.websocket.on(IS.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(IS.CLOSED,(()=>{this.connectionState=bS.CLOSED})),this.websocket.on(IS.FAILED,(()=>{this._disconnectedReason=dE.NETWORK_ERROR,this.connectionState=bS.CLOSED})),this.websocket.on(IS.RECONNECTING,(e=>{this._websocketReconnectReason=e,this.joinResponse=void 0,this.connectionState===bS.CONNECTED?this.connectionState=bS.RECONNECTING:this.connectionState=bS.CONNECTING})),this.websocket.on(IS.WILL_RECONNECT,((e,t,i)=>{"retry"!==e?(Yw.debug("".concat(this.clientId," websocket will_connect event, renewSession reconnectMode is ").concat(e)),this.reconnectToken=void 0,this.emit(yS.NEED_RENEW_SESSION)):Yw.debug("".concat(this.clientId," reconnect mode is retry, no need to renew session")),i(e)})),this.websocket.on(IS.CONNECTED,(()=>{this.openConnectionTime=Date.now(),this.join().catch((e=>{if(this.emit(yS.REPORT_JOIN_GATEWAY,e.message||e.code,this.url||""),e instanceof jv&&e.code===Bv.UNEXPECTED_RESPONSE&&e.data.code===ES.ERR_NO_AUTHORIZED)return Yw.warning("[".concat(this.clientId,"] reconnect no authorized, recover")),void this.reconnect("recover",hE.SERVER_ERROR);Yw.error("[".concat(this.clientId,"] join gateway request failed"),e.toString()),this.spec.forceWaitGatewayResponse?this.reconnect("tryNext",hE.SERVER_ERROR):(this.initError=e,this.close())}))})),this.websocket.on(IS.REQUEST_NEW_URLS,((e,t)=>{EE(this,yS.REQUEST_RECOVER,this.multiIpOption).then(e).catch(t)})),this.websocket.on(IS.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{this.emit(TS.ON_TOKEN_PRIVILEGE_DID_EXPIRE)}))}}function FR(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function WR(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?FR(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):FR(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}const GR=new Map;class HR extends rE{get state(){return this._state}set state(e){if(e===this._state)return;const t=this._state;this._state=e,"DISCONNECTED"===e&&this._disconnectedReason?this.emit(nT.CONNECTION_STATE_CHANGE,e,t,this._disconnectedReason):this.emit(nT.CONNECTION_STATE_CHANGE,e,t)}get joinGatewayStartTime(){return this._joinGatewayStartTime}set joinGatewayStartTime(e){Yw.debug("[".concat(this.store.clientId,"] set joinGatewayStartTime at ").concat(e)),this._joinGatewayStartTime=e}constructor(e,t){super(),oh(this,"store",void 0),oh(this,"joinInfo",void 0),oh(this,"key",void 0),oh(this,"ntpOffset",0),oh(this,"signal",void 0),oh(this,"role",void 0),oh(this,"inChannelInfo",{joinAt:null,duration:0}),oh(this,"spec",void 0),oh(this,"_state","DISCONNECTED"),oh(this,"_statsCollector",void 0),oh(this,"_disconnectedReason",void 0),oh(this,"isSignalRecover",!1),oh(this,"hasChangeBGPAddress",!1),oh(this,"trafficStatsInterval",void 0),oh(this,"networkQualityInterval",void 0),oh(this,"_joinGatewayStartTime",0),oh(this,"_signalTimeout",!1),oh(this,"_clientRoleOptions",void 0),oh(this,"_isProactiveJoin",!1),this.store=e,this.spec=t,this.signal=this.store.useP2P?new jR(WR(WR({},t),{},{retryConfig:t.websocketRetryConfig}),e):this.store.useDataChannel?new VR(WR(WR({},t),{},{retryConfig:t.websocketRetryConfig}),e):new iR(WR(WR({},t),{},{retryConfig:t.websocketRetryConfig}),e),this._statsCollector=t.statsCollector,this.role=t.role||"audience",this._clientRoleOptions=t.clientRoleOptions,this.handleSignalEvents()}async join(e,t,i){if(this.signal instanceof VR){let t=!1;"disabled"!==e.cloudProxyServer?(Yw.debug("[".concat(this.store.clientId,"] Dc is not supported, because cloudProxyServer are not supported (").concat(e.cloudProxyServer,")")),t=!0):"".concat(e.apResponse.cid,"_").concat(e.apResponse.cert).length>255||"".concat(e.apResponse.cid,"_").concat(e.apResponse.cert).length<22?(Yw.debug("[".concat(this.store.clientId,"] Dc is not supported, because ticket length is incorrect, it has to be between 22 and 255")),t=!0):e.apResponse.addresses.some((e=>e.fingerprint))||Pw("FINGERPRINT")||(Yw.debug("[".concat(this.store.clientId,"] Dc is not supported, because fingerprint does not exist")),t=!0),t&&this.resetSignal()}this.store.joinGatewayStart(),"disabled"!==e.cloudProxyServer&&(this.hasChangeBGPAddress=!0);const n=Date.now();let r=GR.get(e.cname);if(r||(r=new Map,GR.set(e.cname,r)),this._isProactiveJoin=!0,r.has(e.uid)){const t=new jS(Bv.UID_CONFLICT);throw aS.joinGateway(e.sid,{lts:n,succ:!1,ec:t.message,addr:null,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!e.proxyServer,signalChannel:this.signal instanceof VR?"1":"0"}),this._isProactiveJoin=!1,t}r.set(e.uid,!0),this.joinInfo=e,this.key=t;let o=0;this.joinGatewayStartTime=n;const s=e.proxyServer;try{let t;if(Yw.debug("[".concat(this.store.clientId,"] use ").concat(this.signal instanceof VR?"datachannel":"websocket"," join uid ").concat(o)),this.signal instanceof VR)t=await this.signal.init(e.apResponse.addresses,i);else{const n=e.gatewayAddrs.map((t=>{let{address:i}=t;const[n,r]=i.split(":"),o={host:n,port:r};return e.proxyServer&&(o.proxy=e.proxyServer),o}));t=await this.signal.init(n,i)}o=t.uid,Yw.debug("[".concat(this.store.clientId,"] ").concat(this.signal instanceof VR?"datachannel":"websocket"," join uid ").concat(o," cost ").concat(Date.now()-this.joinGatewayStartTime))}catch(t){if(t&&t.code===Bv.INIT_WEBSOCKET_TIMEOUT)throw Yw.warning("[".concat(this.store.clientId,"] User join failed"),t.toString()),t;if(t&&t.code===Bv.INIT_DATACHANNEL_TIMEOUT)throw Yw.warning("[".concat(this.store.clientId,"] User join datachannel failed"),t.toString()),this.resetSignal(),t;throw Yw.error("[".concat(this.store.clientId,"] User join failed"),t.toString()),aS.joinGateway(e.sid,{lts:n,succ:!1,ec:t.message,addr:this.signal.url,uid:e.uid,cid:e.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!s,signalChannel:this.signal instanceof VR?"1":"0"}),this._isProactiveJoin=!1,r.delete(e.uid),this.signal.close(),t}return this.state="CONNECTED",this.inChannelInfo.joinAt=Date.now(),Yw.debug("[".concat(this.store.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval((()=>{this.updateTrafficStats().catch((e=>{Yw.warning("[".concat(this.store.clientId,"] get traffic stats error"),e.toString())}))}),3e3),this.networkQualityInterval=window.setInterval((()=>{navigator&&void 0!==navigator.onLine&&!navigator.onLine?this.emit(nT.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):this._signalTimeout?this.emit(nT.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):"CONNECTED"===this.state&&this._statsCollector.trafficStats?this.emit(nT.NETWORK_QUALITY,{uplinkNetworkQuality:OR(this._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:OR(this._statsCollector.trafficStats.B_dnq)}):this.emit(nT.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})}),2e3),this.store.joinGatewayEnd(),o}async leave(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;if("DISCONNECTED"!==this.state){t!==dE.FALLBACK&&(this.state="DISCONNECTING");try{e||this.signal.connectionState!==bS.CONNECTED||await function(e,t){return t===1/0?e:nv.race([e,UE(t)])}(this.signal.request(wS.LEAVE,void 0,!0),3e3)}catch(e){Yw.warning("[".concat(this.store.clientId,"] leave request failed, ignore"),e)}this.signal.close(t),t!==dE.FALLBACK&&(this.state="DISCONNECTED"),this.reset()}}async publish(e,t,i){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new jS(Bv.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const n={state:"offer",p2p_id:this.store.p2pId,ortc:t,mode:this.spec.mode,extend:Pw("PUB_EXTEND"),twcc:!!Pw("PUBLISH_TWCC"),rtx:!!Pw("USE_PUB_RTX")};try{return(await this.signal.request(wS.PUBLISH,n,!0))._message}catch(n){if(i&&n.data&&n.data.code===ES.ERR_PUBLISH_REQUEST_INVALID)return Yw.warning("[".concat(this.store.clientId,"] receive publish error code, retry"),n.toString()),await this.tryUnpubBeforeRepub(e,t),this.publish(e,t,!1);throw n}}async publishDataChannel(e,t,i){var n;if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new jS(Bv.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));const r={stream_id:t.streamId,ordered:t.ordered?1:0,max_retrans_times:null!==(n=t.maxRetransmits)&&void 0!==n?n:10,channel_id:t.channelId,metadata:t.metadata};try{await this.signal.request(wS.PUBLISH_DATASTREAM,r,!0)}catch(n){if(i&&n.data&&n.data.code===ES.ERR_PUBLISH_REQUEST_INVALID)return Yw.warning("[".concat(this.store.clientId,"] receive publish datachannels error code, retry"),n.toString()),await this.tryUnpubDataChannelBeforeRepub(e,t),this.publishDataChannel(e,t,!1);throw n}}async unpublish(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new jS(Bv.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await this.signal.request(wS.UNPUBLISH,{stream_id:t,ortc:e},!0)}catch(e){Yw.warning("[".concat(this.store.clientId,"] unpublish warning: "),e)}}async unpublishDataChannel(e){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new jS(Bv.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await nv.all(e.map((e=>this.signal.request(wS.UNPUBLISH_DATASTREAM,{channel_id:e},!0))))}catch(e){Yw.warning("unpublish datachannels warning: ",e)}}async presubscribe(e,t,i){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new jS(Bv.INVALID_OPERATION,"can not presubscribe when connection state is ".concat(this.state));const n={stream_id:e,stream_type:t,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Pw("SUBSCRIBE_TWCC"),rtx:!!Pw("USE_SUB_RTX")||void 0,extend:Pw("SUB_EXTEND"),svc:Array.isArray(Pw("SVC"))&&0!==Pw("SVC").length?Pw("SVC"):void 0};try{return await this.signal.request(wS.PRE_SUBSCRIBE,n,!0)}catch(n){if(i&&n.data&&n.data.code===ES.ERR_SUBSCRIBE_REQUEST_INVALID)return Yw.warning("[".concat(this.store.clientId,"] pre-subscribe error, retry"),n.toString()),this.presubscribe(e,t,!1);throw n}}async subscribe(e,t,i){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new jS(Bv.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state));const n={stream_id:e,stream_type:t.stream_type,mode:this.spec.mode,codec:this.spec.codec,p2p_id:this.store.p2pId,twcc:!!Pw("SUBSCRIBE_TWCC"),rtx:!!Pw("USE_SUB_RTX"),extend:Pw("SUB_EXTEND"),ssrcId:t.ssrcId,svc:Array.isArray(Pw("SVC"))&&0!==Pw("SVC").length?Pw("SVC"):void 0};try{return(await this.signal.request(wS.SUBSCRIBE,n,!0))._message}catch(n){if(i&&n.data&&n.data.code===ES.ERR_SUBSCRIBE_REQUEST_INVALID)return Yw.warning("[".concat(this.store.clientId,"] receiver subscribe error code, retry"),n.toString()),await this.tryUnsubBeforeResub(e,t),await this.subscribe(e,t,!1);throw n}}async subscribeDataChannel(e,t,i){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new jS(Bv.INVALID_OPERATION,"can not subscribe datachannel when connection state is ".concat(this.state));const n={uid:e,stream_id:t.id,channel_id:t.datachannelId};try{return void await this.signal.request(wS.SUBSCRIBE_DATASTREAM,n,!0)}catch(n){if(i&&n.data&&n.data.code===ES.ERR_SUBSCRIBE_REQUEST_INVALID)return Yw.warning("[".concat(this.store.clientId,"] receiver subscribe datachannel error code, retry"),n.toString()),await this.tryUnsubDataChannelBeforeResub(e,t),await this.subscribeDataChannel(e,t,!1);throw n}}async subscribeAll(e,t){if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new jS(Bv.INVALID_OPERATION,"can not massSubscribe when connection state is ".concat(this.state));const i={p2p_id:this.store.p2pId,users:e,dtx:!1,rtx:!!Pw("USE_SUB_RTX")};try{return await this.signal.request(wS.SUBSCRIBE_STREAMS,i,!0)}catch(i){if(t&&i.data&&i.data.code===ES.ERR_SUBSCRIBE_REQUEST_INVALID)return Yw.warning("[".concat(this.store.clientId,"] receiver massSubscribe error code, retry"),i.toString()),await this.tryMassUnsubBeforeResub(e),await this.subscribeAll(e,!1);throw i}}async setVideoProfile(e){const t=function(e){if(!(e.bitrateMax&&e.bitrateMin&&e.frameRate&&e.height&&e.width))return;let t=e.frameRate,i=e.width,n=e.height,r=!0;return"number"!=typeof t&&(t=t.exact||t.ideal||t.max||t.min||0,t||(r=!1)),"number"!=typeof i&&(i=i.exact||i.ideal||i.max||i.min||0,i||(r=!1)),"number"!=typeof n&&(n=n.exact||n.ideal||n.max||n.min||0,t||(r=!1)),r?{stream_type:0,width:i,height:n,fps:t,start_bps:1e3*e.bitrateMax,min_bps:1e3*e.bitrateMin,target_bps:1e3*e.bitrateMax}:void 0}(e);if(t)return this.signal.request(wS.SET_VIDEO_PROFILE,t);Yw.debug("[".concat(this.store.clientId,"] encoder config is not complete, do not report to gateway"))}async unsubscribe(e,t){try{await this.signal.request(wS.UNSUBSCRIBE,{p2p_id:this.store.p2pId,ortc:e,stream_id:t},!0)}catch(e){Yw.warning("[".concat(this.store.clientId,"] unsubscribe warning: "),e)}}async unsubscribeDataChannel(e,t){try{if("CONNECTED"!==this.state&&"RECONNECTING"!==this.state)throw new jS(Bv.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state));await nv.all(e.map((e=>this.signal.request(wS.UNSUBSCRIBE_DATASTREAM,{stream_id:e,uid:t},!0))))}catch(e){Yw.warning("unsubscribeDataChannel warning: ",e)}}async massUnsubscribe(e){try{await this.signal.request(wS.UNSUBSCRIBE_STREAMS,e,!0)}catch(e){Yw.warning("[".concat(this.store.clientId,"] massUnsubscribeAll warning: "),e)}}async reconnectPC(e){const{iceParameters:t,dtlsParameters:i,rtpCapabilities:n}=e;return{gatewayEstablishParams:await this.signal.request(wS.CONNECT_PC,{p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:{iceParameters:t,dtlsParameters:i,rtpCapabilities:n}},!0),gatewayAddress:this.getCurrentGatewayAddress()}}getGatewayInfo(){return this.signal.request(wS.GATEWAY_INFO)}async renewToken(e){await this.signal.request(wS.RENEW_TOKEN,e),this.key=e.token}async setClientRole(e,t){if(t&&(this._clientRoleOptions=Object.assign({},t)),"CONNECTED"!==this.state)return void(this.role=e);let i,n=0;"audience"===e?this._clientRoleOptions&&this._clientRoleOptions.delay?(i=this._clientRoleOptions.delay,n=1):n=this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:n=0,await this.signal.request(wS.SET_CLIENT_ROLE,{role:e,level:n,delay:i,client_ts:Date.now()}),this.role=e}async setRemoteVideoStreamType(e,t){await this.signal.request(wS.SWITCH_VIDEO_STREAM,{stream_id:e,stream_type:t})}async setDefaultRemoteVideoStreamType(e){await this.signal.request(wS.DEFAULT_VIDEO_STREAM,{stream_type:e})}async setStreamFallbackOption(e,t){await this.signal.request(wS.SET_FALLBACK_OPTION,{stream_id:e,fallback_type:t})}async pickSVCLayer(e,t){await this.signal.request(wS.PICK_SVC_LAYER,{stream_id:e,spatial_layer:t.spatialLayer,temporal_layer:t.temporalLayer})}async setRTM2Flag(e){await this.signal.request(wS.SET_RTM2_FLAG,{rtm2_flag:e})}async sendExtensionMessage(e,t,i){if(this.signal instanceof jR)return this.signal.sendExtensionMessage(e,t,i)}getInChannelInfo(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt),WR({},this.inChannelInfo)}async getGatewayVersion(){return(await this.signal.request(wS.GATEWAY_INFO)).version}reset(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=Date.now()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){const e=GR.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.joinInfo=void 0,this.key=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}updateTurnConfigFromSignal(){if(!this.joinInfo)return;const e=function(e){let t;return t=e.startsWith("dc")?e.match(/(dc\:\/\/)?([^:]+):(\d+)/):e.match(/(wss\:\/\/)?([^:]+):(\d+)/),t?{username:uS.username,password:uS.password,turnServerURL:t[2],tcpport:parseInt(t[3])+30,udpport:parseInt(t[3])+30,forceturn:!1}:null}(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex].address)||"");this.joinInfo.turnServer.serversFromGateway=[],e&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&this.joinInfo.turnServer.serversFromGateway.push(WR(WR({},uS),{},{turnServerURL:e.turnServerURL,tcpport:e.tcpport,udpport:e.udpport,username:this.joinInfo.uid.toString(),password:this.joinInfo.token}))}async updateTrafficStats(){if("CONNECTED"!==this.state)return;const e=await this.signal.request(wS.TRAFFIC_STATS,void 0,!0);e.timestamp=Date.now(),null!=e.ntp_offset&&(this.ntpOffset=e.ntp_offset),e.peer_delay.forEach((e=>{const t=this._statsCollector.trafficStats&&this._statsCollector.trafficStats.peer_delay.find((t=>t.peer_uid===e.peer_uid));t&&t.B_st!==e.B_st&&AE((()=>{this.emit(nT.STREAM_TYPE_CHANGE,e.peer_uid,e.B_st)}))})),this._statsCollector.updateTrafficStats(e)}getJoinMessage(e){if(!this.joinInfo||!this.key)throw new jS(Bv.UNEXPECTED_ERROR,"can not generate join message, no join info");const t=Object.assign({},this.joinInfo.apResponse);let i=Pw("REPORT_APP_SCENARIO");if("string"!=typeof i)try{i=JSON.stringify(i)}catch(e){i=void 0}i&&i.length>128&&(i=void 0);const n=WR({license:this.joinInfo.license,p2p_id:this.store.p2pId,session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Iw,browser:navigator.userAgent,process_id:Pw("PROCESS_ID"),mode:this.store.useP2P?"p2p":this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:t,extend:Pw("JOIN_EXTEND"),details:{6:this.joinInfo.stringUid,cservice_map:"proxy3"===this.joinInfo.cloudProxyServer?"1":"proxy5"===this.joinInfo.cloudProxyServer?"2":void 0},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:i,attributes:{userAttributes:{enablePublishedUserList:Pw("ENABLE_PUBLISHED_USER_LIST"),maxSubscription:Pw("MAX_SUBSCRIPTION"),subscribeAudioFilterTopN:"number"==typeof Pw("SUBSCRIBE_AUDIO_FILTER_TOPN")?Pw("SUBSCRIBE_AUDIO_FILTER_TOPN"):void 0,enablePublishAudioFilter:"boolean"==typeof Pw("ENABLE_PUBLISH_AUDIO_FILTER")?Pw("ENABLE_PUBLISH_AUDIO_FILTER"):void 0,enableUserLicenseCheck:"boolean"==typeof Pw("ENABLE_USER_LICENSE_CHECK")?Pw("ENABLE_USER_LICENSE_CHECK"):void 0,enableRTX:!0===Pw("USE_PUB_RTX")||!0===Pw("USE_SUB_RTX")||void 0,disableFEC:Pw("DISABLE_FEC"),enableNTPReport:!!Pw("ENABLE_NTP_REPORT")||void 0,enableInstantVideo:!!Pw("ENABLE_INSTANT_VIDEO")||void 0,enableDataStream2:"boolean"==typeof Pw("ENABLE_DATASTREAM_2")?Pw("ENABLE_DATASTREAM_2"):void 0,rtm2Flag:"number"==typeof this.joinInfo.rtmFlag?this.joinInfo.rtmFlag:void 0,enableUserAutoRebalanceCheck:!!Pw("ENABLE_USER_AUTO_REBALANCE_CHECK"),enableXR:"boolean"==typeof Pw("USE_XR")?Pw("USE_XR"):void 0}},join_ts:this.joinGatewayStartTime},e);return this.joinInfo.stringUid&&(n.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(n.aes_mode=this.joinInfo.aesmode,Pw("ENCRYPT_AES")?(n.aes_secret=this.joinInfo.aespassword,n.aes_encrypt=!0):n.aes_secret=this.joinInfo.aespassword,this.joinInfo.aessalt&&(n.aes_salt=this.joinInfo.aessalt)),t.addresses[this.signal.websocket.currentURLIndex]&&(n.ap_response.ticket=t.addresses[this.signal.websocket.currentURLIndex].ticket,delete t.addresses),void 0!==this.joinInfo.defaultVideoStream&&(n.default_video_stream=this.joinInfo.defaultVideoStream),n}getRejoinMessage(){if(!this.joinInfo)throw new jS(Bv.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}handleSignalEvents(){this.signal.on(yS.WS_RECONNECT_WAITTING_FINISH,(e=>{var t;Mn(t=["tryNext","recover"]).call(t,e)&&this.joinInfo&&aS.adjustSessionStartTime(this.joinInfo.sid)})),this.signal.on(yS.WS_RECONNECT_CREATE_CONNECTION,(e=>{this.joinGatewayStartTime=Date.now()})),this.signal.on(yS.WS_RECONNECTING,(e=>{this.joinInfo&&aS.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:e||hE.NETWORK_ERROR}),this.joinInfo&&(this.state="RECONNECTING",aS.sessionInit(this.joinInfo.sid,{lts:(new Date).getTime(),extend:this.isSignalRecover?{recover:!0}:{rejoin:!0},cname:this.joinInfo.cname,appid:this.joinInfo.appId,mode:this.spec.mode,stringUid:this.joinInfo.stringUid,channelProfile:"live"===this.spec.mode?1:0,channelMode:0,lsid:this.joinInfo.sid,clientRole:"audience"===this.role?2:1}),this.isSignalRecover=!1,this.joinGatewayStartTime=Date.now())})),this.signal.on(yS.WS_CLOSED,(e=>{let t;switch(e){case dE.LEAVE:t=hE.LEAVE;break;case dE.UID_BANNED:case dE.IP_BANNED:case dE.CHANNEL_BANNED:case dE.SERVER_ERROR:t=hE.SERVER_ERROR;break;case dE.FALLBACK:t=hE.FALLBACK;break;case dE.LICENSE_MISSING:case dE.LICENSE_EXPIRED:case dE.LICENSE_MINUTES_EXCEEDED:case dE.LICENSE_PERIOD_INVALID:case dE.LICENSE_MULTIPLE_SDK_SERVICE:case dE.LICENSE_ILLEGAL:case dE.TOKEN_EXPIRE:t=e;break;default:t=hE.NETWORK_ERROR}Yw.debug("[".concat(this.store.clientId,"] [signal] websocket closed, reason: ").concat(t||"undefined -> "+hE.NETWORK_ERROR)),this.joinInfo&&aS.WebSocketQuit(this.joinInfo.sid,{lts:Date.now(),succ:e===dE.LEAVE?1:-1,cname:this.joinInfo.cname,uid:this.joinInfo.uid,cid:this.joinInfo.cid,errorCode:t}),this._disconnectedReason=e,e!==dE.FALLBACK&&(this.state="DISCONNECTED"),this.reset()})),this.signal.on(yS.WS_CONNECTED,(()=>{if(this.updateTurnConfigFromSignal(),this.state="CONNECTED",this.joinInfo&&("audience"===this.role&&this._clientRoleOptions&&(this._clientRoleOptions.level||this._clientRoleOptions.delay)&&(Yw.debug("[".concat(this.store.clientId,"] patch to send set client role, role: ").concat(this.role,", mode: ").concat(this.spec.mode,", level: ").concat(this._clientRoleOptions.level,", delay: ").concat(this._clientRoleOptions.delay)),this.setClientRole(this.role,this._clientRoleOptions)),aS.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!0,ec:null,vid:this.joinInfo.vid,addr:this.signal.url,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof VR?"1":"0"}),this._isProactiveJoin=!1,this.joinInfo.useLocalAccessPoint&&1===this.joinInfo.setLocalAPVersion)){const e=this.signal.url&&this.signal.url.match(/wss\:\/\/([^:]+):(\d+)/);if(!e)return void Yw.error("[".concat(this.store.clientId,"] set local access point after joined failed: ").concat(e));kw("EVENT_REPORT_DOMAIN",e[1]),kw("EVENT_REPORT_BACKUP_DOMAIN",e[1]),kw("LOG_UPLOAD_SERVER","".concat(e[1],":6444"))}})),this.signal.on(TS.ON_UPLINK_STATS,(e=>{this._statsCollector.updateUplinkStats(e)})),this.signal.on(yS.REQUEST_RECOVER,((e,t,i)=>{if(!this.joinInfo)return i(new jS(Bv.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));e&&(this.joinInfo.multiIP=e,this.hasChangeBGPAddress=!0),this.isSignalRecover=!0,EE(this,nT.REQUEST_NEW_GATEWAY_LIST).then(t).catch(i)})),this.signal.on(yS.REQUEST_JOIN_INFO,(async e=>{var t;if(this.updateTurnConfigFromSignal(),this.store.useP2P)return void e(this.getJoinMessage({ortc:{}}));const{iceParameters:i,dtlsParameters:n,rtpCapabilities:r}=await EE(this,nT.REQUEST_P2P_CONNECTION_PARAMS,{turnServer:null===(t=this.joinInfo)||void 0===t?void 0:t.turnServer});e(this.getJoinMessage({ortc:{iceParameters:i,dtlsParameters:n,rtpCapabilities:r,version:"2"}}))})),this.signal.on(yS.REQUEST_REJOIN_INFO,(e=>{e(this.getRejoinMessage())})),this.signal.on(yS.REPORT_JOIN_GATEWAY,((e,t)=>{this.joinInfo&&(aS.joinGateway(this.joinInfo.sid,{lts:this.joinGatewayStartTime,succ:!1,ec:e,addr:t,uid:this.joinInfo.uid,cid:this.joinInfo.cid,firstSuccess:this._isProactiveJoin,avoidJoinStartTime:this.store.avoidJoinStart,isProxy:!!this.joinInfo.proxyServer,signalChannel:this.signal instanceof VR?"1":"0"}),this._isProactiveJoin=!1)})),this.signal.on(yS.IS_P2P_DISCONNECTED,(e=>{e(wE(this,nT.IS_P2P_DISCONNECTED))})),this.signal.on(yS.DISCONNECT_P2P,(()=>{this.emit(nT.DISCONNECT_P2P)})),this.signal.on(yS.NEED_RENEW_SESSION,(()=>{this.emit(nT.NEED_RENEW_SESSION)})),this.signal.on(yS.REQUEST_SUCCESS,(()=>{this._signalTimeout=!1})),this.signal.on(yS.REQUEST_TIMEOUT,(()=>{this._signalTimeout=!0})),this.signal.on(yS.JOIN_RESPONSE,(e=>{const t=this.getCurrentGatewayAddress();this.emit(nT.JOIN_RESPONSE,e,t)})),this.signal.on(yS.DATACHANNEL_PRECONNECT,(async(e,t,i)=>{this.updateTurnConfigFromSignal();const n=this.getCurrentGatewayAddress();return EE(this,nT.DATACHANNEL_PRECONNECT,e,n).then(t).catch(i)})),this.signal.on(yS.DATACHANNEL_CONNECTING,(async e=>{const{iceParameters:t,dtlsParameters:i,rtpCapabilities:n}=await EE(this,nT.REQUEST_DC_CONNECTION_PARAMS);e(this.getJoinMessage({ortc:{iceParameters:t,dtlsParameters:i,rtpCapabilities:n,version:"2"}}))})),this.signal.on(yS.DATACHANNEL_FAILBACK,(()=>{Yw.warning("[".concat(this.store.clientId,"] User join datachannel failed")),this.reset(),this.resetSignal(),this.emit(nT.DATACHANNEL_FAILBACK)}))}async tryUnsubBeforeResub(e,t){try{await this.signal.request(wS.UNSUBSCRIBE,{p2p_id:this.store.p2pId,stream_id:e,ortc:[t]},!0)}catch(e){throw Yw.warning("[".concat(this.store.clientId,"] tryUnsubBeforeResub warning"),e),e}}async tryUnsubDataChannelBeforeResub(e,t){try{await this.signal.request(wS.UNSUBSCRIBE,{stream_id:t.id},!0)}catch(e){throw Yw.warning("unsubscribe datachannel warning",e),e}}async tryUnpubBeforeRepub(e,t){try{await this.signal.request(wS.UNPUBLISH,{stream_id:e,ortc:t},!0)}catch(e){throw Yw.warning("[".concat(this.store.clientId,"] tryUnpubBeforeRepub warning: "),e),e}}async tryUnpubDataChannelBeforeRepub(e,t){try{await this.signal.request(wS.UNPUBLISH_DATASTREAM,{channnel_id:t.channelId},!0)}catch(e){throw Yw.warning("unpublish datastream warning: ",e),e}}async tryMassUnsubBeforeResub(e){const t={users:e.map((e=>({stream_id:e.stream_id,stream_type:e.stream_type})))};try{await this.signal.request(wS.UNSUBSCRIBE_STREAMS,t,!0)}catch(e){throw Yw.warning("[".concat(this.store.clientId,"] tryMassUnsubBeforeResub warning"),e),e}}async muteLocal(e,t){const i={action:e.find((e=>e.stream_type===iT.Audio))?"mute_local_audio":"mute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(wS.CONTROL,i,!0,!0)}catch(e){throw Yw.warning("[".concat(this.store.clientId,"] gateway muteLocal warning: "),e),e}}async unmuteLocal(e,t){const i={action:e.find((e=>e.stream_type===iT.Audio))?"unmute_local_audio":"unmute_local_video",p2p_id:this.store.p2pId,ortc:e,stream_id:t};try{await this.signal.request(wS.CONTROL,i,!0,!0)}catch(e){throw Yw.warning("[".concat(this.store.clientId,"] gateway unmuteLocal warning: "),e),e}}async muteRemote(e,t){const i={action:e===pT.AUDIO?"mute_remote_audio":"mute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(wS.CONTROL,i,!0,!0)}catch(e){throw Yw.warning("[".concat(this.store.clientId,"] gateway muteRemote warning: "),e),e}}async unmuteRemote(e,t){const i={action:e===pT.AUDIO?"unmute_remote_audio":"unmute_remote_video",p2p_id:this.store.p2pId,stream_id:t};try{await this.signal.request(wS.CONTROL,i,!0,!0)}catch(e){throw Yw.warning("[".concat(this.store.clientId,"] gateway unmuteRemote warning: "),e),e}}uploadWRTCStats(e){this.signal.uploadWRTCStats(e)}upload(e,t){this.signal.upload(e,t)}getSignalRTT(){return this.signal.rtt}async restartICE(e){const t={p2p_id:this.store.p2pId,stream_id:this.store.uid,ortc:e};try{return await this.signal.request(wS.RESTART_ICE,t,!0)}catch(e){throw Yw.warning("[".concat(this.store.clientId,"] P2PChannel.restartICE warning: "),e),e}}reconnect(){"CONNECTED"===this.state&&this.signal.reconnect(void 0,hE.P2P_FAILED)}getCurrentGatewayAddress(){var e;if(!Pw("GATEWAY_WSS_ADDRESS"))return null!==(e=this.joinInfo)&&void 0!==e&&e.gatewayAddrs?this.joinInfo.gatewayAddrs[this.signal.currentURLIndex]:void 0}async setPublishAudioFilterEnabled(e){await this.signal.request(wS.SET_PARAMETER,{enablePublishAudioFilter:e})}resetSignal(){this.signal&&(this.signal.removeAllListeners(),this.signal.close(dE.FALLBACK)),this.store.useDataChannel=!1,this.signal=new iR(WR(WR({},this.spec),{},{retryConfig:this.spec.websocketRetryConfig}),this.store),this.handleSignalEvents(),this.emit(nT.RESET_SIGNAL,sT.websocket)}}let qR=0,KR=0;function zR(e,t,i,n){return new nv(((r,o)=>{t.timeout=t.timeout||Pw("HTTP_CONNECT_TIMEOUT"),t.responseType=t.responseType||"json",t.data&&!i?(t.data=JSON.stringify(t.data),qR+=LE(t.data)):i&&(t.data.size?qR+=t.data.size:t.data instanceof FormData?qR+=xE(t.data):qR+=LE(JSON.stringify(t.data))),t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,gw.request(t).then((e=>{"string"==typeof e.data?KR+=LE(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?KR+=e.data.byteLength:KR+=LE(JSON.stringify(e.data)),n&&r({data:e.data,headers:e.headers}),r(e.data)})).catch((e=>{gw.isCancel(e)?o(new jS(Bv.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?o(new jS(Bv.NETWORK_TIMEOUT,e.message)):e.response?o(new jS(Bv.NETWORK_RESPONSE_ERROR,e.response.status)):o(new jS(Bv.NETWORK_ERROR,e.message))}))}))}!function(){var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var i,n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){return e==Array.prototype||e==Object.prototype||(e[t]=i.value),e},o=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof r&&r];for(var t=0;t<e.length;++t){var i=e[t];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")}(this);function s(e,t){if(t)e:{var i=o;e=e.split(".");for(var r=0;r<e.length-1;r++){var s=e[r];if(!(s in i))break e;i=i[s]}(t=t(r=i[e=e[e.length-1]]))!=r&&null!=t&&n(i,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function c(e){var i="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return i?i.call(e):{next:t(e)}}if(s("Symbol",(function(e){function t(e,t){this.A=e,n(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.A};var i="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",r=0;return function e(n){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(i+(n||"")+"_"+r++,n)}})),s("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var i="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),r=0;r<i.length;r++){var s=o[i[r]];"function"==typeof s&&"function"!=typeof s.prototype[e]&&n(s.prototype,e,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return e})),"function"==typeof Object.setPrototypeOf)i=Object.setPrototypeOf;else{var u;e:{var d={};try{d.__proto__={a:!0},u=d.a;break e}catch(e){}u=!1}i=u?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var l=i;function h(){this.m=!1,this.j=null,this.v=void 0,this.h=1,this.u=this.C=0,this.l=null}function f(e){if(e.m)throw new TypeError("Generator is already running");e.m=!0}function p(e,t){return e.h=3,{value:t}}function m(e){this.g=new h,this.G=e}function _(e,t,i,n){try{var r=t.call(e.g.j,i);if(!(r instanceof Object))throw new TypeError("Iterator result "+r+" is not an object");if(!r.done)return e.g.m=!1,r;var o=r.value}catch(t){return e.g.j=null,e.g.s(t),g(e)}return e.g.j=null,n.call(e.g,o),g(e)}function g(e){for(;e.g.h;)try{var t=e.G(e.g);if(t)return e.g.m=!1,{value:t.value,done:!1}}catch(t){e.g.v=void 0,e.g.s(t)}if(e.g.m=!1,e.g.l){if(t=e.g.l,e.g.l=null,t.F)throw t.D;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function v(e){this.next=function(t){return e.o(t)},this.throw=function(t){return e.s(t)},this.return=function(t){return function(e,t){f(e.g);var i=e.g.j;return i?_(e,"return"in i?i.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),g(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function E(e,t){return t=new v(new m(t)),l&&e.prototype&&l(t,e.prototype),t}if(h.prototype.o=function(e){this.v=e},h.prototype.s=function(e){this.l={D:e,F:!0},this.h=this.C||this.u},h.prototype.return=function(e){this.l={return:e},this.h=this.u},m.prototype.o=function(e){return f(this.g),this.g.j?_(this,this.g.j.next,e,this.g.o):(this.g.o(e),g(this))},m.prototype.s=function(e){return f(this.g),this.g.j?_(this,this.g.j.throw,e,this.g.o):(this.g.s(e),g(this))},s("Array.prototype.entries",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var i=0,n=!1,r={next:function(){if(!n&&i<e.length){var r=i++;return{value:t(r,e[r]),done:!1}}return n=!0,{done:!0,value:void 0}}};return r[Symbol.iterator]=function(){return r},r}(this,(function(e,t){return[e,t]}))}})),"undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var b=function(e,t){for(var i=0;i<e.length;i++)t(e[i])},y=function(e){return e.replace(/\r?\n|\r/g,"\r\n")},w=function(e,t,i){return t instanceof Blob?(i=void 0!==i?String(i+""):"string"==typeof t.name?t.name:"blob",t.name===i&&"[object Blob]"!==Object.prototype.toString.call(t)||(t=new File([t],i)),[String(e),t]):[String(e),String(t)]},S=function(e,t){if(e.length<t)throw new TypeError(t+" argument required, but only "+e.length+" present.")},T="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:this,R=T.FormData,C=T.XMLHttpRequest&&T.XMLHttpRequest.prototype.send,I=T.Request&&T.fetch,A=T.navigator&&T.navigator.sendBeacon,O=T.Element&&T.Element.prototype,M=T.Symbol&&Symbol.toStringTag;M&&(Blob.prototype[M]||(Blob.prototype[M]="Blob"),"File"in T&&!File.prototype[M]&&(File.prototype[M]="File"));try{new File([],"")}catch(e){T.File=function(e,t,i){return e=new Blob(e,i||{}),Object.defineProperties(e,{name:{value:t},lastModified:{value:+(i&&void 0!==i.lastModified?new Date(i.lastModified):new Date)},toString:{value:function(){return"[object File]"}}}),M&&Object.defineProperty(e,M,{value:"File"}),e}}var N=function(e){return e.replace(/\n/g,"%0A").replace(/\r/g,"%0D").replace(/"/g,"%22")},k=function(e){this.i=[];var t=this;e&&b(e.elements,(function(e){if(e.name&&!e.disabled&&"submit"!==e.type&&"button"!==e.type&&!e.matches("form fieldset[disabled] *"))if("file"===e.type){var i=e.files&&e.files.length?e.files:[new File([],"",{type:"application/octet-stream"})];b(i,(function(i){t.append(e.name,i)}))}else"select-multiple"===e.type||"select-one"===e.type?b(e.options,(function(i){!i.disabled&&i.selected&&t.append(e.name,i.value)})):"checkbox"===e.type||"radio"===e.type?e.checked&&t.append(e.name,e.value):(i="textarea"===e.type?y(e.value):e.value,t.append(e.name,i))}))};if((e=k.prototype).append=function(e,t,i){S(arguments,2),this.i.push(w(e,t,i))},e.delete=function(e){S(arguments,1);var t=[];e=String(e),b(this.i,(function(i){i[0]!==e&&t.push(i)})),this.i=t},e.entries=function e(){var t,i=this;return E(e,(function(e){if(1==e.h&&(t=0),3!=e.h)return t<i.i.length?e=p(e,i.i[t]):(e.h=0,e=void 0),e;t++,e.h=2}))},e.forEach=function(e,t){S(arguments,1);for(var i=c(this),n=i.next();!n.done;n=i.next()){var r=c(n.value);n=r.next().value,r=r.next().value,e.call(t,r,n,this)}},e.get=function(e){S(arguments,1);var t=this.i;e=String(e);for(var i=0;i<t.length;i++)if(t[i][0]===e)return t[i][1];return null},e.getAll=function(e){S(arguments,1);var t=[];return e=String(e),b(this.i,(function(i){i[0]===e&&t.push(i[1])})),t},e.has=function(e){S(arguments,1),e=String(e);for(var t=0;t<this.i.length;t++)if(this.i[t][0]===e)return!0;return!1},e.keys=function e(){var t,i,n,r=this;return E(e,(function(e){if(1==e.h&&(t=c(r),i=t.next()),3!=e.h)return i.done?void(e.h=0):(n=i.value,p(e,c(n).next().value));i=t.next(),e.h=2}))},e.set=function(e,t,i){S(arguments,2),e=String(e);var n=[],r=w(e,t,i),o=!0;b(this.i,(function(t){t[0]===e?o&&(o=!n.push(r)):n.push(t)})),o&&n.push(r),this.i=n},e.values=function e(){var t,i,n,r,o=this;return E(e,(function(e){if(1==e.h&&(t=c(o),i=t.next()),3!=e.h)return i.done?void(e.h=0):(n=i.value,(r=c(n)).next(),p(e,r.next().value));i=t.next(),e.h=2}))},k.prototype._asNative=function(){for(var e=new R,t=c(this),i=t.next();!i.done;i=t.next()){var n=c(i.value);i=n.next().value,n=n.next().value,e.append(i,n)}return e},k.prototype._blob=function(){var e="----formdata-polyfill-"+Math.random(),t=[],i="--"+e+'\r\nContent-Disposition: form-data; name="';return this.forEach((function(e,n){return"string"==typeof e?t.push(i+N(y(n))+'"\r\n\r\n'+y(e)+"\r\n"):t.push(i+N(y(n))+'"; filename="'+N(e.name)+'"\r\nContent-Type: '+(e.type||"application/octet-stream")+"\r\n\r\n",e,"\r\n")})),t.push("--"+e+"--"),new Blob(t,{type:"multipart/form-data; boundary="+e})},k.prototype[Symbol.iterator]=function(){return this.entries()},k.prototype.toString=function(){return"[object FormData]"},O&&!O.matches&&(O.matches=O.matchesSelector||O.mozMatchesSelector||O.msMatchesSelector||O.oMatchesSelector||O.webkitMatchesSelector||function(e){for(var t=(e=(this.document||this.ownerDocument).querySelectorAll(e)).length;0<=--t&&e.item(t)!==this;);return-1<t}),M&&(k.prototype[M]="FormData"),C){var P=T.XMLHttpRequest.prototype.setRequestHeader;T.XMLHttpRequest.prototype.setRequestHeader=function(e,t){P.call(this,e,t),"content-type"===e.toLowerCase()&&(this.B=!0)},T.XMLHttpRequest.prototype.send=function(e){e instanceof k?(e=e._blob(),this.B||this.setRequestHeader("Content-Type",e.type),C.call(this,e)):C.call(this,e)}}I&&(T.fetch=function(e,t){return t&&t.body&&t.body instanceof k&&(t.body=t.body._blob()),I.call(this,e,t)}),A&&(T.navigator.sendBeacon=function(e,t){return t instanceof k&&(t=t._asNative()),A.call(this,e,t)}),T.FormData=k}}();const YR=()=>{const e=Pw("AREAS");return 0===e.length&&e.push(aT.GLOBAL),db(e).call(e,((e,t,i)=>{const n=JR(t);return n?0===i?n:"".concat(e,",").concat(n):e}),"")},JR=e=>e===aT.OVERSEA?"".concat(dT.ASIA,",").concat(dT.EUROPE,",").concat(dT.AFRICA,",").concat(dT.NORTH_AMERICA,",").concat(dT.SOUTH_AMERICA,",").concat(dT.OCEANIA):dT[e],XR=e=>{const t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return e.map((e=>{const i=lT[e],n=Object.keys(i);n&&n.map((e=>{"CODE"!==e&&(t[e]=t[e].concat(i[e]))}))})),t},QR={GLOBAL:{ASIA:[aT.CHINA,aT.JAPAN,aT.INDIA,aT.KOREA,aT.HKMC],EUROPE:[],NORTH_AMERICA:[aT.US],SOUTH_AMERICA:[],OCEANIA:[],AFRICA:[]}},ZR=Object.keys(QR[aT.GLOBAL]),$R=[aT.CHINA,aT.NORTH_AMERICA,aT.EUROPE,aT.ASIA,aT.JAPAN,aT.INDIA,aT.OCEANIA,aT.SOUTH_AMERICA,aT.AFRICA,aT.KOREA,aT.HKMC,aT.US],eC=function(e,t){let i=[];if(Mn(e).call(e,aT.GLOBAL)){const o=[aT.GLOBAL,aT.OVERSEA],s=Object.keys(lT);if(t===aT.GLOBAL)throw new jS(Bv.INVALID_PARAMS,"GLOBAL is an invalid excludedArea value");if(t===aT.CHINA)i=[aT.OVERSEA];else if(r=t,Mn(ZR).call(ZR,r)){const e=(n=t,QR[aT.GLOBAL][n]||[]),r=[...o,t,...e];i=s.filter((e=>!Mn(r).call(r,e)))}else if(function(e){let t=!1;return ZR.forEach((i=>{var n;Mn(n=QR[aT.GLOBAL][i]).call(n,e)&&(t=!0)})),t}(t)){const e=function(e){let t;return ZR.forEach((i=>{var n;Mn(n=QR[aT.GLOBAL][i]).call(n,e)&&(t=i)})),t}(t),n=[...o,e,t];i=s.filter((e=>!Mn(n).call(n,e)))}else i=e;i=function(e){const t=[];return $R.forEach((i=>{Mn(e).call(e,i)&&t.push(i)})),t.concat(e.filter((e=>!Mn($R).call($R,e))))}(i)}else i=e;var n,r;return i};function tC(e){var t,i;if(!e&&Mn(t=Pw("AREAS")).call(t,aT.EXTENSIONS))return Yw.debug("update area from ap : reset"),void iC(cS,!0);if(!Mn(i=Pw("AREAS")).call(i,aT.GLOBAL)||!e)return;let n=lT.EXTENSIONS;n&&(n={CODE:JR(aT.EXTENSIONS),WEBCS_DOMAIN:["ap-web-1-".concat(e,".agora.io")],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-".concat(e,".ap.sd-rtn.com")],PROXY_CS:["proxy-ap-web-".concat(e,".agora.io")],CDS_AP:["cds-ap-web-1-".concat(e,".agora.io"),"cds-ap-web-2-".concat(e,".ap.sd-rtn.com")],ACCOUNT_REGISTER:["sua-ap-web-1-".concat(e,".agora.io"),"sua-ap-web-2-".concat(e,".ap.sd-rtn.com")],UAP_AP:["uap-ap-web-1-".concat(e,".agora.io"),"uap-ap-web-2-".concat(e,".ap.sd-rtn.com")],EVENT_REPORT_DOMAIN:["statscollector-1-".concat(e,".agora.io")],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-".concat(e,".agora.io")],LOG_UPLOAD_SERVER:["logservice-".concat(e,".agora.io")],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy-".concat(e,".agora.io")]},Yw.debug("update area from ap success: ".concat(e,",config is "),n),kw("AREAS",[aT.EXTENSIONS],!0),Object.keys(n).map((e=>{kw(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?n[e][0]:n[e])})))}function iC(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=aS.reportApiInvoke(null,{name:aE.SET_AREA,options:e,tag:cE.TRACER});try{let n=[];if("string"==typeof e&&(n=[e]),Array.isArray(e)&&(e.forEach((e=>{if(!Mn(uT).call(uT,e))throw new jS(Bv.INVALID_PARAMS,"invalid area code")})),n=e),"[object Object]"===Object.prototype.toString.call(e)){const{areaCode:t,excludedArea:i}=e;if(!t)throw new jS(Bv.INVALID_PARAMS,"area code is needed");let r=t;"string"==typeof t&&(r=[t]),n=i?eC(r,i):r}if(!t){if(Dw.AREAS){const e=new jS(Bv.PROHIBITED_OPERATION,"setArea is prohibited because of config-distribute");return i.onError(e),void Yw.warning("setArea is prohibited because of config-distribute")}if(Mn(n).call(n,aT.GLOBAL)&&Pw("AREAS")===aT.EXTENSIONS){const e=new jS(Bv.PROHIBITED_OPERATION,"setArea is prohibited because of ap extensions");return i.onError(e),void Yw.warning("setArea is prohibited because of ap extensions")}}kw("AREAS",n,t);const r=XR(n);Object.keys(r).map((e=>{kw(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?r[e][0]:r[e])})),Yw.debug("set area success:",n.join(","))}catch(e){throw i.onError(e),e}i.onSuccess()}function nC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function rC(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?nC(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):nC(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}let oC=1;function sC(e,t,i,n,r){oC+=1;const o={sid:i.sid,command:"convergeAllocateEdge",uid:"666",appId:i.appId,ts:Math.floor(Date.now()/1e3),seq:oC,requestId:oC,version:Iw,cname:i.cname},s={service_name:t,json_body:JSON.stringify(o)};let a,c,u=e[0];return ZE((async()=>{a=Date.now();const e=await zR(u,{data:s,cancelToken:n,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});if(c=Date.now()-a,0!==e.code){const t=new jS(Bv.UNEXPECTED_RESPONSE,"live streaming ap error, code"+e.code,{retry:!0,responseTime:c});throw Yw.error(t.toString()),t}const i=JSON.parse(e.json_body);if(200!==i.code){const e=new jS(Bv.UNEXPECTED_RESPONSE,"live streaming app center error, code: ".concat(i.code,", reason: ").concat(i.reason),{code:i.code,responseTime:c});throw Yw.error(e.toString()),e}if(!i.servers||0===i.servers.length){const e=new jS(Bv.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:i.code,responseTime:c});throw Yw.error(e.toString()),e}const r=function(e,t){return{addressList:e.servers.map((e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat(Pw("WORKER_DOMAIN"),":").concat(e.wss,"?serviceName=").concat(encodeURIComponent(t)))),workerToken:e.workerToken,vid:e.vid}}(i,t);return Pw("LIVE_STREAMING_ADDRESS")&&(r.addressList=Pw("LIVE_STREAMING_ADDRESS")instanceof Array?Pw("LIVE_STREAMING_ADDRESS"):[Pw("LIVE_STREAMING_ADDRESS")]),rC(rC({},r),{},{responseTime:c})}),((n,r)=>(aS.apworkerEvent(i.sid,{success:!0,sc:200,serviceName:t,responseDetail:JSON.stringify(n.addressList),firstSuccess:0===r,responseTime:c,serverIp:e[r%e.length]}),!1)),((n,r)=>(aS.apworkerEvent(i.sid,{success:!1,sc:n.data&&n.data.code||200,serviceName:t,responseTime:c,serverIp:e[r%e.length]}),!!(n.code!==Bv.OPERATION_ABORTED&&n.code!==Bv.UNEXPECTED_RESPONSE||n.data&&n.data.retry)&&(u=e[(r+1)%e.length],!0))),r)}let aC=1;function cC(e,t,i,n){let{url:r,areaCode:o}=e;const s=Date.now();let a;const[c,u]=fC(t,o,[_R.CHOOSE_SERVER]);let d=SE.networkState;return ZE((async()=>{d&&SE.networkState===fE.OFFLINE&&SE.onlineWaiter&&await nv.race([SE.onlineWaiter,VE(n&&n.maxRetryTimeout||XE.maxRetryTimeout)]),d=SE.networkState;const{data:e,headers:o}=await zR(r,{data:c,cancelToken:i,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);a="1"===o.http3?1:-1,aS.reportResourceTiming(r,t.sid),dC(e,r,t,s,[_R.CHOOSE_SERVER],a);const u=MR(e,_R.CHOOSE_SERVER);return lC(u),CR(u,r)}),(e=>(e&&aS.joinChooseServer(t.sid,{lts:s,succ:!0,csAddr:r,opid:u,serverList:e.gatewayAddrs.map((e=>e.address)),ec:null,cid:e.cid.toString(),uid:e.uid.toString(),csIp:e.csIp,unilbsServerIds:[_R.CHOOSE_SERVER].toString(),isHttp3:a}),!1)),(e=>e.code!==Bv.OPERATION_ABORTED&&(e.code===Bv.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(aS.joinChooseServer(t.sid,{lts:s,succ:!1,csAddr:r,serverList:null,opid:u,ec:e.code,csIp:e.data&&e.data.csIp,unilbsServerIds:[_R.CHOOSE_SERVER].toString(),extend:JSON.stringify({networkState:d}),isHttp3:a}),Yw.warning("[".concat(t.clientId,"] Choose server network error, retry"),e),!0))),n)}function uC(e,t,i,n){let r,{url:o,areaCode:s,serviceIds:a}=e;const c=Date.now(),[u,d]=fC(t,s,a);let l;return ZE((async()=>{l&&SE.networkState===fE.OFFLINE&&SE.onlineWaiter&&await nv.race([SE.onlineWaiter,VE(n&&n.maxRetryTimeout||XE.maxRetryTimeout)]),l=SE.networkState;const{data:e,headers:s}=await zR(o,{data:u,cancelToken:i,headers:{"Content-Type":"multipart/form-data;"}},!0,!0);r="1"===s.http3?1:-1,aS.reportResourceTiming(o,t.sid),dC(e,o,t,c,a,r);const d=MR(e,_R.CHOOSE_SERVER),h=MR(e,"proxy5"===t.cloudProxyServer?_R.CLOUD_PROXY_5:"proxy3"===t.cloudProxyServer||"proxy4"===t.cloudProxyServer?_R.CLOUD_PROXY:_R.CLOUD_PROXY_FALLBACK);return lC(d),{gatewayInfo:CR(d,o),proxyInfo:h,url:o}}),(e=>(e.gatewayInfo&&aS.joinChooseServer(t.sid,{lts:c,succ:!0,csAddr:o,serverList:e.gatewayInfo.gatewayAddrs.map((e=>e.address)),ec:null,opid:d,cid:e.gatewayInfo.cid.toString(),uid:e.gatewayInfo.uid.toString(),csIp:e.gatewayInfo.csIp,unilbsServerIds:a.toString(),isHttp3:r}),e.proxyInfo&&aS.joinWebProxyAP(t.sid,{lts:c,sucess:1,apServerAddr:o,turnServerAddrList:e.proxyInfo.addresses.map((e=>e.ip)).join(","),errorCode:null,eventType:t.cloudProxyServer,unilbsServerIds:a.toString()}),!1)),(e=>e.code!==Bv.OPERATION_ABORTED&&(e.code===Bv.CAN_NOT_GET_GATEWAY_SERVER?e.data.retry:(aS.joinWebProxyAP(t.sid,{lts:c,sucess:0,apServerAddr:o,turnServerAddrList:null,errorCode:e.code,eventType:t.cloudProxyServer,unilbsServerIds:a.toString(),extend:JSON.stringify({networkState:l})}),Yw.warning("[".concat(t.clientId,"] multi unilbs network error, retry"),e),!0))),n)}const dC=(e,t,i,n,r,o)=>{const s=[],a=s=>{4096===s.flag?aS.joinChooseServer(i.sid,{lts:n,succ:!1,csAddr:t,opid:e.opid,serverList:null,ec:s.error.message,csIp:s.error.data&&s.error.data.csIp,unilbsServerIds:r.toString(),isHttp3:o}):1048576!==s.flag&&4194304!==s.flag&&4194310!==s.flag||aS.joinWebProxyAP(i.sid,{lts:n,sucess:0,apServerAddr:t,turnServerAddrList:null,errorCode:s.error.code,eventType:i.cloudProxyServer,unilbsServerIds:r.toString()})};if(e.response_body.forEach((t=>{const i=t.buffer.code;if(23===t.uri&&0===i&&!t.buffer.edges_services)if(4194310===t.buffer.flag)Yw.warning("no edge services in ap response of proxy fallback, will not set proxy in iceServers"),t.buffer.edges_services=[];else{const i={error:new jS(Bv.CAN_NOT_GET_GATEWAY_SERVER,"no edge services in ap response",{retry:!0,csIp:e.detail[502]}),flag:t.buffer.flag};s.push(i),a(i)}if(0!==i){const n=BT(i),r={error:new jS(Bv.CAN_NOT_GET_GATEWAY_SERVER,n.desc,{desc:n.desc,retry:n.retry,csIp:e.detail[502]}),flag:t.buffer.flag};4194310===t.buffer.flag?Yw.warning(r.error.toString()):s.push(r),a(r)}})),s.length)throw Yw.warning("[".concat(i.clientId,"] multi unilbs ").concat(t," failed, ").concat(s.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message,", retry: ").concat(e.error.data.retry))).join(" | "))),new jS(Bv.CAN_NOT_GET_GATEWAY_SERVER,s.map((e=>"flag: ".concat(e.flag,", message: ").concat(e.error.message))).join(" | "),{retry:!!s.find((e=>e.error.data.retry)),csIp:e.detail[502],desc:[...new Set(s.map((e=>{var t;return null==e||null===(t=e.error)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.desc})).filter((e=>!!e)))]})},lC=e=>{var t,i,n,r;if(e.addresses&&0===e.addresses.length&&0===e.code)throw new jS(Bv.CAN_NOT_GET_GATEWAY_SERVER,"void gateway address",{retry:!0,csIp:e.detail&&e.detail[502]});if(Pw("AP_AREA")&&(null!==(n=e.detail)&&void 0!==n&&n[23]&&"string"==typeof(null===(r=e.detail)||void 0===r?void 0:r[23])?tC(e.detail[23].toLowerCase()):tC()),null!==(t=e.detail)&&void 0!==t&&t[19]&&"string"==typeof(null===(i=e.detail)||void 0===i?void 0:i[19])){const t=e.detail[19],i=null==t?void 0:t.split(";");for(let n=0;n<i.length;n++){var o;const t=wR(o=i[n]).call(o);e.addresses[n]&&i&&(e.addresses[n].fingerprint=t)}}if(Pw("GATEWAY_ADDRESS")&&Pw("GATEWAY_ADDRESS").length>0){Yw.debug("assign gateway address to",Pw("GATEWAY_ADDRESS"));const t=Pw("GATEWAY_ADDRESS").map((t=>{var i,n;const r=null!==(i=null===(n=e.addresses.find((e=>e.ip===t.ip&&e.port===t.port)))||void 0===n?void 0:n.fingerprint)&&void 0!==i?i:"";return{ip:t.ip,port:t.port,ticket:e.addresses[0]&&e.addresses[0].ticket,fingerprint:r}}));e.addresses=t}},hC=(e,t)=>{if(e.response_body&&e.response_body.length){const t=e.response_body[0];if(0!==t.buffer.code){const e=BT(t.buffer.code);throw new jS(Bv.UPDATE_TICKET_FAILED,"[".concat(t.buffer.code,"]: ").concat(e.desc),{retry:e.retry})}return t.buffer.ticket}throw Yw.debug("update ticket request received ap response without response body:",t),new jS(Bv.UPDATE_TICKET_FAILED,"cannot find response body from ap response",{retry:!1})},fC=(e,t,i)=>{const n=Math.floor(Math.random()*10**12),r={appid:e.appId,client_ts:Date.now(),opid:n,sid:e.sid,request_bodies:[{uri:22,buffer:{cname:e.cname,detail:rC({6:e.stringUid,11:t,12:Pw("USE_NEW_TOKEN")?"1":void 0,22:t},e.apRTM?{26:"RTM2"}:{}),key:e.token,service_ids:i,uid:e.uid||0}}]};r.request_bodies.forEach((t=>{e.multiIP&&e.multiIP.gateway_ip&&(t.buffer.detail[5]=JSON.stringify({vocs_ip:[e.multiIP.uni_lbs_ip],vos_ip:[e.multiIP.gateway_ip]}))}));const o=new FormData;return o.append("request",JSON.stringify(r)),[o,n]},pC=(e,t)=>{const i=Math.floor(Math.random()*10**12),n={appid:e.appId,client_ts:Date.now(),opid:i,sid:e.sid,request_bodies:[{uri:28,buffer:{cname:e.cname,detail:{1:"",6:e.stringUid,12:"1"},token:e.token,service_ids:t,uid:e.uid||0,edges_services:e.apResponse.addresses.map((e=>({ip:e.ip,port:e.port})))}}]},r=new FormData;return r.append("request",JSON.stringify(n)),[r,i]};let mC=0;function _C(e){return nv.all(e.map((e=>e.then((e=>{throw e}),(e=>e))))).then((e=>{throw e}),(e=>e))}const gC=async e=>{let{fragementLength:t,referenceList:i,asyncMapHandler:n,allFailedhandler:r,promisesCollector:o}=e,s=0;const a=t;let c,u=0;const d=async()=>{const e=(()=>{const e=s*a,t=e+a;return i.slice(e,t).map(n)})();o&&o.push(...e);try{c=await _C(e)}catch(e){if(u+=a,s++,!(u>=i.length))return void await d();r(e)}e.forEach((e=>e.cancel()))};return await d(),c};async function vC(e,t,i,n){const r=async function(e,t,i,n){let r=null;const o=[],s=async()=>{const r=Pw("WEBCS_DOMAIN").slice(0,Pw("AJAX_REQUEST_CONCURRENT")).map((t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:YR()}))),s=n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:r.map((e=>e.url))}),a=await gC({fragementLength:Pw("FRAGEMENT_LENGTH"),referenceList:r,asyncMapHandler:n=>(Yw.debug("[".concat(e.clientId,"] Connect to choose_server:"),n.url),cC(n,e,t,i)),allFailedhandler:e=>{throw n.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},s),e[0]},promisesCollector:o});return n.recordJoinChannelService({endTs:Date.now(),status:"success"},s),a},a=async()=>{if(await VE(1e3),null!==r)return r;const s=Pw("WEBCS_DOMAIN_BACKUP_LIST").map((t=>({url:e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2"),areaCode:YR()}))),a=n.recordJoinChannelService({endTs:void 0,startTs:Date.now(),status:"pending",service:"chooseServer",urls:s.map((e=>e.url))}),c=await gC({fragementLength:Pw("FRAGEMENT_LENGTH"),referenceList:s,asyncMapHandler:n=>(Yw.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),n.url),cC(n,e,t,i)),allFailedhandler:e=>{throw n.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},a),e[0]},promisesCollector:o});return n.recordJoinChannelService({endTs:Date.now(),status:"success"},a),c};try{return r=await _C([s(),a()]),o.length&&o.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),r}catch(e){throw e[0]}}(e,t,i,n);return{gatewayInfo:await r}}async function EC(e,t,i,n,r){const o=e.cloudProxyServer;if("disabled"===o){if(!n)return;if(e.useLocalAccessPoint)return await vC(e,t,i,r);if(Pw("JOIN_WITH_FALLBACK_MEDIA_PROXY")){const{gatewayInfo:n,proxyInfo:o}=await wC(e,t,i,r);if(e.turnServer&&"auto"!==e.turnServer.mode)return{gatewayInfo:n};const a=o.map((e=>({turnServerURL:e.address,tcpport:e.tcpport||uS.tcpport,udpport:e.udpport||uS.udpport,username:e.username||uS.username,password:e.password||uS.password,forceturn:!1,security:!0})));if(r.useP2P){var s;const t=null!==(s=e.uid)&&void 0!==s?s:n.uid,i="glb:".concat(t.toString()),r=await nE(i),c=o.map((e=>({turnServerURL:e.address,tcpport:e.tcpport||uS.tcpport,udpport:e.udpport||uS.udpport,username:i,password:r,forceturn:!1,security:!0})));a.push(...c)}return e.turnServer={mode:"manual",servers:a},{gatewayInfo:n}}return await vC(e,t,i,r)}const{proxyInfo:a,gatewayInfo:c}=await wC(e,t,i,r),u={gatewayInfo:c},d=a.map((e=>({turnServerURL:e.address,tcpport:"proxy3"===o?void 0:e.tcpport?e.tcpport:uS.tcpport,udpport:"proxy4"===o?void 0:e.udpport?e.udpport:uS.udpport,username:e.username||uS.username,password:e.password||uS.password,forceturn:"proxy4"!==o,security:"proxy5"===o})));if(r.useP2P){var l;const t=null!==(l=e.uid)&&void 0!==l?l:c.uid,i="glb:".concat(t.toString()),n=await nE(i),r=a.map((e=>({turnServerURL:e.address,tcpport:"proxy3"===o?void 0:e.tcpport||uS.tcpport,udpport:"proxy4"===o?void 0:e.udpport||uS.udpport,username:i,password:n,forceturn:"proxy4"!==o,security:"proxy5"===o})));d.push(...r)}return e.turnServer={mode:"manual",servers:d},Yw.debug("[".concat(e.clientId,"] set proxy server: ").concat(e.proxyServer,", mode: ").concat(o)),u}async function bC(e,t,i,n,r){const o=Pw("ACCOUNT_REGISTER").slice(0,Pw("AJAX_REQUEST_CONCURRENT"));let s=[];s=t.proxyServer?o.map((e=>"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1"))):o.map((e=>"https://".concat(e,"/api/v1")));const a=null==r?void 0:r.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"stringUID",urls:s});try{const o=await async function(e,t,i,n,r){const o=Date.now(),s={sid:i.sid,opid:10,appid:i.appId,string_uid:t};let a=e[0];const c=await ZE((()=>zR(a+"".concat(-1===a.indexOf("?")?"?":"&","action=stringuid"),{data:s,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}})),((i,n)=>{if(0===i.code){if(i.uid<=0||i.uid>=Math.pow(2,32))throw Yw.error("Invalid Uint Uid ".concat(t," => ").concat(i.uid),i),aS.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:i.uid,errorCode:Bv.INVALID_UINT_UID_FROM_STRING_UID,extend:s}),new jS(Bv.INVALID_UINT_UID_FROM_STRING_UID);return aS.reqUserAccount(s.sid,{lts:o,success:!0,serverAddr:a,stringUid:s.string_uid,uid:i.uid,errorCode:null,extend:s}),!1}const r=BT(i.code);return r.retry&&(a=e[(n+1)%e.length]),aS.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:i.uid,errorCode:r.desc,extend:s}),r.retry}),((t,i)=>t.code!==Bv.OPERATION_ABORTED&&(aS.reqUserAccount(s.sid,{lts:o,success:!1,serverAddr:a,stringUid:s.string_uid,uid:null,errorCode:t.code,extend:s}),a=e[(i+1)%e.length],!0)),r);if(0!==c.code){const e=BT(c.code);throw new jS(Bv.UNEXPECTED_RESPONSE,e.desc)}return c}(s,e,t,i,n);return null==r||r.recordJoinChannelService({status:"success",endTs:Date.now()},a),o.uid}catch(e){throw null==r||r.recordJoinChannelService({status:"error",endTs:Date.now(),errors:[e]},a),e}}async function yC(e,t,i){const n=Pw("CDS_AP").slice(0,Pw("AJAX_REQUEST_CONCURRENT")).map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1"):"https://".concat(t,"/api/v1?action=config"))).map((n=>function(e,t,i,n){const r=mv(),o={flag:64,cipher_method:0,features:{device:r.name,system:r.os,system_general:navigator.userAgent,vendor:t.appId,version:Iw,cname:t.cname,sid:t.sid,session_id:t.sid,detail:"",proxyServer:t.proxyServer}};return ZE((()=>zR(e,{data:o,timeout:1e3,cancelToken:i,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}})),void 0,(e=>e.code!==Bv.OPERATION_ABORTED),n)}(n,e,t,i)));let r=null,o=null,s={};try{r=await _C(n)}catch(e){if(e.code===Bv.OPERATION_ABORTED)throw e;o=e}if(n.forEach((e=>e.cancel())),aS.reportApiInvoke(e.sid,{name:aE.REQUEST_CONFIG_DISTRIBUTE,options:{error:o,res:r}}).onSuccess(),r&&r.test_tags)try{s=function(e){if(!e.test_tags)return{};const t=e.test_tags,i=Object.keys(t),n={};return i.forEach((e=>{var i;const r=wR(i=e.slice(4)).call(i),o=JSON.parse(t[e])[1];n[r]=o})),n}(r)}catch(e){}return s}async function wC(e,t,i,n){const r=Pw("PROXY_SERVER_TYPE3"),o=(e,t,i)=>{let n=i||r;return Array.isArray(n)&&(n=t%2==0?r[1]:r[0]),"https://".concat(n,"/ap/?url=").concat(e)};let s=null;const a=[],c=async()=>{const r=Pw("WEBCS_DOMAIN").slice(0,Pw("AJAX_REQUEST_CONCURRENT")).map(((t,i)=>{let n;return n="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(t,"/api/v2/transpond/webrtc?v=2"),i,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):o("".concat(t,"/api/v2/transpond/webrtc?v=2"),i),{url:n,areaCode:YR(),serviceIds:[_R.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?_R.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?_R.CLOUD_PROXY:_R.CLOUD_PROXY_FALLBACK]}})),s=n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:r.map((e=>e.url))}),c=await gC({fragementLength:Pw("FRAGEMENT_LENGTH"),referenceList:r,asyncMapHandler:n=>(Yw.debug("[".concat(e.clientId,"] Connect to choose_server:"),n.url),uC(n,e,t,i)),allFailedhandler:e=>{throw n.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},s),e[0]},promisesCollector:a});return n.recordJoinChannelService({endTs:Date.now(),status:"success"},s),c},u=async()=>{if(await VE(1e3),null!==s)return s;const r=Pw("WEBCS_DOMAIN_BACKUP_LIST").map(((t,i)=>{let n;return n="disabled"===e.cloudProxyServer&&e.proxyServer?o("".concat(t,"/api/v2/transpond/webrtc?v=2"),i,e.proxyServer):"disabled"===e.cloudProxyServer||"fallback"===e.cloudProxyServer?"https://".concat(t,"/api/v2/transpond/webrtc?v=2"):o("".concat(t,"/api/v2/transpond/webrtc?v=2"),i),{url:n,areaCode:YR(),serviceIds:[_R.CHOOSE_SERVER,"proxy5"===e.cloudProxyServer?_R.CLOUD_PROXY_5:"proxy3"===e.cloudProxyServer||"proxy4"===e.cloudProxyServer?_R.CLOUD_PROXY:_R.CLOUD_PROXY_FALLBACK]}})),c=n.recordJoinChannelService({startTs:Date.now(),status:"pending",service:"chooseServer",urls:r.map((e=>e.url))}),u=await gC({fragementLength:Pw("FRAGEMENT_LENGTH"),referenceList:r,asyncMapHandler:n=>(Yw.debug("[".concat(e.clientId,"] Connect to backup choose_server:"),n.url),uC(n,e,t,i)),allFailedhandler:e=>{throw n.recordJoinChannelService({endTs:Date.now(),status:"error",errors:e},c),e[0]},promisesCollector:a});return n.recordJoinChannelService({endTs:Date.now(),status:"success"},c),u};let d,l,h;try{({gatewayInfo:d,proxyInfo:l,url:h}=await _C([c(),u()]))}catch(e){throw e[0]}if(a.length&&a.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),!d||!l)throw new jS(Bv.UNEXPECTED_ERROR,"missing gateway or proxy response").print();if(e.apUrl=h,"disabled"!==e.cloudProxyServer&&Array.isArray(r)&&h){const t=/^https?:\/\/(.+?)(\/.*)?$/.exec(h)[1];Mn(r).call(r,t)&&(e.proxyServer=t,Yw.setProxyServer(t),aS.setProxyServer(t))}return s={gatewayInfo:d,proxyInfo:await NR(l,d.uid)},s}async function SC(e,t,i,n){const r=Pw("UAP_AP").slice(0,Pw("AJAX_REQUEST_CONCURRENT")).map((e=>t.proxyServer?"https://".concat(t.proxyServer,"/ap/?url=").concat(e+"/api/v1?action=uap"):"https://".concat(e,"/api/v1?action=uap")));return await sC(r,e,t,i,n)}async function TC(e,t,i){const n=Pw("UAP_AP").slice(0,Pw("AJAX_REQUEST_CONCURRENT")).map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v1?action=uap"):"https://".concat(t,"/api/v1?action=uap"))).map((n=>function(e,t,i,n){const r={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,ts:Date.now(),version:Iw,cname:t.cname,uid:t.uid.toString(),requestId:aC,seq:aC};aC+=1;const o={service_name:"tele_channel",json_body:JSON.stringify(r)};return ZE((async()=>{const t=await zR(e,{data:o,cancelToken:i,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});if(0!==t.code){const e=new jS(Bv.UNEXPECTED_RESPONSE,"cross channel ap error, code"+t.code,{retry:!0});throw Yw.error(e.toString()),e}const n=JSON.parse(t.json_body);if(200!==n.code){const e=new jS(Bv.UNEXPECTED_RESPONSE,"cross channel app center error, code: ".concat(n.code,", reason: ").concat(n.reason));throw Yw.error(e.toString()),e}if(!n.servers||0===n.servers.length){const e=new jS(Bv.UNEXPECTED_RESPONSE,"cross channel app center empty server");throw Yw.error(e.toString()),e}return{vid:n.vid,workerToken:n.workerToken,addressList:(Pw("CHANNEL_MEDIA_RELAY_SERVERS")||n.servers).map((e=>"wss://".concat(e.address.replace(/\./g,"-"),".").concat(Pw("WORKER_DOMAIN"),":").concat(e.wss)))}}),void 0,(e=>!!(e.code!==Bv.OPERATION_ABORTED&&e.code!==Bv.UNEXPECTED_RESPONSE||e.data&&e.data.retry)),n)}(n,e,t,i)));try{const e=await _C(n);return n.forEach((e=>e.cancel())),e}catch(e){throw e[0]}}async function RC(e,t,i){let n=null;const r=[],o=async o=>{const s=Pw(o?"WEBCS_DOMAIN_BACKUP_LIST":"WEBCS_DOMAIN").map((t=>e.proxyServer?"https://".concat(e.proxyServer,"/ap/?url=").concat(t+"/api/v2/transpond/webrtc?v=2"):"https://".concat(t,"/api/v2/transpond/webrtc?v=2")));return o&&(await VE(1e3),null!==n)?n:await gC({fragementLength:Pw("FRAGEMENT_LENGTH"),referenceList:s,asyncMapHandler:n=>(Yw.debug("[".concat(e.clientId,"] update ticket, Connect to ").concat(o?"backup":""," choose_server:"),n),function(e,t,i,n){const[r]=pC(t,[_R.CHOOSE_SERVER]);let o=SE.networkState;return ZE((async()=>{o&&SE.networkState===fE.OFFLINE&&SE.onlineWaiter&&await nv.race([SE.onlineWaiter,VE(n&&n.maxRetryTimeout||XE.maxRetryTimeout)]),o=SE.networkState;const t=await zR(e,{data:r,cancelToken:i,headers:{"Content-Type":"multipart/form-data;"}},!0);return hC(t,e)}),(()=>!1),(e=>e.code!==Bv.OPERATION_ABORTED&&(e.code===Bv.UPDATE_TICKET_FAILED?e.data.retry:(Yw.warning("[".concat(t.clientId,"] update ticket network error, retry"),e),!0))),n)}(n,e,t,i)),allFailedhandler:e=>{throw e[0]},promisesCollector:r})};try{return n=await _C([o(!1),o(!0)]),r.length&&r.forEach((e=>e.cancel&&"function"==typeof e.cancel&&e.cancel())),n}catch(e){throw e[0]}}function CC(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function IC(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?CC(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):CC(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class AC extends rE{get isSuccess(){return!!this.configs}constructor(){super(),oh(this,"configs",void 0),oh(this,"joinInfo",void 0),oh(this,"cancelToken",void 0),oh(this,"retryConfig",{timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4}),oh(this,"interval",void 0),oh(this,"mutex",new YE("config-distribute")),oh(this,"mutableParamsRead",!1)}startGetConfigDistribute(e,t){this.joinInfo=e,this.cancelToken=t,this.interval&&this.stopGetConfigDistribute(),Pw("ENABLE_CONFIG_DISTRIBUTE")&&(this.updateConfigDistribute(),this.interval=window.setInterval((()=>{this.updateConfigDistribute()}),Pw("CONFIG_DISTRIBUTE_INTERVAL")))}stopGetConfigDistribute(){this.interval&&clearInterval(this.interval),this.interval=void 0,this.joinInfo=void 0,this.cancelToken=void 0}async awaitConfigDistributeComplete(){this.mutex.isLocked&&(await this.mutex.lock())()}async updateConfigDistribute(){if(this.mutableParamsRead||(this.mutableParamsRead=!0,aS.reportApiInvoke(null,{options:void 0,name:aE.LOAD_CONFIG_FROM_LOCALSTORAGE,tag:cE.TRACER}).onSuccess(JSON.stringify(Dw))),!this.joinInfo||!this.cancelToken||!this.retryConfig)return void Yw.debug("[config-distribute] get config distribute interrupted have no joininfo");let e;const t=await this.mutex.lock();try{e=await yC(this.joinInfo,this.cancelToken,this.retryConfig),Yw.debug("[config-distribute] get config distribute",JSON.stringify(e)),e.limit_bitrate&&this.handleBitrateLimit(e.limit_bitrate),this.cacheGlobalParameterConfig(e),this.configs=e}catch(e){const t=new jS(Bv.NETWORK_RESPONSE_ERROR,e);Yw.warning("[config-distribute] ".concat(t.toString()))}finally{t()}}getBitrateLimit(){return this.configs?this.configs.limit_bitrate:void 0}handleBitrateLimit(e){var t;(t=e)&&t.uplink&&t.id&&void 0!==t.uplink.max_bitrate&&void 0!==t.uplink.min_bitrate&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==e.id&&this.emit(hT.UPDATE_BITRATE_LIMIT,e):this.emit(hT.UPDATE_BITRATE_LIMIT,e))}getLowStreamConfigDistribute(){return this.configs&&this.configs.limit_bitrate&&IC({},this.configs.limit_bitrate.low_stream_uplink)}cacheGlobalParameterConfig(e){var t;const i=ef(t=Object.keys(e).filter((e=>/^webrtc_ng_global_parameter/.test(e)))).call(t);for(let r=0;r<i.length;r++)for(let t=i.length-1;t>r;t--){const n=i[t];if("number"==typeof e[n].__priority){const r=e[n].__priority,o=i[t-1];if("number"==typeof e[o].__priority){if(!(r>e[o].__priority))continue;{const e=n;i[t]=i[t-1],i[t-1]=e}}else{const e=n;i[t]=i[t-1],i[t-1]=e}}}const n={};i.forEach((t=>{const i=e[t],r=i.__expires;Object.keys(i).forEach((e=>{"__priority"===e||"__expires"===e||Object.prototype.hasOwnProperty.call(n,e)||(n[e]=IC({value:i[e]},r&&{expires:r}))}))}));try{!function(e){try{const t=Date.now();Object.keys(e).forEach((i=>{switch(i){case"ENABLE_EVENT_REPORT":case"UPLOAD_LOG":if(Object.prototype.hasOwnProperty.call(Nw,i)){const{value:n,expires:r}=e[i];if(r&&r<=t)return;Dw[i]=n,Nw[i]=n,Yw.debug("Update global parameters from config distribute",i,n)}}}))}catch(t){Yw.error("Error update config immediately: ".concat(e),t.message)}}(n);const e=JSON.stringify(n),t=window.btoa(e);window.localStorage.setItem("websdk_ng_global_parameter",t),Yw.debug("Caching global parameters ".concat(e))}catch(e){Yw.error("Error caching global parameters:",e.message)}}}const OC={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1,supportDataChannel:!1,supportPCSetConfiguration:!1,supportWebRTCEncodedTransform:!1,supportWebRTCInsertableStream:!1};function MC(){return OC}var NC;function kC(e,t,i){return{sampleRate:e,stereo:t,bitrate:i}}function PC(e,t,i,n,r){return{width:e,height:t,frameRate:i,bitrateMin:n,bitrateMax:r}}function DC(e,t,i,n,r){return{width:{max:e},height:{max:t},frameRate:i,bitrateMin:n,bitrateMax:r}}function LC(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}!function(e){e.IOS_15_16_INTERRUPTION_START="ios15_16-interruption-start",e.IOS_15_16_INTERRUPTION_END="ios15_16-interruption-end",e.IOS_INTERRUPTION_START="ios-interruption-start",e.IOS_INTERRUPTION_END="ios-interruption-end",e.STATE_CHANGE="state-change"}(NC||(NC={}));const xC={"90p":PC(160,90),"90p_1":PC(160,90),"120p":PC(160,120,15,30,65),"120p_1":PC(160,120,15,30,65),"120p_3":PC(120,120,15,30,50),"120p_4":PC(212,120),"180p":PC(320,180,15,30,140),"180p_1":PC(320,180,15,30,140),"180p_3":PC(180,180,15,30,100),"180p_4":PC(240,180,15,30,120),"240p":PC(320,240,15,40,200),"240p_1":PC(320,240,15,40,200),"240p_3":PC(240,240,15,40,140),"240p_4":PC(424,240,15,40,220),"360p":PC(640,360,15,80,400),"360p_1":PC(640,360,15,80,400),"360p_3":PC(360,360,15,80,260),"360p_4":PC(640,360,30,80,600),"360p_6":PC(360,360,30,80,400),"360p_7":PC(480,360,15,80,320),"360p_8":PC(480,360,30,80,490),"360p_9":PC(640,360,15,80,800),"360p_10":PC(640,360,24,80,800),"360p_11":PC(640,360,24,80,1e3),"480p":PC(640,480,15,100,500),"480p_1":PC(640,480,15,100,500),"480p_2":PC(640,480,30,100,1e3),"480p_3":PC(480,480,15,100,400),"480p_4":PC(640,480,30,100,750),"480p_6":PC(480,480,30,100,600),"480p_8":PC(848,480,15,100,610),"480p_9":PC(848,480,30,100,930),"480p_10":PC(640,480,10,100,400),"720p":PC(1280,720,15,120,1130),"720p_auto":PC(1280,720,30,900,3e3),"720p_1":PC(1280,720,15,120,1130),"720p_2":PC(1280,720,30,120,2e3),"720p_3":PC(1280,720,30,120,1710),"720p_5":PC(960,720,15,120,910),"720p_6":PC(960,720,30,120,1380),"1080p":PC(1920,1080,15,120,2080),"1080p_1":PC(1920,1080,15,120,2080),"1080p_2":PC(1920,1080,30,120,3e3),"1080p_3":PC(1920,1080,30,120,3150),"1080p_5":PC(1920,1080,60,120,4780),"1440p":PC(2560,1440,30,120,4850),"1440p_1":PC(2560,1440,30,120,4850),"1440p_2":PC(2560,1440,60,120,7350),"4k":PC(3840,2160,30,120,8910),"4k_1":PC(3840,2160,30,120,8910),"4k_3":PC(3840,2160,60,120,13500)},UC=[{scaleResolutionDownBy:2,width:1280,height:720,frameRate:30,bitrateMin:300,bitrateMax:900},{scaleResolutionDownBy:1.333333,width:1280,height:720,frameRate:30,bitrateMin:600,bitrateMax:2e3},{scaleResolutionDownBy:1,width:1280,height:720,frameRate:30,bitrateMin:900,bitrateMax:3e3}],VC={"480p":DC(640,480,5),"480p_1":DC(640,480,5),"480p_2":DC(640,480,30),"480p_3":DC(640,480,15),"720p":DC(1280,720,5),"720p_auto":PC(1280,720,30,900,3e3),"720p_1":DC(1280,720,5),"720p_2":DC(1280,720,30),"720p_3":DC(1280,720,15),"1080p":DC(1920,1080,5),"1080p_1":DC(1920,1080,5),"1080p_2":DC(1920,1080,30),"1080p_3":DC(1920,1080,15)},BC={"1SL1TL":LC(1,1),"3SL3TL":LC(3,3),"2SL3TL":LC(2,3)};function jC(e){return e||(e="480p_1"),"string"==typeof e?Object.assign({},xC[e]):e}function FC(e){return"string"==typeof e?Object.assign({},VC[e]):e}function WC(e){return"string"==typeof e?Object.assign({},BC[e]):e}const GC={speech_low_quality:kC(16e3,!1),speech_standard:kC(32e3,!1,18),music_standard:kC(48e3,!1),standard_stereo:kC(48e3,!0,56),high_quality:kC(48e3,!1,128),high_quality_stereo:kC(48e3,!0,192)};function HC(e){return"string"==typeof e?Object.assign({},GC[e]):e}const qC=[];function KC(e){return Wv(e,"mediaSource",["screen","window","application"]),!0}var zC,YC,JC,XC,QC,ZC,$C,eI,tI,iI;!function(e){e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_CLOSE="@need_close",e.NEED_ENABLE_TRACK="@need_enable_track",e.NEED_DISABLE_TRACK="@need_disable_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_RTC_STATS="@get_rtc_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp",e.NEED_UPDATE_VIDEO_ENCODER="@need_update_video_encoder",e.NEED_MUTE_TRACK="@need_mute_track",e.NEED_UNMUTE_TRACK="@need_unmute_track"}(zC||(zC={})),function(e){e.SCREEN_TRACK="screen_track",e.CUSTOM_TRACK="custome_track",e.LOW_STREAM="low_stream"}(YC||(YC={})),function(e){e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM"}(JC||(JC={})),function(e){e[e.HIGH_STREAM=0]="HIGH_STREAM",e[e.LOW_STREAM=1]="LOW_STREAM"}(XC||(XC={})),function(e){e[e.DISABLE=0]="DISABLE",e[e.LOW_STREAM=1]="LOW_STREAM",e[e.AUDIO_ONLY=2]="AUDIO_ONLY"}(QC||(QC={})),function(e){e.TRANSCEIVER_UPDATED="transceiver-updated"}(ZC||(ZC={})),function(e){e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status",e.CLOSED="closed"}($C||($C={})),function(e){e.FIRST_FRAME_DECODED="first-frame-decoded",e.VIDEO_ELEMENT_VISIBLE_STATUS="video-element-visible-status"}(eI||(eI={})),function(e){e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer",e.UPDATE_SOURCE="update_source"}(tI||(tI={})),function(e){e.UPDATE_TRACK_SOURCE="update-track-source"}(iI||(iI={}));const nI={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,currentPacketLossRate:0},rI={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendJitterMs:0,sendRttMs:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0,currentPacketLossRate:0},oI={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1},sI={uplinkNetworkQuality:0,downlinkNetworkQuality:0},aI={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,currentPacketLossRate:0,publishDuration:-1};var cI,uI,dI,lI,hI;!function(e){e.ON_TRACK="on_track",e.ON_NODE="on_node"}(cI||(cI={})),function(e){e.REQUEST_UPDATE_CONSTRAINTS="request_update_constraints",e.REQUEST_CONSTRAINTS="request_constraints"}(uI||(uI={})),function(e){e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND"}(dI||(dI={})),function(e){e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(lI||(lI={})),function(e){e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied",e.LOADEDDATA="loadeddata"}(hI||(hI={}));const fI={uninit:100,none:110,init:120,loadeddata:130,canplay:200,playing:210,paused:220,suspend:300,stalled:310,waiting:320,error:330,destroyed:340,abort:350,ended:360,emptied:370};var pI;!function(e){e.OPEN="open",e.MESSAGE="message",e.CLOSE="close",e.CLOSING="closing",e.ERROR="error"}(pI||(pI={}));class mI extends rE{constructor(e,t){super(),oh(this,"_ID",void 0),oh(this,"_rtpTransceiver",void 0),oh(this,"_lowRtpTransceiver",void 0),oh(this,"_hints",[]),oh(this,"_isClosed",!1),oh(this,"_originMediaStreamTrack",void 0),oh(this,"_mediaStreamTrack",void 0),oh(this,"_external",{}),this._ID=t||BE(8,"track-"),this._originMediaStreamTrack=e,this._mediaStreamTrack=e,function(e){Mn(qC).call(qC,e)||qC.push(e)}(this)}toString(){return this._ID}getTrackId(){return this._ID}getMediaStreamTrack(e){if(!e){const e=aS.reportApiInvoke(null,{name:aE.GET_MEDIA_STREAM_TRACK,options:[],tag:cE.TRACER});this._mediaStreamTrack&&"string"==typeof this._mediaStreamTrack.label?e.onSuccess(this._mediaStreamTrack.label):e.onSuccess("")}return this._mediaStreamTrack}getRTCRtpTransceiver(e){return e===JC.LOW_STREAM?this._lowRtpTransceiver:this._rtpTransceiver}getMediaStreamTrackSettings(){return this.getMediaStreamTrack(!0).getSettings()}close(){this._isClosed=!0,this._lowRtpTransceiver=void 0,this._rtpTransceiver=void 0,function(e){const t=qC.indexOf(e);-1!==t&&qC.splice(t,1)}(this),this.emit($C.CLOSED)}_updateRtpTransceiver(e,t){if(t===JC.LOW_STREAM){if(this._lowRtpTransceiver===e)return;this._lowRtpTransceiver=e}else{if(this._rtpTransceiver===e)return;this._rtpTransceiver=e}this.emit(ZC.TRANSCEIVER_UPDATED,e,t)}}class _I extends mI{get isExternalTrack(){return this._isExternalTrack}get muted(){return this._muted}get enabled(){return this._enabled}get processorContext(){return this._processorContext}set processorContext(e){this._processorContext=e}constructor(e,t){super(e,t),oh(this,"_enabled",!0),oh(this,"_muted",!1),oh(this,"_isExternalTrack",!1),oh(this,"_isClosed",!1),oh(this,"_enabledMutex",void 0),oh(this,"processor",void 0),oh(this,"_handleTrackEnded",(()=>{this.onTrackEnded()})),this._enabledMutex=new YE("".concat(this.getTrackId())),e.addEventListener("ended",this._handleTrackEnded)}getTrackLabel(){var e,t;return null!==(e=null===(t=this._originMediaStreamTrack)||void 0===t?void 0:t.label)&&void 0!==e?e:""}close(){this._isClosed||(this.stop(),this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,Yw.debug("[".concat(this.getTrackId(),"] close")),this.emit(zC.NEED_CLOSE),super.close())}async _updateOriginMediaStreamTrack(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._isExternalTrack=i,e!==this._originMediaStreamTrack&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await bE(this,zC.NEED_REPLACE_TRACK,this),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}))}_getDefaultPlayerConfig(){return{}}onTrackEnded(){Yw.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit($C.TRACK_ENDED)}stateCheck(e,t){if(Yw.debug("check track state, [muted: ".concat(this._muted,", enabled: ").concat(this._enabled,"] to [").concat(e,": ").concat(t,"]")),Fv(t,e),this._enabled&&this._muted&&"enabled"===e&&!1===t)throw new jv(Bv.TRACK_STATE_UNREACHABLE,"cannot set enabled while the track is muted").print("error",Yw);if(!this._enabled&&!this._muted&&"muted"===e&&!0===t)throw new jv(Bv.TRACK_STATE_UNREACHABLE,"cannot set muted while the track is disabled").print("error",Yw)}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}function gI(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}const vI=window.AudioContext||window.webkitAudioContext;let EI=null;const bI=new class extends rE{constructor(){super(...arguments),oh(this,"prevState",void 0),oh(this,"curState",void 0),oh(this,"currentTime",void 0),oh(this,"currentTimeStuckAt",void 0),oh(this,"interruptDetectorTrack",void 0),oh(this,"onLocalAudioTrackMute",(()=>{Yw.info("ios15-interruption-start"),this.emit(NC.IOS_15_16_INTERRUPTION_START)})),oh(this,"onLocalAudioTrackUnmute",(async()=>{Yw.info("ios15-interruption-end"),"running"!==this.curState||this.duringInterruption?Yw.info("ios15-interruption-end-canceled"):(EI&&await EI.suspend(),this.emit(NC.IOS_15_16_INTERRUPTION_END))}))}get duringInterruption(){return"running"===this.prevState&&"interrupted"===this.curState}bindInterruptDetectorTrack(e){Yw.debug("webaudio bindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack||(this.interruptDetectorTrack=e,this.interruptDetectorTrack._mediaStreamTrack.onmute=this.onLocalAudioTrackMute,this.interruptDetectorTrack._mediaStreamTrack.onunmute=this.onLocalAudioTrackUnmute)}unbindInterruptDetectorTrack(e){Yw.debug("webaudio unbindInterruptDetectorTrack ".concat(e.getTrackId())),this.interruptDetectorTrack&&this.interruptDetectorTrack===e&&(this.interruptDetectorTrack._mediaStreamTrack&&(this.interruptDetectorTrack._mediaStreamTrack.onmute=null,this.interruptDetectorTrack._mediaStreamTrack.onunmute=null),this.interruptDetectorTrack=void 0)}};function yI(){if(!vI)return void Yw.error("your browser is not support web audio");Yw.info("create audio context");const e=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?gI(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):gI(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},Pw("WEBAUDIO_INIT_OPTIONS"));Yw.debug("audio context init option:",JSON.stringify(e)),EI=new vI(e),bI.curState=EI.state,EI.onstatechange=()=>{bI.prevState=bI.curState,bI.curState=EI?EI.state:void 0;const{prevState:e,curState:t}=bI,i="running"===t,n="interrupted"===t,r="running"===e,o="suspended"===e,s="interrupted"===e,a=mv().osVersion;(Tv()||Pv())&&r&&n&&(Yw.info("ios".concat(a,"-interruption-start")),bI.emit(NC.IOS_INTERRUPTION_START)),(Tv()||Pv())&&(o||s)&&i&&(Yw.info("ios".concat(a,"-interruption-end")),bI.emit(NC.IOS_INTERRUPTION_END)),e!==t&&bI.emit(NC.STATE_CHANGE,t,e)},setInterval((()=>{var e;const t=null===(e=EI)||void 0===e?void 0:e.currentTime;bI.currentTime!==t?(bI.currentTimeStuckAt&&(Yw.debug("AudioContext current time resume at ".concat(t)),bI.currentTimeStuckAt=void 0),bI.currentTime=t):(t!==bI.currentTimeStuckAt&&(aS.reportApiInvoke(null,{name:"WEB_AUDIO_CURRENT_TIME_STUCK",options:{currentTime:t},tag:cE.TRACER}).onSuccess(),Yw.warning("AudioContext current time stuck at ".concat(t))),bI.currentTimeStuckAt=t)}),5e3),async function(e){const t=["click","contextmenu","auxclick","dblclick","mousedown","mouseup","touchend","keydown","keyup"];let i,n=!1,r=!1,o=!1;function s(t){"running"===e.state?a(!1):Tv()||Pv()?"suspended"===e.state&&(a(!0),t&&e.resume().then(u,u)):"closed"!==e.state&&(a(!0),t&&e.resume().then(u,u))}function a(e){if(n!==e){n=e;for(let i=0,n=t;i<n.length;i+=1){const t=n[i];e?window.addEventListener(t,d,{capture:!0,passive:!0}):window.removeEventListener(t,d,{capture:!0,passive:!0})}}}function c(){s(!0)}function u(){s(!1)}function d(){s(!0)}function l(e){if(!o)if(i.paused)if(e){let t;h(!1),o=!0;try{t=i.play(),t?t.then(f,f):(i.addEventListener("playing",f),i.addEventListener("abort",f),i.addEventListener("error",f))}catch(e){f()}}else h(!0);else h(!1)}function h(e){if(r!==e){r=e;for(let i=0,n=t;i<n.length;i++){const t=n[i];e?window.addEventListener(t,p,{capture:!0,passive:!0}):window.removeEventListener(t,p,{capture:!0,passive:!0})}}}function f(){i.removeEventListener("playing",f),i.removeEventListener("abort",f),i.removeEventListener("error",f),o=!1,l(!1)}function p(){l(!0)}if(Tv()){const t=e.createMediaStreamDestination(),n=document.createElement("div");n.innerHTML="<audio x-webkit-airplay='deny'></audio>",i=n.children.item(0),i.controls=!1,i.disableRemotePlayback=!0,i.preload="auto",i.srcObject=t.stream,l(!0)}bI.on(NC.STATE_CHANGE,c),s(!1)}(EI)}function wI(){if(!EI){if(yI(),!EI)throw new jv(Bv.NOT_SUPPORTED,"can not create audio context");return EI}return EI}function SI(){return!!EI}function TI(e){if(function(){if(null!==RI)return RI;const e=wI(),t=e.createBufferSource(),i=e.createGain(),n=e.createGain();t.connect(i),t.connect(n),t.disconnect(i);let r=!1;try{t.disconnect(i)}catch(e){r=!0}return t.disconnect(),RI=r,r}())return;const t=e.connect,i=e.disconnect;e.connect=(i,n,r)=>{var o;return e._inputNodes||(e._inputNodes=[]),Mn(o=e._inputNodes).call(o,i)||(i instanceof AudioNode?(e._inputNodes.push(i),t.call(e,i,n,r)):t.call(e,i,n)),e},e.disconnect=(n,r,o)=>{i.call(e),n?CE(e._inputNodes,n):e._inputNodes=[];for(const i of e._inputNodes)t.call(e,i)}}let RI=null;function CI(e,t){let i=!1;const n=1/t;if(Pw("DISABLE_WEBAUDIO")){const t=window.setInterval((()=>{i?window.clearInterval(t):e(performance.now()/1e3)}),1e3*n)}else{const t=wI();let r=t.createGain();r.gain.value=0,r.connect(t.destination);const o=()=>{if(i)return void(r=null);const s=t.createOscillator();s.onended=o,s.connect(r),s.start(0),s.stop(t.currentTime+n),e(t.currentTime)};o()}return()=>{i=!0}}class II{constructor(){oh(this,"context",void 0),oh(this,"analyserNode",void 0),oh(this,"sourceNode",void 0),this.context=wI(),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4}updateSource(e){if(e!==this.sourceNode){if(this.sourceNode)try{this.sourceNode.disconnect(this.analyserNode)}catch(e){}this.sourceNode=e,null==e||e.connect(this.analyserNode)}}getVolumeLevel(){if(!this.sourceNode)return 0;if(!this.context||Tv()||Pv()||"running"!==this.context.state&&this.context.resume(),!this.analyserNode)return 0;const e=new Float32Array(this.analyserNode.fftSize);if(this.analyserNode.getFloatTimeDomainData)this.analyserNode.getFloatTimeDomainData(e);else{const t=new Uint8Array(this.analyserNode.fftSize);this.analyserNode.getByteTimeDomainData(t);for(let i=0;i<e.length;++i)e[i]=t[i]/128-1}const t=db(e).call(e,((e,t)=>e+t*t),0)/e.length;return Math.max(10*Math.log10(t)+100,0)/100}getAnalyserNode(){return this.analyserNode}rebuildAnalyser(){try{var e,t;null===(e=this.sourceNode)||void 0===e||e.disconnect(this.analyserNode),this.analyserNode=this.context.createAnalyser(),this.analyserNode.fftSize=2048,this.analyserNode.smoothingTimeConstant=.4,null===(t=this.sourceNode)||void 0===t||t.connect(this.analyserNode)}catch(e){Yw.warning("rebuild analyser node failed.")}}destroy(){this.updateSource(void 0)}}class AI extends rE{get processSourceNode(){return this.sourceNode}set processedNode(e){var t;if(!this.isDestroyed&&this._processedNode!==e){try{var i;null===(i=this.sourceNode)||void 0===i||i.disconnect(this.outputNode)}catch(e){}null===(t=this._processedNode)||void 0===t||t.disconnect(),this._processedNode=e,this.connect()}}get processedNode(){return this._processedNode}constructor(){super(),oh(this,"outputNode",void 0),oh(this,"outputTrack",void 0),oh(this,"isPlayed",!1),oh(this,"context",void 0),oh(this,"audioBufferNode",void 0),oh(this,"destNode",void 0),oh(this,"audioOutputLevel",0),oh(this,"volumeLevelAnalyser",void 0),oh(this,"_processedNode",void 0),oh(this,"playNode",void 0),oh(this,"isDestroyed",!1),oh(this,"onNoAudioInput",void 0),oh(this,"isNoAudioInput",!1),oh(this,"_noAudioInputCount",0),this.context=wI(),this.playNode=this.context.destination,this.outputNode=this.context.createGain(),TI(this.outputNode),this.volumeLevelAnalyser=new II}startGetAudioBuffer(e){this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=e=>{this.emit(tI.ON_AUDIO_BUFFER,function(e){for(let t=0;t<e.outputBuffer.numberOfChannels;t+=1){const i=e.outputBuffer.getChannelData(t);for(let e=0;e<i.length;e+=1)i[e]=0}return e.inputBuffer}(e))})}stopGetAudioBuffer(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}createOutputTrack(){if(!MC().webAudioMediaStreamDest)throw new jv(Bv.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}play(e){"running"!==this.context.state&&AE((()=>{bI.emit("autoplay-failed")})),this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}stop(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch(e){}this.isPlayed=!1}getAccurateVolumeLevel(){return this.volumeLevelAnalyser.getVolumeLevel()}async checkHasAudioInput(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(e>5)return this.isNoAudioInput=!0,this.onNoAudioInput&&this.onNoAudioInput(),!1;Tv()||Pv()?"suspended"===this.context.state&&this.context.resume():"running"!==this.context.state&&this.context.resume();const t=this.volumeLevelAnalyser.getAnalyserNode();let i;t.getFloatTimeDomainData?(i=new Float32Array(t.fftSize),t.getFloatTimeDomainData(i)):(i=new Uint8Array(t.fftSize),t.getByteTimeDomainData(i));let n=!1;for(let r=0;r<i.length;r++)0!==i[r]&&(n=!0);return n?(this.isNoAudioInput=!1,!0):(await VE(200),await this.checkHasAudioInput(e?e+1:1)&&n)}getAudioVolume(){return this.outputNode.gain.value}setVolume(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}destroy(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}disconnect(){var e,t;null===(e=this.processedNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.outputNode&&this.outputNode.disconnect()}connect(){var e;this.processedNode?null===(e=this.processedNode)||void 0===e||e.connect(this.outputNode):this.sourceNode&&this.sourceNode.connect(this.outputNode),this.volumeLevelAnalyser.updateSource(this.outputNode)}}class OI extends AI{get isFreeze(){return!1}constructor(e,t,i){var n;if(super(),oh(this,"sourceNode",void 0),oh(this,"track",void 0),oh(this,"clonedTrack",void 0),oh(this,"audioElement",void 0),oh(this,"isCurrentTrackCloned",!1),oh(this,"isRemoteTrack",!1),oh(this,"originVolumeLevelAnalyser",void 0),oh(this,"rebuildWebAudio",(async()=>{if(Yw.debug("ready to rebuild web audio, state:",this.context.state),this.isNoAudioInput&&await this.checkHasAudioInput(),!this.isNoAudioInput||this.isDestroyed)return document.body.removeEventListener("click",this.rebuildWebAudio,!0),void Yw.debug("rebuild web audio success, current volume status",this.getAccurateVolumeLevel());this.context.resume().then((()=>Yw.info("resume success"))),Yw.debug("rebuild web audio because of ios 12 bugs"),this.disconnect();const e=this.track;this.track=this.track.clone(),this.isCurrentTrackCloned?e.stop():this.isCurrentTrackCloned=!0;const t=new MediaStream([this.track]);this.sourceNode=this.context.createMediaStreamSource(t),TI(this.sourceNode),this.volumeLevelAnalyser.rebuildAnalyser();const i=this.outputNode.gain.value;this.outputNode=this.context.createGain(),this.outputNode.gain.setValueAtTime(i,this.context.currentTime),TI(this.outputNode),this.emit(tI.UPDATE_SOURCE),this.connect(),this.audioElement.srcObject=t,this.isPlayed&&this.play(this.playNode),this.checkHasAudioInput()})),"audio"!==e.kind)throw new jv(Bv.UNEXPECTED_ERROR);this.track=e;const r=new MediaStream([this.track]);if(this.isRemoteTrack=!!t,this.sourceNode=this.context.createMediaStreamSource(r),TI(this.sourceNode),i){const e=i.clone();e.enabled=!0,this.clonedTrack=e,Yw.debug("create an unmuted track ".concat(e.id," from the original track ").concat(i.id," to get the volume"));const t=this.context.createMediaStreamSource(new MediaStream([e]));TI(t),this.originVolumeLevelAnalyser=new II,this.originVolumeLevelAnalyser.updateSource(t)}this.connect(),this.audioElement=document.createElement("audio"),this.audioElement.srcObject=r;const o=mv();t&&o.os===uv.IOS&&Number(null===(n=o.osVersion)||void 0===n?void 0:n.split(".")[0])<15&&(bI.on(NC.STATE_CHANGE,(()=>{"suspended"===this.context.state?document.body.addEventListener("click",this.rebuildWebAudio,!0):"running"===this.context.state&&this.rebuildWebAudio()})),this.checkHasAudioInput().then((e=>{e||document.body.addEventListener("click",this.rebuildWebAudio,!0)})))}updateTrack(e){this.sourceNode.disconnect(),this.track=e,this.isCurrentTrackCloned=!1;const t=new MediaStream([e]);this.sourceNode=this.context.createMediaStreamSource(t),TI(this.sourceNode),this.processedNode||this.sourceNode.connect(this.outputNode),this.emit(tI.UPDATE_SOURCE),this.audioElement.srcObject=t}destroy(){var e;this.audioElement.srcObject=null,this.audioElement.remove(),bI.off("state-change",this.rebuildWebAudio),null===(e=this.originVolumeLevelAnalyser)||void 0===e||e.destroy(),this.clonedTrack=void 0,super.destroy()}createMediaStreamSourceNode(e){return this.context.createMediaStreamSource(new MediaStream([e]))}updateOriginTrack(e){const t=e.clone();t.enabled=!0,this.clonedTrack&&(this.clonedTrack.stop(),this.clonedTrack=t),Yw.debug("create an unmuted track ".concat(t.id," from the original track ").concat(e.id," to get the volume"));const i=this.context.createMediaStreamSource(new MediaStream([t]));TI(i),this.originVolumeLevelAnalyser&&this.originVolumeLevelAnalyser.updateSource(i)}getOriginVolumeLevel(){return this.originVolumeLevelAnalyser?this.originVolumeLevelAnalyser.getVolumeLevel():this.getAccurateVolumeLevel()}}async function MI(e,t,i){const n=(e,t)=>e?"number"!=typeof e?e.max||e.exact||e.ideal||e.min||t:e:t,r={audio:!!i&&{mandatory:{chromeMediaSource:"desktop"}},video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxHeight:n(t.height,1080),maxWidth:n(t.width,1920)}}};return t.frameRate&&"number"!=typeof t.frameRate?(r.video.mandatory.maxFrameRate=t.frameRate.max,r.video.mandatory.minFrameRate=t.frameRate.min):"number"==typeof t.frameRate&&(r.video.mandatory.maxFrameRate=t.frameRate),await navigator.mediaDevices.getUserMedia(r)}async function NI(e,t){const i=await kI(e.mediaSource),{sourceId:n,audio:r}=await function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new nv(((i,n)=>{const r=document.createElement("div");r.innerText="share screen",r.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");const o=document.createElement("div");o.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");const s=document.createElement("div");s.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",s.setAttribute("style","height: 12%;");const a=document.createElement("div");a.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");const c=document.createElement("div");c.setAttribute("style","display: flex; justify-content: space-between; padding: 16px 0;");const u=document.createElement("button");u.innerHTML="cancel",u.setAttribute("style","width: 85px;"),u.onclick=()=>{document.body.removeChild(h);const e=new Error("NotAllowedError");e.name="NotAllowedError",n(e)};let d=t;const l=document.createElement("div");if(t){const e=document.createElement("input");e.setAttribute("type","checkbox");const t=document.createElement("span");e.setAttribute("style","margin-right: 6px;"),t.innerText="Share audio",e.checked=d,e.onchange=()=>{d=e.checked},l.appendChild(e),l.appendChild(t)}c.appendChild(l),c.appendChild(u),o.appendChild(s),o.appendChild(a),o.appendChild(c);const h=document.createElement("div");h.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),h.appendChild(r),h.appendChild(o),document.body.appendChild(h),e.map((e=>{if(e.id){const t=document.createElement("div");t.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;");let n=e.thumbnail;try{const{width:e}=n.getSize();e>1920&&(n=n.resize({width:1920}))}catch(e){throw e&&e.message.startsWith("Illegal invocation")&&console.error("Operate thumbnail error, please try to set contextIsolation: false. (https://github.com/electron/electron/issues/34953)"),e}t.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+n.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name.replace(/[\u00A0-\u9999<>\&]/g,(function(e){return"&#"+e.charCodeAt(0)+";"}))+"</span>",t.onclick=()=>{document.body.removeChild(h),i({sourceId:e.id,audio:d})},a.appendChild(t)}}))}))}(i,t);return await MI(n,e,r)}async function kI(e){let t=["window","screen"];"application"!==e&&"window"!==e||(t=["window"]),"screen"===e&&(t=["screen"]);const i=sE();if(!i)throw console.error("failed to fetch electron, please mount it to window"),new jv(Bv.ELECTRON_IS_NULL);let n=null;try{var r;n=(null===(r=i.desktopCapturer)||void 0===r?void 0:r.getSources({types:t}))||i.ipcRenderer.invoke("DESKTOP_CAPTURER_GET_SOURCES",{types:t})}catch(e){n=null}n&&n.then||(n=new nv(((e,n)=>{i.desktopCapturer.getSources({types:t},((t,i)=>{t?n(t):e(i)}))})));try{return await n}catch(e){throw new jv(Bv.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,e.toString())}}function PI(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}const DI=new YE("safari");let LI=!1,xI=!1;async function UI(e,t){let i=0,n=null;for(;i<2;)try{n=await VI(e,t,i>0);break}catch(e){if(e instanceof jv)throw Yw.error("[".concat(t,"] ").concat(e.toString())),e;const n=BI(e.name||e.code||e,e.message);if(n.code===Bv.MEDIA_OPTION_INVALID){Yw.debug("[".concat(t,"] detect media option invalid, retry")),i+=1,await VE(500);continue}throw Yw.error("[".concat(t,"] ").concat(n.toString())),n}if(!n)throw new jv(Bv.UNEXPECTED_ERROR,"can not find stream after getUserMedia");return n}async function VI(e,t,i){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new jv(Bv.NOT_SUPPORTED,"can not find getUserMedia");i&&(e.video&&(delete e.video.width,delete e.video.height),e.screen&&(delete e.screen.width,delete e.screen.height));const n=MC(),r=new MediaStream;if(e.audioSource&&r.addTrack(e.audioSource),e.videoSource&&r.addTrack(e.videoSource),!e.audio&&!e.video&&!e.screen)return Yw.debug("Using Video Source/ Audio Source"),r;if(e.screen)if(sE())e.screen.sourceId?jI(r,await MI(e.screen.sourceId,e.screen,e.screenAudio)):jI(r,await NI(e.screen,e.screenAudio));else if(yv()&&e.screen.extensionId&&e.screen.mandatory){if(!n.getStreamFromExtension)throw new jv(Bv.NOT_SUPPORTED,"This browser does not support screen sharing");Yw.debug("[".concat(t,'] Screen access on chrome stable, looking for extension"'));const i=await(s=e.screen.extensionId,a=t,new nv(((e,t)=>{try{chrome.runtime.sendMessage(s,{getStream:!0},(i=>{if(!i||!i.streamId)return Yw.error("[".concat(a,"] No response from Chrome Plugin. Plugin not installed properly"),i),void t(new jv(Bv.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));e(i.streamId)}))}catch(e){Yw.error("[".concat(a,"] AgoraRTC screensharing plugin is not accessible(").concat(s,")"),e.toString()),t(new jv(Bv.CHROME_PLUGIN_NOT_INSTALL))}})));e.screen.mandatory.chromeMediaSourceId=i,jI(r,await navigator.mediaDevices.getUserMedia({video:{mandatory:e.screen.mandatory}}))}else if(n.getDisplayMedia){var o;e.screen.mediaSource&&KC(e.screen.mediaSource);const i={width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate,displaySurface:null!==(o=e.screen.displaySurface)&&void 0!==o?o:"screen"===e.screen.mediaSource?"monitor":e.screen.mediaSource},{selfBrowserSurface:n,surfaceSwitching:s,systemAudio:a}=e.screen,c={selfBrowserSurface:n,surfaceSwitching:s,systemAudio:a};!n&&delete c.selfBrowserSurface,!s&&delete c.surfaceSwitching,!a&&delete c.systemAudio,Yw.debug("[".concat(t,"] getDisplayMedia:"),JSON.stringify({video:i,audio:!!e.screenAudio,controls:c}));const u=await navigator.mediaDevices.getDisplayMedia(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?PI(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):PI(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({video:i,audio:!!e.screenAudio},c));jI(r,u)}else{if(!Sv())throw Yw.error("[".concat(t,"] This browser does not support screenSharing")),new jv(Bv.NOT_SUPPORTED,"This browser does not support screen sharing");{e.screen.mediaSource&&KC(e.screen.mediaSource);const i={video:{mediaSource:e.screen.mediaSource,width:e.screen.width,height:e.screen.height,frameRate:e.screen.frameRate}};Yw.debug("[".concat(t,"] getUserMedia: ").concat(JSON.stringify(i))),jI(r,await navigator.mediaDevices.getUserMedia(i))}}var s,a;if(!e.video&&!e.audio)return r;let c={video:e.video,audio:e.audio},u=Pw("MEDIA_DEVICE_CONSTRAINTS");if(u)try{"string"==typeof u&&(u=JSON.parse(u)),c=qE(c,u)}catch(e){}Yw.debug("[".concat(t,"] GetUserMedia"),JSON.stringify(c)),mv();let d,l=null;(wv()||Tv()||vv())&&(l=await DI.lock());try{d=await navigator.mediaDevices.getUserMedia(c)}catch(e){throw l&&l(),e}return c.audio&&(LI=!0),c.video&&(xI=!0),jI(r,d),l&&l(),r}function BI(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":return new jv(Bv.MEDIA_OPTION_INVALID,"".concat(e,": ").concat(t));case"NotFoundError":case"DevicesNotFoundError":return new jv(Bv.DEVICE_NOT_FOUND,"".concat(e,": ").concat(t));case"NotSupportedError":return new jv(Bv.NOT_SUPPORTED,"".concat(e,": ").concat(t));case"NotReadableError":return new jv(Bv.NOT_READABLE,"".concat(e,": ").concat(t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":return new jv(Bv.PERMISSION_DENIED,"".concat(e,": ").concat(t));case"ConstraintNotSatisfiedError":return new jv(Bv.CONSTRAINT_NOT_SATISFIED,"".concat(e,": ").concat(t));default:return Yw.error("getUserMedia unexpected error",e),new jv(Bv.UNEXPECTED_ERROR,"".concat(e,": ").concat(t))}}function jI(e,t){const i=e.getVideoTracks()[0],n=e.getAudioTracks()[0],r=t.getVideoTracks()[0],o=t.getAudioTracks()[0];o&&(n&&e.removeTrack(n),e.addTrack(o)),r&&(i&&e.removeTrack(i),e.addTrack(r))}const FI=new class extends rE{get state(){return this._state}set state(e){e!==this._state&&(this.emit(lI.STATE_CHANGE,e),this._state=e)}constructor(){super(),oh(this,"_state",dI.IDLE),oh(this,"isAccessMicrophonePermission",!1),oh(this,"isAccessCameraPermission",!1),oh(this,"lastAccessMicrophonePermission",!1),oh(this,"lastAccessCameraPermission",!1),oh(this,"checkdeviceMatched",!1),oh(this,"deviceInfoMap",new Map),this.init().then((()=>{navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",this.updateDevicesInfo.bind(this)),window.setInterval((()=>{(Pw("ENUMERATE_DEVICES_INTERVAL")||(Uv()||_v()===uv.HARMONY_OS)&&xv())&&this.updateDevicesInfo()}),Pw("ENUMERATE_DEVICES_INTERVAL_TIME"))})).catch((e=>Yw.error(e.toString())))}async enumerateDevices(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)return new jv(Bv.NOT_SUPPORTED,"enumerateDevices() not supported.").throw();const n=await navigator.mediaDevices.enumerateDevices(),r=this.checkMediaDeviceInfoIsOk(n);let o=!this.isAccessMicrophonePermission&&e,s=!this.isAccessCameraPermission&&t;r.audio&&(o=!1),r.video&&(s=!1);let a=null,c=null,u=null;if(!i&&(o||s)){if(DI.isLocked&&(Yw.debug("[device manager] wait GUM lock"),(await DI.lock())(),Yw.debug("[device manager] GUM unlock")),LI&&(o=!1,this.isAccessMicrophonePermission=!0),xI&&(s=!1,this.isAccessCameraPermission=!0),Yw.debug("[device manager] check media device permissions",e,t,o,s),o&&s){try{u=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0})}catch(e){const t=BI(e.name||e.code||e,e.message);if(t.code===Bv.PERMISSION_DENIED)throw t;Yw.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0,this.isAccessMicrophonePermission=!0}else if(o){try{a=await navigator.mediaDevices.getUserMedia({audio:e})}catch(e){const t=BI(e.name||e.code||e,e.message);if(t.code===Bv.PERMISSION_DENIED)throw t;Yw.warning("getUserMedia failed in getDevices",t)}this.isAccessMicrophonePermission=!0}else if(s){try{c=await navigator.mediaDevices.getUserMedia({video:t})}catch(e){const t=BI(e.name||e.code||e,e.message);if(t.code===Bv.PERMISSION_DENIED)throw t;Yw.warning("getUserMedia failed in getDevices",t)}this.isAccessCameraPermission=!0}Yw.debug("[device manager] mic permission",e,"cam permission",t)}try{const e=await navigator.mediaDevices.enumerateDevices();return a&&a.getTracks().forEach((e=>e.stop())),c&&c.getTracks().forEach((e=>e.stop())),u&&u.getTracks().forEach((e=>e.stop())),a=null,c=null,u=null,e}catch(e){return a&&a.getTracks().forEach((e=>e.stop())),c&&c.getTracks().forEach((e=>e.stop())),u&&u.getTracks().forEach((e=>e.stop())),a=null,c=null,u=null,new jv(Bv.ENUMERATE_DEVICES_FAILED,e.toString()).throw()}}async getRecordingDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter((e=>"audioinput"===e.kind))}async getCamerasDevices(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!1,!0,e)).filter((e=>"videoinput"===e.kind))}async getSpeakers(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(await this.enumerateDevices(!0,!1,e)).filter((e=>"audiooutput"===e.kind))}searchDeviceIdByName(e){let t=null;return this.deviceInfoMap.forEach((i=>{i.device.label===e&&(t=i.device.deviceId)})),t}async getDeviceById(e){const t=(await this.enumerateDevices(!0,!0,!0)).find((t=>t.deviceId===e));if(!t)throw new jv(Bv.DEVICE_NOT_FOUND,"deviceId: ".concat(e));return t}async init(){this.state=dI.INITING;try{await this.updateDevicesInfo(),this.state=dI.INITEND}catch(e){throw Yw.warning("Device Detection functionality cannot start properly.",e.toString()),this.state=dI.IDLE,("boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname)||new jv(Bv.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e}}async updateDevicesInfo(){const e=await this.enumerateDevices(!0,!0,!0),t=Date.now(),i=[];if(e[0]&&e[0].label&&!1===this.checkdeviceMatched){this.checkdeviceMatched=!0;const t=e.find((e=>"audioinput"===e.kind&&"default"===e.deviceId)),i=e.find((e=>"audiooutput"===e.kind&&"default"===e.deviceId));t&&i?i.groupId===t.groupId?Yw.debug("[device-check] default input ".concat(t.label," and output ").concat(i.label," is the same group")):Yw.warning("[device-check] default input ".concat(t.label," and output ").concat(i.label," is not the same group")):Yw.debug("[device-check] default input or output not found")}const n=this.checkMediaDeviceInfoIsOk(e);if(e.forEach((e=>{if(!e.deviceId)return;const n=this.deviceInfoMap.get("".concat(e.kind,"_").concat(e.deviceId));if("ACTIVE"!==(n?n.state:"INACTIVE")){const n={initAt:t,updateAt:t,device:e,state:"ACTIVE"};this.deviceInfoMap.set("".concat(e.kind,"_").concat(e.deviceId),n),i.push(n)}n&&(n.updateAt=t)})),this.deviceInfoMap.forEach(((e,n)=>{"ACTIVE"===e.state&&e.updateAt!==t&&(e.state="INACTIVE",i.push(e))})),this.state!==dI.INITEND)return n.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(n.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0));i.forEach((e=>{switch(e.device.kind){case"audioinput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(lI.RECORDING_DEVICE_CHANGED,e);break;case"videoinput":this.lastAccessCameraPermission&&this.isAccessCameraPermission&&this.emit(lI.CAMERA_DEVICE_CHANGED,e);break;case"audiooutput":this.lastAccessMicrophonePermission&&this.isAccessMicrophonePermission&&this.emit(lI.PLAYOUT_DEVICE_CHANGED,e)}})),n.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),n.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0)}checkMediaDeviceInfoIsOk(e){const t=e.filter((e=>"audioinput"===e.kind)),i=e.filter((e=>"videoinput"===e.kind)),n={audio:!1,video:!1};for(const r of t)if(r.label&&r.deviceId){n.audio=!0;break}for(const r of i)if(r.label&&r.deviceId){n.video=!0;break}return n}};let WI=!1;const GI=new class extends rE{constructor(){super(...arguments),oh(this,"onAutoplayFailed",void 0),oh(this,"onAudioAutoplayFailed",void 0)}};function HI(){if(mv(),!WI){const e=t=>{t.preventDefault(),WI=!1,Vv()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};WI=!0,Vv()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),Yw.info("detect media autoplay failed, document: https://docs.agora.io/cn/Voice/autoplay_policy_web_ng?platform=Web"),GI.onAutoplayFailed?GI.onAutoplayFailed():GI.onAudioAutoplayFailed?Yw.warning("AgoraRTC.onAudioAutoplayFailed has been deprecated in favor of AgoraRTC.onAutoplayFailed.\n\n  Please refer to the Agora document to migrate the newer API, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."):Yw.warning("We have detected a media autoplay failed event, and found out that you haven't implemented AgoraRTC.onAutoplayFailed callback yet.\n\n  It will cause audio/video element not playing automatically on some browsers without user interaction, possibly hurting user experiences.\n\n  Please refer to the Agora document to properly handle autoplay failed event, https://docs.agora.io/en/Voice/autoplay_policy_web_ng?platform=Web ."),GI.emit("autoplay-failed")}}function qI(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function KI(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?qI(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):qI(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function zI(e,t,i,n){if(!e)return;const r=aS.getBaseInfoBySessionId(e);if(!r)return;const o=r.info,s=Date.now(),a=KI(KI({},o),{},{vid:void 0===o.vid?0:Number(o.vid),lts:s,elapse:s-r.startTime,cbRegistered:GI.onAutoplayFailed||GI.onAudioAutoplayFailed?1:-1,errorMsg:i,mediaType:t,trackId:n,extend:void 0});aS.send({type:eS.AUTOPLAY_FAILED,data:a},!0)}const YI=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","error"],JI=new class{constructor(){oh(this,"onAutoplayFailed",void 0),oh(this,"elementMap",new Map),oh(this,"elementStateMap",new Map),oh(this,"elementsNeedToResume",[]),oh(this,"sinkIdMap",new Map),oh(this,"autoResumeAfterInterruption",(e=>{Array.from(this.elementMap.entries()).forEach((t=>{let[i,n]=t;const r=this.elementStateMap.get(i),o=n.srcObject.getAudioTracks()[0],s=o&&o.readyState;if(Yw.debug("resume after interrupted, ele: ".concat(r," audio: ").concat(s," ").concat(e)),"live"===s){if(e)return n.pause(),void n.play();if("running"===bI.curState)return Mv()?(n.pause(),void n.play()):void(r&&"paused"===r&&n.play())}}))})),oh(this,"autoResumeAfterInterruptionOnIOS15_16",(()=>{Array.from(this.elementMap.entries()).forEach((e=>{let[t,i]=e;const n=i.srcObject.getAudioTracks()[0];n&&"live"===n.readyState&&(Yw.debug("auto resume after interruption inside autoResumeAfterInterruptionOnIOS15"),i.pause(),i.play())}))})),this.autoResumeAudioElement(),bI.on(NC.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),bI.on(NC.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),bI.on(NC.STATE_CHANGE,(()=>{Tv()&&"suspended"===bI.prevState&&"running"===bI.curState&&this.autoResumeAfterInterruption()}))}async setSinkID(e,t){const i=this.elementMap.get(e);if(this.sinkIdMap.set(e,t),i)try{await i.setSinkId(t)}catch(e){throw new jv(Bv.PERMISSION_DENIED,"can not set sink id: "+e.toString())}}play(e,t,i,n){if(this.elementMap.has(t))return;const r=document.createElement("audio");r.autoplay=!0,r.srcObject=new MediaStream([e]),this.bindAudioElementEvents(t,r),this.elementMap.set(t,r),this.elementStateMap.set(t,hI.INIT),this.setVolume(t,i);const o=this.sinkIdMap.get(t);if(o)try{r.setSinkId(o).catch((e=>{Yw.warning("[".concat(t,"] set sink id failed"),e.toString())}))}catch(e){Yw.warning("[".concat(t,"] set sink id failed"),e.toString())}const s=r.play();s&&s.then&&s.catch((e=>{n&&zI(n,"audio",e.message,t),Yw.warning("audio element play warning",e.toString()),this.elementMap.has(t)&&"NotAllowedError"===e.name&&(Yw.warning("detected audio element autoplay failed"),this.elementsNeedToResume.push(r),AE((()=>{this.onAutoplayFailed&&this.onAutoplayFailed(),HI()})))}))}updateTrack(e,t){const i=this.elementMap.get(e);i&&(i.srcObject=new MediaStream([t]))}isPlaying(e){return this.elementMap.has(e)&&"playing"===this.elementStateMap.get(e)}setVolume(e,t){const i=this.elementMap.get(e);i&&(t=Math.max(0,Math.min(100,t)),i.volume=t/100)}stop(e){const t=this.elementMap.get(e);if(this.sinkIdMap.delete(e),!t)return;const i=this.elementsNeedToResume.indexOf(t);this.elementsNeedToResume.splice(i,1),t.srcObject=null,t.remove(),this.elementMap.delete(e),this.elementStateMap.delete(e)}bindAudioElementEvents(e,t){YI.forEach((i=>{t.addEventListener(i,(i=>{const n=this.elementStateMap.get(e),r="pause"===i.type?"paused":i.type;if(Yw.debug("[".concat(e,"] audio-element-status change ").concat(n," => ").concat(r)),"error"===i.type){const i=null==t?void 0:t.error;i&&Yw.error("[".concat(e,"] media error, code: ").concat(i.code,", message: ").concat(i.message))}this.elementStateMap.set(e,r)}))}))}getPlayerState(e){return this.elementStateMap.get(e)||"uninit"}autoResumeAudioElement(){const e=()=>{this.elementsNeedToResume.forEach((e=>{e.play().then((e=>{Yw.debug("Auto resume audio element success")})).catch((e=>{Yw.warning("Auto resume audio element failed!",e)}))})),this.elementsNeedToResume=[]};new nv((e=>{document.body?e():window.addEventListener("load",(()=>e()))})).then((()=>{Vv()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0))}))}};function XI(){return function(e,t,i){const n=i.value;return"function"==typeof n&&(i.value=function(){this._isClosed&&new jv(Bv.INVALID_OPERATION,"[".concat(this.getTrackId(),"] cannot operate a closed track")).print("warning",Yw);for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];const r=n.apply(this,t);return r instanceof nv?new nv(((e,t)=>{r.then(e).catch(t)})):r}),i}}function QI(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ZI(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?QI(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):QI(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class $I extends rE{constructor(e){super(),oh(this,"name","VideoProcessorDestination"),oh(this,"ID","0"),oh(this,"_source",void 0),oh(this,"videoContext",void 0),oh(this,"inputTrack",void 0),this.videoContext=e}get kind(){return"video"}get enabled(){return!0}pipe(){throw new jv(Bv.NOT_SUPPORTED,"VideoProcessor cannot pipe to any other Processor")}unpipe(){throw new jv(Bv.NOT_SUPPORTED,"VideoProcessor cannot unpipe to any other Processor")}enable(){}disable(){}updateInput(e){if(e.context!==this.videoContext)throw new Error("ProcessorContext passed to VideoTrack.processorDestination doesn't match it's belonging VideoTrack's context.\nProbably you are making pipeline like this:\nvideoTrack1.pipe(processor).pipe(videoTrack2.processorDestination).");e.track&&e.track!==this.inputTrack&&(this.videoContext.chained=!0,this.inputTrack=e.track,this.emit(cI.ON_TRACK,e.track))}reset(){this.inputTrack=void 0,this.videoContext.chained=!1,this.emit(cI.ON_TRACK,void 0)}}class eA extends rE{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t){super(),oh(this,"constraintsMap",new Map),oh(this,"statsRegistry",[]),oh(this,"usageRegistry",[]),oh(this,"trackId",void 0),oh(this,"direction",void 0),oh(this,"_chained",!1),this.trackId=e,this.direction=t}async getConstraints(){return await EE(this,uI.REQUEST_CONSTRAINTS)}async requestApplyConstraints(e,t){var i;return Yw.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),bE(this,uI.REQUEST_UPDATE_CONSTRAINTS,Array.from(US(i=this.constraintsMap).call(i)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return Yw.info("processor ".concat(e.name," requestRevertConstraints for ").concat(this.trackId)),this.constraintsMap.delete(e),bE(this,uI.REQUEST_UPDATE_CONSTRAINTS,Array.from(US(t=this.constraintsMap).call(t)))}registerStats(e,t,i){this.statsRegistry.find((i=>i.processorID===e.ID&&i.processorName===e.name&&i.type===t))||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:i})}unregisterStats(e,t){const i=this.statsRegistry.findIndex((i=>i.processorID===e.ID&&i.processorName===e.name&&i.type===t));-1!==i&&this.statsRegistry.splice(i,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:i,type:n,cb:r}of this.statsRegistry)try{const o=r();e.push({processorID:t,processorName:i,type:n,stats:o})}catch(e){Yw.error(new jv(Bv.UNEXPECTED_ERROR,e.message))}return e}registerUsage(e,t){this.usageRegistry.find((t=>t.processorID===e.ID&&t.processorName===e.name))||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){const t=this.usageRegistry.findIndex((t=>t.processorID===e.ID&&t.processorName===e.name));-1!==t&&this.usageRegistry.splice(t,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:t}of this.usageRegistry)try{let i=t();i instanceof nv&&(i=await i),e.push(ZI(ZI({},i),{},{direction:this.direction}))}catch(e){Yw.error("gather extension usage error",e)}return e}getDirection(){return this.direction}}class tA extends rE{constructor(e){super(),oh(this,"name","AudioProcessorDestination"),oh(this,"ID","0"),oh(this,"inputTrack",void 0),oh(this,"inputNode",void 0),oh(this,"audioProcessorContext",void 0),oh(this,"_source",void 0),this.audioProcessorContext=e}get kind(){return"audio"}get enabled(){return!0}pipe(){throw new jv(Bv.NOT_SUPPORTED,"AudioProcessorDestination cannot pipe to any other Processor")}unpipe(){throw new jv(Bv.NOT_SUPPORTED,"AudioProcessor cannot unpipe to any other Processor")}enable(){}disable(){}reset(){this.inputTrack=void 0,this.inputNode=void 0,this.audioProcessorContext.chained=!1,this.emit(cI.ON_TRACK,void 0),this.emit(cI.ON_NODE,void 0)}updateInput(e){if(e.context!==this.audioProcessorContext)throw new Error("ProcessorContext passed to AudioTrack.processorDestination doesn't match it's belonging AudioTrack's context.\n        Probably you are making pipeline like this: audioTrack1.pipe(processor).pipe(audioTrack2.processorDestination).");e.track&&this.inputTrack!==e.track&&(this.audioProcessorContext.chained=!0,this.inputTrack=e.track,this.emit(cI.ON_TRACK,this.inputTrack)),e.node&&this.inputNode!==e.node&&(this.audioProcessorContext.chained=!0,this.inputNode=e.node,this.emit(cI.ON_NODE,this.inputNode))}}class iA extends rE{set chained(e){this._chained=e}get chained(){return this._chained}constructor(e,t,i){super(),oh(this,"constraintsMap",new Map),oh(this,"statsRegistry",[]),oh(this,"audioContext",void 0),oh(this,"trackId",void 0),oh(this,"direction",void 0),oh(this,"usageRegistry",[]),oh(this,"_chained",!1),this.audioContext=e,this.trackId=t,this.direction=i}async getConstraints(){return EE(this,uI.REQUEST_CONSTRAINTS)}getAudioContext(){return this.audioContext}async requestApplyConstraints(e,t){var i;return Yw.info("processor ".concat(t.name," requestApplyConstraints for ").concat(this.trackId)),e&&this.constraintsMap.set(t,e),bE(this,uI.REQUEST_UPDATE_CONSTRAINTS,Array.from(US(i=this.constraintsMap).call(i)))}async requestRevertConstraints(e){var t;if(this.constraintsMap.has(e))return this.constraintsMap.delete(e),bE(this,uI.REQUEST_UPDATE_CONSTRAINTS,Array.from(US(t=this.constraintsMap).call(t)))}registerStats(e,t,i){this.statsRegistry.find((i=>i.processorID===e.ID&&i.processorName===e.name&&i.type===t))||this.statsRegistry.push({processorName:e.name,processorID:e.ID,type:t,cb:i})}unregisterStats(e,t){const i=this.statsRegistry.findIndex((i=>i.processorID===e.ID&&i.processorName===e.name&&i.type===t));-1!==i&&this.statsRegistry.splice(i,1)}gatherStats(){const e=[];for(const{processorID:t,processorName:i,type:n,cb:r}of this.statsRegistry)try{const o=r();e.push({processorID:t,processorName:i,type:n,stats:o})}catch(e){Yw.error(new jv(Bv.UNEXPECTED_ERROR,e.message))}return e}registerUsage(e,t){this.usageRegistry.find((t=>t.processorID===e.ID&&t.processorName===e.name))||this.usageRegistry.push({processorID:e.ID,processorName:e.name,cb:t})}unregisterUsage(e){const t=this.usageRegistry.findIndex((t=>t.processorID===e.ID&&t.processorName===e.name));-1!==t&&this.usageRegistry.splice(t,1)}async gatherUsage(){const e=[];if(!this.chained)return[];for(const{cb:t}of this.usageRegistry)try{let i=t();i instanceof nv&&(i=await i),e.push(ZI(ZI({},i),{},{direction:this.direction}))}catch(e){Yw.error("gather extension usage error",e)}return e}getDirection(){return this.direction}}class nA extends rE{get isPlayed(){return!0}get isFreeze(){return!1}constructor(){super(),oh(this,"context",void 0),oh(this,"processSourceNode",void 0),oh(this,"outputTrack",void 0),oh(this,"processedNode",void 0),oh(this,"clonedTrack",void 0),oh(this,"outputNode",void 0),this.outputNode=new rA}setVolume(){}createOutputTrack(){throw new jv(Bv.NOT_SUPPORTED,"can not create output MediaStreamTrack when WebAudio disabled")}getOriginVolumeLevel(){return 0}getAccurateVolumeLevel(){return 0}stopGetAudioBuffer(){}startGetAudioBuffer(){}play(){}stop(){}destroy(){}updateTrack(){}updateOriginTrack(){}createMediaStreamSourceNode(){}}class rA{disconnect(){}connect(){}}let oA=null;class sA{constructor(){oh(this,"state","open"),oh(this,"trigger",void 0),oh(this,"tasks",[]),Yw.debug("[macro-task-queue] is created."),this.trigger=window.setTimeout((()=>{this.state="closed",Yw.debug("[macro-task-queue] will be closed, all remaining tasks will execute. [".concat(this.tasks.map((e=>e.key)),"]")),this.trigger=void 0,this.tasks.forEach((e=>{let{func:t}=e;return t()})),this.tasks.length=0,Yw.debug("[macro-task-queue] is closed.")}))}enqueue(e,t){"closed"!==this.state&&(this.tasks.push({key:e,func:t}),Yw.debug("[macro-task-queue] is queued, current queue ".concat(this.tasks.length,". ").concat("string"==typeof e?e:"")))}runTask(e){if("closed"===this.state)return;const t=this.tasks.findIndex((t=>t.key===e));if(-1!==t){const i=this.tasks.splice(t,1);Yw.debug("[macro-task-queue] is unqueued, current queue ".concat(this.tasks.length,". ").concat("string"==typeof e?e:"")),i[0].func()}}release(){this.trigger&&(this.state="closed",clearTimeout(this.trigger),this.trigger=void 0,this.tasks.length=0,Yw.debug("[macro-task-queue] is closed."))}}function aA(e){return function(t,i,n){var r;const o=null!==(r=n.value)&&void 0!==r?r:n.get,s=function(){oA&&"open"===oA.state&&oA.runTask(e);for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return null==o?void 0:o.apply(this,...i)};return n.value?n.value=s:n.get=s,n}}function cA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function uA(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?cA(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):cA(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class dA extends _I{get _source(){return this._trackSource}set _source(e){this._trackSource=e}get processorContext(){return this._processorContext}set processorContext(e){this._processorContext=e}get processorDestination(){return this._processorDestination}set processorDestination(e){this._processorDestination=e}get isPlaying(){return this._useAudioElement?JI.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"LocalAudioTrack"}constructor(e,t,i,n,r){super(e,i),oh(this,"trackMediaType","audio"),oh(this,"_encoderConfig",void 0),oh(this,"_trackSource",void 0),oh(this,"_enabled",!0),oh(this,"_volume",100),oh(this,"_useAudioElement",!1),oh(this,"_bypassWebAudio",!1),oh(this,"processor",void 0),oh(this,"_processorContext",void 0),oh(this,"_processorDestination",void 0),oh(this,"_getOriginVolumeLevel",void 0),this._encoderConfig=t,this._getOriginVolumeLevel=!!n;const o=()=>{this.processorContext=new iA(this._source.context,this.getTrackId(),"local"),this.processorDestination=new tA(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(tI.UPDATE_SOURCE,(()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})}))},s=r&&wv()&&!SI();Pw("DISABLE_WEBAUDIO")?(this._source=new nA,this._useAudioElement=!0,this._bypassWebAudio=!0):s?this._source=new nA:(this._source=new OI(e,!1,this._getOriginVolumeLevel?e:void 0),Pw("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0)),o(),!Pw("DISABLE_WEBAUDIO")&&s&&(oA||(oA=new sA),oA).enqueue("INIT_WEBAUDIO",(()=>{this._source=new OI(e,!1,this._getOriginVolumeLevel?e:void 0),Pw("LOCAL_AUDIO_TRACK_USES_WEB_AUDIO")||(this._useAudioElement=!0),o(),this.emit(iI.UPDATE_TRACK_SOURCE)}))}setVolume(e){Gv(e,"volume",0,1e3),this._volume=e,this._source.setVolume(e/100),this._useAudioElement&&JI.setVolume(this.getTrackId(),e);try{if(this._bypassWebAudio)return void Yw.debug("[".concat(this.getTrackId(),"] setVolume returned because no pass through WebAudio."));const e=this._source.createOutputTrack();this._mediaStreamTrack!==e&&(this._mediaStreamTrack=e,bE(this,zC.NEED_REPLACE_TRACK,this).then((()=>{Yw.debug("[".concat(this.getTrackId(),"] replace web audio track success"))})).catch((e=>{Yw.warning("[".concat(this.getTrackId(),"] replace web audio track failed"),e)})))}catch(e){}}getVolumeLevel(){return this._muted&&this.enabled&&this._getOriginVolumeLevel?this._source.getOriginVolumeLevel():this._source.getAccurateVolumeLevel()}async setPlaybackDevice(e){if(!this._useAudioElement||!yv()&&Pw("RESTRICTION_SET_PLAYBACK_DEVICE"))throw new jv(Bv.NOT_SUPPORTED,"your browser does not support setting the audio output device");await JI.setSinkID(this.getTrackId(),e)}async setEnabled(e,t,i){return this._setEnabled(e,t,i)}async _setEnabled(e,t,i){if(!i){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(Yw.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){this._originMediaStreamTrack.enabled=!0;try{i||(this._enabled=!0),await bE(this,zC.NEED_ENABLE_TRACK,this),Yw.info("[".concat(this.getTrackId(),"] setEnabled to ").concat(e," success"))}catch(e){throw i||(this._enabled=!1),Yw.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}}else{this._originMediaStreamTrack.enabled=!1,i||(this._enabled=!1);try{await bE(this,zC.NEED_DISABLE_TRACK,this)}catch(e){throw i||(this._enabled=!0),Yw.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}}}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,Yw.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await bE(this,zC.NEED_MUTE_TRACK,this):await bE(this,zC.NEED_UNMUTE_TRACK,this))}getStats(){return kE((()=>{Yw.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")}),"localAudioTrackGetStatsWarning"),yE(this,zC.GET_STATS)||uA({},nI)}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(tI.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(tI.ON_AUDIO_BUFFER),this._source.on(tI.ON_AUDIO_BUFFER,(t=>e(t)))}play(){Yw.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(Yw.debug("[".concat(this.getTrackId(),"] start audio playback in element")),JI.play(this._mediaStreamTrack,this.getTrackId(),this._volume)):this._source.play()}stop(){Yw.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?JI.stop(this.getTrackId()):this._source.stop()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe(),this._source.destroy()}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Yw.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&JI.updateTrack(this.getTrackId(),this._mediaStreamTrack)}async _updateOriginMediaStreamTrack(e,t){this._originMediaStreamTrack!==e&&(this._originMediaStreamTrack&&(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t&&this._originMediaStreamTrack.stop()),e.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=e,this._muted&&(this._originMediaStreamTrack.enabled=!1),this.processor&&this.processor.updateInput({track:e,context:this.processorContext}),this._mediaStreamTrack!==this._source.outputTrack?(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await bE(this,zC.NEED_REPLACE_TRACK,this)):this._source.updateTrack(this._originMediaStreamTrack),this._getOriginVolumeLevel&&this._source.updateOriginTrack(e))}renewMediaStreamTrack(e){return nv.resolve(void 0)}pipe(e){if(this._bypassWebAudio)throw new jv(Bv.INVALID_OPERATION,"Can not process AudioTrack when bypassWebAudio set to true.");if(this.processor===e)return e;if(e._source)throw new jv(Bv.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(cI.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e),await bE(this,zC.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await bE(this,zC.NEED_REPLACE_TRACK,this))})),this.processorDestination.on(cI.ON_NODE,(e=>{this._source.processedNode=e}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(cI.ON_TRACK),this.processorDestination.removeAllListeners(cI.ON_NODE)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(uI.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(uI.REQUEST_CONSTRAINTS)}}VS([aA("INIT_WEBAUDIO"),BS("design:type",Object),BS("design:paramtypes",[Object])],dA.prototype,"_source",null),VS([aA("INIT_WEBAUDIO"),BS("design:type",iA),BS("design:paramtypes",[iA])],dA.prototype,"processorContext",null),VS([aA("INIT_WEBAUDIO"),BS("design:type",tA),BS("design:paramtypes",[tA])],dA.prototype,"processorDestination",null),VS([sS({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),BS("design:type",Function),BS("design:paramtypes",[Number]),BS("design:returntype",void 0)],dA.prototype,"setVolume",null),VS([sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],dA.prototype,"setPlaybackDevice",null),VS([JE("LocalAudioTrack","_enabledMutex"),sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Boolean,Object,Boolean]),BS("design:returntype",nv)],dA.prototype,"setEnabled",null),VS([JE("LocalAudioTrack","_enabledMutex"),sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Boolean]),BS("design:returntype",nv)],dA.prototype,"setMuted",null),VS([XI(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",Object)],dA.prototype,"getStats",null),VS([XI(),BS("design:type",Function),BS("design:paramtypes",[Object,Number]),BS("design:returntype",void 0)],dA.prototype,"setAudioFrameCallback",null),VS([sS({argsMap:e=>[e.getTrackId()]}),XI(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],dA.prototype,"play",null),VS([sS({argsMap:e=>[e.getTrackId()]}),XI(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],dA.prototype,"stop",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],dA.prototype,"close",null),VS([sS({argsMap:(e,t)=>[e.getTrackId(),t.name]}),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",Object)],dA.prototype,"pipe",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],dA.prototype,"unpipe",null);class lA extends dA{get __className__(){return"MicrophoneAudioTrack"}constructor(e,t,i,n){super(e,t.encoderConfig?HC(t.encoderConfig):{},n,Pw("GET_VOLUME_OF_MUTED_AUDIO_TRACK"),!0),oh(this,"_config",void 0),oh(this,"_deviceName","default"),oh(this,"_constraints",void 0),oh(this,"_originalConstraints",void 0),oh(this,"_enabled",!0),this._config=t,this._constraints=i,this._originalConstraints=i,this._deviceName=e.label,"boolean"==typeof t.bypassWebAudio&&(this._bypassWebAudio=t.bypassWebAudio),(Mv()||Nv())&&bI.bindInterruptDetectorTrack(this),this.on(iI.UPDATE_TRACK_SOURCE,(()=>{this.bindProcessorContextEvents()})),SI()&&this.bindProcessorContextEvents()}async setDevice(e){if(Yw.info("[".concat(this.getTrackId(),"] start set device to ").concat(e)),this._enabled)try{const t=await FI.getDeviceById(e),i={};i.audio=uA({},this._constraints),i.audio.deviceId={exact:e},this._originMediaStreamTrack.stop();let n=null;try{n=await UI(i,this.getTrackId())}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),n=await UI({audio:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(n.getAudioTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(n.getAudioTracks()[0],!1),this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await FI.getDeviceById(e);this._deviceName=t.label,this._config.microphoneId=e,this._constraints.deviceId={exact:e}}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}Yw.info("[".concat(this.getTrackId(),"] set device to ").concat(e," success"))}async setEnabled(e,t,i){if(t)return Yw.debug("[".concat(this.getTrackId(),"] setEnabled false (do not close microphone)")),await super._setEnabled(e);if(!i){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(Yw.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){var n;this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),null===(n=this._source.clonedTrack)||void 0===n||n.stop(),i||(this._enabled=!1);try{await bE(this,zC.NEED_DISABLE_TRACK,this)}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setEnabled false failed"),e.toString()),e}return}const r=uA({},this._constraints),o=FI.searchDeviceIdByName(this._deviceName);o&&!r.deviceId&&(r.deviceId=o);try{i||(this._enabled=!0);const e=await UI({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!1),await bE(this,zC.NEED_ENABLE_TRACK,this)}catch(e){throw i||(this._enabled=!1),Yw.error("[".concat(this.getTrackId(),"] setEnabled true failed"),e.toString()),e}Yw.info("[".concat(this.getTrackId(),"] setEnabled success"))}close(){super.close(),(Mv()||Nv())&&bI.unbindInterruptDetectorTrack(this)}onTrackEnded(){if((Tv()||Pv())&&this._enabled&&!this._isClosed&&bI.duringInterruption){const e=async()=>{bI.off(NC.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(Yw.debug("[".concat(this.getTrackId(),"] try capture microphone media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};bI.on(NC.IOS_INTERRUPTION_END,e)}else Yw.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit($C.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,i=FI.searchDeviceIdByName(this._deviceName);if(i&&!t.deviceId&&(t.deviceId=i),this._constraints=t,this._enabled){this._originMediaStreamTrack.stop();const e=await UI({audio:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getAudioTracks()[0],!0)}}bindProcessorContextEvents(){this.processorContext.on(uI.REQUEST_UPDATE_CONSTRAINTS,(async(e,t,i)=>{try{const i=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(i),t()}catch(e){i(e)}})),this.processorContext.on(uI.REQUEST_CONSTRAINTS,(async e=>{e(this._originMediaStreamTrack.getSettings())}))}}VS([sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],lA.prototype,"setDevice",null),VS([JE("MicrophoneAudioTrack","_enabledMutex"),sS({argsMap:(e,t,i)=>[e.getTrackId(),t,i]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Boolean,Boolean,Boolean]),BS("design:returntype",nv)],lA.prototype,"setEnabled",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],lA.prototype,"close",null);class hA extends dA{get __className__(){return"BufferSourceAudioTrack"}constructor(e,t,i,n){super(t.createOutputTrack(),i,n),oh(this,"source",void 0),oh(this,"_bufferSource",void 0),this.source=e,this._bufferSource=t,this._bufferSource.on(tI.AUDIO_SOURCE_STATE_CHANGE,(e=>{this.safeEmit($C.SOURCE_STATE_CHANGE,e)}));try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}}get currentState(){return this._bufferSource.currentState}get duration(){return this._bufferSource.duration}get playbackSpeed(){return this._bufferSource.playbackSpeed}getCurrentTime(){return this._bufferSource.currentTime}startProcessAudioBuffer(e){e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer()}pauseProcessAudioBuffer(){this._bufferSource.pauseProcessAudioBuffer()}seekAudioBuffer(e){this._bufferSource.seekAudioBuffer(e)}resumeProcessAudioBuffer(){this._bufferSource.resumeProcessAudioBuffer()}stopProcessAudioBuffer(){this._bufferSource.stopProcessAudioBuffer()}close(){this.source=null,this._bufferSource.destroy(),super.close()}setAudioBufferPlaybackSpeed(e){Gv(e,"speed",0),this._bufferSource.setAudioBufferPlaybackSpeed(e)}}VS([sS({argsMap:(e,t)=>[e.getTrackId(),t,e.duration]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",void 0)],hA.prototype,"startProcessAudioBuffer",null),VS([sS({argsMap:e=>[e.getTrackId()]}),XI(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],hA.prototype,"pauseProcessAudioBuffer",null),VS([sS({argsMap:e=>[e.getTrackId()]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Number]),BS("design:returntype",void 0)],hA.prototype,"seekAudioBuffer",null),VS([sS({argsMap:e=>[e.getTrackId()]}),XI(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],hA.prototype,"resumeProcessAudioBuffer",null),VS([sS({argsMap:e=>[e.getTrackId()]}),XI(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],hA.prototype,"stopProcessAudioBuffer",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],hA.prototype,"close",null),VS([sS({argsMap:e=>[e.getTrackId()]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Number]),BS("design:returntype",void 0)],hA.prototype,"setAudioBufferPlaybackSpeed",null);class fA extends dA{get __className__(){return"MixingAudioTrack"}get isActive(){for(const e of this.trackList)if(e._enabled&&!e._isClosed&&!e.muted)return!0;return!1}constructor(){const e=wI().createMediaStreamDestination();super(e.stream.getAudioTracks()[0],void 0,BE(8,"track-mix-")),oh(this,"trackList",void 0),oh(this,"destNode",void 0);try{this._mediaStreamTrack=this._source.createOutputTrack()}catch(e){}this.destNode=e,this.trackList=[]}hasAudioTrack(e){return-1!==this.trackList.indexOf(e)}addAudioTrack(e){-1===this.trackList.indexOf(e)?(Yw.debug("add ".concat(e.getTrackId()," to mixing track")),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()):Yw.debug("track ".concat(e.getTrackId()," is already added"))}removeAudioTrack(e){if(-1!==this.trackList.indexOf(e)){Yw.debug("remove ".concat(e.getTrackId()," from mixing track"));try{e._source.outputNode.disconnect(this.destNode)}catch(e){}CE(this.trackList,e),this.updateEncoderConfig()}}updateEncoderConfig(){const e={};this.trackList.forEach((t=>{t._encoderConfig&&((t._encoderConfig.bitrate||0)>(e.bitrate||0)&&(e.bitrate=t._encoderConfig.bitrate),(t._encoderConfig.sampleRate||0)>(e.sampleRate||0)&&(e.sampleRate=t._encoderConfig.sampleRate),(t._encoderConfig.sampleSize||0)>(e.sampleSize||0)&&(e.sampleSize=t._encoderConfig.sampleSize),t._encoderConfig.stereo&&(e.stereo=!0))})),this._encoderConfig=e}_updateRtpTransceiver(e){this._rtpTransceiver!==e&&(this._rtpTransceiver=e,this.trackList.forEach((t=>{t instanceof fA?t.emit(ZC.TRANSCEIVER_UPDATED,e):t._updateRtpTransceiver(e)})))}}function pA(e){const t={};e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId});const i=jC(e.encoderConfig);return null!=i.width&&(t.width=i.width),null!=i.height&&(t.height=i.height),!Lv()&&i.frameRate&&(t.frameRate=i.frameRate),mv().name===dv.EDGE&&"object"==typeof t.frameRate&&(t.frameRate.max=60),Sv()&&(t.frameRate={ideal:30,max:30}),t}function mA(e){const t={};if(Lv()||(void 0!==e.AGC&&(t.autoGainControl=e.AGC),void 0!==e.AEC&&(t.echoCancellation=e.AEC),void 0!==e.ANS&&(t.noiseSuppression=e.ANS,yv()&&e.ANS&&(t.googHighpassFilter=e.ANS))),e.encoderConfig){const i=HC(e.encoderConfig);t.channelCount=i.stereo?2:1,t.sampleRate=i.sampleRate,t.sampleSize=i.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),Uv()&&(t.sampleRate=void 0),t}class _A extends AI{set currentState(e){e!==this._currentState&&(this._currentState=e,this.safeEmit(tI.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}get currentState(){return this._currentState}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),oh(this,"audioBuffer",void 0),oh(this,"sourceNode",void 0),oh(this,"startPlayTime",0),oh(this,"startPlayOffset",0),oh(this,"pausePlayTime",0),oh(this,"options",void 0),oh(this,"currentLoopCount",0),oh(this,"currentPlaybackSpeed",100),oh(this,"_currentState","stopped"),this.audioBuffer=e,this.options=t,this.startPlayOffset=this.options.startPlayTime||0}createWebAudioDiagram(){return this.context.createGain()}get duration(){return this.audioBuffer?this.audioBuffer.duration:0}get playbackSpeed(){return this.currentPlaybackSpeed}get currentTime(){return this.audioBuffer?"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:((this.context.currentTime-this.startPlayTime)*(this.playbackSpeed/100)+this.startPlayOffset)%this.audioBuffer.duration:0}updateOptions(e){"stopped"===this.currentState?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):Yw.warning("can not set audio source options")}startProcessAudioBuffer(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}pauseProcessAudioBuffer(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}seekAudioBuffer(e){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=e,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=e))}resumeProcessAudioBuffer(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}stopProcessAudioBuffer(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch(e){}this.reset()}}destroy(){this.audioBuffer=null,super.destroy()}setAudioBufferPlaybackSpeed(e){this.sourceNode&&("playing"===this.currentState&&(this.startPlayOffset=this.currentTime,this.startPlayTime=this.context.currentTime),this.sourceNode.playbackRate.value=e/100),this.currentPlaybackSpeed=e}startSourceNode(){this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=this.handleSourceNodeEnded.bind(this))}createSourceNode(){const e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e.playbackRate.value=this.currentPlaybackSpeed/100,e}handleSourceNodeEnded(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}reset(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}const gA=new Map;async function vA(e,t){let i=null;if("string"==typeof e){const t=gA.get(e);if(t)return Yw.debug("use cached audio resource: ",e),t;try{i=(await ZE((()=>gw.get(e,{responseType:"arraybuffer"})),void 0,void 0,{maxRetryCount:3})).data}catch(e){throw new jv(Bv.FETCH_AUDIO_FILE_FAILED,e.toString())}}else{const t=new nv(((t,i)=>{const n=new FileReader;n.onload=e=>{e.target?t(e.target.result):i(new jv(Bv.READ_LOCAL_AUDIO_FILE_ERROR))},n.onerror=()=>{i(new jv(Bv.READ_LOCAL_AUDIO_FILE_ERROR))},n.readAsArrayBuffer(e)}));i=await t}const n=await function(e){const t=wI();return new nv(((i,n)=>{t.decodeAudioData(e,(e=>{i(e)}),(e=>{n(new jv(Bv.DECODE_AUDIO_FILE_FAILED,e.toString()))}))}))}(i);return"string"==typeof e&&t&&gA.set(e,n),n}const EA=e=>{const t=document.createElement("canvas");return t.width=2,t.height=2,new nv(((i,n)=>{t.toBlob((async e=>{if(t.remove(),e){const n=await bA(e);i({buffer:n,width:t.width,height:t.height})}else n(new jv(Bv.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))}),e,1)}))},bA=async e=>{const t=await e.arrayBuffer();return new Uint8Array(t)},yA=new class extends rE{get visibility(){return document.visibilityState}get lastHiddenTime(){return this._lastHiddenTime}get lastVisibleTime(){return this._lastVisibleTime}constructor(){super(),oh(this,"_lastHiddenTime",0),oh(this,"_lastVisibleTime",0),document.addEventListener("visibilitychange",(()=>{"hidden"===document.visibilityState?this._lastHiddenTime=performance.now():this._lastVisibleTime=performance.now(),Yw.debug("document visibility went ".concat(document.visibilityState)),this.emit("VISIBILITY_CHANGE",document.visibilityState)}))}};function wA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function SA(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?wA(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):wA(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class TA{get videoElementStatus(){return this._videoElementStatus}set videoElementStatus(e){e!==this._videoElementStatus&&(Yw.debug("[".concat(this.trackId,"] video-element-status change ").concat(this._videoElementStatus," => ").concat(e)),this._videoElementStatus=e)}constructor(e){oh(this,"trackId",void 0),oh(this,"config",void 0),oh(this,"onFirstVideoFrameDecoded",void 0),oh(this,"freezeTimeCounterList",[]),oh(this,"renderFreezeAccTime",0),oh(this,"isKeepLastFrame",!1),oh(this,"timeUpdatedCount",0),oh(this,"freezeTime",0),oh(this,"playbackTime",0),oh(this,"lastTimeUpdatedTime",0),oh(this,"autoplayFailed",!1),oh(this,"videoTrack",void 0),oh(this,"videoElement",void 0),oh(this,"cacheVideoElement",void 0),oh(this,"videoElementCheckInterval",void 0),oh(this,"_videoElementStatus",hI.NONE),oh(this,"isGettingVideoDimensions",!1),oh(this,"startGetVideoDimensions",(()=>{const e=()=>{if(this.isGettingVideoDimensions=!0,this.videoElement.videoWidth*this.videoElement.videoHeight>4)return Yw.debug("[".concat(this.trackId,"] current video dimensions:"),this.videoElement.videoWidth,this.videoElement.videoHeight),void(this.isGettingVideoDimensions=!1);setTimeout(e,500)};!this.isGettingVideoDimensions&&e()})),oh(this,"autoResumeAfterInterruption",(()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&"running"===bI.curState&&(Yw.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(gv())),kv()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))})),oh(this,"handleVideoEvents",(e=>{switch(e.type){case"play":case"playing":this.startGetVideoDimensions(),this.videoElementStatus=hI.PLAYING;break;case"loadeddata":if(this.onFirstVideoFrameDecoded&&this.onFirstVideoFrameDecoded(),this.cacheVideoElement){try{this.cacheVideoElement.srcObject=null,this.cacheVideoElement.remove()}catch(e){}this.cacheVideoElement=void 0}break;case"canplay":this.videoElementStatus=hI.CANPLAY;break;case"stalled":this.videoElementStatus=hI.STALLED;break;case"suspend":this.videoElementStatus=hI.SUSPEND;break;case"pause":this.videoElementStatus=hI.PAUSED,Tv()||Pv()||wv()&&this.autoplayFailed||!this.videoTrack||"live"!==this.videoTrack.readyState||(Yw.debug("[track-".concat(this.trackId,"] video element paused, auto resume")),this.videoElement.play());break;case"waiting":this.videoElementStatus=hI.WAITING;break;case"abort":this.videoElementStatus=hI.ABORT;break;case"ended":this.videoElementStatus=hI.ENDED;break;case"emptied":this.videoElementStatus=hI.EMPTIED;break;case"error":{this.videoElementStatus=hI.ERROR;const e=this.videoElement.error;e&&Yw.error("[".concat(this.trackId,"] media error, code: ").concat(e.code,", message: ").concat(e.message));break}case"timeupdate":{const e=performance.now();if(this.timeUpdatedCount+=1,this.timeUpdatedCount<10)return void(this.lastTimeUpdatedTime=e);const t=e-this.lastTimeUpdatedTime,i=this.lastTimeUpdatedTime;if(this.lastTimeUpdatedTime=e,yA.lastVisibleTime<yA.lastHiddenTime||i<yA.lastHiddenTime||i<yA.lastVisibleTime)return;for(t>Pw("VIDEO_FREEZE_DURATION")&&(this.freezeTime+=t),this.playbackTime+=t;this.playbackTime>=6e3;){this.playbackTime-=6e3;const e=Math.min(6e3,this.freezeTime);this.freezeTimeCounterList.push(e),this.freezeTime=Math.max(0,this.freezeTime-6e3)}break}}})),oh(this,"autoResumeAfterInterruptionOnIOS15_16",(()=>{this.videoTrack&&"live"===this.videoTrack.readyState&&(Yw.debug("[track-".concat(this.trackId,"] video element paused, auto resume for ").concat(gv())),kv()?(this.videoElement.srcObject=null,this.videoElement.srcObject=new MediaStream([this.videoTrack]),this.videoElement.play()):(this.videoElement.pause(),this.videoElement.play()))})),this.trackId=e.trackId,this.config=e,e.element instanceof HTMLVideoElement?this.videoElement=e.element:this.videoElement=document.createElement("video"),bI.on(NC.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),bI.on(NC.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16)}getVideoElement(){return this.videoElement}getContainerElement(){var e;return null!==(e=this.videoElement.parentElement)&&void 0!==e?e:void 0}updateConfig(e){this.config=e,this.trackId=e.trackId,e.element!==this.videoElement&&(this.destroy(),this.videoElement=e.element),this.videoTrack&&this.initVideoElement()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.initVideoElement())}play(e){const t=this.videoElement.play();t&&t.catch&&t.catch((t=>{e&&zI(e,"video",t.message,this.trackId),"NotAllowedError"===t.name?(Yw.warning("detected video element autoplay failed",t),this.autoplayFailed=!0,this.handleAutoPlayFailed()):Yw.warning("[".concat(this.trackId,"] play warning: "),t)}));const i=mv();if(("Safari"===i.name&&15===Number(i.version)||Mv())&&t&&t.then){const e=()=>{this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)")};t.then(e).catch(e)}}getCurrentFrame(){const e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;const t=e.getContext("2d");if(!t)return Yw.error("create canvas context failed!"),new ImageData(2,2);t.drawImage(this.videoElement,0,0,e.width,e.height);const i=t.getImageData(0,0,e.width,e.height);return e.remove(),i}async getCurrentFrameToUint8Array(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const i=document.createElement("canvas");i.width=this.videoElement.videoWidth,i.height=this.videoElement.videoHeight;const n=i.getContext("2d");return n?(n.drawImage(this.videoElement,0,0,i.width,i.height),new nv(((n,r)=>{i.toBlob((async e=>{if(i.remove(),e){const t=await bA(e);n({buffer:t,width:i.width,height:i.height})}else r(new jv(Bv.CONVERTING_VIDEO_FRAME_TO_BLOB_FAILED))}),e,t<0?.1:t>1?1:t)}))):await EA(e)}destroy(){bI.off(NC.IOS_INTERRUPTION_END,this.autoResumeAfterInterruption),bI.off(NC.IOS_15_16_INTERRUPTION_END,this.autoResumeAfterInterruptionOnIOS15_16),this.videoElement.srcObject=null,this.resetVideoElement(),this.freezeTimeCounterList=[]}initVideoElement(){if(this.videoElementStatus=hI.INIT,!this.videoElementCheckInterval&&(RA.forEach((e=>{this.videoElement.addEventListener(e,this.handleVideoEvents)})),this.videoElementCheckInterval=window.setInterval((()=>{(function(e){return e!==document.body&&document.body.contains(e)})(this.videoElement)||(this.videoElementStatus=hI.DESTROYED)}),1e3),Pw("ENABLE_VIDEO_FRAME_CALLBACK"))){var e,t;let i;const n=(e,t)=>{if(this.videoElementStatus===hI.PLAYING){if(i){const e=t.presentationTime-i.presentationTime;e>Pw("VIDEO_FREEZE_DURATION")&&yA.lastVisibleTime>=yA.lastHiddenTime&&i.timestamp>yA.lastVisibleTime&&i.timestamp>yA.lastHiddenTime&&(this.renderFreezeAccTime+=e)}i=SA(SA({},t),{},{timestamp:e})}var r,o;Pw("ENABLE_VIDEO_FRAME_CALLBACK")&&(null===(r=(o=this.videoElement).requestVideoFrameCallback)||void 0===r||r.call(o,n))};null===(e=(t=this.videoElement).requestVideoFrameCallback)||void 0===e||e.call(t,n)}this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),Uv()&&(this.videoElement.poster="noposter");const i=mv();"Safari"===i.name&&15===Number(i.version)||Mv()||!this.config.mirror||(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Sv()&&this.videoElement.load()):(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null,Sv()&&this.videoElement.load());const n=this.videoElement.play();void 0!==n&&n.catch((e=>{Yw.debug("[".concat(this.trackId,"] playback interrupted"),e.toString())}))}resetVideoElement(){RA.forEach((e=>{this.videoElement&&this.videoElement.removeEventListener(e,this.handleVideoEvents)})),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0),this.videoElementStatus=hI.NONE}handleAutoPlayFailed(){const e=t=>{t.preventDefault(),this.videoElement.play().then((()=>{Yw.debug("[".concat(this.trackId,"] Video element for trackId:").concat(this.trackId," autoplay resumed."))})).catch((e=>{Yw.error(e)})),this.autoplayFailed=!1,Vv()?document.body.removeEventListener("click",e,!0):(document.body.removeEventListener("touchstart",e,!0),document.body.removeEventListener("mousedown",e,!0))};Vv()?document.body.addEventListener("click",e,!0):(document.body.addEventListener("touchstart",e,!0),document.body.addEventListener("mousedown",e,!0)),HI()}}const RA=["play","playing","loadeddata","canplay","pause","stalled","suspend","waiting","abort","emptied","ended","timeupdate","error"];class CA extends TA{constructor(e){super(e),oh(this,"container",void 0),oh(this,"slot",void 0),this.slot=e.element,this.updateConfig(e)}updateConfig(e){this.config=e,this.trackId=e.trackId;const t=e.element;t!==this.slot&&(this.destroy(),this.slot=t),this.createElements()}updateVideoTrack(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}play(e){var t;null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)&&super.play(e)}getCurrentFrame(){var e;return null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)?super.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameToUint8Array(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return null!==(t=this.container)&&void 0!==t&&t.contains(this.videoElement)?await super.getCurrentFrameToUint8Array(e,i):await EA(e)}destroy(){if(super.destroy(),this.videoElement.remove(),this.videoElement=document.createElement("video"),this.container){try{this.container.remove(),this.slot.removeChild(this.container)}catch(e){}this.container=void 0}}createElements(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",Pw("KEEP_LAST_FRAME")&&this.isKeepLastFrame&&this.videoElement.paused&&this.resetVideoElement(),this.mountedVideoElement()):this.unmountedVideoElement(),this.slot.appendChild(this.container)}mountedVideoElement(){var e;!this.container||null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)||this.container.appendChild(this.videoElement),super.initVideoElement(),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.style.left="0",this.videoElement.style.top="0"}unmountedVideoElement(){var e;if(null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)){super.resetVideoElement();try{this.container&&this.container.removeChild(this.videoElement)}catch(e){}this.videoElement=document.createElement("video")}}resetVideoElement(){var e;null!==(e=this.container)&&void 0!==e&&e.contains(this.videoElement)&&(super.resetVideoElement(),this.cacheVideoElement=this.videoElement,this.videoElement=document.createElement("video"))}getContainerElement(){return this.container}}function IA(e){return new nv(((t,i)=>{let n=!1;const r=document.createElement("video");r.setAttribute("autoplay",""),r.setAttribute("muted",""),r.muted=!0,r.autoplay=!0,r.setAttribute("playsinline",""),r.setAttribute("style","position: fixed; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(r);const o=Tv()?"canplay":"playing";r.addEventListener(o,(()=>{const e=r.videoWidth,i=r.videoHeight;!e&&Sv()||(n=!0,r.srcObject=null,r.remove(),t([e,i]))})),r.srcObject=new MediaStream([e]),r.play().catch(FE),setTimeout((()=>{n||(r.srcObject=null,r.remove(),t([r.videoWidth,r.videoHeight]))}),4e3)}))}const AA=async(e,t,i)=>{const n=function(e){const t=[];for(let i=0;i<e.length;i+=2)t.push(parseInt(e.slice(i,i+2),16));return Uint8Array.from(t)}(function(e){const t="0123456789abcdef";function i(e){let i,n="";for(i=0;i<=3;i++)n+=t.charAt(e>>8*i+4&15)+t.charAt(e>>8*i&15);return n}function n(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function r(e,t,i,r,o,s){return n(function(e,t){return e<<t|e>>>32-t}(n(n(t,e),n(r,s)),o),i)}function o(e,t,i,n,o,s,a){return r(t&i|~t&n,e,t,o,s,a)}function s(e,t,i,n,o,s,a){return r(t&n|i&~n,e,t,o,s,a)}function a(e,t,i,n,o,s,a){return r(t^i^n,e,t,o,s,a)}function c(e,t,i,n,o,s,a){return r(i^(t|~n),e,t,o,s,a)}const u=function(e){let t;const i=1+(e.length+8>>6),n=new Array(16*i);for(t=0;t<16*i;t++)n[t]=0;for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<t%4*8;return n[t>>2]|=128<<t%4*8,n[16*i-2]=8*e.length,n}(e);let d,l,h,f,p,m=1732584193,_=-271733879,g=-1732584194,v=271733878;for(d=0;d<u.length;d+=16)l=m,h=_,f=g,p=v,m=o(m,_,g,v,u[d+0],7,-680876936),v=o(v,m,_,g,u[d+1],12,-389564586),g=o(g,v,m,_,u[d+2],17,606105819),_=o(_,g,v,m,u[d+3],22,-1044525330),m=o(m,_,g,v,u[d+4],7,-176418897),v=o(v,m,_,g,u[d+5],12,1200080426),g=o(g,v,m,_,u[d+6],17,-1473231341),_=o(_,g,v,m,u[d+7],22,-45705983),m=o(m,_,g,v,u[d+8],7,1770035416),v=o(v,m,_,g,u[d+9],12,-1958414417),g=o(g,v,m,_,u[d+10],17,-42063),_=o(_,g,v,m,u[d+11],22,-1990404162),m=o(m,_,g,v,u[d+12],7,1804603682),v=o(v,m,_,g,u[d+13],12,-40341101),g=o(g,v,m,_,u[d+14],17,-1502002290),_=o(_,g,v,m,u[d+15],22,1236535329),m=s(m,_,g,v,u[d+1],5,-165796510),v=s(v,m,_,g,u[d+6],9,-1069501632),g=s(g,v,m,_,u[d+11],14,643717713),_=s(_,g,v,m,u[d+0],20,-373897302),m=s(m,_,g,v,u[d+5],5,-701558691),v=s(v,m,_,g,u[d+10],9,38016083),g=s(g,v,m,_,u[d+15],14,-660478335),_=s(_,g,v,m,u[d+4],20,-405537848),m=s(m,_,g,v,u[d+9],5,568446438),v=s(v,m,_,g,u[d+14],9,-1019803690),g=s(g,v,m,_,u[d+3],14,-187363961),_=s(_,g,v,m,u[d+8],20,1163531501),m=s(m,_,g,v,u[d+13],5,-1444681467),v=s(v,m,_,g,u[d+2],9,-51403784),g=s(g,v,m,_,u[d+7],14,1735328473),_=s(_,g,v,m,u[d+12],20,-1926607734),m=a(m,_,g,v,u[d+5],4,-378558),v=a(v,m,_,g,u[d+8],11,-2022574463),g=a(g,v,m,_,u[d+11],16,1839030562),_=a(_,g,v,m,u[d+14],23,-35309556),m=a(m,_,g,v,u[d+1],4,-1530992060),v=a(v,m,_,g,u[d+4],11,1272893353),g=a(g,v,m,_,u[d+7],16,-155497632),_=a(_,g,v,m,u[d+10],23,-1094730640),m=a(m,_,g,v,u[d+13],4,681279174),v=a(v,m,_,g,u[d+0],11,-358537222),g=a(g,v,m,_,u[d+3],16,-722521979),_=a(_,g,v,m,u[d+6],23,76029189),m=a(m,_,g,v,u[d+9],4,-640364487),v=a(v,m,_,g,u[d+12],11,-421815835),g=a(g,v,m,_,u[d+15],16,530742520),_=a(_,g,v,m,u[d+2],23,-995338651),m=c(m,_,g,v,u[d+0],6,-198630844),v=c(v,m,_,g,u[d+7],10,1126891415),g=c(g,v,m,_,u[d+14],15,-1416354905),_=c(_,g,v,m,u[d+5],21,-57434055),m=c(m,_,g,v,u[d+12],6,1700485571),v=c(v,m,_,g,u[d+3],10,-1894986606),g=c(g,v,m,_,u[d+10],15,-1051523),_=c(_,g,v,m,u[d+1],21,-2054922799),m=c(m,_,g,v,u[d+8],6,1873313359),v=c(v,m,_,g,u[d+15],10,-30611744),g=c(g,v,m,_,u[d+6],15,-1560198380),_=c(_,g,v,m,u[d+13],21,1309151649),m=c(m,_,g,v,u[d+4],6,-145523070),v=c(v,m,_,g,u[d+11],10,-1120210379),g=c(g,v,m,_,u[d+2],15,718787259),_=c(_,g,v,m,u[d+9],21,-343485551),m=n(m,l),_=n(_,h),g=n(g,f),v=n(v,p);return i(m)+i(_)+i(g)+i(v)}(""+t+i)).slice(0,16),r=n.slice(0,12),o=await window.crypto.subtle.importKey("raw",n,"AES-GCM",!0,["encrypt"]);return new Uint8Array(await window.crypto.subtle.encrypt({name:"AES-GCM",iv:r},o,e))},OA=async(e,t,i)=>await AA(e.buffer,t,i);function MA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function NA(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?MA(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):MA(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class kA extends _I{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==hI.PLAYING)}get processorContext(){return this._processorContext}set processorContext(e){this._processorContext=e}get __className__(){return"LocalVideoTrack"}constructor(e,t,i,n,r,o){if(super(e,r),oh(this,"trackMediaType","video"),oh(this,"_player",void 0),oh(this,"isUseScaleResolutionDownBy",!1),oh(this,"_videoVisibleTimer",null),oh(this,"_statsTimer",null),oh(this,"_previousVideoVisibleStatus",void 0),oh(this,"_clearPreviousVideoVisibleStatus",(()=>this._previousVideoVisibleStatus=void 0)),oh(this,"_encoderConfig",void 0),oh(this,"_scalabilityMode",{numSpatialLayers:1,numTemporalLayers:1}),oh(this,"_optimizationMode",void 0),oh(this,"_videoHeight",void 0),oh(this,"_videoWidth",void 0),oh(this,"_forceBitrateLimit",void 0),oh(this,"_enabled",!0),oh(this,"processorDestination",void 0),oh(this,"_processorContext",void 0),wv()){const{width:t,height:i}=e.getSettings();this._videoWidth=t,this._videoHeight=i}else this.updateMediaStreamTrackResolution();if(this._encoderConfig=t,this._scalabilityMode=i,this._optimizationMode=n,this._hints=o||[],-1===this._hints.indexOf(YC.SCREEN_TRACK))this.updateBitrateFromProfile();else if(function(e,t,i){const n=mv();return!(n.name!==e||!n.osVersion)&&(i?Number(n.version)>=t&&Number(n.version)<=i:Number(n.version)===t)}(dv.CHROME,115)&&-1!==_v().indexOf("Windows")){const t=function(e,t){if("VideoFrame"in window&&"TransformStream"in window&&MC().supportWebRTCInsertableStream){const i=new MediaStreamTrackProcessor(e),n=new MediaStreamTrackGenerator({kind:"video"});let r,o,s=Date.now();const a=()=>{c&&(clearInterval(c),c=void 0),r&&(r.close(),r=void 0),e.stop(),o=void 0,n.removeEventListener("ended",a)};let c=window.setInterval((()=>{if(o&&r&&Date.now()-s>(null!=t?t:1e3))try{"live"===n.readyState?o.enqueue(r.clone()):a()}catch(e){a()}}),null!=t?t:1e3);const u=new TransformStream({transform:(e,t)=>{"live"===n.readyState?(o=t,s=Date.now(),void 0===r?(r=e,t.enqueue(e.clone())):(t.enqueue(r),r=e)):e.close()}});return n.addEventListener("ended",a),i.readable.pipeThrough(u).pipeTo(n.writable),n}}(e);t&&(Yw.info("local screen video track begin to inject frame"),this._mediaStreamTrack=t)}t&&-1!==this._hints.indexOf(YC.CUSTOM_TRACK)&&this.setEncoderConfiguration(t),this.processorContext=new eA(this.getTrackId(),"local"),this.processorDestination=new $I(this.processorContext),this.bindProcessorDestinationEvents()}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){const t=document.getElementById(e);t?e=t:(Yw.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}Yw.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const i=NA(NA(NA({},this._getDefaultPlayerConfig()),t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(i):(e instanceof HTMLVideoElement?this._player=new TA(i):this._player=new CA(i),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval((()=>{try{const e=this.getVideoElementVisibleStatus();this.safeEmit($C.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}}),Pw("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._statsTimer&&(this.isUseScaleResolutionDownBy=!1,window.clearInterval(this._statsTimer),this._statsTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,Yw.debug("[".concat(this.getTrackId(),"] stop video playback")))}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(Yw.info("[".concat(this.getTrackId(),"] start setEnabled"),e),!e){this._originMediaStreamTrack.enabled=!1;try{await bE(this,zC.NEED_DISABLE_TRACK,this)}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}return t||(this._enabled=!1),void Yw.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}this._originMediaStreamTrack.enabled=!0;try{await bE(this,zC.NEED_ENABLE_TRACK,this)}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.toString()),e}Yw.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}async setMuted(e){e!==this._muted&&(this.stateCheck("muted",e),this._muted=e,this._originMediaStreamTrack.enabled=!e,Yw.debug("[".concat(this.getTrackId(),"] start set muted: ").concat(e)),e?await bE(this,zC.NEED_MUTE_TRACK,this):await bE(this,zC.NEED_UNMUTE_TRACK,this))}async setEncoderConfiguration(e,t){if(!this._enabled)throw new jv(Bv.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");if("720p_auto"===e?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),e=jC(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),e.width||e.height||e.frameRate){const t=pA({encoderConfig:e});(wv()||Tv()||Pv())&&(t.deviceId=void 0),Yw.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(t));try{await this._originMediaStreamTrack.applyConstraints(t),this.updateMediaStreamTrackResolution()}catch(e){const t=new jv(Bv.UNEXPECTED_ERROR,e.toString());throw Yw.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),t}}this._encoderConfig=e,-1===this._hints.indexOf(YC.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await bE(this,zC.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(Yw)}}getStats(){return kE((()=>{Yw.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")}),"localVideoTrackGetStatsWarning"),yE(this,zC.GET_STATS)||NA({},rI)}async setBeautyEffect(e){Yw.error("LocalVideoTrack.setBeautyEffect was deprecated, please migrate to agora-extension-beauty-effect")}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}async getCurrentFrameImage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._player?this._player.getCurrentFrameToUint8Array(e,t):await EA(e)}async setBitrateLimit(e){if(Yw.debug("[".concat(this.getTrackId(),"] set bitrate limit, ").concat(JSON.stringify(e))),e){this._forceBitrateLimit=e,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<e.max_bitrate?this._encoderConfig.bitrateMax:e.max_bitrate:this._encoderConfig.bitrateMax=e.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=e.min_bitrate);try{await bE(this,zC.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(Yw)}}}async setOptimizationMode(e){if("motion"!==e&&"detail"!==e&&"balanced"!==e)return void Yw.error(Bv.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");const t=this._optimizationMode;try{this._optimizationMode=e,await bE(this,zC.SET_OPTIMIZATION_MODE,this)}catch(e){throw this._optimizationMode=t,Yw.error("[".concat(this.getTrackId(),"] set optimization mode failed"),e.toString()),e}Yw.info("[".concat(this.getTrackId(),"] set optimization mode success (").concat(e,")"))}setScalabiltyMode(e){if(1===e.numSpatialLayers&&1!==e.numTemporalLayers)return Yw.error(Bv.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabilityMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabilityMode=e,Yw.info("[".concat(this.getTrackId(),"] set scalability mode success (").concat(e,")"))}updateMediaStreamTrackResolution(){IA(this._originMediaStreamTrack).then((e=>{let[t,i]=e;this._videoHeight=i,this._videoWidth=t})).catch(FE)}_updatePlayerSource(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}_getDefaultPlayerConfig(){return{fit:"contain"}}async setSenderConfiguration(e){if(!this._enabled)throw new jv(Bv.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");Yw.debug("[".concat(this.getTrackId(),"] setSenderConfiguration applyConstraints"),JSON.stringify(e)),e=jC(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin),this._encoderConfig=e,-1===this._hints.indexOf(YC.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await bE(this,zC.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(Yw)}}updateBitrateFromProfile(){if(!this._encoderConfig)return;const{width:e,height:t,frameRate:i}=this.getMediaStreamTrackSettings();if(!e||!t||!i)return;const[n,r]=function(e,t,i,n){let r;const o=200*Math.pow(i/15,.6)*Math.pow(e*t/640/360,.75),s=o;if("STANDARD_BITRATE"===n)r=4*o;else{if("COMPATIABLE_BITRATE"!==n)return;r=2*o}return[Math.floor(r),Math.floor(s)]}(e,t,i,Pw("BITRATE_ADAPTER_TYPE"))||[void 0,void 0];this._encoderConfig.bitrateMin||this._encoderConfig.bitrateMax||(this._encoderConfig.bitrateMin=r,this._encoderConfig.bitrateMax=n,Yw.debug("[".concat(this.getTrackId(),"] update bitrate from profile, [w: ").concat(e,", h: ").concat(t,", fps: ").concat(i,"] => [brMax: ").concat(n,", brMin: ").concat(r,"]")))}getVideoElementVisibleStatus(){try{var e,t;const i=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),n={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==i?void 0:i.parentElement},{element:r,slot:o}=n;if(this.isPlaying&&r instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=$v.checkOneElementVisible(r),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.LOCAL_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new jv(Bv.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}async renewMediaStreamTrack(e){}pipe(e){if(this.processor===e)return e;if(e._source)throw new jv(Bv.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}close(){super.close(),this.unbindProcessorDestinationEvents(),this.unbindProcessorContextEvents(),this.unpipe(),this.processorDestination._source&&this.processorDestination._source.unpipe()}clone(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._encoderConfig;e&&(i=NA(NA({},i),jC(e))),i=ME(i);const n=BE(8,"track-video-cloned-"),r=new kA(t?this._mediaStreamTrack.clone():this._mediaStreamTrack,i,ME(this._scalabilityMode),this._optimizationMode,n,ME(this._hints));return e&&i&&r.setEncoderConfiguration(i),Yw.debug("clone video track from ".concat(this.getTrackId()," to ").concat(n,", clone ").concat(t)),r}async replaceTrack(e,t){if(!(e instanceof MediaStreamTrack))throw new jv(Bv.INVALID_PARAMS,"track should be an instance of MediaStreamTrack");if("video"!==e.kind)throw new jv(Bv.INVALID_PARAMS,"track should be a video MediaStreamTrack");await this._updateOriginMediaStreamTrack(e,t,!0),this.updateMediaStreamTrackResolution()}startMonitorStats(){if(!wv()&&!Tv())return;this._statsTimer&&window.clearInterval(this._statsTimer);let e=2,t=UC[e],i=-1,n=Date.now();const r=e=>{e>2||e<0||(n=Date.now(),t=UC[e],this.setSenderConfiguration(t))};this.isUseScaleResolutionDownBy=!0,this._statsTimer=window.setInterval((()=>{const o=this.getStats(),s=yE(this,zC.GET_RTC_STATS);if(o.sendPackets>0&&s){-1===i&&(i=Date.now());const a=Date.now();if(a-i<1e3||a-n<Pw("PROFILE_SWITCH_INTERVAL"))return;const c=o.sendFrameRate,u=.6*t.frameRate,d=.9*t.frameRate;"number"==typeof c&&c>0&&c<u?e>0&&(e--,r(e),Yw.debug("[".concat(this.getTrackId(),"] step down for fps ").concat(c,", switchProfile to ").concat(e))):s.OutgoingAvailableBandwidth<t.bitrateMin?e>0&&(e--,r(e),Yw.debug("[".concat(this.getTrackId(),"] step down for OutgoingAvailableBandwidth ").concat(s.OutgoingAvailableBandwidth,", bitrateMin ").concat(t.bitrateMin,", switchProfile to ").concat(e))):"number"==typeof c&&c>d&&e<UC.length-1&&s.OutgoingAvailableBandwidth>1.2*UC[e+1].bitrateMin&&(e++,r(e),Yw.debug("[".concat(this.getTrackId(),"] step up for fps ").concat(c,", OutgoingAvailableBandwidth ").concat(s.OutgoingAvailableBandwidth,", switchProfile to ").concat(e)))}}),Pw("CHECK_LOCAL_STATS_INTERVAL"))}bindProcessorDestinationEvents(){this.processorDestination.on(cI.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(),await bE(this,zC.NEED_REPLACE_TRACK,this)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),await bE(this,zC.NEED_REPLACE_TRACK,this))}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(cI.ON_TRACK)}unbindProcessorContextEvents(){this.processorContext.removeAllListeners(uI.REQUEST_UPDATE_CONSTRAINTS),this.processorContext.removeAllListeners(uI.REQUEST_CONSTRAINTS)}}VS([sS({argsMap:(e,t,i)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",i]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Object,Object]),BS("design:returntype",void 0)],kA.prototype,"play",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],kA.prototype,"stop",null),VS([JE("LocalVideoTrack","_enabledMutex"),sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Boolean,Boolean]),BS("design:returntype",nv)],kA.prototype,"setEnabled",null),VS([JE("LocalVideoTrack","_enabledMutex"),sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Boolean]),BS("design:returntype",nv)],kA.prototype,"setMuted",null),VS([sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Object,Boolean]),BS("design:returntype",nv)],kA.prototype,"setEncoderConfiguration",null),VS([XI(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",Object)],kA.prototype,"getStats",null),VS([sS({argsMap:(e,t,i)=>[e.getTrackId(),t,i]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Boolean,Object]),BS("design:returntype",nv)],kA.prototype,"setBeautyEffect",null),VS([XI(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",ImageData)],kA.prototype,"getCurrentFrameData",null),VS([XI(),BS("design:type",Function),BS("design:paramtypes",[String,Number]),BS("design:returntype",nv)],kA.prototype,"getCurrentFrameImage",null),VS([XI(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],kA.prototype,"setBitrateLimit",null),VS([XI(),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],kA.prototype,"setOptimizationMode",null),VS([XI(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",void 0)],kA.prototype,"setScalabiltyMode",null),VS([XI(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],kA.prototype,"updateMediaStreamTrackResolution",null),VS([sS({argsMap:(e,t)=>[e.getTrackId(),t.name]}),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",Object)],kA.prototype,"pipe",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],kA.prototype,"unpipe",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],kA.prototype,"close",null),VS([sS({argsMap:(e,t,i)=>[e.getTrackId(),t.label,i]}),BS("design:type",Function),BS("design:paramtypes",[MediaStreamTrack,Boolean]),BS("design:returntype",nv)],kA.prototype,"replaceTrack",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],kA.prototype,"startMonitorStats",null);class PA extends kA{get __className__(){return"CameraVideoTrack"}constructor(e,t,i,n,r,o){super(e,jC(t.encoderConfig),n,r,o),oh(this,"_config",void 0),oh(this,"_originalConstraints",void 0),oh(this,"_constraints",void 0),oh(this,"_enabled",!0),oh(this,"_deviceName","default"),oh(this,"tryResumeVideoForIOS15_16WeChat",(async()=>{(Mv()||Nv())&&!function(){const e=mv();if(e.os!==uv.IOS||!e.osVersion)return!1;const t=e.osVersion.split(".");return 15===Number(t[0])&&Number(t[1])>=2}()&&Dv()&&this._enabled&&!this._isClosed&&(Yw.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS 15 device on WeChat.")),await this.renewMediaStreamTrack())})),this._config=t,this._originalConstraints=i,this._constraints=i,this._deviceName=e.label,this._encoderConfig=jC(this._config.encoderConfig),bI.on(NC.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),bI.on(NC.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),this.bindProcessorContextEvents()}async setDevice(e){return"string"==typeof e?this._setDeviceById(e):e.deviceId?this._setDeviceById(e.deviceId):e.facingMode?this._setDeviceByFacingModel(e.facingMode):void 0}async _setDeviceById(e){if(Yw.info("[".concat(this.getTrackId(),"] set device to ").concat(e)),this._enabled)try{const t=await FI.getDeviceById(e),i={};i.video=NA({},this._constraints),i.video.deviceId={exact:e},i.video.facingMode=void 0,this._originMediaStreamTrack.stop();let n=null;try{n=await UI(i,this.getTrackId())}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setDevice failed"),e.toString()),n=await UI({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(n.getVideoTracks()[0],!1),e}await this._updateOriginMediaStreamTrack(n.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution(),this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}else try{const t=await FI.getDeviceById(e);this._deviceName=t.label,this._config.cameraId=e,this._constraints.deviceId={exact:e}}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setDevice error"),e.toString()),e}Yw.info("[".concat(this.getTrackId(),"] setDevice success"))}async _setDeviceByFacingModel(e){Yw.info("[".concat(this.getTrackId(),"] set facingMode ").concat(e));const t={video:NA(NA({},this._constraints),{},{deviceId:void 0,facingMode:{exact:e}})};if(this._enabled){this._originMediaStreamTrack.stop();let e=null;try{e=await UI(t,this.getTrackId())}catch(t){throw Yw.error("[".concat(this.getTrackId(),"] setDeviceByFacingModel failed"),t.toString()),e=await UI({video:this._constraints},this.getTrackId()),await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),t}await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1),this.updateMediaStreamTrackResolution()}this._deviceName="",this._config.facingMode=e,this._config.cameraId=void 0,this._constraints=NA({},t.video),Yw.info("[".concat(this.getTrackId(),"] setDeviceByFacingModel success"))}async setEnabled(e,t){if(!t){if(e===this._enabled)return;this.stateCheck("enabled",e)}if(Yw.info("[".concat(this.getTrackId(),"] start setEnabled"),e),e){try{if(this.isExternalTrack)this._originMediaStreamTrack.enabled=!0;else{const e=await UI({video:this._constraints},this.getTrackId());await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!1)}await bE(this,zC.NEED_ENABLE_TRACK,this)}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setEnabled true error"),e.toString()),e}this.updateMediaStreamTrackResolution(),Yw.info("[".concat(this.getTrackId(),"] setEnabled to true success")),t||(this._enabled=!0)}else{this.isExternalTrack?this._originMediaStreamTrack.enabled=!1:(this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop()),t||(this._enabled=!1);try{await bE(this,zC.NEED_DISABLE_TRACK,this)}catch(e){throw Yw.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.toString()),e}Yw.info("[".concat(this.getTrackId(),"] setEnabled to false success"))}}async setEncoderConfiguration(e,t){if(!this._enabled)throw new jv(Bv.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled");"720p_auto"===e?this.startMonitorStats():this._statsTimer&&(window.clearInterval(this._statsTimer),this._statsTimer=null),e=jC(e),this._forceBitrateLimit&&(e.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:e.bitrateMax,e.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:e.bitrateMin);const i=OE(this._config);i.encoderConfig=e;const n=pA(i);(wv()||Tv()||Pv())&&(n.deviceId=void 0),Yw.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),JSON.stringify(e),JSON.stringify(n));try{await this._originMediaStreamTrack.applyConstraints(n),this.updateMediaStreamTrackResolution()}catch(e){const t=new jv(Bv.UNEXPECTED_ERROR,e.toString());throw Yw.error("[".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),t}this._config=i,this._constraints=n,this._originalConstraints=n,this._encoderConfig=e,-1===this._hints.indexOf(YC.SCREEN_TRACK)&&this.updateBitrateFromProfile();try{await bE(this,zC.NEED_UPDATE_VIDEO_ENCODER,this)}catch(e){return e.throw(Yw)}}_getDefaultPlayerConfig(){return{mirror:!0,fit:"cover"}}onTrackEnded(){if((Tv()||Pv())&&this._enabled&&!this._isClosed&&bI.duringInterruption){const e=async()=>{bI.off(NC.IOS_INTERRUPTION_END,e),this._enabled&&!this._isClosed&&(Yw.debug("[".concat(this.getTrackId(),"] try capture camera media device for interrupted iOS device.")),await this.setEnabled(!1),await this.setEnabled(!0))};bI.on(NC.IOS_INTERRUPTION_END,e)}else Yw.debug("[".concat(this.getTrackId(),"] track ended")),this.safeEmit($C.TRACK_ENDED)}async renewMediaStreamTrack(e){const t=e||this._constraints,i=FI.searchDeviceIdByName(this._deviceName);if(i&&!t.deviceId&&(t.deviceId={exact:i}),this._enabled){const e=await UI({video:t},this.getTrackId());this._constraints=t,await this._updateOriginMediaStreamTrack(e.getVideoTracks()[0],!0),this.updateMediaStreamTrackResolution()}}close(){super.close(),bI.off(NC.IOS_15_16_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat),bI.off(NC.IOS_INTERRUPTION_END,this.tryResumeVideoForIOS15_16WeChat)}clone(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this._encoderConfig;e&&(i=NA(NA({},i),jC(e))),i=ME(i);const n=BE(8,"track-cam-cloned-"),r=new PA(t?this._mediaStreamTrack.clone():this._mediaStreamTrack,ME(NA(NA({},this._config),{},{encoderConfig:i})),ME(this._constraints),ME(this._scalabilityMode),this._optimizationMode,n);return e&&i&&r.setEncoderConfiguration(i),Yw.debug("clone track from ".concat(this.getTrackId()," to ").concat(n,", clone ").concat(t)),r}bindProcessorContextEvents(){this.processorContext.on(uI.REQUEST_UPDATE_CONSTRAINTS,(async(e,t,i)=>{try{const i=Object.assign({},this._originalConstraints,...e);await this.renewMediaStreamTrack(i),t()}catch(e){i(e)}})),this.processorContext.on(uI.REQUEST_CONSTRAINTS,(async e=>{e(this._originMediaStreamTrack.getSettings())}))}}function DA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function LA(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?DA(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):DA(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function xA(e,t,i,n){i.optimizationMode&&(n&&n.width&&n.height?(i.encoderConfig=LA(LA({},n),{},{bitrateMin:n.bitrateMin,bitrateMax:n.bitrateMax}),"motion"!==i.optimizationMode&&"detail"!==i.optimizationMode||(t.contentHint=i.optimizationMode,t.contentHint===i.optimizationMode?Yw.debug("[".concat(e,"] set content hint to"),i.optimizationMode):Yw.debug("[".concat(e,"] set content hint failed")))):Yw.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig")))}function UA(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function VA(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?UA(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):UA(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}VS([sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],PA.prototype,"setDevice",null),VS([JE("CameraVideoTrack","_enabledMutex"),sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Boolean,Boolean]),BS("design:returntype",nv)],PA.prototype,"setEnabled",null),VS([sS({argsMap:(e,t)=>[e.getTrackId(),t]}),XI(),BS("design:type",Function),BS("design:paramtypes",[Object,Boolean]),BS("design:returntype",nv)],PA.prototype,"setEncoderConfiguration",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],PA.prototype,"close",null);class BA extends mI{getUserId(){return this._userId}constructor(e,t,i,n){super(e,"track-".concat(e.kind,"-").concat(t,"-").concat(n.clientId,"_").concat(BE(5,""))),oh(this,"_userId",void 0),oh(this,"_uintId",void 0),oh(this,"_isDestroyed",!1),oh(this,"store",void 0),oh(this,"processor",void 0),this._userId=t,this._uintId=i,this.store=n}_updateOriginMediaStreamTrack(e){this._originMediaStreamTrack=e,this._mediaStreamTrack=e,this._updatePlayerSource(),this.processor&&this.processor.updateInput({track:this._originMediaStreamTrack,context:this.processorContext})}_destroy(){this._isDestroyed=!0,Yw.info("[".concat(this.getTrackId(),"] is destroyed")),this.stop(),super.close()}getProcessorStats(){return this.processorContext.gatherStats()}getProcessorUsage(){return this.processorContext.gatherUsage()}}class jA extends BA{get isPlaying(){return!(!this._player||this._player.videoElementStatus!==hI.PLAYING)}get __className__(){return"RemoteVideoTrack"}constructor(e,t,i,n){super(e,t,i,n),oh(this,"_videoVisibleTimer",null),oh(this,"_previousVideoVisibleStatus",void 0),oh(this,"_clearPreviousVideoVisibleStatus",(()=>this._previousVideoVisibleStatus=void 0)),oh(this,"trackMediaType","video"),oh(this,"_videoWidth",void 0),oh(this,"_videoHeight",void 0),oh(this,"_player",void 0),oh(this,"processorDestination",void 0),oh(this,"processorContext",void 0),this.updateMediaStreamTrackResolution(),this.processorContext=new eA(this.getTrackId(),"remote"),this.processorDestination=new $I(this.processorContext),this.bindProcessorDestinationEvents()}getStats(){return kE((()=>{Yw.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")}),"remoteVideoTrackGetStatsWarning"),yE(this,zC.GET_STATS)||VA({},aI)}play(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){const t=document.getElementById(e);t?e=t:(Yw.warning("[".concat(this.getTrackId(),'] can not find "#').concat(e,'" element, use document.body')),e=document.body)}Yw.debug("[".concat(this.getTrackId(),"] start video playback in ").concat(e instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement"),JSON.stringify(t));const i=VA(VA({fit:"cover"},t),{},{trackId:this.getTrackId(),element:e});this._player?this._player.updateConfig(i):(e instanceof HTMLVideoElement?this._player=new TA(i):this._player=new CA(i),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=()=>{this.store.subscribe(this.getUserId(),"video",void 0,void 0,Date.now()),this.safeEmit(eI.FIRST_FRAME_DECODED)}),this._player.play(this.store.sessionId||void 0),this._videoVisibleTimer&&window.clearInterval(this._videoVisibleTimer),this._clearPreviousVideoVisibleStatus(),this._videoVisibleTimer=window.setInterval((()=>{try{const e=this.getVideoElementVisibleStatus();this.safeEmit(eI.VIDEO_ELEMENT_VISIBLE_STATUS,e)}catch(e){}}),Pw("CHECK_VIDEO_VISIBLE_INTERVAL"))}stop(){this._player&&(this._videoVisibleTimer&&(window.clearInterval(this._videoVisibleTimer),this._videoVisibleTimer=null),this._clearPreviousVideoVisibleStatus(),this._player.destroy(),this._player=void 0,Yw.debug("[".concat(this.getTrackId(),"] stop video playback")))}getCurrentFrameData(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}updateMediaStreamTrackResolution(){IA(this._originMediaStreamTrack).then((e=>{let[t,i]=e;this._videoHeight=i,this._videoWidth=t})).catch(FE)}_updatePlayerSource(){Yw.debug("[".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}getVideoElementVisibleStatus(){try{var e,t;const i=null==this||null===(e=this._player)||void 0===e?void 0:e.getContainerElement(),n={track:this,element:null==this||null===(t=this._player)||void 0===t?void 0:t.getVideoElement(),slot:null==i?void 0:i.parentElement},{element:r,slot:o}=n;if(this.isPlaying&&r instanceof HTMLVideoElement&&o instanceof HTMLElement){const e=$v.checkOneElementVisible(r),t=Object.assign({},e);if(t.visible!==this._previousVideoVisibleStatus){this._previousVideoVisibleStatus=t.visible;const e=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.REMOTE_VIDEO_TRACK_GET_VIDEO_VISIBLE,options:[this.getTrackId()]});t.visible?e.onSuccess("Video is visible"):e.onSuccess("Invisible because of ".concat(t.reason))}return t}return}catch(e){throw new jv(Bv.GET_VIDEO_ELEMENT_VISIBLE_ERROR,e.message)}}pipe(e){if(this.processor===e)return e;if(e._source)throw new jv(Bv.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,context:this.processorContext}),e}unpipe(){if(!this.processor)return;const e=this.processor;this.processor._source=void 0,this.processor=void 0,e.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(cI.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource()):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(cI.ON_TRACK)}_destroy(){super._destroy(),this.unbindProcessorDestinationEvents()}}VS([sS({argsMap:(e,t,i)=>[e.getTrackId(),"string"==typeof t?t:t instanceof HTMLVideoElement?"HTMLVideoElement":"HTMLElement",i]}),BS("design:type",Function),BS("design:paramtypes",[Object,Object]),BS("design:returntype",void 0)],jA.prototype,"play",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],jA.prototype,"stop",null),VS([sS({argsMap:(e,t)=>[e.getTrackId(),t.name]}),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",Object)],jA.prototype,"pipe",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],jA.prototype,"unpipe",null);class FA extends BA{get isPlaying(){return this._useAudioElement?JI.isPlaying(this.getTrackId()):this._source.isPlayed}get __className__(){return"RemoteAudioTrack"}constructor(e,t,i,n){super(e,t,i,n),oh(this,"trackMediaType","audio"),oh(this,"_source",void 0),oh(this,"_useAudioElement",!0),oh(this,"_volume",100),oh(this,"processorContext",void 0),oh(this,"processorDestination",void 0),oh(this,"_played",!1),oh(this,"_bypassWebAudio",!1),Pw("DISABLE_WEBAUDIO")?(this._source=new nA,this._bypassWebAudio=!0,this._useAudioElement=!0):(this._source=new OI(e,!0),Pw("REMOTE_AUDIO_TRACK_USES_WEB_AUDIO")&&(this._useAudioElement=!1)),this._source.once(tI.RECEIVE_TRACK_BUFFER,(()=>{this.safeEmit(eI.FIRST_FRAME_DECODED)})),this.processorContext=new iA(this._source.context,this.getTrackId(),"remote"),this.processorDestination=new tA(this.processorContext),this.bindProcessorDestinationEvents(),this._source.on(tI.UPDATE_SOURCE,(()=>{this.processor&&this.processor.updateInput({node:this._source.processSourceNode,context:this.processorContext})}))}setAudioFrameCallback(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(tI.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(tI.ON_AUDIO_BUFFER),this._source.on(tI.ON_AUDIO_BUFFER,(t=>e(t)))}setVolume(e){this._volume=e,this._useAudioElement?JI.setVolume(this.getTrackId(),e):this._source.setVolume(e/100)}async setPlaybackDevice(e){if(!this._useAudioElement||!yv()&&Pw("RESTRICTION_SET_PLAYBACK_DEVICE"))throw new jv(Bv.NOT_SUPPORTED,"your browser does not support setting the audio output device");await JI.setSinkID(this.getTrackId(),e)}getVolumeLevel(){return this._source.getAccurateVolumeLevel()}getStats(){return kE((()=>{Yw.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")}),"remoteAudioTrackGetStatsWarning"),yE(this,zC.GET_STATS)||VA({},oI)}play(){Yw.debug("[".concat(this.getTrackId(),"] start audio playback")),this._played=!0,this._useAudioElement?(Yw.debug("[".concat(this.getTrackId(),"] use audio element to play")),JI.play(this._mediaStreamTrack,this.getTrackId(),this._volume,this.store.sessionId||void 0)):this._source.play()}stop(){Yw.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._played=!1,this._useAudioElement?JI.stop(this.getTrackId()):this._source.stop()}_destroy(){super._destroy(),this._played=!1,this.unbindProcessorDestinationEvents(),this._source.destroy()}_isFreeze(){return this._source.isFreeze}_updatePlayerSource(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Yw.debug("[".concat(this.getTrackId(),"] update player source track")),e&&this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&JI.updateTrack(this.getTrackId(),this._mediaStreamTrack)}pipe(e){if(this._bypassWebAudio)throw new jv(Bv.NOT_SUPPORTED,"can not pipe extension when WebAudio disabled");if(this.processor===e)return e;if(e._source)throw new jv(Bv.INVALID_OPERATION,"Processor ".concat(e.name," already piped, please call unpipe beforehand."));return this.unpipe(),this.processor=e,this.processor._source=this,e.updateInput({track:this._originMediaStreamTrack,node:this._source.processSourceNode,context:this.processorContext}),e}unpipe(){var e;if(this._bypassWebAudio)throw new jv(Bv.NOT_SUPPORTED,"can not unpipe extension when WebAudio disabled");if(!this.processor)return;const t=this.processor;null===(e=this._source.processSourceNode)||void 0===e||e.disconnect(),this.processor._source=!1,this.processor=void 0,t.reset()}bindProcessorDestinationEvents(){this.processorDestination.on(cI.ON_TRACK,(async e=>{e?e!==this._mediaStreamTrack&&(this._mediaStreamTrack=e,this._updatePlayerSource(!1),this._source.processedNode=this._source.createMediaStreamSourceNode(e)):this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource())})),this.processorDestination.on(cI.ON_NODE,(e=>{this._source.processedNode=e;const t=!e;this._useAudioElement!==t&&(this._played?(this.stop(),this._useAudioElement=t,this.play()):this._useAudioElement=t)}))}unbindProcessorDestinationEvents(){this.processorDestination.removeAllListeners(cI.ON_TRACK),this.processorDestination.removeAllListeners(cI.ON_NODE)}}function WA(e){let t=e.length;for(;--t>=0;)e[t]=0}VS([sS({argsMap:(e,t)=>[e.getTrackId(),t],throttleTime:300}),BS("design:type",Function),BS("design:paramtypes",[Number]),BS("design:returntype",void 0)],FA.prototype,"setVolume",null),VS([sS({argsMap:(e,t)=>[e.getTrackId(),t]}),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],FA.prototype,"setPlaybackDevice",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],FA.prototype,"play",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],FA.prototype,"stop",null),VS([sS({argsMap:(e,t)=>[e.getTrackId(),t.name]}),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",Object)],FA.prototype,"pipe",null),VS([sS({argsMap:e=>[e.getTrackId()]}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],FA.prototype,"unpipe",null);const GA=256,HA=286,qA=30,KA=15,zA=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),YA=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),JA=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),XA=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),QA=new Array(576);WA(QA);const ZA=new Array(60);WA(ZA);const $A=new Array(512);WA($A);const eO=new Array(256);WA(eO);const tO=new Array(29);WA(tO);const iO=new Array(qA);function nO(e,t,i,n,r){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=e&&e.length}let rO,oO,sO;function aO(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}WA(iO);const cO=e=>e<256?$A[e]:$A[256+(e>>>7)],uO=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},dO=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,uO(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},lO=(e,t,i)=>{dO(e,i[2*t],i[2*t+1])},hO=(e,t)=>{let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1},fO=(e,t,i)=>{const n=new Array(16);let r,o,s=0;for(r=1;r<=KA;r++)s=s+i[r-1]<<1,n[r]=s;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=hO(n[t]++,t))}},pO=e=>{let t;for(t=0;t<HA;t++)e.dyn_ltree[2*t]=0;for(t=0;t<qA;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},mO=e=>{e.bi_valid>8?uO(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},_O=(e,t,i,n)=>{const r=2*t,o=2*i;return e[r]<e[o]||e[r]===e[o]&&n[t]<=n[i]},gO=(e,t,i)=>{const n=e.heap[i];let r=i<<1;for(;r<=e.heap_len&&(r<e.heap_len&&_O(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!_O(t,n,e.heap[r],e.depth));)e.heap[i]=e.heap[r],i=r,r<<=1;e.heap[i]=n},vO=(e,t,i)=>{let n,r,o,s,a=0;if(0!==e.sym_next)do{n=255&e.pending_buf[e.sym_buf+a++],n+=(255&e.pending_buf[e.sym_buf+a++])<<8,r=e.pending_buf[e.sym_buf+a++],0===n?lO(e,r,t):(o=eO[r],lO(e,o+GA+1,t),s=zA[o],0!==s&&(r-=tO[o],dO(e,r,s)),n--,o=cO(n),lO(e,o,i),s=YA[o],0!==s&&(n-=iO[o],dO(e,n,s)))}while(a<e.sym_next);lO(e,256,t)},EO=(e,t)=>{const i=t.dyn_tree,n=t.stat_desc.static_tree,r=t.stat_desc.has_stree,o=t.stat_desc.elems;let s,a,c,u=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<o;s++)0!==i[2*s]?(e.heap[++e.heap_len]=u=s,e.depth[s]=0):i[2*s+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=u<2?++u:0,i[2*c]=1,e.depth[c]=0,e.opt_len--,r&&(e.static_len-=n[2*c+1]);for(t.max_code=u,s=e.heap_len>>1;s>=1;s--)gO(e,i,s);c=o;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],gO(e,i,1),a=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=a,i[2*c]=i[2*s]+i[2*a],e.depth[c]=(e.depth[s]>=e.depth[a]?e.depth[s]:e.depth[a])+1,i[2*s+1]=i[2*a+1]=c,e.heap[1]=c++,gO(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const i=t.dyn_tree,n=t.max_code,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,c=t.stat_desc.max_length;let u,d,l,h,f,p,m=0;for(h=0;h<=KA;h++)e.bl_count[h]=0;for(i[2*e.heap[e.heap_max]+1]=0,u=e.heap_max+1;u<573;u++)d=e.heap[u],h=i[2*i[2*d+1]+1]+1,h>c&&(h=c,m++),i[2*d+1]=h,d>n||(e.bl_count[h]++,f=0,d>=a&&(f=s[d-a]),p=i[2*d],e.opt_len+=p*(h+f),o&&(e.static_len+=p*(r[2*d+1]+f)));if(0!==m){do{for(h=c-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[c]--,m-=2}while(m>0);for(h=c;0!==h;h--)for(d=e.bl_count[h];0!==d;)l=e.heap[--u],l>n||(i[2*l+1]!==h&&(e.opt_len+=(h-i[2*l+1])*i[2*l],i[2*l+1]=h),d--)}})(e,t),fO(i,u,e.bl_count)},bO=(e,t,i)=>{let n,r,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),t[2*(i+1)+1]=65535,n=0;n<=i;n++)r=s,s=t[2*(n+1)+1],++a<c&&r===s||(a<u?e.bl_tree[2*r]+=a:0!==r?(r!==o&&e.bl_tree[2*r]++,e.bl_tree[32]++):a<=10?e.bl_tree[34]++:e.bl_tree[36]++,a=0,o=r,0===s?(c=138,u=3):r===s?(c=6,u=3):(c=7,u=4))},yO=(e,t,i)=>{let n,r,o=-1,s=t[1],a=0,c=7,u=4;for(0===s&&(c=138,u=3),n=0;n<=i;n++)if(r=s,s=t[2*(n+1)+1],!(++a<c&&r===s)){if(a<u)do{lO(e,r,e.bl_tree)}while(0!=--a);else 0!==r?(r!==o&&(lO(e,r,e.bl_tree),a--),lO(e,16,e.bl_tree),dO(e,a-3,2)):a<=10?(lO(e,17,e.bl_tree),dO(e,a-3,3)):(lO(e,18,e.bl_tree),dO(e,a-11,7));a=0,o=r,0===s?(c=138,u=3):r===s?(c=6,u=3):(c=7,u=4)}};let wO=!1;const SO=(e,t,i,n)=>{dO(e,0+(n?1:0),3),mO(e),uO(e,i),uO(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i};var TO=e=>{wO||((()=>{let e,t,i,n,r;const o=new Array(16);for(i=0,n=0;n<28;n++)for(tO[n]=i,e=0;e<1<<zA[n];e++)eO[i++]=n;for(eO[i-1]=n,r=0,n=0;n<16;n++)for(iO[n]=r,e=0;e<1<<YA[n];e++)$A[r++]=n;for(r>>=7;n<qA;n++)for(iO[n]=r<<7,e=0;e<1<<YA[n]-7;e++)$A[256+r++]=n;for(t=0;t<=KA;t++)o[t]=0;for(e=0;e<=143;)QA[2*e+1]=8,e++,o[8]++;for(;e<=255;)QA[2*e+1]=9,e++,o[9]++;for(;e<=279;)QA[2*e+1]=7,e++,o[7]++;for(;e<=287;)QA[2*e+1]=8,e++,o[8]++;for(fO(QA,287,o),e=0;e<qA;e++)ZA[2*e+1]=5,ZA[2*e]=hO(e,5);rO=new nO(QA,zA,257,HA,KA),oO=new nO(ZA,YA,0,qA,KA),sO=new nO(new Array(0),JA,0,19,7)})(),wO=!0),e.l_desc=new aO(e.dyn_ltree,rO),e.d_desc=new aO(e.dyn_dtree,oO),e.bl_desc=new aO(e.bl_tree,sO),e.bi_buf=0,e.bi_valid=0,pO(e)},RO=(e,t,i,n)=>{let r,o,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<GA;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),EO(e,e.l_desc),EO(e,e.d_desc),s=(e=>{let t;for(bO(e,e.dyn_ltree,e.l_desc.max_code),bO(e,e.dyn_dtree,e.d_desc.max_code),EO(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*XA[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),r=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=r&&(r=o)):r=o=i+5,i+4<=r&&-1!==t?SO(e,t,i,n):4===e.strategy||o===r?(dO(e,2+(n?1:0),3),vO(e,QA,ZA)):(dO(e,4+(n?1:0),3),((e,t,i,n)=>{let r;for(dO(e,t-257,5),dO(e,i-1,5),dO(e,n-4,4),r=0;r<n;r++)dO(e,e.bl_tree[2*XA[r]+1],3);yO(e,e.dyn_ltree,t-1),yO(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),vO(e,e.dyn_ltree,e.dyn_dtree)),pO(e),n&&mO(e)},CO=(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(eO[i]+GA+1)]++,e.dyn_dtree[2*cO(t)]++),e.sym_next===e.sym_end),IO={_tr_init:TO,_tr_stored_block:SO,_tr_flush_block:RO,_tr_tally:CO,_tr_align:e=>{dO(e,2,3),lO(e,256,QA),(e=>{16===e.bi_valid?(uO(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},AO=(e,t,i,n)=>{let r=65535&e|0,o=e>>>16&65535|0,s=0;for(;0!==i;){s=i>2e3?2e3:i,i-=s;do{r=r+t[n++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0};const OO=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());var MO=(e,t,i,n)=>{const r=OO,o=n+i;e^=-1;for(let s=n;s<o;s++)e=e>>>8^r[255&(e^t[s])];return-1^e},NO={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},kO={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:PO,_tr_stored_block:DO,_tr_flush_block:LO,_tr_tally:xO,_tr_align:UO}=IO,{Z_NO_FLUSH:VO,Z_PARTIAL_FLUSH:BO,Z_FULL_FLUSH:jO,Z_FINISH:FO,Z_BLOCK:WO,Z_OK:GO,Z_STREAM_END:HO,Z_STREAM_ERROR:qO,Z_DATA_ERROR:KO,Z_BUF_ERROR:zO,Z_DEFAULT_COMPRESSION:YO,Z_FILTERED:JO,Z_HUFFMAN_ONLY:XO,Z_RLE:QO,Z_FIXED:ZO,Z_DEFAULT_STRATEGY:$O,Z_UNKNOWN:eM,Z_DEFLATED:tM}=kO,iM=286,nM=30,rM=19,oM=2*iM+1,sM=15,aM=258,cM=262,uM=42,dM=113,lM=666,hM=(e,t)=>(e.msg=NO[t],t),fM=e=>2*e-(e>4?9:0),pM=e=>{let t=e.length;for(;--t>=0;)e[t]=0},mM=e=>{let t,i,n,r=e.w_size;t=e.hash_size,n=t;do{i=e.head[--n],e.head[n]=i>=r?i-r:0}while(--t);t=r,n=t;do{i=e.prev[--n],e.prev[n]=i>=r?i-r:0}while(--t)};let _M=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const gM=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},vM=(e,t)=>{LO(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,gM(e.strm)},EM=(e,t)=>{e.pending_buf[e.pending++]=t},bM=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},yM=(e,t,i,n)=>{let r=e.avail_in;return r>n&&(r=n),0===r?0:(e.avail_in-=r,t.set(e.input.subarray(e.next_in,e.next_in+r),i),1===e.state.wrap?e.adler=AO(e.adler,t,r,i):2===e.state.wrap&&(e.adler=MO(e.adler,t,r,i)),e.next_in+=r,e.total_in+=r,r)},wM=(e,t)=>{let i,n,r=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match;const c=e.strstart>e.w_size-cM?e.strstart-(e.w_size-cM):0,u=e.window,d=e.w_mask,l=e.prev,h=e.strstart+aM;let f=u[o+s-1],p=u[o+s];e.prev_length>=e.good_match&&(r>>=2),a>e.lookahead&&(a=e.lookahead);do{if(i=t,u[i+s]===p&&u[i+s-1]===f&&u[i]===u[o]&&u[++i]===u[o+1]){o+=2,i++;do{}while(u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&u[++o]===u[++i]&&o<h);if(n=aM-(h-o),o=h-aM,n>s){if(e.match_start=t,s=n,n>=a)break;f=u[o+s-1],p=u[o+s]}}}while((t=l[t&d])>c&&0!=--r);return s<=e.lookahead?s:e.lookahead},SM=e=>{const t=e.w_size;let i,n,r;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-cM)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),mM(e),n+=t),0===e.strm.avail_in)break;if(i=yM(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=i,e.lookahead+e.insert>=3)for(r=e.strstart-e.insert,e.ins_h=e.window[r],e.ins_h=_M(e,e.ins_h,e.window[r+1]);e.insert&&(e.ins_h=_M(e,e.ins_h,e.window[r+3-1]),e.prev[r&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=r,r++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<cM&&0!==e.strm.avail_in)},TM=(e,t)=>{let i,n,r,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,a=e.strm.avail_in;do{if(i=65535,r=e.bi_valid+42>>3,e.strm.avail_out<r)break;if(r=e.strm.avail_out-r,n=e.strstart-e.block_start,i>n+e.strm.avail_in&&(i=n+e.strm.avail_in),i>r&&(i=r),i<o&&(0===i&&t!==FO||t===VO||i!==n+e.strm.avail_in))break;s=t===FO&&i===n+e.strm.avail_in?1:0,DO(e,0,0,s),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,gM(e.strm),n&&(n>i&&(n=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+n),e.strm.next_out),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n,e.block_start+=n,i-=n),i&&(yM(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(0===s);return a-=e.strm.avail_in,a&&(a>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=a&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-a,e.strm.next_in),e.strstart),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==VO&&t!==FO&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(r=e.window_size-e.strstart,e.strm.avail_in>r&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,r+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),r>e.strm.avail_in&&(r=e.strm.avail_in),r&&(yM(e.strm,e.window,e.strstart,r),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.high_water<e.strstart&&(e.high_water=e.strstart),r=e.bi_valid+42>>3,r=e.pending_buf_size-r>65535?65535:e.pending_buf_size-r,o=r>e.w_size?e.w_size:r,n=e.strstart-e.block_start,(n>=o||(n||t===FO)&&t!==VO&&0===e.strm.avail_in&&n<=r)&&(i=n>r?r:n,s=t===FO&&0===e.strm.avail_in&&i===n?1:0,DO(e,e.block_start,i,s),e.block_start+=i,gM(e.strm)),s?3:1)},RM=(e,t)=>{let i,n;for(;;){if(e.lookahead<cM){if(SM(e),e.lookahead<cM&&t===VO)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=_M(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-cM&&(e.match_length=wM(e,i)),e.match_length>=3)if(n=xO(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=_M(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=_M(e,e.ins_h,e.window[e.strstart+1]);else n=xO(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(vM(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===FO?(vM(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(vM(e,!1),0===e.strm.avail_out)?1:2},CM=(e,t)=>{let i,n,r;for(;;){if(e.lookahead<cM){if(SM(e),e.lookahead<cM&&t===VO)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=_M(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-cM&&(e.match_length=wM(e,i),e.match_length<=5&&(e.strategy===JO||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,n=xO(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=_M(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(vM(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=xO(e,0,e.window[e.strstart-1]),n&&vM(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=xO(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===FO?(vM(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(vM(e,!1),0===e.strm.avail_out)?1:2};function IM(e,t,i,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=r}const AM=[new IM(0,0,0,0,TM),new IM(4,4,8,4,RM),new IM(4,5,16,8,RM),new IM(4,6,32,32,RM),new IM(4,4,16,16,CM),new IM(8,16,32,32,CM),new IM(8,16,128,128,CM),new IM(8,32,128,256,CM),new IM(32,128,258,1024,CM),new IM(32,258,258,4096,CM)];function OM(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=tM,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*oM),this.dyn_dtree=new Uint16Array(2*(2*nM+1)),this.bl_tree=new Uint16Array(2*(2*rM+1)),pM(this.dyn_ltree),pM(this.dyn_dtree),pM(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(sM+1),this.heap=new Uint16Array(2*iM+1),pM(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*iM+1),pM(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const MM=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==uM&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==dM&&t.status!==lM?1:0},NM=e=>{if(MM(e))return hM(e,qO);e.total_in=e.total_out=0,e.data_type=eM;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?uM:dM,e.adler=2===t.wrap?0:1,t.last_flush=-2,PO(t),GO},kM=e=>{const t=NM(e);var i;return t===GO&&((i=e.state).window_size=2*i.w_size,pM(i.head),i.max_lazy_match=AM[i.level].max_lazy,i.good_match=AM[i.level].good_length,i.nice_match=AM[i.level].nice_length,i.max_chain_length=AM[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),t},PM=(e,t,i,n,r,o)=>{if(!e)return qO;let s=1;if(t===YO&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),r<1||r>9||i!==tM||n<8||n>15||t<0||t>9||o<0||o>ZO||8===n&&1!==s)return hM(e,qO);8===n&&(n=9);const a=new OM;return e.state=a,a.strm=e,a.status=uM,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=t,a.strategy=o,a.method=i,kM(e)};var DM=(e,t)=>{if(MM(e)||t>WO||t<0)return e?hM(e,qO):qO;const i=e.state;if(!e.output||0!==e.avail_in&&!e.input||i.status===lM&&t!==FO)return hM(e,0===e.avail_out?zO:qO);const n=i.last_flush;if(i.last_flush=t,0!==i.pending){if(gM(e),0===e.avail_out)return i.last_flush=-1,GO}else if(0===e.avail_in&&fM(t)<=fM(n)&&t!==FO)return hM(e,zO);if(i.status===lM&&0!==e.avail_in)return hM(e,zO);if(i.status===uM&&0===i.wrap&&(i.status=dM),i.status===uM){let t=tM+(i.w_bits-8<<4)<<8,n=-1;if(n=i.strategy>=XO||i.level<2?0:i.level<6?1:6===i.level?2:3,t|=n<<6,0!==i.strstart&&(t|=32),t+=31-t%31,bM(i,t),0!==i.strstart&&(bM(i,e.adler>>>16),bM(i,65535&e.adler)),e.adler=1,i.status=dM,gM(e),0!==i.pending)return i.last_flush=-1,GO}if(57===i.status)if(e.adler=0,EM(i,31),EM(i,139),EM(i,8),i.gzhead)EM(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),EM(i,255&i.gzhead.time),EM(i,i.gzhead.time>>8&255),EM(i,i.gzhead.time>>16&255),EM(i,i.gzhead.time>>24&255),EM(i,9===i.level?2:i.strategy>=XO||i.level<2?4:0),EM(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(EM(i,255&i.gzhead.extra.length),EM(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=MO(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(EM(i,0),EM(i,0),EM(i,0),EM(i,0),EM(i,0),EM(i,9===i.level?2:i.strategy>=XO||i.level<2?4:0),EM(i,3),i.status=dM,gM(e),0!==i.pending)return i.last_flush=-1,GO;if(69===i.status){if(i.gzhead.extra){let t=i.pending,n=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+n>i.pending_buf_size;){let r=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>t&&(e.adler=MO(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex+=r,gM(e),0!==i.pending)return i.last_flush=-1,GO;t=0,n-=r}let r=new Uint8Array(i.gzhead.extra);i.pending_buf.set(r.subarray(i.gzindex,i.gzindex+n),i.pending),i.pending+=n,i.gzhead.hcrc&&i.pending>t&&(e.adler=MO(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let t,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(e.adler=MO(e.adler,i.pending_buf,i.pending-n,n)),gM(e),0!==i.pending)return i.last_flush=-1,GO;n=0}t=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,EM(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>n&&(e.adler=MO(e.adler,i.pending_buf,i.pending-n,n)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let t,n=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>n&&(e.adler=MO(e.adler,i.pending_buf,i.pending-n,n)),gM(e),0!==i.pending)return i.last_flush=-1,GO;n=0}t=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,EM(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>n&&(e.adler=MO(e.adler,i.pending_buf,i.pending-n,n))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(gM(e),0!==i.pending))return i.last_flush=-1,GO;EM(i,255&e.adler),EM(i,e.adler>>8&255),e.adler=0}if(i.status=dM,gM(e),0!==i.pending)return i.last_flush=-1,GO}if(0!==e.avail_in||0!==i.lookahead||t!==VO&&i.status!==lM){let n=0===i.level?TM(i,t):i.strategy===XO?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(SM(e),0===e.lookahead)){if(t===VO)return 1;break}if(e.match_length=0,i=xO(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(vM(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===FO?(vM(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(vM(e,!1),0===e.strm.avail_out)?1:2})(i,t):i.strategy===QO?((e,t)=>{let i,n,r,o;const s=e.window;for(;;){if(e.lookahead<=aM){if(SM(e),e.lookahead<=aM&&t===VO)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(r=e.strstart-1,n=s[r],n===s[++r]&&n===s[++r]&&n===s[++r])){o=e.strstart+aM;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<o);e.match_length=aM-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=xO(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=xO(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(vM(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===FO?(vM(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(vM(e,!1),0===e.strm.avail_out)?1:2})(i,t):AM[i.level].func(i,t);if(3!==n&&4!==n||(i.status=lM),1===n||3===n)return 0===e.avail_out&&(i.last_flush=-1),GO;if(2===n&&(t===BO?UO(i):t!==WO&&(DO(i,0,0,!1),t===jO&&(pM(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),gM(e),0===e.avail_out))return i.last_flush=-1,GO}return t!==FO?GO:i.wrap<=0?HO:(2===i.wrap?(EM(i,255&e.adler),EM(i,e.adler>>8&255),EM(i,e.adler>>16&255),EM(i,e.adler>>24&255),EM(i,255&e.total_in),EM(i,e.total_in>>8&255),EM(i,e.total_in>>16&255),EM(i,e.total_in>>24&255)):(bM(i,e.adler>>>16),bM(i,65535&e.adler)),gM(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?GO:HO)},LM=(e,t)=>{let i=t.length;if(MM(e))return qO;const n=e.state,r=n.wrap;if(2===r||1===r&&n.status!==uM||n.lookahead)return qO;if(1===r&&(e.adler=AO(e.adler,t,i,0)),n.wrap=0,i>=n.w_size){0===r&&(pM(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(i-n.w_size,i),0),t=e,i=n.w_size}const o=e.avail_in,s=e.next_in,a=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,SM(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=_M(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,SM(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=s,e.input=a,e.avail_in=o,n.wrap=r,GO},xM={deflateInit:(e,t)=>PM(e,t,tM,15,8,$O),deflateInit2:PM,deflateReset:kM,deflateResetKeep:NM,deflateSetHeader:(e,t)=>MM(e)||2!==e.state.wrap?qO:(e.state.gzhead=t,GO),deflate:DM,deflateEnd:e=>{if(MM(e))return qO;const t=e.state.status;return e.state=null,t===dM?hM(e,KO):GO},deflateSetDictionary:LM,deflateInfo:"pako deflate (from Nodeca project)"};const UM=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var VM={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const t in i)UM(i,t)&&(e[t]=i[t])}}return e},flattenChunks:e=>{let t=0;for(let n=0,r=e.length;n<r;n++)t+=e[n].length;const i=new Uint8Array(t);for(let n=0,r=0,o=e.length;n<o;n++){let t=e[n];i.set(t,r),r+=t.length}return i}};let BM=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){BM=!1}const jM=new Uint8Array(256);for(let t=0;t<256;t++)jM[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;jM[254]=jM[254]=1;var FM={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,n,r,o,s=e.length,a=0;for(r=0;r<s;r++)i=e.charCodeAt(r),55296==(64512&i)&&r+1<s&&(n=e.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),a+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(a),o=0,r=0;o<a;r++)i=e.charCodeAt(r),55296==(64512&i)&&r+1<s&&(n=e.charCodeAt(r+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),r++)),i<128?t[o++]=i:i<2048?(t[o++]=192|i>>>6,t[o++]=128|63&i):i<65536?(t[o++]=224|i>>>12,t[o++]=128|i>>>6&63,t[o++]=128|63&i):(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63,t[o++]=128|i>>>6&63,t[o++]=128|63&i);return t},buf2string:(e,t)=>{const i=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let n,r;const o=new Array(2*i);for(r=0,n=0;n<i;){let t=e[n++];if(t<128){o[r++]=t;continue}let s=jM[t];if(s>4)o[r++]=65533,n+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&n<i;)t=t<<6|63&e[n++],s--;s>1?o[r++]=65533:t<65536?o[r++]=t:(t-=65536,o[r++]=55296|t>>10&1023,o[r++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&BM)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let i="";for(let n=0;n<t;n++)i+=String.fromCharCode(e[n]);return i})(o,r)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+jM[e[i]]>t?i:t}},WM=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const GM=Object.prototype.toString,{Z_NO_FLUSH:HM,Z_SYNC_FLUSH:qM,Z_FULL_FLUSH:KM,Z_FINISH:zM,Z_OK:YM,Z_STREAM_END:JM,Z_DEFAULT_COMPRESSION:XM,Z_DEFAULT_STRATEGY:QM,Z_DEFLATED:ZM}=kO;function $M(e){this.options=VM.assign({level:XM,method:ZM,chunkSize:16384,windowBits:15,memLevel:8,strategy:QM},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new WM,this.strm.avail_out=0;let i=xM.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==YM)throw new Error(NO[i]);if(t.header&&xM.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?FM.string2buf(t.dictionary):"[object ArrayBuffer]"===GM.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=xM.deflateSetDictionary(this.strm,e),i!==YM)throw new Error(NO[i]);this._dict_set=!0}}function eN(e,t){const i=new $M(t);if(i.push(e,!0),i.err)throw i.msg||NO[i.err];return i.result}$M.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?zM:HM,"string"==typeof e?i.input=FM.string2buf(e):"[object ArrayBuffer]"===GM.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),(o===qM||o===KM)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(r=xM.deflate(i,o),r===JM)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),r=xM.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===YM;if(0!==i.avail_out){if(o>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},$M.prototype.onData=function(e){this.chunks.push(e)},$M.prototype.onEnd=function(e){e===YM&&(this.result=VM.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var tN={Deflate:$M,deflate:eN,deflateRaw:function(e,t){return(t=t||{}).raw=!0,eN(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,eN(e,t)},constants:kO};const iN=16209;var nN=function(e,t){let i,n,r,o,s,a,c,u,d,l,h,f,p,m,_,g,v,E,b,y,w,S,T,R;const C=e.state;i=e.next_in,T=e.input,n=i+(e.avail_in-5),r=e.next_out,R=e.output,o=r-(t-e.avail_out),s=r+(e.avail_out-257),a=C.dmax,c=C.wsize,u=C.whave,d=C.wnext,l=C.window,h=C.hold,f=C.bits,p=C.lencode,m=C.distcode,_=(1<<C.lenbits)-1,g=(1<<C.distbits)-1;e:do{f<15&&(h+=T[i++]<<f,f+=8,h+=T[i++]<<f,f+=8),v=p[h&_];t:for(;;){if(E=v>>>24,h>>>=E,f-=E,E=v>>>16&255,0===E)R[r++]=65535&v;else{if(!(16&E)){if(0==(64&E)){v=p[(65535&v)+(h&(1<<E)-1)];continue t}if(32&E){C.mode=16191;break e}e.msg="invalid literal/length code",C.mode=iN;break e}b=65535&v,E&=15,E&&(f<E&&(h+=T[i++]<<f,f+=8),b+=h&(1<<E)-1,h>>>=E,f-=E),f<15&&(h+=T[i++]<<f,f+=8,h+=T[i++]<<f,f+=8),v=m[h&g];i:for(;;){if(E=v>>>24,h>>>=E,f-=E,E=v>>>16&255,!(16&E)){if(0==(64&E)){v=m[(65535&v)+(h&(1<<E)-1)];continue i}e.msg="invalid distance code",C.mode=iN;break e}if(y=65535&v,E&=15,f<E&&(h+=T[i++]<<f,f+=8,f<E&&(h+=T[i++]<<f,f+=8)),y+=h&(1<<E)-1,y>a){e.msg="invalid distance too far back",C.mode=iN;break e}if(h>>>=E,f-=E,E=r-o,y>E){if(E=y-E,E>u&&C.sane){e.msg="invalid distance too far back",C.mode=iN;break e}if(w=0,S=l,0===d){if(w+=c-E,E<b){b-=E;do{R[r++]=l[w++]}while(--E);w=r-y,S=R}}else if(d<E){if(w+=c+d-E,E-=d,E<b){b-=E;do{R[r++]=l[w++]}while(--E);if(w=0,d<b){E=d,b-=E;do{R[r++]=l[w++]}while(--E);w=r-y,S=R}}}else if(w+=d-E,E<b){b-=E;do{R[r++]=l[w++]}while(--E);w=r-y,S=R}for(;b>2;)R[r++]=S[w++],R[r++]=S[w++],R[r++]=S[w++],b-=3;b&&(R[r++]=S[w++],b>1&&(R[r++]=S[w++]))}else{w=r-y;do{R[r++]=R[w++],R[r++]=R[w++],R[r++]=R[w++],b-=3}while(b>2);b&&(R[r++]=R[w++],b>1&&(R[r++]=R[w++]))}break}}break}}while(i<n&&r<s);b=f>>3,i-=b,f-=b<<3,h&=(1<<f)-1,e.next_in=i,e.next_out=r,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=r<s?s-r+257:257-(r-s),C.hold=h,C.bits=f};const rN=15,oN=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),sN=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),aN=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),cN=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var uN=(e,t,i,n,r,o,s,a)=>{const c=a.bits;let u,d,l,h,f,p,m=0,_=0,g=0,v=0,E=0,b=0,y=0,w=0,S=0,T=0,R=null;const C=new Uint16Array(16),I=new Uint16Array(16);let A,O,M,N=null;for(m=0;m<=rN;m++)C[m]=0;for(_=0;_<n;_++)C[t[i+_]]++;for(E=c,v=rN;v>=1&&0===C[v];v--);if(E>v&&(E=v),0===v)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(g=1;g<v&&0===C[g];g++);for(E<g&&(E=g),w=1,m=1;m<=rN;m++)if(w<<=1,w-=C[m],w<0)return-1;if(w>0&&(0===e||1!==v))return-1;for(I[1]=0,m=1;m<rN;m++)I[m+1]=I[m]+C[m];for(_=0;_<n;_++)0!==t[i+_]&&(s[I[t[i+_]]++]=_);if(0===e?(R=N=s,p=20):1===e?(R=oN,N=sN,p=257):(R=aN,N=cN,p=0),T=0,_=0,m=g,f=o,b=E,y=0,l=-1,S=1<<E,h=S-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){A=m-y,s[_]+1<p?(O=0,M=s[_]):s[_]>=p?(O=N[s[_]-p],M=R[s[_]-p]):(O=96,M=0),u=1<<m-y,d=1<<b,g=d;do{d-=u,r[f+(T>>y)+d]=A<<24|O<<16|M|0}while(0!==d);for(u=1<<m-1;T&u;)u>>=1;if(0!==u?(T&=u-1,T+=u):T=0,_++,0==--C[m]){if(m===v)break;m=t[i+s[_]]}if(m>E&&(T&h)!==l){for(0===y&&(y=E),f+=g,b=m-y,w=1<<b;b+y<v&&(w-=C[b+y],!(w<=0));)b++,w<<=1;if(S+=1<<b,1===e&&S>852||2===e&&S>592)return 1;l=T&h,r[l]=E<<24|b<<16|f-o|0}}return 0!==T&&(r[f+T]=m-y<<24|64<<16|0),a.bits=E,0};const{Z_FINISH:dN,Z_BLOCK:lN,Z_TREES:hN,Z_OK:fN,Z_STREAM_END:pN,Z_NEED_DICT:mN,Z_STREAM_ERROR:_N,Z_DATA_ERROR:gN,Z_MEM_ERROR:vN,Z_BUF_ERROR:EN,Z_DEFLATED:bN}=kO,yN=16180,wN=16190,SN=16191,TN=16192,RN=16194,CN=16199,IN=16200,AN=16206,ON=16209,MN=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function NN(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const kN=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<yN||t.mode>16211?1:0},PN=e=>{if(kN(e))return _N;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=yN,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,fN},DN=e=>{if(kN(e))return _N;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,PN(e)},LN=(e,t)=>{let i;if(kN(e))return _N;const n=e.state;return t<0?(i=0,t=-t):(i=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?_N:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,DN(e))},xN=(e,t)=>{if(!e)return _N;const i=new NN;e.state=i,i.strm=e,i.window=null,i.mode=yN;const n=LN(e,t);return n!==fN&&(e.state=null),n};let UN,VN,BN=!0;const jN=e=>{if(BN){UN=new Int32Array(512),VN=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(uN(1,e.lens,0,288,UN,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;uN(2,e.lens,0,32,VN,0,e.work,{bits:5}),BN=!1}e.lencode=UN,e.lenbits=9,e.distcode=VN,e.distbits=5},FN=(e,t,i,n)=>{let r;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(t.subarray(i-o.wsize,i),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>n&&(r=n),o.window.set(t.subarray(i-n,i-n+r),o.wnext),(n-=r)?(o.window.set(t.subarray(i-n,i),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var WN=(e,t)=>{let i,n,r,o,s,a,c,u,d,l,h,f,p,m,_,g,v,E,b,y,w,S,T=0;const R=new Uint8Array(4);let C,I;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(kN(e)||!e.output||!e.input&&0!==e.avail_in)return _N;i=e.state,i.mode===SN&&(i.mode=TN),s=e.next_out,r=e.output,c=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,u=i.hold,d=i.bits,l=a,h=c,S=fN;e:for(;;)switch(i.mode){case yN:if(0===i.wrap){i.mode=TN;break}for(;d<16;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if(2&i.wrap&&35615===u){0===i.wbits&&(i.wbits=15),i.check=0,R[0]=255&u,R[1]=u>>>8&255,i.check=MO(i.check,R,2,0),u=0,d=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",i.mode=ON;break}if((15&u)!==bN){e.msg="unknown compression method",i.mode=ON;break}if(u>>>=4,d-=4,w=8+(15&u),0===i.wbits&&(i.wbits=w),w>15||w>i.wbits){e.msg="invalid window size",i.mode=ON;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&u?16189:SN,u=0,d=0;break;case 16181:for(;d<16;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if(i.flags=u,(255&i.flags)!==bN){e.msg="unknown compression method",i.mode=ON;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=ON;break}i.head&&(i.head.text=u>>8&1),512&i.flags&&4&i.wrap&&(R[0]=255&u,R[1]=u>>>8&255,i.check=MO(i.check,R,2,0)),u=0,d=0,i.mode=16182;case 16182:for(;d<32;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}i.head&&(i.head.time=u),512&i.flags&&4&i.wrap&&(R[0]=255&u,R[1]=u>>>8&255,R[2]=u>>>16&255,R[3]=u>>>24&255,i.check=MO(i.check,R,4,0)),u=0,d=0,i.mode=16183;case 16183:for(;d<16;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}i.head&&(i.head.xflags=255&u,i.head.os=u>>8),512&i.flags&&4&i.wrap&&(R[0]=255&u,R[1]=u>>>8&255,i.check=MO(i.check,R,2,0)),u=0,d=0,i.mode=16184;case 16184:if(1024&i.flags){for(;d<16;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}i.length=u,i.head&&(i.head.extra_len=u),512&i.flags&&4&i.wrap&&(R[0]=255&u,R[1]=u>>>8&255,i.check=MO(i.check,R,2,0)),u=0,d=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(f=i.length,f>a&&(f=a),f&&(i.head&&(w=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(n.subarray(o,o+f),w)),512&i.flags&&4&i.wrap&&(i.check=MO(i.check,n,f,o)),a-=f,o+=f,i.length-=f),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===a)break e;f=0;do{w=n[o+f++],i.head&&w&&i.length<65536&&(i.head.name+=String.fromCharCode(w))}while(w&&f<a);if(512&i.flags&&4&i.wrap&&(i.check=MO(i.check,n,f,o)),a-=f,o+=f,w)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===a)break e;f=0;do{w=n[o+f++],i.head&&w&&i.length<65536&&(i.head.comment+=String.fromCharCode(w))}while(w&&f<a);if(512&i.flags&&4&i.wrap&&(i.check=MO(i.check,n,f,o)),a-=f,o+=f,w)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;d<16;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if(4&i.wrap&&u!==(65535&i.check)){e.msg="header crc mismatch",i.mode=ON;break}u=0,d=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=SN;break;case 16189:for(;d<32;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}e.adler=i.check=MN(u),u=0,d=0,i.mode=wN;case wN:if(0===i.havedict)return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,i.hold=u,i.bits=d,mN;e.adler=i.check=1,i.mode=SN;case SN:if(t===lN||t===hN)break e;case TN:if(i.last){u>>>=7&d,d-=7&d,i.mode=AN;break}for(;d<3;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}switch(i.last=1&u,u>>>=1,d-=1,3&u){case 0:i.mode=16193;break;case 1:if(jN(i),i.mode=CN,t===hN){u>>>=2,d-=2;break e}break;case 2:i.mode=16196;break;case 3:e.msg="invalid block type",i.mode=ON}u>>>=2,d-=2;break;case 16193:for(u>>>=7&d,d-=7&d;d<32;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",i.mode=ON;break}if(i.length=65535&u,u=0,d=0,i.mode=RN,t===hN)break e;case RN:i.mode=16195;case 16195:if(f=i.length,f){if(f>a&&(f=a),f>c&&(f=c),0===f)break e;r.set(n.subarray(o,o+f),s),a-=f,o+=f,c-=f,s+=f,i.length-=f;break}i.mode=SN;break;case 16196:for(;d<14;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if(i.nlen=257+(31&u),u>>>=5,d-=5,i.ndist=1+(31&u),u>>>=5,d-=5,i.ncode=4+(15&u),u>>>=4,d-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=ON;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;d<3;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}i.lens[A[i.have++]]=7&u,u>>>=3,d-=3}for(;i.have<19;)i.lens[A[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,C={bits:i.lenbits},S=uN(0,i.lens,0,19,i.lencode,0,i.work,C),i.lenbits=C.bits,S){e.msg="invalid code lengths set",i.mode=ON;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;T=i.lencode[u&(1<<i.lenbits)-1],_=T>>>24,g=T>>>16&255,v=65535&T,!(_<=d);){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if(v<16)u>>>=_,d-=_,i.lens[i.have++]=v;else{if(16===v){for(I=_+2;d<I;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if(u>>>=_,d-=_,0===i.have){e.msg="invalid bit length repeat",i.mode=ON;break}w=i.lens[i.have-1],f=3+(3&u),u>>>=2,d-=2}else if(17===v){for(I=_+3;d<I;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}u>>>=_,d-=_,w=0,f=3+(7&u),u>>>=3,d-=3}else{for(I=_+7;d<I;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}u>>>=_,d-=_,w=0,f=11+(127&u),u>>>=7,d-=7}if(i.have+f>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=ON;break}for(;f--;)i.lens[i.have++]=w}}if(i.mode===ON)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=ON;break}if(i.lenbits=9,C={bits:i.lenbits},S=uN(1,i.lens,0,i.nlen,i.lencode,0,i.work,C),i.lenbits=C.bits,S){e.msg="invalid literal/lengths set",i.mode=ON;break}if(i.distbits=6,i.distcode=i.distdyn,C={bits:i.distbits},S=uN(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,C),i.distbits=C.bits,S){e.msg="invalid distances set",i.mode=ON;break}if(i.mode=CN,t===hN)break e;case CN:i.mode=IN;case IN:if(a>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,i.hold=u,i.bits=d,nN(e,h),s=e.next_out,r=e.output,c=e.avail_out,o=e.next_in,n=e.input,a=e.avail_in,u=i.hold,d=i.bits,i.mode===SN&&(i.back=-1);break}for(i.back=0;T=i.lencode[u&(1<<i.lenbits)-1],_=T>>>24,g=T>>>16&255,v=65535&T,!(_<=d);){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if(g&&0==(240&g)){for(E=_,b=g,y=v;T=i.lencode[y+((u&(1<<E+b)-1)>>E)],_=T>>>24,g=T>>>16&255,v=65535&T,!(E+_<=d);){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}u>>>=E,d-=E,i.back+=E}if(u>>>=_,d-=_,i.back+=_,i.length=v,0===g){i.mode=16205;break}if(32&g){i.back=-1,i.mode=SN;break}if(64&g){e.msg="invalid literal/length code",i.mode=ON;break}i.extra=15&g,i.mode=16201;case 16201:if(i.extra){for(I=i.extra;d<I;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}i.length+=u&(1<<i.extra)-1,u>>>=i.extra,d-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;T=i.distcode[u&(1<<i.distbits)-1],_=T>>>24,g=T>>>16&255,v=65535&T,!(_<=d);){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if(0==(240&g)){for(E=_,b=g,y=v;T=i.distcode[y+((u&(1<<E+b)-1)>>E)],_=T>>>24,g=T>>>16&255,v=65535&T,!(E+_<=d);){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}u>>>=E,d-=E,i.back+=E}if(u>>>=_,d-=_,i.back+=_,64&g){e.msg="invalid distance code",i.mode=ON;break}i.offset=v,i.extra=15&g,i.mode=16203;case 16203:if(i.extra){for(I=i.extra;d<I;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}i.offset+=u&(1<<i.extra)-1,u>>>=i.extra,d-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=ON;break}i.mode=16204;case 16204:if(0===c)break e;if(f=h-c,i.offset>f){if(f=i.offset-f,f>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=ON;break}f>i.wnext?(f-=i.wnext,p=i.wsize-f):p=i.wnext-f,f>i.length&&(f=i.length),m=i.window}else m=r,p=s-i.offset,f=i.length;f>c&&(f=c),c-=f,i.length-=f;do{r[s++]=m[p++]}while(--f);0===i.length&&(i.mode=IN);break;case 16205:if(0===c)break e;r[s++]=i.length,c--,i.mode=IN;break;case AN:if(i.wrap){for(;d<32;){if(0===a)break e;a--,u|=n[o++]<<d,d+=8}if(h-=c,e.total_out+=h,i.total+=h,4&i.wrap&&h&&(e.adler=i.check=i.flags?MO(i.check,r,h,s-h):AO(i.check,r,h,s-h)),h=c,4&i.wrap&&(i.flags?u:MN(u))!==i.check){e.msg="incorrect data check",i.mode=ON;break}u=0,d=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;d<32;){if(0===a)break e;a--,u+=n[o++]<<d,d+=8}if(4&i.wrap&&u!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=ON;break}u=0,d=0}i.mode=16208;case 16208:S=pN;break e;case ON:S=gN;break e;case 16210:return vN;default:return _N}return e.next_out=s,e.avail_out=c,e.next_in=o,e.avail_in=a,i.hold=u,i.bits=d,(i.wsize||h!==e.avail_out&&i.mode<ON&&(i.mode<AN||t!==dN))&&FN(e,e.output,e.next_out,h-e.avail_out),l-=e.avail_in,h-=e.avail_out,e.total_in+=l,e.total_out+=h,i.total+=h,4&i.wrap&&h&&(e.adler=i.check=i.flags?MO(i.check,r,h,e.next_out-h):AO(i.check,r,h,e.next_out-h)),e.data_type=i.bits+(i.last?64:0)+(i.mode===SN?128:0)+(i.mode===CN||i.mode===RN?256:0),(0===l&&0===h||t===dN)&&S===fN&&(S=EN),S},GN={inflateReset:DN,inflateReset2:LN,inflateResetKeep:PN,inflateInit:e=>xN(e,15),inflateInit2:xN,inflate:WN,inflateEnd:e=>{if(kN(e))return _N;let t=e.state;return t.window&&(t.window=null),e.state=null,fN},inflateGetHeader:(e,t)=>{if(kN(e))return _N;const i=e.state;return 0==(2&i.wrap)?_N:(i.head=t,t.done=!1,fN)},inflateSetDictionary:(e,t)=>{const i=t.length;let n,r,o;return kN(e)?_N:(n=e.state,0!==n.wrap&&n.mode!==wN?_N:n.mode===wN&&(r=1,r=AO(r,t,i,0),r!==n.check)?gN:(o=FN(e,t,i,i),o?(n.mode=16210,vN):(n.havedict=1,fN)))},inflateInfo:"pako inflate (from Nodeca project)"},HN=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const qN=Object.prototype.toString,{Z_NO_FLUSH:KN,Z_FINISH:zN,Z_OK:YN,Z_STREAM_END:JN,Z_NEED_DICT:XN,Z_STREAM_ERROR:QN,Z_DATA_ERROR:ZN,Z_MEM_ERROR:$N}=kO;function ek(e){this.options=VM.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new WM,this.strm.avail_out=0;let i=GN.inflateInit2(this.strm,t.windowBits);if(i!==YN)throw new Error(NO[i]);if(this.header=new HN,GN.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=FM.string2buf(t.dictionary):"[object ArrayBuffer]"===qN.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=GN.inflateSetDictionary(this.strm,t.dictionary),i!==YN)))throw new Error(NO[i])}function tk(e,t){const i=new ek(t);if(i.push(e),i.err)throw i.msg||NO[i.err];return i.result}ek.prototype.push=function(e,t){const i=this.strm,n=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=t===~~t?t:!0===t?zN:KN,"[object ArrayBuffer]"===qN.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(n),i.next_out=0,i.avail_out=n),o=GN.inflate(i,s),o===XN&&r&&(o=GN.inflateSetDictionary(i,r),o===YN?o=GN.inflate(i,s):o===ZN&&(o=XN));i.avail_in>0&&o===JN&&i.state.wrap>0&&0!==e[i.next_in];)GN.inflateReset(i),o=GN.inflate(i,s);switch(o){case QN:case ZN:case XN:case $N:return this.onEnd(o),this.ended=!0,!1}if(a=i.avail_out,i.next_out&&(0===i.avail_out||o===JN))if("string"===this.options.to){let e=FM.utf8border(i.output,i.next_out),t=i.next_out-e,r=FM.buf2string(i.output,e);i.next_out=t,i.avail_out=n-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(r)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(o!==YN||0!==a){if(o===JN)return o=GN.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},ek.prototype.onData=function(e){this.chunks.push(e)},ek.prototype.onEnd=function(e){e===YN&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=VM.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var ik={Inflate:ek,inflate:tk,inflateRaw:function(e,t){return(t=t||{}).raw=!0,tk(e,t)},ungzip:tk,constants:kO};const{Deflate:nk,deflate:rk,deflateRaw:ok,gzip:sk}=tN,{Inflate:ak,inflate:ck,inflateRaw:uk,ungzip:dk}=ik;var lk,hk=rk,fk=ck;!function(e){e[e.ONE_BYTE=0]="ONE_BYTE",e[e.TWO_BYTE=1]="TWO_BYTE"}(lk||(lk={}));class pk{constructor(){oh(this,"_sequence",0),oh(this,"_startTime",Date.now()),oh(this,"isUseOneByte",!0)}get startTime(){const e=Date.now()-this._startTime;return e<Math.pow(2,16)?e:(this._startTime+=Math.pow(2,16),this.startTime)}get sequence(){return this._sequence<Math.pow(2,32)?this._sequence++:(this._sequence-=Math.pow(2,32),this.sequence)}serialize(e){const t={commonPacketHeader:{length:0,reserved:0,extension:0,sequence:this.sequence},commonStreamHeader:this.startTime,extension:void 0,payload:e};if(e.byteLength>128){const i=new Uint8Array(4);i.set([1,0,0,0]);const n={id:0,length:4,data:i.buffer},r={profile:this.isUseOneByte?0:1,length:this.isUseOneByte?5:6,datas:[n]};t.commonPacketHeader.extension=1,t.extension=r,t.payload=this.compress(e),t.commonPacketHeader.length=8+(t.extension.length+2)+t.payload.byteLength}else t.commonPacketHeader.length=8+t.payload.byteLength;Pw("SHOW_DATASTREAM2_LOG")&&Yw.debug("send data header: ".concat(JSON.stringify(t.commonPacketHeader)));const i=new ArrayBuffer(t.commonPacketHeader.length),n=new Uint8Array(i),r=new DataView(i);let o=0;if(r.setUint16(o,t.commonPacketHeader.extension<<15|t.commonPacketHeader.reserved<<14|t.commonPacketHeader.length,!0),o+=2,r.setUint32(o,t.commonPacketHeader.sequence,!0),o+=4,r.setUint16(o,t.commonStreamHeader,!0),o+=2,t.extension){const e=this.serializeExtension(t.extension);n.set(new Uint8Array(e),o),o+=e.byteLength}if(n.set(new Uint8Array(t.payload),o),o+=t.payload.byteLength,o!==t.commonPacketHeader.length)throw Error("serialize error!");return i}deserialize(e){if(e.byteLength<4)return new ArrayBuffer(0);const t=new DataView(e);let i=0;const n=t.getUint16(i,!0);i+=2;const r={length:16383&n,reserved:(16384&n)>>14,extension:(32768&n)>>15,sequence:t.getUint16(i+2,!0)<<16|t.getUint16(i,!0)};let o,s;if(i+=4,Pw("SHOW_DATASTREAM2_LOG")&&Yw.debug("receive data header: ".concat(JSON.stringify(r))),t.getUint16(i,!0),i+=2,r.extension){s=this.deserializeExtension(e.slice(i)),i+=2+s.length,o=e.slice(i);let t=!1;if(s.datas.length>0){const e=s.datas.find((e=>0===e.id));e&&(t=1==(1&new DataView(e.data).getUint32(0,!0)))}o=t?this.decompress(o):o}else o=e.slice(8);return o}serializeExtension(e){const{profile:t,length:i,datas:n}=e,r=new ArrayBuffer(i+2),o=new Uint8Array(r),s=new DataView(r);let a=0;if(s.setUint8(a++,t),s.setUint8(a++,i),n.forEach((e=>{t?(s.setUint8(a++,e.id),s.setUint8(a++,e.length),o.set(new Uint8Array(e.data),a),a+=e.data.byteLength):(s.setUint8(a++,e.id|e.length<<4),o.set(new Uint8Array(e.data),a),a+=e.data.byteLength)})),a!==i+2)throw Error("serialize extension error, is ".concat(a,"!==").concat(i+2));return r}deserializeExtension(e){const t=new DataView(e);let i=0;const n=t.getUint8(i);i++;const r=t.getUint8(i);i++;const o=n===lk.TWO_BYTE,s=[],a=new DataView(e,2);let c=0;for(;c<r;){let e=0,t=0,i=new ArrayBuffer(0);o?(e=a.getUint8(c),c++,t=a.getUint8(c),c++):(e=15&a.getUint8(c),t=a.getUint8(c)>>4,c++),t>0&&(i=a.buffer.slice(c+2,c+2+t),c+=i.byteLength),s.push({id:e,length:t,data:i})}if(c!==r)throw Error("parse error");return{profile:n,length:r,datas:s}}decompress(e){return fk(new Uint8Array(e))}compress(e){return hk(new Uint8Array(e))}}class mk extends rE{constructor(e,t){super(),oh(this,"_version",1),oh(this,"_type",3),oh(this,"_config",void 0),oh(this,"_originDataChannel",void 0),oh(this,"_dataStreamPacketHeader",new ArrayBuffer(4)),oh(this,"_dataStreamPacketHandler",void 0),oh(this,"_datachannelEventMap",new Map),this._config=e,t&&(this._originDataChannel=t,this._bandDataChannelEvents(t)),this._initPacketHeader(),this._dataStreamPacketHandler=new pk}get id(){return this._config.id}get ordered(){return this._config.ordered}get maxRetransmits(){return Pw("DATASTREAM_MAX_RETRANSMITS")}get metadata(){return this._config.metadata}get readyState(){var e,t;return null!==(e=null===(t=this._originDataChannel)||void 0===t?void 0:t.readyState)&&void 0!==e?e:"connecting"}get _originDataChannelId(){var e,t;return null!==(e=null===(t=this._originDataChannel)||void 0===t?void 0:t.id)&&void 0!==e?e:null}getChannelId(){return this.id}getConfig(){return this._config}_close(){this._originDataChannel&&(this._unbindDataChannelEvents(this._originDataChannel),this._originDataChannel=void 0)}async _waitTillOpen(){return new nv(((e,t)=>{if(this._originDataChannel){"open"===this._originDataChannel.readyState&&e();const i=setTimeout((()=>{var e;t(new jv(Bv.DATACHANNEL_CONNECTION_TIMEOUT,"Cannot create datachannel, id: ".concat(null===(e=this._originDataChannel)||void 0===e?void 0:e.id)))}),1e4);this._originDataChannel.onopen=()=>{clearTimeout(i),this._originDataChannel&&this._bandDataChannelEvents(this._originDataChannel),e()},this._originDataChannel.onerror=()=>{throw clearTimeout(i),new jv(Bv.DATACHANNEL_CONNECTION_TIMEOUT)}}else t(new jv(Bv.DATACHANNEL_CONNECTION_TIMEOUT,"cannot find dataChannel"))}))}_updateOriginDataChannel(e){this._originDataChannel=e,this._bandDataChannelEvents(e)}_initPacketHeader(){const e=new DataView(this._dataStreamPacketHeader);e.setUint16(0,this._version),e.setUint8(2,this._type),e.setUint8(3,this._config.id)}_bandDataChannelEvents(e){this._unbindDataChannelEvents(e),[pI.OPEN,pI.CLOSE,pI.ERROR].forEach((t=>{const i=()=>{this.emit(t)};this._datachannelEventMap.set(t,i),e.addEventListener(t,i)}))}_unbindDataChannelEvents(e){Array.from(this._datachannelEventMap.entries()).forEach((t=>{let[i,n]=t;e.removeEventListener(i,n)})),this._datachannelEventMap.clear()}}class _k extends mk{constructor(e){super(e),oh(this,"_messageListener",void 0),this._messageListener=e=>{if(e.data.byteLength<this._dataStreamPacketHeader.byteLength)throw Error("invalid byteLength: the byte length must exceed "+this._dataStreamPacketHeader.byteLength);const t=e.data.slice(0,this._dataStreamPacketHeader.byteLength),i=new DataView(t).getUint8(3);if(i!==this.id)return void(Pw("SHOW_DATASTREAM2_LOG")&&Yw.debug("invalid datachannel id: ".concat(i," !== ").concat(this.id)));let n=e.data.slice(this._dataStreamPacketHeader.byteLength);n=this._dataStreamPacketHandler.deserialize(n),this.emit(pI.MESSAGE,n)}}_updateOriginDataChannel(e){super._updateOriginDataChannel(e),this._bandRemoteDataChannelEvents()}_close(){this._originDataChannel&&(this._originDataChannel.removeEventListener("message",this._messageListener),super._close())}_bandRemoteDataChannelEvents(){this._originDataChannel&&this._originDataChannel.addEventListener("message",this._messageListener)}}class gk extends mk{send(e){if(this._originDataChannel){let t=e;t=this._dataStreamPacketHandler.serialize(e);const i=new Uint8Array(this._dataStreamPacketHeader.byteLength+t.byteLength);i.set(new Uint8Array(this._dataStreamPacketHeader),0),i.set(new Uint8Array(t),this._dataStreamPacketHeader.byteLength),this._originDataChannel.send(i.buffer)}}}!function(){const e=mv();OC.getDisplayMedia=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia),OC.getStreamFromExtension=e.name===dv.CHROME&&Number(e.version)>34,OC.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver)return!1;if(!("currentDirection"in RTCRtpTransceiver.prototype))return!1;const e=new RTCPeerConnection;let t=!1;try{e.addTransceiver("audio"),t=!0}catch(e){}return e.close(),t}(),OC.supportMinBitrate=e.name===dv.CHROME||e.name===dv.EDGE,OC.supportSetRtpSenderParameters=function(){const e=mv();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!xv()||!(!wv()&&!vv())||e.name===dv.FIREFOX&&Number(e.version)>=64)}(),e.name===dv.SAFARI&&(Number(e.version)>=14?OC.supportDualStream=!0:OC.supportDualStream=!1),OC.webAudioMediaStreamDest=function(){const e=mv();return!(e.name===dv.SAFARI&&Number(e.version)<12)}(),OC.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,OC.supportWebGL="undefined"!=typeof WebGLRenderingContext,OC.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,xv()||(OC.webAudioWithAEC=!0),OC.supportShareAudio=function(){const e=mv();return(e.os===uv.WIN_10||e.os===uv.WIN_81||e.os===uv.WIN_7||e.os===uv.LINUX||e.os===uv.MAC_OS||e.os===uv.CHROMIUM_OS)&&e.name===dv.CHROME&&Number(e.version)>=74}(),OC.supportDataChannel=!!(Rv(76)||function(e){const t=mv();return!(t.name!==dv.FIREFOX||!t.osVersion)&&Number(t.version)>=e}(68)||function(e){const t=mv();return!(t.name!==dv.SAFARI||!t.osVersion)&&Number(t.version)>=e}(14)),OC.supportPCSetConfiguration=function(){const e=window.RTCPeerConnection;return!Sv()&&!!e&&e.prototype.setConfiguration instanceof Function}(),OC.supportWebRTCEncodedTransform=function(){const e=mv();return"Chrome"===e.name&&Number(e.version)>=86}(),OC.supportWebRTCInsertableStream=function(){const e=mv();return(e.name===dv.CHROME||e.name===dv.EDGE)&&Number(e.version)>=94&&"MediaStreamTrackGenerator"in window&&"MediaStreamTrackProcessor"in window}(),AE((()=>{OC.supportDualStreamEncoding=function(){const e=mv();return!!Pw("DISABLE_WEBAUDIO")||"Safari"===e.name&&Number(e.version)>=14||!!("Chrome"===e.name&&/Windows/i.test(e.os||"")&&Number(e.version)>=100&&Pw("CHROME_DUAL_STREAM_USE_ENCODING"))}(),Yw.info("browser compatibility",JSON.stringify(OC),JSON.stringify(e))}))}();class vk extends rE{constructor(){super(...arguments),oh(this,"resultStorage",new Map)}setLocalAudioStats(e,t,i){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(i,t)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(i,t))}setLocalVideoStats(e,t,i){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(i,t)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(i,t)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(i))}setRemoteAudioStats(e,t){const i=e.getUserId();this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",i,this.checkAudioOutputLevel(t))}setRemoteVideoStats(e,t){const i=e.getUserId();this.record("RECV_VIDEO_DECODE_FAILED",i,this.checkVideoDecode(t))}record(e,t,i){if(Pw("STATS_UPDATE_INTERVAL")>500)return;this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});const n=this.resultStorage.get(e);if(n&&(n.result.push(i),n.result.length>=5)){var r;const i=Mn(r=n.result).call(r,!0);n.isPrevNormal&&!i&&this.emit("exception",Ek[e],e,t),!n.isPrevNormal&&i&&this.emit("exception",Ek[e]+2e3,e+"_RECOVER",t),n.isPrevNormal=i,n.result=[]}}checkAudioOutputLevel(e){return!(e.receiveBitrate>0&&0===e.receiveLevel)}checkAudioInputLevel(e,t){return t instanceof fA&&!t.isActive||!!t.muted||0!==e.sendVolumeLevel}checkFramerateInput(e,t){let i=null;t._encoderConfig&&t._encoderConfig.frameRate&&(i=IR(t._encoderConfig.frameRate));const n=e.captureFrameRate;return!i||!n||!(i>10&&n<5||i<10&&i>=5&&n<=1)}checkFramerateSent(e){return!(e.captureFrameRate&&e.sendFrameRate&&e.captureFrameRate>5&&e.sendFrameRate<=1)}checkSendVideoBitrate(e,t){return!!t.muted||0!==e.sendBitrate}checkSendAudioBitrate(e,t){return t instanceof fA&&!t.isActive||!!t.muted||0!==e.sendBitrate}checkVideoDecode(e){return 0===e.receiveBitrate||0!==e.decodeFrameRate}}const Ek={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},bk=new class{markSubscribeStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/subscribe-").concat(t))}markPublishStart(e,t){performance.mark("agora-web-sdk/".concat(e,"/publish-").concat(t))}measureFromSubscribeStart(e,t){const i=performance.getEntriesByName("agora-web-sdk/".concat(e,"/subscribe-").concat(t));if(i.length>0){const e=i[i.length-1];return Math.round(performance.now()-e.startTime)}return 0}measureFromPublishStart(e,t){const i=performance.getEntriesByName("agora-web-sdk/".concat(e,"/publish-").concat(t));if(i.length>0){const e=i[i.length-1];return Math.round(performance.now()-e.startTime)}return 0}};function yk(e,t){this.v=e,this.k=t}function wk(e){return new yk(e,0)}var Sk=iv,Tk=a_;Ni({target:"Promise",stat:!0,forced:!0},{withResolvers:function(){var e=Tk.f(this);return{promise:e.promise,resolve:e.resolve,reject:e.reject}}});var Rk=a_,Ck=Wm;Ni({target:"Promise",stat:!0,forced:!0},{try:function(e){var t=Rk.f(this),i=Ck(e);return(i.error?t.reject:t.resolve)(i.value),t.promise}});var Ik=o(Sk),Ak=Ws.f("asyncIterator"),Ok=o(Ak);function Mk(e){var t,i;function n(t,i){try{var o=e[t](i),s=o.value,a=s instanceof yk;Ik.resolve(a?s.v:s).then((function(i){if(a){var c="return"===t?"return":"next";if(!s.k||i.done)return n(c,i);i=e[c](i).value}r(o.done?"return":"normal",i)}),(function(e){n("throw",e)}))}catch(e){r("throw",e)}}function r(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?n(t.key,t.arg):i=null}this._invoke=function(e,r){return new Ik((function(o,s){var a={key:e,arg:r,resolve:o,reject:s,next:null};i?i=i.next=a:(t=i=a,n(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}function Nk(e){return function(){return new Mk(e.apply(this,arguments))}}Mk.prototype["function"==typeof Vl&&Ok||"@@asyncIterator"]=function(){return this},Mk.prototype.next=function(e){return this._invoke("next",e)},Mk.prototype.throw=function(e){return this._invoke("throw",e)},Mk.prototype.return=function(e){return this._invoke("return",e)};var kk=o(oe.Object.getOwnPropertySymbols),Pk=Ni,Dk=Yi.indexOf,Lk=Sh,xk=I([].indexOf),Uk=!!xk&&1/xk([1],1,-0)<0;Pk({target:"Array",proto:!0,forced:Uk||!Lk("indexOf")},{indexOf:function(e){var t=arguments.length>1?arguments[1]:void 0;return Uk?xk(this,e,t)||0:Dk(this,e,t)}});var Vk=Qi("Array").indexOf,Bk=f,jk=Vk,Fk=Array.prototype,Wk=o((function(e){var t=e.indexOf;return e===Fk||Bk(Fk,e)&&t===Fk.indexOf?jk:t})),Gk=Ze,Hk=Xo;Ni({target:"Object",stat:!0,forced:s((function(){Hk(1)}))},{keys:function(e){return Hk(Gk(e))}});var qk=o(oe.Object.keys);function Kk(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i,n,r={},o=qk(e);for(n=0;n<o.length;n++)i=o[n],Wk(t).call(t,i)>=0||(r[i]=e[i]);return r}(e,t);if(kk){var o=kk(e);for(n=0;n<o.length;n++)i=o[n],Wk(t).call(t,i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var zk={exports:{}};!function(e,t){e.exports=(()=>{var e={8:(e,t,i)=>{i.r(t),i.d(t,{Parser:()=>w,Printer:()=>I,parse:()=>N,print:()=>k});const n="\n",r="".concat("\r").concat(n),o=" ";let s;function a(e){return e>="0"&&e<="9"}function c(e){return e>="!"&&e<="~"}function u(e){return c(e)||e>="\x80"&&e<="\xff"}function d(e){return"!"===e||e>="#"&&e<="'"||e>="*"&&e<="+"||e>="-"&&e<="."||e>="0"&&e<="9"||e>="A"&&e<="Z"||e>="^"&&e<="~"}function l(e){return e>="1"&&e<="9"}function h(e){return e>="A"&&e<="Z"||e>="a"&&e<="z"}function f(e){return"d"===e||"h"===e||"m"===e||"s"===e}function p(e){return e>"\x01"&&e<"\t"||e>"\v"&&e<"\f"||e>"\x0e"&&e<"\xff"}function m(e){return h(e)||a(e)||"+"===e||"/"===e}function _(e){return a(e)||h(e)||"+"===e||"/"===e||"-"===e||"_"===e}function g(e){return h(e)||a(e)||"+"===e||"/"===e}function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function E(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach((function(t){b(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}!function(e){e.VERSION="v",e.ORIGIN="o",e.SESSION_NAME="s",e.INFORMATION="i",e.URI="u",e.EMAIL="e",e.PHONE="p",e.CONNECTION="c",e.BANDWIDTH="b",e.TIME="t",e.REPEAT="r",e.ZONE_ADJUSTMENTS="z",e.KEY="k",e.ATTRIBUTE="a",e.MEDIA="m"}(s||(s={}));class y{consumeText(e,t){let i=t;for(;i<e.length;){const t=e[i];if("\0"===t||"\r"===t||t===n)break;i+=1}if(i-t==0)throw new Error("Invalid text, at ".concat(e));return i}consumeUnicastAddress(e,t,i){return this.consumeTill(e,t,o)}consumeOneOrMore(e,t,i){let n=t;for(;i(e[n]);)n++;if(n-t==0)throw new Error("Invalid rule at ".concat(t,"."));return n}consumeSpace(e,t){if(e[t]===o)return t+1;throw new Error("Invalid space at ".concat(t,"."))}consumeIP4Address(e,t){let i=t;for(let n=0;n<4;n++)if(i=this.consumeDecimalUChar(e,i),3!==n){if("."!==e[i])throw new Error("Invalid IP4 address.");i++}return i}consumeDecimalUChar(e,t){let i=t;for(let r=0;r<3&&a(e[i]);r++,i++);if(i-t==0)throw new Error("Invalid decimal uchar.");const n=parseInt(e.slice(t,i));if(n>=0&&n<=255)return i;throw new Error("Invalid decimal uchar")}consumeIP6Address(e,t){let i=this.consumeHexpart(e,t);return":"===e[i]?(i+=1,i=this.consumeIP4Address(e,i),i):i}consumeHexpart(e,t){let i=t;if(":"===e[i]&&":"===e[i+1]){i+=2;try{i=this.consumeHexseq(e,i)}catch(e){}return i}if(i=this.consumeHexseq(e,i),":"===e[i]&&":"===e[i+1]){i+=2;try{i=this.consumeHexseq(e,i)}catch(e){}return i}return i}consumeHexseq(e,t){let i=t;for(;i=this.consumeHex4(e,i),":"===e[i]&&":"!==e[i+1];)i+=1;return i}consumeHex4(e,t){let i=0;for(;i<4;i++)if(!((n=e[t+i])>="0"&&n<="9"||n>="a"&&n<="f"||n>="A"&&n<="F")){if(0===i)throw new Error("Invalid hex 4");break}var n;return t+i}consumeFQDN(e,t){let i=t;for(;a(e[i])||h(e[i])||"-"===e[i]||"."===e[i];)i+=1;if(i-t<4)throw new Error("Invalid FQDN");return i}consumeExtnAddr(e,t){return this.consumeOneOrMore(e,t,u)}consumeMulticastAddress(e,t,i){switch(i){case"IP4":case"ip4":return this.consumeIP4MulticastAddress(e,t);case"IP6":case"ip6":return this.consumeIP6MulticastAddress(e,t);default:try{return this.consumeFQDN(e,t)}catch(i){return this.consumeExtnAddr(e,t)}}}consumeIP6MulticastAddress(e,t){const i=this.consumeHexpart(e,t);return"/"===e[i]?this.consumeInteger(e,i+1):i}consumeIP4MulticastAddress(e,t){let i=t+3;const n=e.slice(t,i),r=parseInt(n);if(r<224||r>239)throw new Error("Invalid IP4 multicast address, IPv4 multicast addresses may be in the range 224.0.0.0 to 239.255.255.255.");for(let o=0;o<3;o++){if("."!==e[i])throw new Error("Invalid IP4 multicast address.");i+=1,i=this.consumeDecimalUChar(e,i)}return"/"===e[i]&&(i+=1),i=this.consumeTTL(e,i),"/"===e[i]&&(i=this.consumeInteger(e,i)),i}consumeInteger(e,t){if(!l(e[t]))throw new Error("Invalid integer.");for(t+=1;a(e[t]);)t+=1;return t}consumeTTL(e,t){if("0"===e[t])return t+1;if(!l(e[t]))throw new Error("Invalid TTL.");t+=1;for(let i=0;i<2&&a(e[t]);i++)t+=1;return t}consumeToken(e,t){return this.consumeOneOrMore(e,t,d)}consumeTime(e,t){let i=t;if("0"===e[i])return i+1;for(l(e[i])&&(i+=1);a(e[i]);)i++;if(i-t<10)throw new Error("Invalid time");return i}consumeAddress(e,t){return this.consumeTill(e,t,o)}consumeTypedTime(e,t){let i=t;return i=this.consumeOneOrMore(e,i,a),f(e[i])?i+1:i}consumeRepeatInterval(e,t){if(!l(e[t]))throw new Error("Invalid repeat interval");for(t+=1;a(e[t]);)t+=1;return f(e[t])&&(t+=1),t}consumePort(e,t){return this.consumeOneOrMore(e,t,a)}consume(e,t,i){for(let n=0;n<i.length;n++){if(t+n>=e.length)throw new Error("consume exceeding value length");if(e[t+n]!==i[n])throw new Error("consume ".concat(i," failed at ").concat(n))}return t+i.length}consumeTill(e,t,i){let n=t;for(;n<e.length&&("string"!=typeof i||e[n]!==i)&&("function"!=typeof i||!i(e[n]));)n++;return n}}class w extends y{constructor(){super(),b(this,"records",[]),b(this,"currentLine",0)}parse(e){const t=this.probeEOL(e);this.records=e.split(t).filter((e=>!!e.trim())).map(this.parseLine),this.currentLine=0;const i=this.parseVersion(),n=this.parseOrigin(),r=this.parseSessionName(),o=this.parseInformation(),s=this.parseUri(),a=this.parseEmail(),c=this.parsePhone(),u=this.parseConnection(),d=this.parseBandWidth(),l=this.parseTimeFields(),h=this.parseKey(),f=this.parseSessionAttribute(),p=this.parseMediaDescription();if(this.currentLine!==this.records.length)throw new Error("parsing failed, non exhaustive sdp lines.");return{version:i,origin:n,sessionName:r,information:o,uri:s,emails:a,phones:c,connection:u,bandwidths:d,timeFields:l,key:h,attributes:f,mediaDescriptions:p}}getCurrentRecord(){const e=this.records[this.currentLine];if(!e)throw new Error("Record doesn't exit.");return e}probeEOL(e){for(let t=0;t<e.length;t++)if(e[t]===n)return"\r"===e[t-1]?r:n;throw new Error("Invalid newline character.")}parseLine(e,t){if(e.length<2)throw new Error("Invalid sdp line, sdp line should be of form <type>=<value>.");const i=e[0];if("="!==e[1])throw new Error('Invalid sdp line, <type> should be a single character followed by an "=" sign.');return{type:i,value:e.slice(2),line:t,cur:0}}parseSessionAttribute(){const e=new T;for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==s.ATTRIBUTE)break;const i={attField:this.extractOneOrMore(t,(e=>d(e)&&":"!==e)),_cur:0};":"===t.value[t.cur]&&(t.cur+=1,i.attValue=this.extractOneOrMore(t,p)),e.parse(i),this.currentLine++}return e.digest()}parseMediaAttributes(e){const t=new R(e);for(;this.currentLine<this.records.length;){const e=this.getCurrentRecord();if(e.type!==s.ATTRIBUTE)break;const i={attField:this.extractOneOrMore(e,(e=>d(e)&&":"!==e)),_cur:0};":"===e.value[e.cur]&&(e.cur+=1,i.attValue=this.extractOneOrMore(e,p)),t.parse(i),this.currentLine++}return t.digest()}parseKey(){const e=this.getCurrentRecord();if(e.type===s.KEY){if("prompt"===e.value||"clear:"===e.value||"base64:"===e.value||"uri:"===e.value)return e.value;throw this.currentLine++,new Error("Invalid key.")}}parseZone(){const e=this.getCurrentRecord();if(e.type===s.ZONE_ADJUSTMENTS){const t=[];for(;;)try{const i=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);let n=!1;"-"===e.value[e.cur]&&(n=!0,e.cur+=1);const r=this.extract(e,this.consumeTypedTime);t.push({time:i,typedTime:r,back:n})}catch(e){break}if(0===t.length)throw new Error("Invalid zone adjustments");return this.currentLine++,t}return[]}parseRepeat(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==s.REPEAT)break;{const i=this.extract(t,this.consumeRepeatInterval),n=this.parseTypedTime(t);e.push({repeatInterval:i,typedTimes:n}),this.currentLine++}}return e}parseTypedTime(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeTypedTime))}catch(e){break}if(0===t.length)throw new Error("Invalid typed time.");return t}parseTime(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeTime);this.consumeSpaceForRecord(e);const i=this.extract(e,this.consumeTime);return this.currentLine++,{startTime:t,stopTime:i}}parseBandWidth(){const e=[];for(;this.currentLine<this.records.length;){const t=this.getCurrentRecord();if(t.type!==s.BANDWIDTH)break;{const i=this.extractOneOrMore(t,d);if(":"!==t.value[t.cur])throw new Error("Invalid bandwidth field.");t.cur++;const n=this.extractOneOrMore(t,a);e.push({bwtype:i,bandwidth:n}),this.currentLine++}}return e}parseVersion(){const e=this.getCurrentRecord();if(e.type!==s.VERSION)throw new Error("first sdp record must be version");const t=e.value.slice(0,this.consumeOneOrMore(e.value,0,a));if(t.length!==e.value.length)throw new Error('invalid proto version, "v='.concat(e.value,'"'));return this.currentLine++,t}parseOrigin(){const e=this.getCurrentRecord();if(e.type!==s.ORIGIN)throw new Error("second line of sdp must be origin");const t=this.extractOneOrMore(e,u);this.consumeSpaceForRecord(e);const i=this.extractOneOrMore(e,a);this.consumeSpaceForRecord(e);const n=this.extractOneOrMore(e,a);this.consumeSpaceForRecord(e);const r=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const o=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const c=this.extract(e,this.consumeUnicastAddress);return this.currentLine++,{username:t,sessId:i,sessVersion:n,nettype:r,addrtype:o,unicastAddress:c}}parseSessionName(){const e=this.getCurrentRecord();if(e.type===s.SESSION_NAME){const t=this.extract(e,this.consumeText);return this.currentLine++,t}}parseInformation(){const e=this.getCurrentRecord();if(e.type!==s.INFORMATION)return;const t=this.extract(e,this.consumeText);return this.currentLine++,t}parseUri(){const e=this.getCurrentRecord();if(e.type===s.URI)return this.currentLine++,e.value}parseEmail(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==s.EMAIL)break;e.push(t.value),this.currentLine++}return e}parsePhone(){const e=[];for(;;){const t=this.getCurrentRecord();if(t.type!==s.PHONE)break;e.push(t.value),this.currentLine++}return e}parseConnection(){const e=this.getCurrentRecord();if(e.type===s.CONNECTION){const t=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const i=this.extractOneOrMore(e,d);this.consumeSpaceForRecord(e);const n=this.extract(e,this.consumeAddress);return this.currentLine++,{nettype:t,addrtype:i,address:n}}}parseMedia(){const e=this.getCurrentRecord(),t=this.extract(e,this.consumeToken);this.consumeSpaceForRecord(e);let i=this.extract(e,this.consumePort);"/"===e.value[e.cur]&&(e.cur+=1,i+=this.extract(e,this.consumeInteger)),this.consumeSpaceForRecord(e);const n=[];for(n.push(this.extract(e,this.consumeToken));"/"===e.value[e.cur];)e.cur+=1,n.push(this.extract(e,this.consumeToken));if(0===n.length)throw new Error("Invalid proto");const r=this.parseFmt(e);return this.currentLine++,{mediaType:t,port:i,protos:n,fmts:r}}parseTimeFields(){const e=[];for(;this.getCurrentRecord().type===s.TIME;){const t=this.parseTime(),i=this.parseRepeat(),n=this.parseZone();e.push({time:t,repeats:i,zones:n})}return e}parseMediaDescription(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===s.MEDIA;){const t=this.parseMedia(),i=this.parseInformation(),n=this.parseConnections(),r=this.parseBandWidth(),o=this.parseKey(),s=this.parseMediaAttributes(t);e.push({media:t,information:i,connections:n,bandwidths:r,key:o,attributes:s})}return e}parseConnections(){const e=[];for(;this.currentLine<this.records.length&&this.getCurrentRecord().type===s.CONNECTION;)e.push(this.parseConnection());return e}parseFmt(e){const t=[];for(;;)try{this.consumeSpaceForRecord(e),t.push(this.extract(e,this.consumeToken))}catch(e){break}if(0===t.length)throw new Error("Invalid fmts");return t}extract(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];const o=t.call(this,e.value,e.cur,...n),s=e.value.slice(e.cur,o);return e.cur=o,s}extractOneOrMore(e,t){const i=this.consumeOneOrMore(e.value,e.cur,t),n=e.value.slice(e.cur,i);return e.cur=i,n}consumeSpaceForRecord(e){if(e.value[e.cur]!==o)throw new Error("Invalid space at ".concat(e.cur,"."));e.cur+=1}}class S extends y{constructor(){super(...arguments),b(this,"attributes",void 0),b(this,"digested",!1)}extractOneOrMore(e,t,i){const n=this.consumeOneOrMore(e.attValue,e._cur,t),r=e.attValue.slice(e._cur,n),[o,s]=i||[];if("number"==typeof o&&r.length<o)throw new Error("error in length, should be more or equal than ".concat(o," characters."));if("number"==typeof s&&r.length>s)throw new Error("error in length, should be less or equal than ".concat(s," characters."));return e._cur=n,r}consumeAttributeSpace(e){if(e.attValue[e._cur]!==o)throw new Error("Invalid space at ".concat(e._cur,"."));e._cur+=1}extract(e,t){if(!e.attValue)throw new Error("Nothing to extract from attValue.");for(var i=arguments.length,n=new Array(i>2?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];const o=t.call(this,e.attValue,e._cur,...n),s=e.attValue.slice(e._cur,o);return e._cur=o,s}atEnd(e){if(!e.attValue)throw new Error;return e._cur>=e.attValue.length}peekChar(e){if(!e.attValue)throw new Error;return e.attValue[e._cur]}peek(e,t){if(!e.attValue)throw new Error;for(let i=0;i<t.length;i++)if(t[i]!==e.attValue[e._cur+i])return!1;return!0}parseIceUfrag(e){if(this.attributes.iceUfrag)throw new Error("Invalid ice-ufrag, should be only a single line if 'a=ice-ufrag'");this.attributes.iceUfrag=this.extractOneOrMore(e,m,[4,256])}parseIcePwd(e){if(this.attributes.icePwd)throw new Error("Invalid ice-pwd, should be only a single line if 'a=ice-pwd'");this.attributes.icePwd=this.extractOneOrMore(e,m,[22,256])}parseIceOptions(e){if(this.attributes.iceOptions)throw new Error("Invalid ice-options, should be only one 'ice-options' line");const t=[];for(;!this.atEnd(e);){t.push(this.extractOneOrMore(e,m));try{this.consumeAttributeSpace(e)}catch(t){if(this.atEnd(e))break;throw t}}this.attributes.iceOptions=t}parseFingerprint(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const i=this.extract(e,this.consumeTill);this.attributes.fingerprints.push({hashFunction:t,fingerprint:i})}parseExtmap(e){const t=this.extractOneOrMore(e,a);let i;"/"===this.peekChar(e)&&(this.extract(e,this.consume,"/"),i=this.extract(e,this.consumeToken)),this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeTill,o),r=E(E({entry:parseInt(t,10)},i&&{direction:i}),{},{extensionName:n});this.peekChar(e)===o&&(this.consumeAttributeSpace(e),r.extensionAttributes=this.extract(e,this.consumeTill)),this.attributes.extmaps.push(r)}parseSetup(e){if(this.attributes.setup)throw new Error("must only be one single 'a=setup' line.");const t=this.extract(e,this.consumeTill);if("active"!==t&&"passive"!==t&&"actpass"!==t&&"holdconn"!==t)throw new Error("role must be one of 'active', 'passive', 'actpass', 'holdconn'.");this.attributes.setup=t}}class T extends S{constructor(){super(...arguments),b(this,"attributes",{unrecognized:[],groups:[],extmaps:[],fingerprints:[],identities:[]})}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"group":this.parseGroup(e);break;case"ice-lite":this.parseIceLite();break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"fingerprint":this.parseFingerprint(e);break;case"setup":this.parseSetup(e);break;case"tls-id":this.parseTlsId(e);break;case"identity":this.parseIdentity(e);break;case"extmap":this.parseExtmap(e);break;case"msid-semantic":this.parseMsidSemantic(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing session attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}digest(){return this.digested=!0,this.attributes}parseGroup(e){const t=this.extract(e,this.consumeToken),i=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;)this.consumeAttributeSpace(e),i.push(this.extract(e,this.consumeToken));this.attributes.groups.push({semantic:t,identificationTag:i})}parseIceLite(){if(this.attributes.iceLite)throw new Error("Invalid ice-lite, should be only a single line of 'a=ice-lite'");this.attributes.iceLite=!0}parseTlsId(e){if(this.attributes.tlsId)throw new Error("must be only one tld-id line");this.attributes.tlsId=this.extractOneOrMore(e,_)}parseIdentity(e){const t=this.extractOneOrMore(e,g),i=[];for(;!this.atEnd(e)&&this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.extract(e,this.consume,"=");const n=this.extractOneOrMore(e,(e=>e!==o&&p(e)));i.push({name:t,value:n})}this.attributes.identities.push({assertionValue:t,extensions:i})}parseMsidSemantic(e){this.peekChar(e)===o&&this.consumeAttributeSpace(e);const t={semantic:this.extract(e,this.consumeToken),identifierList:[]};for(;;){try{this.consumeAttributeSpace(e)}catch(e){break}if("*"===this.peekChar(e)){this.extract(e,this.consume,"*"),t.applyForAll=!0;break}{const i=this.extract(e,this.consumeTill,o);t.identifierList.push(i)}}this.attributes.msidSemantic=t}}class R extends S{constructor(e){super(),b(this,"attributes",void 0),-1!==e.protos.indexOf("RTP")||e.protos.indexOf("rtp"),this.attributes={unrecognized:[],candidates:[],extmaps:[],fingerprints:[],imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[]}}parse(e){if(this.digested)throw new Error("already digested");try{switch(e.attField){case"extmap":this.parseExtmap(e);break;case"setup":this.parseSetup(e);break;case"ice-ufrag":this.parseIceUfrag(e);break;case"ice-pwd":this.parseIcePwd(e);break;case"ice-options":this.parseIceOptions(e);break;case"candidate":this.parseCandidate(e);break;case"remote-candidate":this.parseRemoteCandidate(e);break;case"end-of-candidates":this.parseEndOfCandidates();break;case"fingerprint":this.parseFingerprint(e);break;case"rtpmap":this.parseRtpmap(e);break;case"ptime":this.parsePtime(e);break;case"maxptime":this.parseMaxPtime(e);break;case"sendrecv":case"recvonly":case"sendonly":case"inactive":this.parseDirection(e);break;case"ssrc":this.parseSSRC(e);break;case"fmtp":this.parseFmtp(e);break;case"rtcp-fb":this.parseRtcpFb(e);break;case"rtcp-mux":this.parseRTCPMux();break;case"rtcp-mux-only":this.parseRTCPMuxOnly();break;case"rtcp-rsize":this.parseRTCPRsize();break;case"rtcp":this.parseRTCP(e);break;case"mid":this.parseMid(e);break;case"msid":this.parseMsid(e);break;case"imageattr":this.parseImageAttr(e);break;case"rid":this.parseRid(e);break;case"simulcast":this.parseSimulcast(e);break;case"sctp-port":this.parseSctpPort(e);break;case"max-message-size":this.parseMaxMessageSize(e);break;case"ssrc-group":this.parseSSRCGroup(e);break;default:e.ignored=!0,this.attributes.unrecognized.push(e)}}catch(t){throw console.error("parsing media attribute ".concat(e.attField,' error, "a=').concat(e.attField,":").concat(e.attValue,'"')),t}if(!e.ignored&&e.attValue&&!this.atEnd(e))throw new Error("attribute parsing error")}parseCandidate(e){const t=this.extractOneOrMore(e,m,[1,32]);this.consumeAttributeSpace(e);const i=this.extractOneOrMore(e,a,[1,5]);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const r=this.extractOneOrMore(e,a,[1,10]);this.consumeAttributeSpace(e);const s=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const u=this.extract(e,this.consumePort);this.consumeAttributeSpace(e),this.extract(e,this.consume,"typ"),this.consumeAttributeSpace(e);const d={foundation:t,componentId:i,transport:n,priority:r,connectionAddress:s,port:u,type:this.extract(e,this.consumeToken),extension:{}};for(this.peek(e," raddr")&&(this.extract(e,this.consume," raddr"),this.consumeAttributeSpace(e),d.relAddr=this.extract(e,this.consumeAddress)),this.peek(e," rport")&&(this.extract(e,this.consume," rport"),this.consumeAttributeSpace(e),d.relPort=this.extract(e,this.consumePort));this.peekChar(e)===o;){this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e),d.extension[t]=this.extractOneOrMore(e,c)}this.attributes.candidates.push(d)}parseRemoteCandidate(e){const t=[];for(;;){const i=this.extractOneOrMore(e,a,[1,5]);this.consumeAttributeSpace(e);const n=this.extract(e,this.consumeAddress);this.consumeAttributeSpace(e);const r=this.extract(e,this.consumePort);t.push({componentId:i,connectionAddress:n,port:r});try{this.consumeAttributeSpace(e)}catch(e){break}}this.attributes.remoteCandidatesList.push(t)}parseEndOfCandidates(){if(this.attributes.endOfCandidates)throw new Error("must be only one line of end-of-candidates");this.attributes.endOfCandidates=!0}parseRtpmap(e){const t=this.extract(e,this.consumeToken);this.consumeAttributeSpace(e);const i=this.extract(e,this.consumeTill,"/");this.extract(e,this.consume,"/");const n={encodingName:i,clockRate:this.extractOneOrMore(e,a)};this.atEnd(e)||"/"!==this.peekChar(e)||(this.extract(e,this.consume,"/"),n.encodingParameters=parseInt(this.extract(e,this.consumeTill),10));const r=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));r?r.rtpMap=n:this.attributes.payloads.push({payloadType:parseInt(t,10),rtpMap:n,rtcpFeedbacks:[]})}parsePtime(e){if(this.attributes.ptime)throw new Error("must be only one line of ptime");this.attributes.ptime=this.extract(e,this.consumeTill)}parseMaxPtime(e){if(this.attributes.maxPtime)throw new Error("must be only one line of ptime");this.attributes.maxPtime=this.extract(e,this.consumeTill)}parseDirection(e){if(this.attributes.direction)throw new Error("must be only one line of direction info");this.attributes.direction=e.attField}parseSSRC(e){const t=this.extractOneOrMore(e,a);this.consumeAttributeSpace(e);const i=this.extract(e,this.consumeTill,":");let n;":"===this.peekChar(e)&&(this.extract(e,this.consume,":"),n=this.extract(e,this.consumeTill));const r=this.attributes.ssrcs.find((e=>e.ssrcId===parseInt(t,10)));r?r.attributes[i]=n:this.attributes.ssrcs.push({ssrcId:parseInt(t,10),attributes:{[i]:n}})}parseFmtp(e){const t=this.extract(e,this.consumeTill,o);this.consumeAttributeSpace(e);const i=this.extract(e,this.consumeTill),n={};i.split(";").forEach((e=>{let[t,i]=e.split("=");t=t.trim();const r="string"==typeof i?i.trim():null;"string"==typeof t&&t.length>0&&(n[t]=r)}));const r=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));r?r.fmtp={parameters:n}:this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[],fmtp:{parameters:n}})}parseFmtParameters(e){const t={},i=this.extract(e,this.consumeTill,"=");e._cur++;const n=this.extract(e,this.consumeTill,";");for(t[i]=n;";"===e.attValue[e._cur];){const i=this.extract(e,this.consumeTill,"=");e._cur++;const n=this.extract(e,this.consumeTill,";");t[i]=n}return t}parseRtcpFb(e){let t="";t="*"===this.peekChar(e)?this.extract(e,this.consume,"*"):this.extract(e,this.consumeTill,o),this.consumeAttributeSpace(e);const i=this.extract(e,this.consumeTill,o);let n;if("trr-int"===i)n={type:i,interval:this.extract(e,this.consumeTill)};else{const t={type:i};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.parameter=this.extract(e,this.consumeToken),this.peekChar(e)===o&&(t.additional=this.extract(e,this.consumeTill))),n=t}if("*"===t)this.attributes.rtcpFeedbackWildcards.push(n);else{const e=this.attributes.payloads.find((e=>e.payloadType===parseInt(t,10)));e?e.rtcpFeedbacks.push(n):this.attributes.payloads.push({payloadType:parseInt(t,10),rtcpFeedbacks:[n]})}}parseRTCPMux(){if(this.attributes.rtcpMux)throw new Error("must be single line of rtcp-mux");this.attributes.rtcpMux=!0}parseRTCPMuxOnly(){if(this.attributes.rtcpMuxOnly)throw new Error("must be single line of rtcp-only");this.attributes.rtcpMuxOnly=!0}parseRTCPRsize(){if(this.attributes.rtcpRsize)throw new Error("must be single line of rtcp-rsize");this.attributes.rtcpRsize=!0}parseRTCP(e){if(this.attributes.rtcp)throw new Error("must be single line of rtcp");const t={port:this.extract(e,this.consumePort)};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.netType=this.extractOneOrMore(e,d),this.consumeAttributeSpace(e),t.addressType=this.extractOneOrMore(e,d),this.consumeAttributeSpace(e),t.address=this.extract(e,this.consumeAddress)),this.attributes.rtcp=t}parseMsid(e){const t={id:this.extractOneOrMore(e,d,[1,64])};this.peekChar(e)===o&&(this.consumeAttributeSpace(e),t.appdata=this.extractOneOrMore(e,d,[1,64])),this.attributes.msids.push(t)}parseImageAttr(e){this.attributes.imageattr.push(e.attValue)}parseRid(e){const t=this.extractOneOrMore(e,(e=>h(e)||a(e)||"_"===e||"-"===e));this.consumeAttributeSpace(e);const i={id:t,direction:this.extract(e,this.consumeToken),params:[]};if(this.peekChar(e)===o){if(this.consumeAttributeSpace(e),this.peek(e,"pt=")){this.extract(e,this.consume,"pt=");const t=[];for(;;){const i=this.extract(e,this.consumeToken);t.push(i);try{this.extract(e,this.consume,",")}catch(e){break}}i.payloads=t,this.peekChar(e)===o&&this.extract(e,this.consume,o)}for(;;){const t=this.extract(e,this.consumeToken);switch(t){case"depend":{const n={type:t,rids:this.extract(e,this.consume,"=").split(",")};i.params.push(n);break}default:{const n={type:t};"="===this.peekChar(e)&&(this.extract(e,this.consume,"="),n.val=this.extract(e,this.consumeTill,";")),i.params.push(n)}}try{this.extract(e,this.consume,";")}catch(e){break}}}this.attributes.rids.push(i)}parseSimulcast(e){if(this.attributes.simulcast)throw new Error("must be single line of simulcast");this.attributes.simulcast=e.attValue,this.extract(e,this.consumeTill)}parseSctpPort(e){this.attributes.sctpPort=this.extractOneOrMore(e,a,[1,5])}parseMaxMessageSize(e){this.attributes.maxMessageSize=this.extractOneOrMore(e,a,[1,void 0])}digest(){return this.digested=!0,this.attributes}parseMid(e){this.attributes.mid=this.extract(e,this.consumeToken)}parseSSRCGroup(e){const t=this.extract(e,this.consumeToken),i=[];for(;;)try{this.consumeAttributeSpace(e);const t=this.extract(e,this.consumeInteger);i.push(parseInt(t,10))}catch(e){break}this.attributes.ssrcGroups.push({semantic:t,ssrcIds:i})}}function C(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class I{constructor(){C(this,"eol",r)}print(e,t){let i="";return t&&(this.eol=t),i+=this.printVersion(e.version),i+=this.printOrigin(e.origin),i+=this.printSessionName(e.sessionName),i+=this.printInformation(e.information),i+=this.printUri(e.uri),i+=this.printEmail(e.emails),i+=this.printPhone(e.phones),i+=this.printConnection(e.connection),i+=this.printBandwidth(e.bandwidths),i+=this.printTimeFields(e.timeFields),i+=this.printKey(e.key),i+=this.printSessionAttributes(e.attributes),i+=this.printMediaDescription(e.mediaDescriptions),i}printVersion(e){return"v=".concat(e).concat(this.eol)}printOrigin(e){return"o=".concat(e.username," ").concat(e.sessId," ").concat(e.sessVersion," ").concat(e.nettype," ").concat(e.addrtype," ").concat(e.unicastAddress).concat(this.eol)}printSessionName(e){return e?"s=".concat(e).concat(this.eol):""}printInformation(e){return e?"i=".concat(e).concat(this.eol):""}printUri(e){return e?"u=".concat(e).concat(this.eol):""}printEmail(e){let t="";for(const i of e)t+="e=".concat(i).concat(this.eol);return t}printPhone(e){let t="";for(const i of e)t+="e=".concat(i).concat(this.eol);return t}printConnection(e){return e?"c=".concat(e.nettype," ").concat(e.addrtype," ").concat(e.address).concat(this.eol):""}printBandwidth(e){let t="";for(const i of e)t+="b=".concat(i.bwtype,":").concat(i.bandwidth).concat(this.eol);return t}printTimeFields(e){let t="";for(const i of e){t+="t=".concat(i.time.startTime," ").concat(i.time.startTime).concat(this.eol);for(const e of i.repeats)t+="r=".concat(e.repeatInterval," ").concat(e.typedTimes.join(" ")).concat(this.eol);i.zoneAdjustments&&(t+="z=",t+="z=".concat(i.zoneAdjustments.map((e=>"".concat(e.time," ").concat(e.back?"-":""," ").concat(e.typedTime))).join(" ")).concat(this.eol),t+=this.eol)}return t}printKey(e){return e?"k=".concat(e).concat(this.eol):""}printAttributes(e){let t="";for(const i of e)t+="a=".concat(i.attField).concat(i.attValue?":".concat(i.attValue):"").concat(this.eol);return t}printMediaDescription(e){let t="";for(const i of e)t+=this.printMedia(i.media),t+=this.printInformation(i.information),t+=this.printConnections(i.connections),t+=this.printBandwidth(i.bandwidths),t+=this.printKey(i.key),t+=this.printMediaAttributes(i);return t}printConnections(e){let t="";for(const i of e)t+=this.printConnection(i);return t}printMedia(e){return"m=".concat(e.mediaType," ").concat(e.port," ").concat(e.protos.join("/")," ").concat(e.fmts.join(" ")).concat(this.eol)}printSessionAttributes(e){return new O(this.eol).print(e)}printMediaAttributes(e){return new M(this.eol).print(e)}}class A{constructor(e){C(this,"eol",void 0),this.eol=e}printIceUfrag(e){return void 0===e?"":"a=ice-ufrag:".concat(e).concat(this.eol)}printIcePwd(e){return void 0===e?"":"a=ice-pwd:".concat(e).concat(this.eol)}printIceOptions(e){return void 0===e?"":"a=ice-options:".concat(e.join(o)).concat(this.eol)}printFingerprints(e){return e.length>0?e.map((e=>"a=fingerprint:".concat(e.hashFunction).concat(o).concat(e.fingerprint))).join(this.eol)+this.eol:""}printExtmap(e){return e.map((e=>"a=extmap:".concat(e.entry).concat(e.direction?"/".concat(e.direction):"").concat(o).concat(e.extensionName).concat(e.extensionAttributes?"".concat(o).concat(e.extensionAttributes):"").concat(this.eol))).join("")}printSetup(e){return void 0===e?"":"a=setup:".concat(e).concat(this.eol)}printUnrecognized(e){return e.map((e=>"a=".concat(e.attField).concat(e.attValue?":".concat(e.attValue):"").concat(this.eol))).join("")}}class O extends A{print(e){let t="";return t+=this.printGroups(e.groups),t+=this.printMsidSemantic(e.msidSemantic),t+=this.printIceLite(e.iceLite),t+=this.printIceUfrag(e.iceUfrag),t+=this.printIcePwd(e.icePwd),t+=this.printIceOptions(e.iceOptions),t+=this.printFingerprints(e.fingerprints),t+=this.printSetup(e.setup),t+=this.printTlsId(e.tlsId),t+=this.printIdentity(e.identities),t+=this.printExtmap(e.extmaps),t+=this.printUnrecognized(e.unrecognized),t}printGroups(e){let t="";return e.length>0&&(t+=e.map((e=>"a=group:".concat(e.semantic).concat(e.identificationTag.map((e=>"".concat(o).concat(e))).join("")).concat(this.eol))).join("")),t}printIceLite(e){return void 0===e?"":"a=ice-lite"+this.eol}printTlsId(e){return e?"a=tls-id:".concat(e).concat(this.eol):""}printIdentity(e){return 0===e.length?"":e.map((e=>"a=identity:".concat(e.assertionValue).concat(e.extensions.map((e=>"".concat(o).concat(e.name).concat(e.value?"=".concat(e.value):"")))))).join(this.eol)+this.eol}printMsidSemantic(e){if(!e)return"";let t="a=msid-semantic:".concat(e.semantic);return e.applyForAll?t+="".concat(o,"*"):e.identifierList.length>0&&(t+=e.identifierList.map((e=>"".concat(o).concat(e)))),t+this.eol}}class M extends A{print(e){const t=e.attributes;let i="";return i+=this.printRTCP(t.rtcp),i+=this.printIceUfrag(t.iceUfrag),i+=this.printIcePwd(t.icePwd),i+=this.printIceOptions(t.iceOptions),i+=this.printCandidates(t.candidates),i+=this.printRemoteCandidatesList(t.remoteCandidatesList),i+=this.printEndOfCandidates(t.endOfCandidates),i+=this.printFingerprints(t.fingerprints),i+=this.printSetup(t.setup),i+=this.printMid(t.mid),i+=this.printExtmap(t.extmaps),i+=this.printRTPRelated(t),i+=this.printPtime(t.ptime),i+=this.printMaxPtime(t.maxPtime),i+=this.printDirection(t.direction),i+=this.printSSRCGroups(t.ssrcGroups),i+=this.printSSRC(t.ssrcs),i+=this.printRTCPMux(t.rtcpMux),i+=this.printRTCPMuxOnly(t.rtcpMuxOnly),i+=this.printRTCPRsize(t.rtcpRsize),i+=this.printMSId(t.msids),i+=this.printImageattr(t.imageattr),i+=this.printRid(t.rids),i+=this.printSimulcast(t.simulcast),i+=this.printSCTPPort(t.sctpPort),i+=this.printMaxMessageSize(t.maxMessageSize),i+=this.printUnrecognized(t.unrecognized),i}printCandidates(e){return e.map((e=>"a=candidate:".concat(e.foundation).concat(o).concat(e.componentId).concat(o).concat(e.transport).concat(o).concat(e.priority).concat(o).concat(e.connectionAddress).concat(o).concat(e.port).concat(o,"typ").concat(o).concat(e.type).concat(e.relAddr?"".concat(o,"raddr").concat(o).concat(e.relAddr):"").concat(e.relPort?"".concat(o,"rport").concat(o).concat(e.relPort):"").concat(Object.keys(e.extension).map((t=>"".concat(o).concat(t).concat(o).concat(e.extension[t]))).join("")).concat(this.eol))).join("")}printRemoteCandidatesList(e){return e.map((e=>"a=remote-candidates:".concat(e.join(o)).concat(this.eol))).join("")}printEndOfCandidates(e){return void 0===e?"":"a=end-of-candidates"+this.eol}printRTPRelated(e){if(!e.payloads)return"";const t=e.payloads;let i="";i+=e.rtcpFeedbackWildcards.map((e=>this.printRTCPFeedback("*",e))).join("");for(const n of t)i+=this.printRtpMap(n.payloadType,n.rtpMap),i+=this.printFmtp(n.payloadType,n.fmtp),i+=n.rtcpFeedbacks.map((e=>this.printRTCPFeedback(n.payloadType,e))).join("");return i}printFmtp(e,t){if(!t)return"";const i=Object.keys(t.parameters);return 1===i.length&&null===t.parameters[i[0]]?"a=fmtp:".concat(e).concat(o).concat(i[0]).concat(this.eol):"a=fmtp:".concat(e).concat(o).concat(Object.keys(t.parameters).map((e=>"".concat(e,"=").concat(t.parameters[e]))).join(";")).concat(this.eol)}printRtpMap(e,t){return t?"a=rtpmap:".concat(e).concat(o).concat(t.encodingName,"/").concat(t.clockRate).concat(t.encodingParameters?"/".concat(t.encodingParameters):"").concat(this.eol):""}printRTCPFeedback(e,t){let i="a=rtcp-fb:".concat(e).concat(o),n=t;return"trr-int"===n.type?i+="ttr-int".concat(o).concat(n.interval):(i+="".concat(n.type),n.parameter&&(i+="".concat(o).concat(n.parameter),n.additional&&(i+="".concat(o).concat(n.additional)))),i+this.eol}printPtime(e){return void 0===e?"":"a=ptime:".concat(e).concat(this.eol)}printMaxPtime(e){return void 0===e?"":"a=maxptime:".concat(e).concat(this.eol)}printDirection(e){return void 0===e?"":"a=".concat(e).concat(this.eol)}printSSRC(e){return e.map((e=>Object.keys(e.attributes).map((t=>"a=ssrc:".concat(e.ssrcId.toString(10)).concat(o).concat(t).concat(e.attributes[t]?":".concat(e.attributes[t]):"").concat(this.eol))).join(""))).join("")}printRTCPMux(e){return void 0===e?"":"a=rtcp-mux".concat(this.eol)}printRTCPMuxOnly(e){return void 0===e?"":"a=rtcp-mux-only".concat(this.eol)}printRTCPRsize(e){return void 0===e?"":"a=rtcp-rsize".concat(this.eol)}printRTCP(e){if(void 0===e)return"";let t="a=rtcp:".concat(e.port);return e.netType&&(t+="".concat(o).concat(e.netType)),e.addressType&&(t+="".concat(o).concat(e.addressType)),e.address&&(t+="".concat(o).concat(e.address)),t+this.eol}printMSId(e){return e.map((e=>"a=msid:".concat(e.id).concat(e.appdata?"".concat(o).concat(e.appdata):"").concat(this.eol))).join("")}printImageattr(e){return e.map((e=>"a=imageattr:".concat(e).concat(this.eol))).join("")}printRid(e){return e.map((e=>{let t="a=rid:".concat(e.id).concat(o).concat(e.direction);return e.payloads&&(t+="".concat(o,"pt=").concat(e.payloads.join(","))),e.params.length>0&&(t+="".concat(o).concat(e.params.map((e=>"depend"===e.type?"depend=".concat(e.rids.join(",")):"".concat(e.type,"=").concat(e.val))).join(";"))),t+this.eol})).join("")}printSimulcast(e){return void 0===e?"":"a=simulcast:".concat(e).concat(this.eol)}printSCTPPort(e){return void 0===e?"":"a=sctp-port:".concat(e).concat(this.eol)}printMaxMessageSize(e){return void 0===e?"":"a=max-message-size:".concat(e).concat(this.eol)}printMid(e){return void 0===e?"":"a=mid:".concat(e).concat(this.eol)}printSSRCGroups(e){return e.map((e=>"a=ssrc-group:".concat(e.semantic).concat(e.ssrcIds.map((e=>"".concat(o).concat(e.toString(10)))).join("")).concat(this.eol))).join("")}}function N(e){return(new w).parse(e)}function k(e,t){return(new I).print(e,t)}}},t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={exports:{}};return e[n](r,r.exports,i),r.exports}return i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i(8)})()}(zk);var Yk=zk.exports;function Jk(e){if(Array.isArray(e))return e.map((e=>e));if(!Xk(e))return e;const t={};for(const i in e){const n=e[i];Xk(n)||Array.isArray(n)?t[i]=Jk(n):t[i]=n}return t}function Xk(e){return!("object"!=typeof e||Array.isArray(e)||!e)}class Qk{constructor(e){oh(this,"input",[]),oh(this,"size",void 0),this.size=e}add(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)}diffMean(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length}}const Zk={address:"unknown",candidateType:"unknown",id:"unknown",port:0,priority:0,protocol:"unknown",type:"unknown"},$k={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[],selectedCandidatePair:{id:"unknown",localCandidate:Zk,remoteCandidate:Zk}},eP={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,qpSumPerFrame:0},tP={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0,qpSumPerFrame:0},iP={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0,jitterMs:0},nP={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0,concealedSamples:0};function rP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function oP(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?rP(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):rP(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class sP{constructor(e,t){oh(this,"onFirstVideoReceived",void 0),oh(this,"onFirstVideoDecoded",void 0),oh(this,"onFirstAudioReceived",void 0),oh(this,"onFirstVideoDecodedTimeout",void 0),oh(this,"onFirstAudioDecoded",void 0),oh(this,"onSelectedLocalCandidateChanged",void 0),oh(this,"onSelectedRemoteCandidateChanged",void 0),oh(this,"videoIsReady",!1),oh(this,"videoIsReady2",{}),oh(this,"pc",void 0),oh(this,"options",void 0),oh(this,"intervalTimer",void 0),oh(this,"stats",Jk($k)),oh(this,"isFirstVideoReceived",{}),oh(this,"isFirstVideoDecoded",{}),oh(this,"isFirstAudioReceived",{}),oh(this,"isFirstAudioDecoded",{}),oh(this,"isFirstVideoDecodedTimeout",{}),oh(this,"lossRateWindowStats",[]),this.pc=e,this.options=t,this.intervalTimer=window.setInterval((async()=>{this.updateStats()}),this.options.updateInterval)}getStats(){return this.stats}getSelectedCandidatePair(){return new nv((e=>{e({local:oP({},Zk),remote:oP({},Zk)})}))}setVideoIsReady(e){this.videoIsReady=e}setVideoIsReady2(e,t){this.videoIsReady2[e]=t}getVideoIsReady(e){return this.videoIsReady2[e]||!1}setIsFirstAudioDecoded(e){}destroy(){window.clearInterval(this.intervalTimer),this.pc=void 0}calcLossRate(e){this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);const t=this.lossRateWindowStats.length,i=["videoSend","audioSend","videoRecv","audioRecv"];let n=0,r=0,o=0,s=0;for(const a of i)e[a].forEach(((e,i)=>{if(!this.lossRateWindowStats[t-1][a][i]||!this.lossRateWindowStats[0][a][i])return;const c=this.lossRateWindowStats[t-1][a][i].packets-this.lossRateWindowStats[0][a][i].packets,u=this.lossRateWindowStats[t-1][a][i].packetsLost-this.lossRateWindowStats[0][a][i].packetsLost;"videoSend"===a||"audioSend"===a?(n+=c,o+=u):(r+=c,s+=u),Number.isNaN(c)||Number.isNaN(c)?e.packetLostRate=0:e.packetLostRate=c<=0||u<=0?0:u/(c+u)}));e.sendPacketLossRate=n<=0||o<=0?0:o/(n+o),e.recvPacketLossRate=r<=0||s<=0?0:s/(r+s)}}function aP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function cP(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?aP(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):aP(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class uP extends sP{constructor(){super(...arguments),oh(this,"_stats",$k),oh(this,"lastDecodeVideoReceiverStats",new Map)}async updateStats(){const e=await this._getStats(),t=this.statsResponsesToObjects(e);this._stats=Jk($k);const i=t.filter((e=>"ssrc"===e.type));this.processSSRCStats(i);const n=t.find((e=>"VideoBwe"===e.type));n&&this.processBandwidthStats(n),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}processBandwidthStats(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)}processSSRCStats(e){e.forEach((e=>{var t;const i=Mn(t=e.id).call(t,"send");switch("".concat(e.mediaType,"_").concat(i?"send":"recv")){case"video_send":{const t=Jk(tP);t.codec=e.googCodecName,t.adaptionChangeReason="none",e.googCpuLimitedResolution&&(t.adaptionChangeReason="cpu"),e.googBandwidthLimitedResolution&&(t.adaptionChangeReason="bandwidth"),t.avgEncodeMs=Number(e.googAvgEncodeMs),t.inputFrame={width:Number(e.googFrameWidthInput)||Number(e.googFrameWidthSent),height:Number(e.googFrameHeightInput)||Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},t.sentFrame={width:Number(e.googFrameWidthSent),height:Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},t.firsCount=Number(e.googFirReceived),t.nacksCount=Number(e.googNacksReceived),t.plisCount=Number(e.googPlisReceived),t.frameCount=Number(e.framesEncoded),t.bytes=Number(e.bytesSent),t.packets=Number(e.packetsSent),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.rttMs=Number(e.googRtt||0),this._stats.videoSend.push(t),this._stats.rtt=t.rttMs;break}case"video_recv":{const t=Jk(eP),i=this.lastDecodeVideoReceiverStats.get(Number(e.ssrc));if(t.codec=e.googCodecName,t.targetDelayMs=Number(e.googTargetDelayMs),t.renderDelayMs=Number(e.googRenderDelayMs),t.currentDelayMs=Number(e.googCurrentDelayMs),t.minPlayoutDelayMs=Number(e.googMinPlayoutDelayMs),t.decodeMs=Number(e.googDecodeMs),t.maxDecodeMs=Number(e.googMaxDecodeMs),t.receivedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateReceived)},t.decodedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateDecoded)},t.decodeFrameRate=Number(e.googFrameRateDecoded),t.outputFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateOutput)},t.jitterBufferMs=Number(e.googJitterBufferMs),t.firsCount=Number(e.googFirsSent),t.nacksCount=Number(e.googNacksSent),t.plisCount=Number(e.googPlisSent),t.framesDecodeCount=Number(e.framesDecoded),t.bytes=Number(e.bytesReceived),t.packets=Number(e.packetsReceived),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]&&(this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,t.decodedFrame.width,t.decodedFrame.height),this.isFirstVideoDecoded[t.ssrc]=!0),i){const n=i.stats,r=Date.now()-i.lts;t.framesDecodeFreezeTime=n.framesDecodeFreezeTime,t.framesDecodeInterval=n.framesDecodeInterval,t.framesDecodeCount>n.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(i.lts=Date.now(),t.framesDecodeInterval=r,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc,10))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<i.stats.framesDecodeCount&&(t.framesDecodeInterval=0)}this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:cP({},t),lts:Date.now()}),this._stats.videoRecv.push(t);break}case"audio_recv":{const t=Jk(nP);t.codec=e.googCodecName,t.outputLevel=Math.abs(Number(e.audioOutputLevel))/32767,t.decodingCNG=Number(e.googDecodingCNG),t.decodingCTN=Number(e.googDecodingCTN),t.decodingCTSG=Number(e.googDecodingCTSG),t.decodingNormal=Number(e.googDecodingNormal),t.decodingPLC=Number(e.googDecodingPLC),t.decodingPLCCNG=Number(e.googDecodingPLCCNG),t.expandRate=Number(e.googExpandRate),t.accelerateRate=Number(e.googAccelerateRate),t.preemptiveExpandRate=Number(e.googPreemptiveExpandRate),t.secondaryDecodedRate=Number(e.googSecondaryDecodedRate),t.speechExpandRate=Number(e.googSpeechExpandRate),t.preferredJitterBufferMs=Number(e.googPreferredJitterBufferMs),t.jitterBufferMs=Number(e.googJitterBufferMs),t.jitterMs=Number(e.googJitterReceived),t.bytes=Number(e.bytesReceived),t.packets=Number(e.packetsReceived),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.receivedFrames=Number(e.googDecodingCTN)||Number(e.packetsReceived),t.droppedFrames=Number(e.googDecodingPLC)+Number(e.googDecodingPLCCNG)||Number(e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.decodingNormal>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),this._stats.audioRecv.push(t);break}case"audio_send":{const t=Jk(iP);t.codec=e.googCodecName,t.inputLevel=Math.abs(Number(e.audioInputLevel))/32767,t.aecReturnLoss=Number(e.googEchoCancellationReturnLoss||0),t.aecReturnLossEnhancement=Number(e.googEchoCancellationReturnLossEnhancement||0),t.residualEchoLikelihood=Number(e.googResidualEchoLikelihood||0),t.residualEchoLikelihoodRecentMax=Number(e.googResidualEchoLikelihoodRecentMax||0),t.bytes=Number(e.bytesSent),t.packets=Number(e.packetsSent),t.packetsLost=Number(e.packetsLost),t.ssrc=Number(e.ssrc),t.rttMs=Number(e.googRtt||0),this._stats.rtt=t.rttMs,this._stats.audioSend.push(t);break}}}))}_getStats(){return new nv(((e,t)=>{this.pc.getStats(e,t)}))}statsResponsesToObjects(e){const t=[];return e.result().forEach((e=>{const i={id:e.id,timestamp:e.timestamp.valueOf().toString(),type:e.type};e.names().forEach((t=>{i[t]=e.stat(t)})),t.push(i)})),t}}function dP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function lP(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?dP(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):dP(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class hP extends sP{constructor(){super(...arguments),oh(this,"_stats",$k),oh(this,"report",void 0),oh(this,"lastDecodeVideoReceiverStats",new Map),oh(this,"lastVideoFramesRecv",new Map),oh(this,"lastVideoFramesSent",new Map),oh(this,"lastVideoFramesDecode",new Map),oh(this,"lastVideoJBDelay",new Map),oh(this,"lastAudioJBDelay",new Map),oh(this,"mediaBytesSent",new Map),oh(this,"mediaBytesRetransmit",new Map),oh(this,"mediaBytesTargetEncode",new Map),oh(this,"lastEncoderMs",new Map)}async updateStats(){this.report=await this.pc.getStats(),this._stats=Jk($k),this.report.forEach((e=>{switch(e.type){case pS.OUTBOUND:case pS.INBOUND:{const t=e.mediaType||e.kind,i=!t&&"frameWidth"in e,n=!t&&!("frameWidth"in e);e.type===pS.OUTBOUND?"audio"===t||n?this.processAudioOutboundStats(e):("video"===t||i)&&this.processVideoOutboundStats(e):e.type===pS.INBOUND&&("audio"===t||n?this.processAudioInboundStats(e):("video"===t||i)&&this.processVideoInboundStats(e));break}case pS.TRANSPORT:{const t=this.report.get(e.selectedCandidatePairId);t&&this.processCandidatePairStats(t);break}case pS.CANDIDATE_PAIR:e.selected&&this.processCandidatePairStats(e)}})),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats}async getSelectedCandidatePair(){const e=await this.pc.getStats(),t={local:lP({},Zk),remote:lP({},Zk)};return e.forEach((i=>{let n;if(i.type===pS.TRANSPORT&&(n=e.get(i.selectedCandidatePairId)),i.type===pS.CANDIDATE_PAIR&&i.selected&&(n=i),n){const i=(e,t)=>{e.type=t.type,e.id=t.id,t.address&&(e.address=t.address),t.candidateType&&(e.candidateType=t.candidateType),t.port&&(e.port=t.port),t.priority&&(e.priority=t.priority),t.protocol&&(e.protocol=t.protocol),t.relayProtocol&&(e.relayProtocol=t.relayProtocol)};if(n.localCandidateId){const r=e.get(n.localCandidateId);r&&i(t.local,r)}if(n.remoteCandidateId){const r=e.get(n.remoteCandidateId);r&&i(t.remote,r)}}})),t}processCandidatePairStats(e){if(this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach((t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.audioSend.forEach((t=>{e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.selectedCandidatePair.id=e.id,e.localCandidateId){const t=this.report.get(e.localCandidateId);t&&this.processCandidateStats(t)}if(e.remoteCandidateId){const t=this.report.get(e.remoteCandidateId);t&&this.processCandidateStats(t)}}processCandidateStats(e){let t;e.type===pS.LOCAL_CANDIDATE&&(t=this._stats.selectedCandidatePair.localCandidate),e.type===pS.REMOTE_CANDIDATE&&(t=this._stats.selectedCandidatePair.remoteCandidate),t&&(t.type=e.type,t.id=e.id,e.address&&(t.address=e.address),e.candidateType&&(t.candidateType=e.candidateType),e.port&&(t.port=e.port),e.priority&&(t.priority=e.priority),e.protocol&&(t.protocol=e.protocol),e.relayProtocol&&(t.relayProtocol=e.relayProtocol),e.type===pS.LOCAL_CANDIDATE&&this.stats.selectedCandidatePair.localCandidate.id!==t.id&&this.onSelectedLocalCandidateChanged&&this.onSelectedLocalCandidateChanged(lP({},t),lP({},this.stats.selectedCandidatePair.localCandidate)),e.type===pS.REMOTE_CANDIDATE&&this.stats.selectedCandidatePair.remoteCandidate.id!==t.id&&this.onSelectedRemoteCandidateChanged&&this.onSelectedRemoteCandidateChanged(lP({},t),lP({},this.stats.selectedCandidatePair.remoteCandidate)))}processAudioInboundStats(e){let t=this._stats.audioRecv.find((t=>t.ssrc===e.ssrc));t||(t=Jk(nP),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,this.processAudioTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),t.receivedFrames>0&&!this.isFirstAudioReceived[t.ssrc]&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(t.ssrc),this.isFirstAudioReceived[t.ssrc]=!0),t.outputLevel&&t.outputLevel>0&&!this.isFirstAudioDecoded[t.ssrc]&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(t.ssrc),this.isFirstAudioDecoded[t.ssrc]=!0),"number"==typeof e.concealedSamples&&(t.concealedSamples=e.concealedSamples)}processVideoInboundStats(e){let t=this._stats.videoRecv.find((t=>t.ssrc===e.ssrc));t||(t=Jk(eP),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded,t.totalInterFrameDelay=e.totalInterFrameDelay,t.totalSquaredInterFrameDelay=e.totalSquaredInterFrameDelay;const i=this.lastDecodeVideoReceiverStats.get(t.ssrc),n=this.lastVideoFramesDecode.get(t.ssrc),r=Date.now();if(t.framesDecodeCount>0&&!this.isFirstVideoDecoded[t.ssrc]){const e=t.decodedFrame?t.decodedFrame.width:0,i=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(t.ssrc,e,i),this.isFirstVideoDecoded[t.ssrc]=!0}if(i){const n=i.stats,o=r-i.lts;t.framesDecodeFreezeTime=n.framesDecodeFreezeTime,t.framesDecodeInterval=n.framesDecodeInterval,!this.isFirstVideoDecoded[t.ssrc]&&o>this.options.firstVideoDecodedTimeout&&!this.isFirstVideoDecodedTimeout[t.ssrc]&&(this.onFirstVideoDecodedTimeout&&this.onFirstVideoDecodedTimeout(t.ssrc),this.isFirstVideoDecodedTimeout[t.ssrc]=!0),t.framesDecodeCount>n.framesDecodeCount&&this.isFirstVideoDecoded[t.ssrc]?(i.lts=Date.now(),t.framesDecodeInterval=o,t.framesDecodeInterval>=this.options.freezeRateLimit&&(this.getVideoIsReady(parseInt(e.ssrc))?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady2(parseInt(e.ssrc,10),!0))):t.framesDecodeCount<n.framesDecodeCount&&(t.framesDecodeInterval=0),e.framesDecoded&&e.qpSum&&(i.stats.framesDecodeCount>e.framesDecoded?t.qpSumPerFrame=e.qpSum/e.framesDecoded:t.qpSumPerFrame=(e.qpSum-i.qpSum)/(e.framesDecoded-i.stats.framesDecodeCount))}n&&r-n.lts>=800?(t.decodeFrameRate=Math.round((t.framesDecodeCount-n.count)/((r-n.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:r,rate:t.decodeFrameRate})):n?t.decodeFrameRate=n.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:r,rate:0}),e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime),this.processVideoTrackReceiverStats(e,e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),t.packets>0&&!this.isFirstVideoReceived[t.ssrc]&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(t.ssrc),this.isFirstVideoReceived[t.ssrc]=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:lP({},t),lts:i?i.lts:Date.now(),qpSum:e.qpSum})}processVideoOutboundStats(e){let t=this._stats.videoSend.find((t=>t.ssrc===e.ssrc));t||(t=Jk(tP),this._stats.videoSend.push(t));const i=this.mediaBytesSent.get(e.ssrc);if(i)i.add(e.bytesSent);else{const t=new Qk(10);t.add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,t)}if(void 0!==e.retransmittedBytesSent){const t=this.mediaBytesRetransmit.get(e.ssrc);if(t)t.add(e.retransmittedBytesSent);else{const t=new Qk(10);t.add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,t)}}if(e.totalEncodedBytesTarget){const t=this.mediaBytesTargetEncode.get(e.ssrc);if(t)t.add(e.totalEncodedBytesTarget);else{const t=new Qk(10);t.add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,t)}}if(t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,t.scalabilityMode=e.scalabilityMode,e.totalEncodeTime&&e.framesEncoded){const i=this.lastEncoderMs.get(e.ssrc);if(!i||i.lastFrameCount>e.framesEncoded)t.avgEncodeMs=1e3*e.totalEncodeTime/e.framesEncoded;else{const n=e.framesEncoded-i.lastFrameCount,r=e.totalEncodeTime-i.lastEncoderTime;t.avgEncodeMs=1e3*r/n}}if(e.framesEncoded&&e.qpSum){const i=this.lastEncoderMs.get(e.ssrc);!i||i.lastFrameCount>e.framesEncoded?t.qpSumPerFrame=e.qpSum/e.framesEncoded:t.qpSumPerFrame=(e.qpSum-i.lastQpSum)/(e.framesEncoded-i.lastFrameCount)}if(this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lastQpSum:e.qpSum,lts:Date.now()}),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),this.processVideoTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const i=this.findRemoteStatsId(e.ssrc,pS.REMOTE_INBOUND);i&&this.processRemoteInboundStats(i,t)}}processAudioOutboundStats(e){let t=this._stats.audioSend.find((t=>t.ssrc===e.ssrc));if(t||(t=Jk(iP),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),this.processAudioTrackSenderStats(e,e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{const i=this.findRemoteStatsId(e.ssrc,pS.REMOTE_INBOUND);i&&this.processRemoteInboundStats(i,t)}}findRemoteStatsId(e,t){var i;const n=Array.from(US(i=this.report).call(i)).find((i=>i.type===t&&i.ssrc===e));return n?n.id:null}processVideoMediaSource(e,t){const i=this.report.get(e);i&&i.width&&i.height&&i.framesPerSecond&&(t.inputFrame={width:i.width,height:i.height,frameRate:i.framesPerSecond})}processAudioMediaSource(e,t){const i=this.report.get(e);i&&(t.inputLevel=i.audioLevel)}processVideoTrackSenderStats(e,t,i){var n,r,o,s;const a=t?this.report.get(t):void 0,c=null!==(n=null==a?void 0:a.framesSent)&&void 0!==n?n:e.framesSent;if("number"!=typeof c)return;let u=null!==(r=null==a?void 0:a.frameWidth)&&void 0!==r?r:e.frameWidth,d=null!==(o=null==a?void 0:a.frameHeight)&&void 0!==o?o:e.frameHeight,l=null!==(s=null==a?void 0:a.framesPerSecond)&&void 0!==s?s:e.framesPerSecond;if("number"==typeof u&&"number"==typeof d||(u=0,d=0),null==l){const e=Date.now(),t=this.lastVideoFramesSent.get(i.ssrc);t&&e-t.lts>=800?(l=Math.round((c-t.count)/((e-t.lts)/1e3)),this.lastVideoFramesSent.set(i.ssrc,{count:c,lts:e,rate:l})):t?l=t.rate:this.lastVideoFramesSent.set(i.ssrc,{count:c,lts:e,rate:0})}i.sentFrame={width:u,height:d,frameRate:Math.max(0,l)}}processVideoTrackReceiverStats(e,t,i){var n,r,o,s,a;const c=t?this.report.get(t):void 0,u=null!==(n=null==c?void 0:c.framesReceived)&&void 0!==n?n:e.framesReceived,d=null!==(r=null==c?void 0:c.frameWidth)&&void 0!==r?r:e.frameWidth,l=null!==(o=null==c?void 0:c.frameHeight)&&void 0!==o?o:e.frameHeight,h=null!==(s=null==c?void 0:c.jitterBufferDelay)&&void 0!==s?s:e.jitterBufferDelay,f=null!==(a=null==c?void 0:c.jitterBufferEmittedCount)&&void 0!==a?a:e.jitterBufferEmittedCount;if("number"==typeof u){const e=this.lastVideoFramesRecv.get(i.ssrc),t=Date.now();i.framesReceivedCount=u;let n=0;e&&t-e.lts>=800?(n=Math.round((u-e.count)/((t-e.lts)/1e3)),this.lastVideoFramesRecv.set(i.ssrc,{count:u,lts:t,rate:n})):e?n=e.rate:this.lastVideoFramesRecv.set(i.ssrc,{count:u,lts:t,rate:0}),i.receivedFrame={width:d||0,height:l||0,frameRate:n||0},i.decodedFrame={width:d||0,height:l||0,frameRate:i.decodeFrameRate||0},i.outputFrame={width:d||0,height:l||0,frameRate:i.decodeFrameRate||0}}if(h&&f){const e=this.lastVideoJBDelay.get(i.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let t=e.jitterBufferMs;const n=f-e.jitterBufferEmittedCount;n>0&&(t=1e3*(h-e.jitterBufferDelay)/n),i.jitterBufferMs=t,i.currentDelayMs=Math.round(t),this.lastVideoJBDelay.set(i.ssrc,{jitterBufferDelay:h,jitterBufferEmittedCount:f,jitterBufferMs:i.currentDelayMs})}}processAudioTrackSenderStats(e,t,i){var n,r,o,s;const a=t?this.report.get(t):void 0,c=null!==(n=null!==(r=null==a?void 0:a.echoReturnLoss)&&void 0!==r?r:e.echoReturnLoss)&&void 0!==n?n:0,u=null!==(o=null!==(s=null==a?void 0:a.echoReturnLossEnhancement)&&void 0!==s?s:e.echoReturnLossEnhancement)&&void 0!==o?o:0;i.aecReturnLoss=c,i.aecReturnLossEnhancement=u}processAudioTrackReceiverStats(e,t,i){var n,r,o,s,a,c,u;const d=t?this.report.get(t):void 0,l=null!==(n=null==d?void 0:d.removedSamplesForAcceleration)&&void 0!==n?n:e.removedSamplesForAcceleration,h=null!==(r=null==d?void 0:d.totalSamplesReceived)&&void 0!==r?r:e.totalSamplesReceived,f=null!==(o=null==d?void 0:d.jitterBufferDelay)&&void 0!==o?o:e.jitterBufferDelay,p=null!==(s=null==d?void 0:d.jitterBufferEmittedCount)&&void 0!==s?s:e.jitterBufferEmittedCount,m=null!==(a=null==d?void 0:d.audioLevel)&&void 0!==a?a:null==e?void 0:e.audioLevel,_=null!==(c=null==d?void 0:d.totalSamplesDuration)&&void 0!==c?c:null==e?void 0:e.totalSamplesDuration,g=null!==(u=null==d?void 0:d.concealedSamples)&&void 0!==u?u:e.concealedSamples;if(l&&h&&(i.accelerateRate=l/h),f&&p){const e=this.lastAudioJBDelay.get(i.ssrc)||{jitterBufferDelay:0,jitterBufferEmittedCount:0,jitterBufferMs:0};let t=e.jitterBufferMs;const n=p-e.jitterBufferEmittedCount;n>0&&(t=1e3*(f-e.jitterBufferDelay)/n),i.jitterBufferMs=Math.round(t),this.lastAudioJBDelay.set(i.ssrc,{jitterBufferDelay:f,jitterBufferEmittedCount:p,jitterBufferMs:i.jitterBufferMs})}i.outputLevel=m;let v=1920;_&&h&&(v=h/_/50,i.receivedFrames=Math.round(h/v)),g&&(i.droppedFrames=Math.round(g/v))}processRemoteInboundStats(e,t){const i=this.report.get(e);i&&(t.packetsLost=i.packetsLost,i.roundTripTime&&(t.rttMs=1e3*i.roundTripTime),i.jitter&&(t.jitterMs=1e3*i.jitter),i.timestamp&&(t.timestamp=i.timestamp))}getCodecFromCodecStats(e){const t=this.report.get(e);if(!t)return"";const i=t.mimeType.match(/\/(.*)$/);return i&&i[1]?i[1]:""}updateSendBitrate(){let e=0,t=null,i=null;this.mediaBytesSent.forEach((t=>{e+=t.diffMean()})),this.mediaBytesRetransmit.forEach((e=>{t=null===t?e.diffMean():t+e.diffMean()})),this.mediaBytesTargetEncode.forEach((e=>{i=null===i?e.diffMean():i+e.diffMean()}));const n=null!==t?e-t:e;this._stats.bitrate={actualEncoded:8*n/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},null!==t&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),null!==i&&(this._stats.bitrate.targetEncoded=8*i/(this.options.updateInterval/1e3))}}class fP extends sP{updateStats(){return nv.resolve()}}function pP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e4;const o=function(){const e=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]*/i);return e&&e[0]?Number(e[0].split("/")[1]):null}();return o?o<76?new uP(e,{updateInterval:t,lossRateInterval:i,freezeRateLimit:n,firstVideoDecodedTimeout:r}):new hP(e,{updateInterval:t,lossRateInterval:i,freezeRateLimit:n,firstVideoDecodedTimeout:r}):function(e){return!!window.RTCStatsReport&&e.getStats()instanceof nv}(e)?new hP(e,{updateInterval:t,lossRateInterval:i,freezeRateLimit:n,firstVideoDecodedTimeout:r}):new fP(e,{updateInterval:t,lossRateInterval:i,freezeRateLimit:n,firstVideoDecodedTimeout:r})}function mP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function _P(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?mP(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):mP(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function gP(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;const{filterRTX:r,filterVideoFec:o,filterAudioFec:s,filterAudioCodec:a,filterVideoCodec:c}=t,{useXR:u}=i;let d=[],l=[],h=[],f=[],p=!1,m=!1;if(Yk.parse(e).mediaDescriptions.forEach((e=>{n&&n!==e.attributes.direction||("video"!==e.media.mediaType||p||(l=e.attributes.payloads,f=e.attributes.extmaps,p=!0),"audio"!==e.media.mediaType||m||(d=e.attributes.payloads,h=e.attributes.extmaps,m=!0))})),!f||0===l.length)throw new Error("Cannot get video capabilities from SDP.");if(!h||0===d.length)throw new Error("Cannot get audio capabilities from SDP.");l.forEach((e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate)),u&&e.rtcpFeedbacks.push({type:"rrtr"})})),d.forEach((e=>{var t;null!==(t=e.rtpMap)&&void 0!==t&&t.clockRate&&(e.rtpMap.clockRate=parseInt(e.rtpMap.clockRate)),u&&e.rtcpFeedbacks.push({type:"rrtr"})})),r&&(d=d.filter((e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})),l=l.filter((e=>{var t;return"rtx"!==(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())}))),o&&(l=l.filter((e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")}))),s&&(d=d.filter((e=>{var t;return!/(red)|(ulpfec)|(flexfec)/i.test((null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName)||"")}))),a&&(null==a?void 0:a.length)>0&&(d=d.filter((e=>{var t;return Mn(a).call(a,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")}))),c&&(null==c?void 0:c.length)>0&&(l=l.filter((e=>{var t;return Mn(c).call(c,(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())||"")})));const _=Pw("UNSUPPORTED_VIDEO_CODEC");return _&&_.length>0&&(l=l.filter((e=>!(e.rtpMap&&Mn(_).call(_,e.rtpMap.encodingName.toLowerCase()))))),{audioCodecs:d,videoCodecs:l,audioExtensions:h,videoExtensions:f}}function vP(e){const t=Yk.parse(e);let i,n;for(const r of t.mediaDescriptions){if(!i){const e=r.attributes.iceUfrag,t=r.attributes.icePwd;if(!e||!t)throw new Error("Cannot get iceUfrag or icePwd from SDP.");i={iceUfrag:e,icePwd:t}}if(!n){const e=r.attributes.fingerprints;e.length>0&&(n={fingerprints:e})}}if(!n&&t.attributes.fingerprints.length>0&&(n={fingerprints:t.attributes.fingerprints}),!n||!i)throw new Error("Cannot get iceParameters or dtlsParameters from SDP.");return{iceParameters:i,dtlsParameters:n}}function EP(e,t){const i=[],n=e.attributes.ssrcGroups.filter((e=>"FID"===e.semantic)),r=e.attributes.ssrcGroups.find((e=>"SIM"===e.semantic)),o=e.attributes.ssrcs;if(r)r.ssrcIds.forEach((e=>{var r;const o=null===(r=n.find((t=>t.ssrcIds[0]===e)))||void 0===r?void 0:r.ssrcIds[1];i.push({ssrcId:e,rtx:t?o:void 0})}));else if(n.length>0){const e=n[0].ssrcIds[0],r=n[0].ssrcIds[1];i.push({ssrcId:e,rtx:t?r:void 0})}else{if(0===o.length)throw new Error("No ssrcs found on local media description.");i.push({ssrcId:o[0].ssrcId})}return i}function bP(e,t){const{cname:i}=e;let n;t&&t.ip&&"number"==typeof t.port?(n=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip,port:t.port.toString(),type:"host",extension:{}}],Yw.debug("Using remote candidate from AP ".concat(t.ip,":").concat(t.port)),t.ip6&&(n.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip6,port:t.port.toString(),type:"host",extension:{}}),Yw.debug("Using IPV6 remote candidate from AP ".concat(t.ip6,":").concat(t.port)))):n=e.iceParameters.candidates.map((e=>({foundation:e.foundation,componentId:"1",transport:e.protocol,priority:e.priority.toString(),connectionAddress:e.ip,port:e.port.toString(),type:e.type,extension:{}})));const r={fingerprints:e.dtlsParameters.fingerprints.map((e=>({hashFunction:e.algorithm,fingerprint:e.fingerprint})))},o={iceUfrag:e.iceParameters.iceUfrag,icePwd:e.iceParameters.icePwd};let s;switch(e.dtlsParameters.role){case"server":s="passive";break;case"client":s="active";break;case"auto":s="actpass"}return{dtlsParameters:r,iceParameters:o,candidates:n,rtpCapabilities:NP(e.rtpCapabilities),setup:s,cname:i}}function yP(e,t,i){const n=[],r=[];return e.forEach((e=>{let{ssrcId:o,rtx:s}=e;const a=BE(8,"track-"),c={ssrcId:o,attributes:_P({label:a,mslabel:i=i||BE(10,""),msid:"".concat(i," ").concat(a)},t&&{cname:t})};if(n.push(c),void 0!==s){const e={ssrcId:s,attributes:_P({label:a,mslabel:i,msid:"".concat(i," ").concat(a)},t&&{cname:t})};n.push(e),r.push({semantic:"FID",ssrcIds:[o,s]})}})),e.length>1&&r.push({semantic:"SIM",ssrcIds:e.map((e=>{let{ssrcId:t}=e;return t}))}),{ssrcs:n,ssrcGroups:r}}function wP(e,t){t instanceof dA&&e.attributes.payloads.forEach((e=>{var i;const n=null===(i=e.rtpMap)||void 0===i?void 0:i.encodingName.toLowerCase();if(!n||-1===["opus","pcmu","pcma","g722"].indexOf(n))return;e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.minptime="10",e.fmtp.parameters.useinbandfec="1";const r=t._encoderConfig;r&&"pcmu"!==n&&"pcma"!==n&&"g722"!==n&&(r.bitrate&&!Sv()&&(e.fmtp.parameters.maxaveragebitrate="".concat(Math.floor(1e3*r.bitrate))),r.sampleRate&&(e.fmtp.parameters.maxplaybackrate="".concat(r.sampleRate),e.fmtp.parameters["sprop-maxcapturerate"]="".concat(r.sampleRate)),r.stereo&&(e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"))}))}function SP(e){const t=e.attributes.unrecognized.findIndex((e=>"x-google-flag"===e.attField&&"conference"===e.attValue));-1!==t&&e.attributes.unrecognized.splice(t,1)}function TP(e,t){var i;if(!(t instanceof kA&&t._encoderConfig&&-1===t._hints.indexOf(YC.SCREEN_TRACK)))return;const n=t._encoderConfig;MC().supportMinBitrate&&n.bitrateMin&&e.attributes.payloads.forEach((e=>{var t,i;Mn(t=["h264","h265","vp8","vp9","av1"]).call(t,(null===(i=e.rtpMap)||void 0===i?void 0:i.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-min-bitrate"]="".concat(n.bitrateMin))})),MC().supportMinBitrate&&!Mn(i=t._hints).call(i,YC.LOW_STREAM)&&n.bitrateMax&&e.attributes.payloads.forEach((e=>{var t,i;Mn(t=["h264","h265","vp8","vp9","av1"]).call(t,(null===(i=e.rtpMap)||void 0===i?void 0:i.encodingName.toLowerCase())||"")&&(e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters["x-google-start-bitrate"]="".concat(Pw("X_GOOGLE_START_BITRATE")||Math.floor(n.bitrateMax)))}))}function RP(e){if("video"!==e.media.mediaType)return;const t=mv();if(t.name!==dv.SAFARI&&t.os!==uv.IOS)return;const i=e.attributes.extmaps.findIndex((e=>/video-orientation/g.test(e.extensionName)));-1!==i&&e.attributes.extmaps.splice(i,1)}function CP(e,t,i){if(!t)return;let n,r;if("video"===e.media.mediaType?(n=i.videoExtensions,r=i.videoCodecs):(n=i.audioExtensions,r=i.audioCodecs),!0===t.twcc){const t=n.find((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName));if(t){e.attributes.extmaps.find((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName))||e.attributes.extmaps.push({entry:t.entry,extensionName:"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"});const i=function(e,t){return t.filter((t=>!!e.find((e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find((e=>"transport-cc"===e.type))))))}(r,e.attributes.payloads);i.forEach((e=>{e.rtcpFeedbacks.find((e=>"transport-cc"===e.type))||e.rtcpFeedbacks.push({type:"transport-cc"})}))}}else if(!1===t.twcc){const t=e.attributes.extmaps.findIndex((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"transport-cc"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}if(!0===t.remb){const t=n.find((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName));if(t){e.attributes.extmaps.find((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName))||e.attributes.extmaps.push({entry:t.entry,extensionName:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"});const i=function(e,t){return t.filter((t=>!!e.find((e=>e.payloadType===t.payloadType&&!!e.rtcpFeedbacks.find((e=>"goog-remb"===e.type))))))}(r,e.attributes.payloads);i.forEach((e=>{e.rtcpFeedbacks.find((e=>"goog-remb"===e.type))||e.rtcpFeedbacks.push({type:"goog-remb"})}))}}else if(!1===t.remb){const t=e.attributes.extmaps.findIndex((e=>"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.extensionName));-1!==t&&e.attributes.extmaps.splice(t,1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"goog-remb"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}}function IP(e,t,i){if(Sv())return;if("video"!==e.media.mediaType)return;if(!(t instanceof kA))return;if("vp9"!==i&&"vp8"!==i)return;if("vp8"===i&&!Pw("SIMULCAST"))return;if(void 0===t._scalabilityMode||t._scalabilityMode.numSpatialLayers<=1)return;const n="vp8"===i?2:t._scalabilityMode.numSpatialLayers,r=e.attributes.ssrcs[0],o=e.attributes.ssrcGroups.find((e=>"FID"===e.semantic&&e.ssrcIds[0]===r.ssrcId)),s={semantic:"SIM",ssrcIds:[r.ssrcId]};for(let a=1;a<n;a++)e.attributes.ssrcs.push({ssrcId:r.ssrcId+a,attributes:OE(r.attributes)}),s.ssrcIds.push(r.ssrcId+a),o&&(e.attributes.ssrcs.push({ssrcId:o.ssrcIds[1]+a,attributes:OE(r.attributes)}),e.attributes.ssrcGroups.push({semantic:"FID",ssrcIds:[r.ssrcId+a,o.ssrcIds[1]+a]}));e.attributes.ssrcGroups.unshift(s)}async function AP(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=new RTCPeerConnection;i.addTransceiver("video",{direction:"sendonly"}),i.addTransceiver("audio",{direction:"sendonly"}),i.addTransceiver("video",{direction:"recvonly"}),i.addTransceiver("audio",{direction:"recvonly"});const n=(await i.createOffer()).sdp,{send:r,recv:o,sendrecv:s}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0;const n=gP(i,e,t,"sendonly"),r=gP(i,e,t,"recvonly"),o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},s={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},a={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(MP(n,r,"videoExtensions",o,s,a),MP(n,r,"videoCodecs",o,s,a),MP(n,r,"audioExtensions",o,s,a),MP(n,r,"audioCodecs",o,s,a),Pw("RAISE_H264_BASELINE_PRIORITY")){const e=a.videoCodecs.findIndex((e=>{var t,i;return"h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&"42001f"===(null===(i=e.fmtp)||void 0===i?void 0:i.parameters["profile-level-id"])}));if(-1!==e){const t=a.videoCodecs.findIndex((e=>{var t;return"h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())}));if(t<e){Yw.debug("raising H264 baseline profile priority");const i=a.videoCodecs[e];a.videoCodecs.splice(e,1),a.videoCodecs.splice(t,0,i)}-1!==t&&(s.videoCodecs=s.videoCodecs.filter((e=>{var t,i;return!("h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(i=e.fmtp)||void 0===i?void 0:i.parameters["profile-level-id"]))}))),-1!==t&&Pw("FILTER_SEND_H264_BASELINE")&&(o.videoCodecs=o.videoCodecs.filter((e=>{var t,i;return!("h264"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLocaleLowerCase())&&"42001f"!==(null===(i=e.fmtp)||void 0===i?void 0:i.parameters["profile-level-id"]))})))}}return{send:o,recv:s,sendrecv:a}}(e,t,n);try{i.close()}catch(e){}return{send:r,recv:o,sendrecv:s}}function OP(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=gP(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"recvonly"),i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(MP(e,t,"videoExtensions",i,n,r),MP(e,t,"videoCodecs",i,n,r),MP(e,t,"audioExtensions",i,n,r),MP(e,t,"audioCodecs",i,n,r),Pw("RAISE_H264_BASELINE_PRIORITY")){const e=r.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"===e.fmtp.parameters["profile-level-id"]));if(-1!==e){const t=r.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()));if(t<e){Yw.debug("raising H264 baseline profile priority");const i=r.videoCodecs[e];r.videoCodecs.splice(e,1),r.videoCodecs.splice(t,0,i)}-1!==t&&(n.videoCodecs=n.videoCodecs.filter((e=>!(e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"!==e.fmtp.parameters["profile-level-id"]))))}}return{send:i,recv:n,sendrecv:r}}function MP(e,t,i,n,r,o){if("videoExtensions"===i||"audioExtensions"===i){const s=[];return e[i].forEach((e=>{t[i].some(((t,i)=>{if(e.entry===t.entry&&e.extensionName===t.extensionName)return s.push(i),!0}))?o[i].push(e):n[i].push(e)})),void t[i].forEach(((e,t)=>{-1===s.indexOf(t)&&r[i].push(e)}))}if("videoCodecs"===i||"audioCodecs"===i){const s=[];return e[i].forEach((e=>{t[i].some(((t,i)=>{if(e.payloadType===t.payloadType&&JSON.stringify(e)===JSON.stringify(t))return s.push(i),!0}))?o[i].push(e):n[i].push(e)})),void t[i].forEach(((e,t)=>{-1===s.indexOf(t)&&r[i].push(e)}))}}function NP(e){const{send:t,recv:i,sendrecv:n}=e;if(!n){if(!t||!i)throw new Error("cannot merge rtp capabilities because one of send or recv is empty!");return{send:t,recv:i}}let r,o;return t?(r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r.audioCodecs=[...t.audioCodecs,...n.audioCodecs],r.videoCodecs=[...t.videoCodecs,...n.videoCodecs],r.audioExtensions=[...t.audioExtensions,...n.audioExtensions],r.videoExtensions=[...t.videoExtensions,...n.videoExtensions]):r=n,i?(o={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},o.audioCodecs=[...i.audioCodecs,...n.audioCodecs],o.videoCodecs=[...i.videoCodecs,...n.videoCodecs],o.audioExtensions=[...i.audioExtensions,...n.audioExtensions],o.videoExtensions=[...i.videoExtensions,...n.videoExtensions]):o=n,{send:r,recv:o}}function kP(e){"audio"===e.media.mediaType&&e.attributes.payloads.filter((e=>{var t;return"opus"===(null===(t=e.rtpMap)||void 0===t?void 0:t.encodingName.toLowerCase())})).forEach((e=>{e.fmtp||(e.fmtp={parameters:{}}),e.fmtp.parameters.stereo="1",e.fmtp.parameters["sprop-stereo"]="1"}))}function PP(e){e.mediaDescriptions.forEach((e=>{"video"!==e.media.mediaType&&"audio"!==e.media.mediaType||e.attributes.payloads.forEach((e=>{-1===e.rtcpFeedbacks.findIndex((e=>"rrtr"===e.type))&&e.rtcpFeedbacks.push({type:"rrtr"})}))}))}function DP(e,t,i,n){let r=[];if(e===pT.VIDEO){if(Pw("H264_PROFILE_LEVEL_ID")&&"h264"===n&&(r=t.videoCodecs.filter((e=>{var t;return Mn(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,n)&&e&&e.fmtp&&e.fmtp.parameters["profile-level-id"]===Pw("H264_PROFILE_LEVEL_ID")}))),!Array.isArray(r)||0===r.length){let e=[];const o=[],s=[];i.videoCodecs.forEach((t=>{var i,r,a;Mn(i=t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").call(i,n)&&e.push(t),Mn(r=t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").call(r,"vp8")&&o.push(t),Mn(a=t.rtpMap&&t.rtpMap.encodingName.toLowerCase()||"").call(a,"h264")&&s.push(t)})),0===e.length&&(0!==o.length?(e=o,Yw.warning("codec ".concat(n," not included in rtpCapabilities, fallback to default payloads: vp8"))):0!==s.length&&(e=s,Yw.warning("codec ".concat(n," not included in rtpCapabilities, fallback to default payloads: h264")))),0!==e.length&&(r=t.videoCodecs.filter((t=>e.some((e=>e.payloadType===t.payloadType)))))}if(Pw("USE_PUB_RTX")){const e=r.map((e=>e.payloadType.toString())),i=t.videoCodecs.filter((t=>t.rtpMap&&"rtx"===t.rtpMap.encodingName&&Mn(e).call(e,t.fmtp&&t.fmtp.parameters.apt||"")));r=[...r,...i]}0===r.length&&(Yw.warning("codec ".concat(n," not included in rtpCapabilities, fallback to default payloads: ").concat(t.videoCodecs[0].rtpMap&&t.videoCodecs[0].rtpMap.encodingName)),r=t.videoCodecs)}else r=t.audioCodecs.filter((e=>{var t;return Mn(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,n)})),0===r.length&&(Yw.warning("codec ".concat(n," not included in rtpCapabilities, fallback to opus")),r=t.audioCodecs.filter((e=>{var t;return Mn(t=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(t,"opus")})));return r}let LP=class{get localCapabilities(){return OE(this._localCapabilities)}get rtpCapabilities(){return OE(this._rtpCapabilities)}get candidates(){return OE(this._candidates)}get iceParameters(){return OE(this._iceParameters)}get dtlsParameters(){return OE(this._dtlsParameters)}constructor(e){oh(this,"sessionDesc",void 0),oh(this,"_localCapabilities",void 0),oh(this,"_rtpCapabilities",void 0),oh(this,"_candidates",void 0),oh(this,"_iceParameters",void 0),oh(this,"_dtlsParameters",void 0),oh(this,"setup",void 0),oh(this,"currentMidIndex",void 0),oh(this,"cname","o/i14u9pJrxRKAsu"),oh(this,"firefoxSsrcMidMap",new Map),e=OE(e);const{remoteIceParameters:t,remoteDtlsParameters:i,candidates:n,remoteRTPCapabilities:r,localCapabilities:o,direction:s,setup:a,videoCodec:c,audioCodec:u}=e;let d;this.setup=a,d=s===CS.RECEIVE_ONLY?Yk.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n"):Yk.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=extmap-allow-mixed\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=recvonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n"),this._rtpCapabilities=r,this._candidates=n,this._iceParameters=t,this._dtlsParameters=i,this._localCapabilities=o;const l=s===CS.RECEIVE_ONLY?this.rtpCapabilities.send:this.rtpCapabilities.recv,h=s===CS.RECEIVE_ONLY?this._localCapabilities.recv:this._localCapabilities.send,f=s===CS.RECEIVE_ONLY?r.send.videoCodecs:DP(pT.VIDEO,l,h,c),p=s===CS.RECEIVE_ONLY?r.send.audioCodecs:DP(pT.AUDIO,l,h,u);for(const m of d.mediaDescriptions){if(m.attributes.iceUfrag=t.iceUfrag,m.attributes.icePwd=t.icePwd,m.attributes.fingerprints=i.fingerprints,m.attributes.candidates=n,m.attributes.setup=this.setup,"application"===m.media.mediaType&&(m.attributes.sctpPort="5000"),"video"===m.media.mediaType&&(m.media.fmts=f.map((e=>e.payloadType.toString(10))),m.attributes.payloads=f,m.attributes.extmaps=l.videoExtensions,Pw("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=yP([{ssrcId:4e4,rtx:Pw("USE_SUB_RTX")?40001:void 0}],this.cname);m.attributes.ssrcs=e,m.attributes.ssrcGroups=t}if("audio"===m.media.mediaType&&(m.media.fmts=p.map((e=>e.payloadType.toString(10))),m.attributes.payloads=p,m.attributes.extmaps=l.audioExtensions,kP(m),Pw("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=yP([{ssrcId:2e4}],this.cname);m.attributes.ssrcs=e,m.attributes.ssrcGroups=t}}this.sessionDesc=d,this.currentMidIndex=d.mediaDescriptions.length-1}toString(){return Yk.print(this.sessionDesc)}hasMid(e){return Array.isArray(e)?e.every((e=>this.hasMid(e))):this.sessionDesc.mediaDescriptions.some((t=>t.attributes.mid===e))}send(e,t,i,n,r){i=i.replace(/ /g,"-");const{ssrcs:o,ssrcGroups:s}=yP(t,this.cname,Pw("SYNC_GROUP")?i:void 0),a=this.findPreloadMediaDesc(o);if(a){if(Sv()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,a.attributes.mid),r&&(r.twcc||r.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(a);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(a,r),{mid:a.attributes.mid,needExchangeSDP:!0}}return{mid:a.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,o,n);let i;return-1===t?(i=this.createOrRecycleSendMedia(e,o,s,"sendonly",n,r),this.updateBundleMids()):(i=OE(this.sessionDesc.mediaDescriptions[t]),i.attributes.direction="sendonly",i.attributes.ssrcs=o,i.attributes.ssrcGroups=s,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(i,r)),Sv()&&this.firefoxSsrcMidMap.set(o[0].ssrcId,i.attributes.mid),{needExchangeSDP:!0,mid:i.attributes.mid}}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach((e=>{e.attributes.ssrcs=[]})),this.updateBundleMids()}receive(e,t,i){const n=[];return e.forEach((e=>{const r=e._mediaStreamTrack.kind,o=this.findAvailableRecvMediaIndex(r);let s,a=!1;-1===o?(a=!0,s=this.createOrRecycleRecvMedia(e,[],"recvonly",t,i),this.updateBundleMids()):(s=OE(this.sessionDesc.mediaDescriptions[o]),s.attributes.direction="recvonly"),n.push({mid:s.attributes.mid,needCreateTransceiver:a})})),n}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach((e=>{e.media.port="0",e.attributes.direction="inactive"})),this.updateBundleMids()}addRemoteCandidate(e){const{foundation:t,protocol:i,address:n,port:r,type:o,relatedAddress:s,relatedPort:a,priority:c}=new RTCIceCandidate(e),u={foundation:null!=t?t:"",componentId:"1",transport:null!=i?i:"",priority:c?c+"":"",connectionAddress:null!=n?n:"",port:r?r+"":"",type:o?o+"":"",relAddr:null!=s?s:"",relPort:a?a+"":"",extension:{}};this.candidates.some((e=>e.priority===u.priority&&e.connectionAddress===u.connectionAddress&&e.port===u.port))||(this._candidates.push(u),this.sessionDesc.mediaDescriptions.forEach((e=>{e.attributes.candidates=this.candidates})))}clearRemoteCandidate(){this._candidates=[],this.sessionDesc.mediaDescriptions[0].attributes.candidates=this._candidates}createOrRecycleRecvMedia(e,t,i,n,r){const o=e._mediaStreamTrack.kind,s=this.rtpCapabilities.recv,a=DP(o,s,this.localCapabilities.send,o===pT.AUDIO?r:n),c=o===pT.VIDEO?s.videoExtensions:s.audioExtensions,u="".concat(++this.currentMidIndex);let d={media:{mediaType:o,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(u)}};d=this.mungRecvMediaDsec(d,e);const l=this.findFirstClosedMedia(o);if(l){const e=this.sessionDesc.mediaDescriptions.indexOf(l);this.sessionDesc.mediaDescriptions[e]=d}else this.sessionDesc.mediaDescriptions.push(d);return d}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Mn(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="inactive"}))}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Mn(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="recvonly"}))}findAvailableMediaIndex(e,t,i){return this.sessionDesc.mediaDescriptions.findIndex((n=>{const r=n.media.mediaType===e&&"0"!==n.media.port&&("sendonly"===n.attributes.direction||"sendrecv"===n.attributes.direction)&&0===n.attributes.ssrcs.length;if(Sv()){if(r){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==n.attributes.mid&&"1"!==n.attributes.mid)||!(!e||e!==n.attributes.mid)}return!1}return r&&n.attributes.mid===i}))}findAvailableRecvMediaIndex(e){return this.sessionDesc.mediaDescriptions.findIndex((t=>{const i=t.media.mediaType===e&&"0"!==t.media.port&&("recvonly"===t.attributes.direction||"sendrecv"===t.attributes.direction);return"0"!==t.attributes.mid&&"1"!==t.attributes.mid&&i}))}predictReceivingMids(e){const t=[];for(let i=0;i<e;i++)t.push((this.currentMidIndex+i+1).toString(10));return t}restartICE(e){e=OE(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}createOrRecycleSendMedia(e,t,i,n,r,o){const s=this.rtpCapabilities.send,a=e===pT.VIDEO?s.videoCodecs:s.audioCodecs,c=e===pT.VIDEO?s.videoExtensions:s.audioExtensions;Sv()&&(r="".concat(++this.currentMidIndex));let u={media:{mediaType:e,port:"9",protos:["UDP","TLS","RTP","SAVPF"],fmts:a.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:[],extmaps:c,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:i,rtcpFeedbackWildcards:[],payloads:a,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:r}};u=this.mungSendMediaDesc(u,o);const d=this.findFirstClosedMedia(e);if(d){const e=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[e]=u}else this.sessionDesc.mediaDescriptions.push(u);return u}mungRecvMediaDsec(e,t,i){const n=OE(e);return SP(n),wP(n,t),TP(n,t),RP(n),CP(n,i,this.localCapabilities.send),n}mungSendMediaDesc(e,t){const i=OE(e);return CP(i,t,this.localCapabilities.recv),kP(i),i}updateRecvMedia(e,t){const i=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==i){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],t);this.sessionDesc.mediaDescriptions[i]=e}}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter((e=>"0"!==e.media.port)).map((e=>e.attributes.mid))}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find((t=>{var i;return(null===(i=t.attributes)||void 0===i||null===(i=i.ssrcs[0])||void 0===i?void 0:i.ssrcId)===e[0].ssrcId}))}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find((t=>Sv()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port))}};const xP=["sdp"];function UP(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function VP(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?UP(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):UP(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}let BP=class e extends xT{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,t;return null!==(e=null===(t=this.peerConnection.getReceivers()[0])||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.state)&&void 0!==e?e:null}get localCodecs(){return[]}set isInRestartIce(e){this._isInRestartIce=e}get isInRestartIce(){return this._isInRestartIce}constructor(t,i,n){super(t,i),oh(this,"direction",void 0),oh(this,"name",void 0),oh(this,"store",void 0),oh(this,"spec",void 0),oh(this,"peerConnection",void 0),oh(this,"initialOffer",void 0),oh(this,"transport",void 0),oh(this,"statsFilter",void 0),oh(this,"localCandidateCount",0),oh(this,"allCandidatesReceived",!1),oh(this,"localCandidateAddress",null),oh(this,"useXR",Pw("USE_XR")),oh(this,"filter",{filterRTX:!Pw("USE_PUB_RTX")&&!Pw("USE_SUB_RTX"),filterVideoFec:Pw("FILTER_VIDEO_FEC"),filterAudioFec:Pw("FILTER_AUDIO_FEC")}),oh(this,"extension",{useXR:this.useXR}),oh(this,"_isInRestartIce",!1),oh(this,"mutex",new YE("P2PConnection-mutex")),oh(this,"onLocalCandidate",void 0),oh(this,"remoteSDP",void 0),oh(this,"pendingCandidates",[]),oh(this,"localCapabilities",void 0),oh(this,"isReady",!1),oh(this,"restartCnt",0),oh(this,"curTurnServerIndex",0),this.store=i,this.spec=t,this.peerConnection=new RTCPeerConnection(e.resolvePCConfiguration(t,i.p2pTransport),{optional:[{googDscp:!0}]}),this.direction=null!=n?n:CS.SEND_ONLY,this.name=this.direction===CS.SEND_ONLY?"sendP2PConnection":"recvP2PConnection",this.statsFilter=pP(this.peerConnection,Pw("STATS_UPDATE_INTERVAL"),void 0,Sv()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1}async establish(e){try{const t=await AP(this.filter,this.extension);if(this.localCapabilities=NP(t),e){const{sdp:t}=e,i=Kk(e,xP),n=function(){const e={audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},t=gP(arguments.length>2?arguments[2]:void 0,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},"sendonly"),i={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},n={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},r={audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]};if(MP(t,e,"videoExtensions",i,n,r),MP(t,e,"videoCodecs",i,n,r),MP(t,e,"audioExtensions",i,n,r),MP(t,e,"audioCodecs",i,n,r),Pw("RAISE_H264_BASELINE_PRIORITY")){const e=r.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"===e.fmtp.parameters["profile-level-id"]));if(-1!==e){const t=r.videoCodecs.findIndex((e=>e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()));if(t<e){Yw.debug("raising H264 baseline profile priority");const i=r.videoCodecs[e];r.videoCodecs.splice(e,1),r.videoCodecs.splice(t,0,i)}-1!==t&&Pw("FILTER_SEND_H264_BASELINE")&&(i.videoCodecs=i.videoCodecs.filter((e=>!(e.rtpMap&&"h264"===e.rtpMap.encodingName.toLocaleLowerCase()&&e.fmtp&&"42001f"!==e.fmtp.parameters["profile-level-id"]))))}}return{send:i,recv:n,sendrecv:r}}(this.filter,this.extension,t);this.remoteSDP=new LP({remoteIceParameters:i.iceParameters,remoteDtlsParameters:i.dtlsParameters,candidates:[],remoteRTPCapabilities:n,localCapabilities:this.localCapabilities,direction:this.direction,setup:"actpass",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()}),this.isReady=!0;const r=await this.peerConnection.createAnswer();if(!r.sdp)throw new Error("Cannot get answer sdp when trying to establish PeerConnection.");const o=vP(r.sdp);await this.peerConnection.setLocalDescription(r);const s=await OP(this.filter,this.extension,r.sdp);this.localCapabilities=NP(s);const a=this.peerConnection.getTransceivers()[0];return null!=a&&a.receiver&&a.receiver.transport&&this.tryBindTransportEvents(a.receiver.transport),VP(VP({},o),{},{sdp:r.sdp})}{this.peerConnection.addTransceiver("video",{direction:"sendonly"}),this.peerConnection.addTransceiver("audio",{direction:"sendonly"});const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=vP(e.sdp);return this.initialOffer=e,VP(VP({},t),{},{sdp:e.sdp})}}catch(e){throw new jv(Bv.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");await this.peerConnection.setLocalDescription(this.initialOffer);const{sdp:t,iceParameters:i,dtlsParameters:n}=e,r=await OP(this.filter,this.extension,t);this.remoteSDP=new LP({remoteIceParameters:i,remoteDtlsParameters:n,candidates:[],remoteRTPCapabilities:r,localCapabilities:this.localCapabilities,direction:this.direction,setup:"active",videoCodec:this.store.codec,audioCodec:this.store.audioCodec}),await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()});const o=this.peerConnection.getTransceivers()[0];null!=o&&o.sender&&o.sender.transport&&this.tryBindTransportEvents(o.sender.transport)}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}async addRemoteCandidate(e){try{e&&this.pendingCandidates.push(e),this.peerConnection.remoteDescription&&this.isReady&&(this.pendingCandidates.forEach((e=>{this.peerConnection.addIceCandidate(e)})),this.pendingCandidates=[])}catch(e){throw new jv(Bv.ADD_CANDIDATE_FAILED,"P2PConnection.addRemoteCandidate failed; ".concat(e.toString()))}}send(e,t,i){var n=this;return Nk((function*(){const r=yield wk(n.mutex.lock("From P2PConnection.send"));try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const r=[],o=n.remoteSDP.receive(e,t,i);e.forEach(((e,t)=>{if(o[t].needCreateTransceiver){const t=n.peerConnection.addTransceiver(e._mediaStreamTrack,{direction:"sendonly"});r.push(t),e._updateRtpTransceiver(t)}else{const i=n.peerConnection.getTransceivers().find((e=>e.mid===o[t].mid));if(!i)throw new Error("cannot find transceiver when sendPeerconnection send, mid is ".concat(o[t].mid));r.push(i),e._updateRtpTransceiver(i)}})),Sv()&&!0===Pw("SIMULCAST")&&(yield wk(n.applySimulcastForFirefox(r,e)));const s=o.map((e=>e.mid)),a=yield wk(n.peerConnection.createOffer()),c=n.mungSendOfferSDP(a.sdp,e,s),u=Yk.parse(c),d=s.map((e=>{const t=u.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return EP(t,Pw("USE_PUB_RTX"))})),l=r.map(((e,t)=>{const i=s[t];return{localSSRC:d[t],id:i}}));yield wk(n.peerConnection.setLocalDescription({type:"offer",sdp:c}));try{yield l}catch(e){const i=n.remoteSDP.toString();throw yield wk(n.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield wk(n.peerConnection.setRemoteDescription({type:"answer",sdp:i})),yield wk(n.stopSending(s,!0)),e}yield wk(n.applySimulcastEncodings(r,e)),yield wk(n.applySendEncodings(r,e));const h=n.remoteSDP.toString(),f=n.logSDPExchange(c,"offer","local","send");return null==f||f(h),yield wk(n.setRemoteDescription({type:"answer",sdp:h})),r.map(((e,t)=>{const i=s[t];return{localSSRC:d[t],id:i}}))}catch(e){throw e instanceof jv?e:new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{r()}}))()}async stopSending(e,t){const i=t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter((t=>-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length (".concat(t.length,") doesn't match mids' length (").concat(e.length,") when trying to call P2PConnection.stopSending."));t.map((e=>{var t;e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)}));const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(i),this.remoteSDP.stopReceiving(e);const r=this.remoteSDP.toString();null==n||n(r),await this.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}finally{i&&i()}}async receive(e,t,i,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:r,needExchangeSDP:o}=this.remoteSDP.send(e,t,i,n);if(o){const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer(),o=this.mungReceiveAnswerSDP(n.sdp,r,e);null==i||i(o||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:o}),Yw.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else Yw.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."));const s=this.peerConnection.getTransceivers().find((e=>e.mid===r));if(!s||null===s.mid)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:s.receiver.track,mid:s.mid,transceiver:s}}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async mockReceive(e,t,i,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:r,needExchangeSDP:o}=this.remoteSDP.send(e,t,i,n);if(o){const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","receive");await this.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer(),o=this.mungReceiveAnswerSDP(n.sdp,r,e);null==i||i(o||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:o}),Yw.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else Yw.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."))}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();null==i||i(n.sdp||""),await this.peerConnection.setLocalDescription(n)}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async restartICE(t){try{if(this.store.p2pTransport===Ow.Auto&&(this.store.p2pTransport=Ow.SdRtn,MC().supportPCSetConfiguration&&this.peerConnection.setConfiguration(e.resolvePCConfiguration(this.spec,this.store.p2pTransport))),this.restartCnt>3&&(this.restartCnt=0,MC().supportPCSetConfiguration&&this.peerConnection.setConfiguration(e.resolvePCConfiguration(this.spec,this.store.p2pTransport,++this.curTurnServerIndex))),!t){this.restartCnt++,this.isReady=!1;const e=await this.peerConnection.createOffer({iceRestart:!0});if(!e.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const{iceParameters:t}=vP(e.sdp);return this.store.descriptionStart(),this.direction===CS.SEND_ONLY&&await this.peerConnection.setLocalDescription(e),t}if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");if(this.remoteSDP.restartICE(t),this.store.descriptionStart(),this.direction===CS.RECEIVE_ONLY){this.restartCnt++,await this.setRemoteDescription({type:"offer",sdp:this.remoteSDP.toString()});const e=await this.peerConnection.createAnswer();if(!e.sdp)throw new Error("Cannot get answer sdp when trying to iceRestart.");const{iceParameters:t}=vP(e.sdp);return await this.peerConnection.setLocalDescription(e),t}await this.setRemoteDescription({type:"answer",sdp:this.remoteSDP.toString()}),this.isReady=!0}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}close(){var e;this.peerConnection.close(),this.peerConnection.onicecandidate=null,null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.transport=void 0,this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const i=await this.peerConnection.createOffer(),n=this.mungSendOfferSDP(i.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const r=this.remoteSDP.toString(),o=this.logSDPExchange(n,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),null==o||o(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const i=this.peerConnection.getTransceivers().filter((t=>t.mid===e));1===i.length&&(this.isVP8Simulcast(t)?Sv()||await this.applySimulcastEncodings(i,[t]):await this.applySendEncodings(i,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const i=this.peerConnection.getTransceivers().find((e=>e.mid===t));i&&await i.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const t=e[0].transport.iceTransport,{local:i,remote:n}=t.getSelectedCandidatePair();return{local:VP(VP({},Zk),{},{candidateType:i.type,protocol:i.protocol,address:i.address,port:i.port}),remote:VP(VP({},Zk),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e,t;Mn(e=["connected","completed"]).call(e,this.peerConnection.iceConnectionState)&&(this.isReady=!1),null===(t=this.onICEConnectionStateChange)||void 0===t||t.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;"connected"===this.peerConnection.connectionState&&(this.restartCnt=0),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.startICECandidate()}startICECandidate(){this.peerConnection.onicecandidate||(this.localCandidateCount=0,this.peerConnection.onicecandidate=e=>{var t;e.candidate?(e.candidate.candidate&&(this.localCandidateAddress=e.candidate.address,null===(t=this.onLocalCandidate)||void 0===t||t.call(this,e.candidate.toJSON())),this.localCandidateCount+=1):(this.allCandidatesReceived=!0,Yw.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))})}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(t,i){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r={iceServers:[]};var o;return t.iceServers?r.iceServers=t.iceServers:t.turnServer&&"off"!==t.turnServer.mode&&(_E(t.turnServer.servers)?r.iceServers=t.turnServer.servers:(r.iceServers&&r.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.servers,i,n)),Pw("USE_TURN_SERVER_OF_GATEWAY")&&r.iceServers&&t.turnServer.serversFromGateway&&r.iceServers.push(...e.turnServerConfigToIceServers(t.turnServer.serversFromGateway,i,n)),Mn(o=[Ow.Relay,Ow.SdRtn]).call(o,i)&&(r.iceTransportPolicy="relay"),Pw("FORCE_TURN_TCP")?r.iceTransportPolicy="relay":t.turnServer.servers.concat(t.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(r.iceTransportPolicy="relay")})))),Pw("ENABLE_ENCODED_TRANSFORM")&&MC().supportWebRTCEncodedTransform&&(r.encodedInsertableStreams=!0),Yw.debug("P2PConnection p2pTransport is ".concat(i)),r}static turnServerConfigToIceServers(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=[],r=e.filter((e=>e.tcpport));Yw.debug("P2PConnection turnServers is ".concat(r,", current index is ").concat(i));const o=r.length>i?r[i]:r[0];switch(t){case Ow.SdRtn:const t=e.filter((e=>{var t;return Mn(t=e.username).call(t,"glb:")&&e.turnServerURL==e.turnServerURL})),r=t.length>i?t[i]:t[0];r&&(n.push({username:r.username,credential:r.password,credentialType:"password",urls:"turn:".concat(RR(r.turnServerURL),":").concat(r.tcpport,"?transport=udp")}),n.push({username:r.username,credential:r.password,credentialType:"password",urls:"turns:".concat(RR(r.turnServerURL),":").concat(r.tcpport,"?transport=tcp")}));break;case Ow.Relay:o&&(n.push({username:o.username,credential:o.password,credentialType:"password",urls:"turn:".concat(o.turnServerURL,":").concat(o.tcpport,"?transport=udp")}),n.push({username:o.username,credential:o.password,credentialType:"password",urls:"turns:".concat(RR(o.turnServerURL),":").concat(o.tcpport,"?transport=tcp")}));break;default:o&&(n.push({username:o.username,credential:o.password,credentialType:"password",urls:"turn:".concat(o.turnServerURL,":").concat(o.tcpport,"?transport=udp")}),n.push({username:o.username,credential:o.password,credentialType:"password",urls:"turns:".concat(RR(o.turnServerURL),":").concat(o.tcpport,"?transport=tcp")}),n.push({username:o.username,credential:o.password,credentialType:"password",urls:"stun:".concat(o.turnServerURL,":").concat(o.tcpport)}))}return n}tryBindTransportEvents(e){if(e){this.transport=e,e.onstatechange=()=>{var t;null!=e&&e.state&&(null===(t=this.onDTLSTransportStateChange)||void 0===t||t.call(this,e.state))},e.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,"error"in e?e.error:e)};const t=e.iceTransport;t&&(t.onstatechange=()=>{const t=null==e?void 0:e.iceTransport.state;var i;t&&(null===(i=this.onICETransportStateChange)||void 0===i||i.call(this,t))},t.getSelectedCandidatePair&&(t.onselectedcandidatepairchange=()=>{if(t.getSelectedCandidatePair()){const{local:e,remote:i}=t.getSelectedCandidatePair();Yw.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:e.type,protocol:e.protocol}),", remote ").concat(JSON.stringify({candidateType:i.type,protocol:i.protocol,address:i.address,port:i.port})," )"))}}))}}tryUnbindTransportEvents(){this.transport&&(this.transport.onstatechange=null,this.transport.onerror=null,this.transport.iceTransport&&(this.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,t){var i;if(t||(t=this.peerConnection.getSenders().find((t=>t.track===e._mediaStreamTrack))),!t)return Yw.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return Yw.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!MC().supportSetRtpSenderParameters)return Yw.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const n={},r={};switch(e._optimizationMode){case"motion":n.degradationPreference="maintain-framerate";break;case"detail":n.degradationPreference="maintain-resolution";break;default:n.degradationPreference="balanced"}if(e._encoderConfig){var o;const{bitrateMax:t,frameRate:i,scaleResolutionDownBy:n}=e._encoderConfig;t&&(r.maxBitrate=1e3*t),Mn(o=e._hints).call(o,YC.LOW_STREAM)&&(i&&(r.maxFramerate=IR(i)),n&&n>=1&&(r.scaleResolutionDownBy=n))}if(Pw("DSCP_TYPE")&&xv()){var s;const e=Pw("DSCP_TYPE");Mn(s=["very-low","low","medium","high"]).call(s,e)&&(r.networkPriority=e)}const a=t.getParameters(),c=null===(i=a.encodings)||void 0===i?void 0:i[0];Sv()&&!c&&(n.encodings=[r]),c&&Object.assign(c,r),Object.assign(a,n),Yw.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(a.encodings))),await t.setParameters(a)}async applySendEncodings(e,t){try{if(!MC().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let i=0;i<e.length;i++){const n=e[i],r=t[i];r instanceof kA&&!this.isVP8Simulcast(r)&&await this.updateRtpSenderEncodings(r,n.sender)}}catch(e){Yw.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t,i){const n=Yk.parse(e);return t.forEach(((e,t)=>{const r=i[t],o=n.mediaDescriptions.find((e=>e.attributes.mid===r));o&&(wP(o,e),IP(o,e,this.store.codec))})),Yk.print(n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,i)=>{var n;null===(n=this.onFirstVideoDecoded)||void 0===n||n.call(this,e,t,i)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var i;null===(i=this.onSelectedLocalCandidateChanged)||void 0===i||i.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var i;null===(i=this.onSelectedRemoteCandidateChanged)||void 0===i||i.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let a=0;a<e.length;a++){var i,n,r,o,s;const c=e[a],u=t[a];if(u instanceof kA&&!Mn(i=u._hints).call(i,YC.LOW_STREAM)&&null!==(n=u._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=u._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(o=u._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(s=u._scalabilityMode)||void 0===s?void 0:s.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const i=c.sender.getParameters();await c.sender.setParameters(Object.assign(i,e))}}}async applySimulcastEncodings(e,t){if(!Sv()&&e.length===t.length)for(let i=0;i<e.length;i++){const n=t[i];if(n instanceof kA&&this.isVP8Simulcast(n)){const t=e[i],r={},o={high:1e3*(n._encoderConfig.bitrateMax-50),medium:5e4};r.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const s=t.sender.getParameters();await t.sender.setParameters(Object.assign(s,r))}}}isVP8Simulcast(e){var t,i,n,r,o;return!!(e instanceof kA&&Pw("SIMULCAST")&&"vp8"===this.store.codec&&!Mn(t=e._hints).call(t,YC.LOW_STREAM)&&null!==(i=e._encoderConfig)&&void 0!==i&&i.bitrateMax&&(null===(n=e._encoderConfig)||void 0===n?void 0:n.bitrateMax)>200&&null!==(r=e._scalabilityMode)&&void 0!==r&&r.numSpatialLayers&&(null===(o=e._scalabilityMode)||void 0===o?void 0:o.numSpatialLayers)>1)}logSDPExchange(e,t,i,n){if(Pw("SDP_LOGGING"))return Yw.upload("[".concat(this.store.clientId,"] exchanging ").concat(i," ").concat(t," SDP during P2PConnection.").concat(n,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===i?"remote":"local",n)}:void 0}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((e=>{e.direction="inactive"}));const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.muteRemote(e);const r=this.remoteSDP.toString();null==n||n(r),await this.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((async e=>{e.direction="sendonly"}));const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.unmuteRemote(e);const r=this.remoteSDP.toString();null==n||n(r),await this.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}async getRemoteSSRC(e,t){var i,n;if(t=null!==(i=t)&&void 0!==i?i:null===(n=this.currentRemoteDescription)||void 0===n?void 0:n.sdp){var r;const i=null===(r=Yk.parse(t).mediaDescriptions.find((t=>t.attributes.mid===e)))||void 0===r?void 0:r.attributes.ssrcs;return null==i?void 0:i[0].ssrcId}}async setRemoteDescription(e){var t;await this.peerConnection.setRemoteDescription(e),Mn(t=["connected","completed"]).call(t,this.peerConnection.iceConnectionState)||(this.isReady=!0,this.addRemoteCandidate())}mungReceiveAnswerSDP(e,t,i){const n=Yk.parse(e),r=n.mediaDescriptions.find((e=>e.attributes.mid===t));return r&&(i===pT.AUDIO&&"audio"===r.media.mediaType&&kP(r),this.useXR&&PP(n)),Yk.print(n)}};function jP(e,t,i){const n=e[t];if("function"!=typeof n)throw new Error("Cannot use mutex on object property.");return i.value=async function(){const e=this.mutex,i=await e.lock("From P2PConnection.".concat(t));try{for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return await n.apply(this,o)}finally{i()}},i}function FP(e,t){let i=document.createElement("video"),n=document.createElement("canvas");i.setAttribute("style","display:none"),n.setAttribute("style","display:none"),i.setAttribute("muted",""),i.muted=!0,i.setAttribute("autoplay",""),i.autoplay=!0,i.setAttribute("playsinline",""),n.width=IR(t.width),n.height=IR(t.height);const r=IR(t.framerate||15);document.body.append(i),document.body.append(n);let o=e._mediaStreamTrack;i.srcObject=new MediaStream([o]),i.play();const s=n.getContext("2d");if(!s)throw new jS(Bv.UNEXPECTED_ERROR,"can not get canvas context");const a=MC(),c=n.captureStream(a.supportRequestFrame?0:r).getVideoTracks()[0];c.canvas||(c.canvas=n),n.startCapture=()=>{if(!i)return n.stopCapture&&n.stopCapture();if(i.paused&&i.play(),i.videoHeight>2&&i.videoWidth>2){const e=i.videoWidth,t=i.videoHeight/e,r=n.width*t;Math.abs(r-n.height)>=2&&(Yw.debug("adjust low stream resolution","".concat(n.width,"x").concat(n.height," -> ").concat(n.width,"x").concat(r)),n.height=r)}s.drawImage(i,0,0,n.width,n.height),c.requestFrame&&c.requestFrame(),o!==e._mediaStreamTrack&&(o=e._mediaStreamTrack,i.srcObject=new MediaStream([o]))},n.stopCapture=CI((()=>n.startCapture&&n.startCapture()),r);const u=c.stop;return c.stop=()=>{u.call(c),i&&(i.remove(),i.srcObject=null,i=null),n&&(n.width=0,n.remove(),n.stopCapture&&n.stopCapture(),n.startCapture=void 0,n.stopCapture=void 0,n=null),Yw.debug("clean low stream renderer")},c}var WP,GP,HP,qP,KP,zP,YP,JP,XP,QP,ZP;VS([jP,BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],BP.prototype,"establish",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],BP.prototype,"connect",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[String,Array,String,String]),BS("design:returntype",nv)],BP.prototype,"receive",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[String,Array,String,String]),BS("design:returntype",nv)],BP.prototype,"mockReceive",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],BP.prototype,"stopReceiving",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],BP.prototype,"restartICE",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],BP.prototype,"close",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],BP.prototype,"updateEncoderConfig",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],BP.prototype,"updateSendParameters",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[_I,String]),BS("design:returntype",nv)],BP.prototype,"replaceTrack",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],BP.prototype,"muteLocal",null),VS([jP,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],BP.prototype,"unmuteLocal",null),function(e){e[e.HEIGHT=2033]="HEIGHT",e[e.FRAME_RATE=2034]="FRAME_RATE",e[e.WIDTH=2035]="WIDTH"}(WP||(WP={})),function(e){e[e.HEIGHT=2072]="HEIGHT",e[e.FRAME_RATE=2074]="FRAME_RATE",e[e.WIDTH=2076]="WIDTH"}(GP||(GP={})),function(e){e[e.FRAME_RATE=2002]="FRAME_RATE",e[e.WIDTH=2003]="WIDTH",e[e.HEIGHT=2004]="HEIGHT",e[e.PACKAGE_LOST=2005]="PACKAGE_LOST",e[e.AVG_ENCODE=2007]="AVG_ENCODE",e[e.NACKS=2009]="NACKS",e[e.PLIS=2010]="PLIS",e[e.FIRS=2011]="FIRS",e[e.BITRATE=2012]="BITRATE",e[e.PACKAGE_RATE=2031]="PACKAGE_RATE",e[e.ADAPTATION=2032]="ADAPTATION",e[e.ACTUAL_ENCODED=2060]="ACTUAL_ENCODED",e[e.BANDWIDTH=2061]="BANDWIDTH",e[e.RETRANSMIT=2062]="RETRANSMIT",e[e.TARGET_ENCODED=2064]="TARGET_ENCODED",e[e.TRANSMIT=2066]="TRANSMIT",e[e.FREEZE=2082]="FREEZE",e[e.DISABLED=2095]="DISABLED",e[e.PLAYER_STATUS=2128]="PLAYER_STATUS",e[e.QP_SUM=2143]="QP_SUM"}(HP||(HP={})),function(e){e[e.BITRATE=2069]="BITRATE",e[e.PACKAGE_LOST=2070]="PACKAGE_LOST",e[e.PACKAGE_RATE=2071]="PACKAGE_RATE",e[e.HEIGHT=2073]="HEIGHT",e[e.FRAME_RATE=2075]="FRAME_RATE",e[e.WIDTH=2077]="WIDTH"}(qP||(qP={})),function(e){e[e.JITTER=-1]="JITTER",e[e.PACKAGE_LOST=2014]="PACKAGE_LOST",e[e.WIDTH=2018]="WIDTH",e[e.HEIGHT=2019]="HEIGHT",e[e.FRAME_RATE=2020]="FRAME_RATE",e[e.JITTER_BUFFER=2023]="JITTER_BUFFER",e[e.CURRENT_DELAY=2024]="CURRENT_DELAY",e[e.NACKS=2026]="NACKS",e[e.PLIS=2027]="PLIS",e[e.FIRS=2028]="FIRS",e[e.BITRATE=2029]="BITRATE",e[e.PACKAGE_RATE=2078]="PACKAGE_RATE",e[e.FREEZE=2084]="FREEZE",e[e.DISABLED=2101]="DISABLED",e[e.PLAYER_STATUS=2129]="PLAYER_STATUS",e[e.QP_SUM=2144]="QP_SUM",e[e.I_FRAME_DELAY=2149]="I_FRAME_DELAY"}(KP||(KP={})),function(e){e[e.FRAME_RATE_DECODE=2021]="FRAME_RATE_DECODE",e[e.FRAME_RATE_RENDER=2022]="FRAME_RATE_RENDER",e[e.FREEZE_TIME=2109]="FREEZE_TIME",e[e.FREEZE_TIME_RENDER=2147]="FREEZE_TIME_RENDER"}(zP||(zP={})),function(e){e[e.PCM_LEVEL=2104]="PCM_LEVEL"}(YP||(YP={})),function(e){e[e.PACKAGE_LOST=-1]="PACKAGE_LOST",e[e.LEVEL=2038]="LEVEL",e[e.BITRATE=2039]="BITRATE",e[e.PACKAGE_RATE=2040]="PACKAGE_RATE",e[e.AEC_RETURN_LOSS=2041]="AEC_RETURN_LOSS",e[e.AEC_RETURN_LOSS_ENH=2042]="AEC_RETURN_LOSS_ENH",e[e.FREEZE=2081]="FREEZE",e[e.DISABLED=2096]="DISABLED"}(JP||(JP={})),function(e){e[e.BITRATE=2044]="BITRATE",e[e.PACKAGE_LOST=2045]="PACKAGE_LOST",e[e.PACKAGE_RATE=2046]="PACKAGE_RATE",e[e.CURRENT_DELAY=2047]="CURRENT_DELAY",e[e.JITTER_BUFFER=2054]="JITTER_BUFFER",e[e.JITTER=2055]="JITTER",e[e.FREEZE=2083]="FREEZE",e[e.DISABLED=2102]="DISABLED",e[e.PCM_LEVEL=2105]="PCM_LEVEL",e[e.PLAYER_STATUS=2130]="PLAYER_STATUS",e[e.CONCEALED_SAMPLES=2148]="CONCEALED_SAMPLES"}(XP||(XP={})),function(e){e[e.FREEZE_TIME=-1]="FREEZE_TIME",e[e.LEVEL=2043]="LEVEL"}(QP||(QP={})),function(e){e[e.RTT=2006]="RTT",e[e.CONN_TYPE=801]="CONN_TYPE"}(ZP||(ZP={}));const $P=1e3,eD=3;function tD(e,t,i){null!=i&&Number.isFinite(i)&&(e[t]=Math.round(Math.max(0,i)))}function iD(e){const t={[ZP.CONN_TYPE]:0,[ZP.RTT]:e.rtt};switch(e.selectedCandidatePair.localCandidate.candidateType){case"relay":{const i=e.selectedCandidatePair.localCandidate.relayProtocol;"udp"===i&&(t[ZP.CONN_TYPE]=1),"tcp"===i&&(t[ZP.CONN_TYPE]=3),"tls"===i&&(t[ZP.CONN_TYPE]=4);break}case"srflx":t[ZP.CONN_TYPE]=2}return t}class nD extends rE{constructor(e){super(),oh(this,"store",void 0),oh(this,"uploadWRTCStatsTimer",void 0),oh(this,"uploadOutboundDenoiserStatsTimer",void 0),oh(this,"uploadExtStatsTimer",void 0),oh(this,"uploadExtUsageStatsTimer",void 0),oh(this,"uploadInboundExtStatsTimer",void 0),oh(this,"requestStats",void 0),oh(this,"requestTransportStats",void 0),oh(this,"requestLocalMedia",void 0),oh(this,"requestRemoteMedia",void 0),oh(this,"requestAllTracks",void 0),oh(this,"requestVideoIsReady",void 0),oh(this,"requestUploadStats",void 0),oh(this,"requestUpload",void 0),oh(this,"uploadOutboundStarted",!1),oh(this,"uploadInboundStarted",!1),oh(this,"uploadTransportStarted",!1),oh(this,"uploadExtensionUsageStarted",!1),oh(this,"lastRecvStats",void 0),oh(this,"lastSendStats",void 0),oh(this,"lastFullRecvStats",void 0),oh(this,"lastFullSendStats",void 0),oh(this,"needUploadRenderFreezeTime",!0),this.store=e}uploadWRTCStats(e){if(!this.requestStats||!this.requestUploadStats)return;let t,i;if(this.uploadTransportStarted&&(t=this.requestStats(),this.store.useP2P&&(i=this.requestStats(!0))),!t&&this.uploadOutboundStarted&&(t=this.requestStats()),!i&&this.uploadInboundStarted&&(i=this.requestStats(!0)),t||i){const n={};if(this.uploadTransportStarted&&t){const r=this.getTransportStats(t,i,e);r&&(n.misc=[r])}if(this.uploadOutboundStarted&&t){const i=this.getOutboundStats(t,e?this.lastSendStats:this.lastFullSendStats,e);i&&(n.outbound=[i])}if(this.uploadInboundStarted&&i){const t=this.getInboundStats(i,e?this.lastRecvStats:this.lastFullRecvStats,e);t&&(n.inbound=t)}this.requestUploadStats(n)}this.lastRecvStats=i,this.lastSendStats=t,e||(this.lastFullRecvStats=i,this.lastFullSendStats=t)}startUploadWRTCStats(){if(this.uploadWRTCStatsTimer)return;let e=1;this.uploadWRTCStatsTimer=window.setInterval((()=>{if(!this.uploadTransportStarted&&!this.uploadInboundStarted&&!this.uploadOutboundStarted)return this.stopUploadWRTCStats();this.uploadWRTCStats(e!==eD),++e===eD+1&&(e=1)}),$P)}stopUploadWRTCStats(){window.clearInterval(this.uploadWRTCStatsTimer),this.uploadWRTCStatsTimer=void 0,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0)}getTransportStats(e,t,i){if(!this.requestStats)return;if(i)return null==e.rtt?void 0:{addition:{[ZP.RTT]:e.rtt,[ZP.CONN_TYPE]:void 0}};const n=iD(e);if(this.store.useP2P){if(t){const e=iD(t);n[ZP.CONN_TYPE]+=e[ZP.CONN_TYPE]<<3}n[ZP.CONN_TYPE]+=110}else n[ZP.CONN_TYPE]+=100;return{addition:n}}getOutboundStats(e,t,i){if(!this.requestUploadStats||!this.requestLocalMedia)return;const n=this.requestLocalMedia();if(!n||0===n.length)return;let r,o,s;return n.forEach((n=>{let[a,{track:c,ssrcs:u}]=n;switch(a){case gT.LocalVideoLowTrack:case gT.LocalVideoTrack:if(a===gT.LocalVideoTrack){const n=function(e,t,i,n,r){const o=t.videoSend.find((t=>t.ssrc===e));if(!o)return;const s={},{sentFrame:a,inputFrame:c}=o;if(c&&a){const e=c.frameRate,t=a.frameRate;s[HP.FREEZE]=function(e,t){let i=!0;return i=!(e<=5)&&(e<=10?t<3:e<=20?t<4:t<5),i}(e,t)?1:0}if(tD(s,HP.QP_SUM,o.qpSumPerFrame),r)return s;switch(a&&(tD(s,HP.HEIGHT,a.height),tD(s,HP.WIDTH,a.width),tD(s,HP.FRAME_RATE,a.frameRate)),s[HP.DISABLED]=n._originMediaStreamTrack&&!n._originMediaStreamTrack.enabled||n._mediaStreamTrack&&!n._mediaStreamTrack.enabled?1:0,o.adaptionChangeReason){case"none":s[HP.ADAPTATION]=0;break;case"cpu":s[HP.ADAPTATION]=1;break;case"bandwidth":s[HP.ADAPTATION]=2;break;case"other":s[HP.ADAPTATION]=3}s[HP.PLAYER_STATUS]=fI[n._player?n._player.videoElementStatus:"uninit"],tD(s,HP.NACKS,o.nacksCount),tD(s,HP.PLIS,o.plisCount),tD(s,HP.FIRS,o.firsCount),tD(s,HP.AVG_ENCODE,o.avgEncodeMs);const u=i&&i.videoSend.find((t=>t.ssrc===e));if(u){let e=r?$P:$P*eD;u.timestamp&&o.timestamp&&(e=o.timestamp-u.timestamp),null!=u.packets&&null!=o.packets&&tD(s,HP.PACKAGE_RATE,1e3*(o.packets-u.packets)/e),null!=o.packetsLost&&null!=u.packetsLost&&tD(s,HP.PACKAGE_LOST,o.packetsLost-u.packetsLost),null!=u.bytes&&null!=o.bytes&&tD(s,HP.BITRATE,8*(o.bytes-u.bytes)/e)}return s}(u[0].ssrcId,e,t,c,i),r=i?null:function(e,t,i){const n=t.videoSend.find((t=>t.ssrc===e));if(!n)return null;const r={},o=n.inputFrame,s=o&&o.height||i&&i._videoHeight||0,a=o&&o.width||i&&i._videoWidth||0,c=o&&o.frameRate||0;return tD(r,WP.HEIGHT,s),tD(r,WP.WIDTH,a),tD(r,WP.FRAME_RATE,c),r}(u[0].ssrcId,e,c),s=i?null:function(e){const t={};return tD(t,HP.RETRANSMIT,e.bitrate.retransmit),tD(t,HP.TARGET_ENCODED,e.bitrate.targetEncoded),tD(t,HP.ACTUAL_ENCODED,e.bitrate.actualEncoded),tD(t,HP.TRANSMIT,e.bitrate.transmit),tD(t,HP.BANDWIDTH,e.sendBandwidth),t}(e);o=Object.assign({},n,r,s)}else s=i?void 0:function(e,t,i){const n=t.videoSend.find((t=>t.ssrc===e));if(!n)return;const r={},o=n.sentFrame;if(o&&(tD(r,qP.HEIGHT,o.height),tD(r,qP.WIDTH,o.width),tD(r,qP.FRAME_RATE,o.frameRate)),i){const t=i.videoSend.find((t=>t.ssrc===e));if(t){let e=$P*eD;t.timestamp&&n.timestamp&&(e=n.timestamp-t.timestamp),null!=t.packets&&null!=n.packets&&tD(r,qP.PACKAGE_RATE,1e3*(n.packets-t.packets)/e),null!=n.packetsLost&&null!=t.packetsLost&&tD(r,qP.PACKAGE_LOST,n.packetsLost-t.packetsLost),null!=t.bytes&&null!=n.bytes&&tD(r,qP.BITRATE,8*(n.bytes-t.bytes)/e)}}return r}(u[0].ssrcId,e,t);break;case gT.LocalAudioTrack:r=i?void 0:function(e,t,i,n){const r=t.audioSend.find((t=>t.ssrc===e));if(!r)return;const o={};o[JP.DISABLED]=n._originMediaStreamTrack&&!n._originMediaStreamTrack.enabled||n._mediaStreamTrack&&!n._mediaStreamTrack.enabled?1:0;const s=n._source.getAccurateVolumeLevel(),a=r.inputLevel;tD(o,JP.LEVEL,100*(null==a?s:a)),tD(o,YP.PCM_LEVEL,100*s),tD(o,JP.AEC_RETURN_LOSS,r.aecReturnLoss),tD(o,JP.AEC_RETURN_LOSS_ENH,r.aecReturnLossEnhancement),o[JP.FREEZE]=0;const c=i&&i.audioSend.find((t=>t.ssrc===e));if(c){let e=$P*eD;c.timestamp&&r.timestamp&&(e=r.timestamp-c.timestamp),null!=c.bytes&&null!=r.bytes&&tD(o,JP.BITRATE,8*(r.bytes-c.bytes)/e),null!=c.packets&&null!=r.packets&&tD(o,JP.PACKAGE_RATE,1e3*(r.packets-c.packets)/e)}return o}(u[0].ssrcId,e,t,c)}})),{high:o,low:s,audio:r}}getInboundStats(e,t,i){if(!this.requestRemoteMedia)return;const n=this.requestRemoteMedia()||[],r=[];return n.forEach((n=>{let[o,s]=n;const a={peer:o.uid};if(s.has(pT.VIDEO)&&o.videoTrack){const n=o._videoSSRC&&this.requestVideoIsReady&&this.requestVideoIsReady(o._videoSSRC)||!1,r=o.videoTrack?function(e,t,i,n,r,o,s){const a=t.videoRecv.find((t=>t.ssrc===e));if(!a)return;const c={},{receivedFrame:u,outputFrame:d,decodeFrameRate:l}=a,h=i&&i.videoRecv.find((t=>t.ssrc===e));if(c[KP.FREEZE]=r&&fD.isRemoteVideoFreeze(n,a,h)?1:0,tD(c,zP.FRAME_RATE_DECODE,l),tD(c,KP.QP_SUM,a.qpSumPerFrame),a.framesRateFirefox&&tD(c,KP.FRAME_RATE,a.framesRateFirefox),u&&tD(c,KP.FRAME_RATE,u.frameRate),h){const e=t.timestamp-i.timestamp||(s?$P:eD*$P);null!=a.packetsLost&&null!=h.packetsLost&&tD(c,KP.PACKAGE_LOST,a.packetsLost-h.packetsLost),null!=h.bytes&&null!=a.bytes&&tD(c,KP.BITRATE,8*(a.bytes-h.bytes)/e),null!=h.packets&&null!=a.packets&&tD(c,KP.PACKAGE_RATE,1e3*(a.packets-h.packets)/e)}if(s)return c;if(u?(tD(c,KP.HEIGHT,u.height),tD(c,KP.WIDTH,u.width)):n&&(tD(c,KP.HEIGHT,n._videoHeight||0),tD(c,KP.WIDTH,n._videoWidth||0)),d&&tD(c,zP.FRAME_RATE_RENDER,d.frameRate),tD(c,KP.JITTER_BUFFER,a.jitterBufferMs),tD(c,KP.CURRENT_DELAY,a.currentDelayMs),tD(c,KP.FIRS,a.firsCount),tD(c,KP.NACKS,a.nacksCount),tD(c,KP.PLIS,a.plisCount),n){c[KP.DISABLED]=n._originMediaStreamTrack.enabled&&n._mediaStreamTrack.enabled?0:1;const e=n._player;if(e){const{freezeTimeCounterList:t,renderFreezeAccTime:i}=e;if(t&&t.length>0&&tD(c,zP.FREEZE_TIME,t.splice(0,1)[0]),o&&"visible"===yA.visibility){const t=Math.min(6e3,i);e.renderFreezeAccTime=Math.max(0,i-t),tD(c,zP.FREEZE_TIME_RENDER,t)}}}if(c[KP.PLAYER_STATUS]=fI[n._player?n._player.videoElementStatus:"uninit"],h&&void 0!==a.totalInterFrameDelay&&void 0!==a.totalSquaredInterFrameDelay&&void 0!==h.totalInterFrameDelay&&void 0!==h.totalSquaredInterFrameDelay){const e=a.totalInterFrameDelay-h.totalInterFrameDelay,t=a.totalSquaredInterFrameDelay-h.totalSquaredInterFrameDelay,i=a.framesDecodeCount-h.framesDecodeCount,n=e/i*1e3,r=Math.round(1e3*Math.sqrt((t-Math.pow(e,2)/i)/i));!isNaN(r)&&n+r>Math.max(3*n,n+150)&&(c[KP.I_FRAME_DELAY]=r)}return c}(o._videoSSRC,e,t,o.videoTrack,!0===n,this.needUploadRenderFreezeTime,i):void 0;r&&(a.video=r)}if(s.has(pT.AUDIO)&&o.audioTrack){const n=o.audioTrack?function(e,t,i,n,r){const o=t.audioRecv.find((t=>t.ssrc===e));if(!o)return;const s={},a=i&&i.audioRecv.find((t=>t.ssrc===e)),{receivedFrames:c,droppedFrames:u}=o;var d;if(tD(s,XP.JITTER,o.jitterMs),null!=c&&null!=u&&(s[XP.FREEZE]=0===(d=c)||100*u/d>20?1:0),a){const e=t.timestamp-i.timestamp||(r?$P:$P*eD);null!=o.packets&&null!=a.packets&&tD(s,XP.PACKAGE_RATE,1e3*(o.packets-a.packets)/e),null!=a.bytes&&null!=o.bytes&&tD(s,XP.BITRATE,8*(o.bytes-a.bytes)/e),null!=o.packetsLost&&null!=a.packetsLost&&tD(s,XP.PACKAGE_LOST,o.packetsLost-a.packetsLost)}if(r)return s;const l=n._source.getAccurateVolumeLevel(),h=o.outputLevel;if(tD(s,QP.LEVEL,100*(null==h?l:h)),tD(s,XP.PCM_LEVEL,100*l),n&&(s[XP.DISABLED]=n._originMediaStreamTrack.enabled&&n._mediaStreamTrack.enabled?0:1),tD(s,XP.JITTER_BUFFER,o.jitterBufferMs),tD(s,XP.CURRENT_DELAY,o.jitterBufferMs),s[XP.PLAYER_STATUS]=fI[JI.getPlayerState(n.getTrackId())],a){const e=o.concealedSamples-a.concealedSamples;e>0&&tD(s,XP.CONCEALED_SAMPLES,e)}return s}(o._audioSSRC,e,t,o.audioTrack,i):void 0;n&&(a.audio=n)}(a.video||a.audio)&&r.push(a)})),this.needUploadRenderFreezeTime=!this.needUploadRenderFreezeTime,r}startUploadTransportStats(){this.uploadTransportStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats()}stopUploadTransportStats(){this.uploadTransportStarted=!1}startUploadOutboundStats(){this.uploadOutboundStarted||(this.uploadOutboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=window.setInterval((()=>{if(!this.requestAllTracks||!this.requestUpload)return;const e=(this.requestAllTracks()||[]).find((e=>e instanceof lA));if(e&&e._external.getDenoiserStats){const t=e._external.getDenoiserStats();t&&this.requestUpload(SS.DENOISER_STATS,t)}}),2e3),this.uploadExtStatsTimer&&window.clearInterval(this.uploadExtStatsTimer),this.uploadExtStatsTimer=window.setInterval((()=>{this.requestAllTracks&&this.requestUpload&&this.requestAllTracks().forEach((e=>{e.getProcessorStats().forEach((e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)}))}))}),2e3))}stopUploadOutboundStats(){this.uploadOutboundStarted&&(this.uploadOutboundStarted=!1,this.lastSendStats&&(this.lastSendStats.videoSend=[],this.lastSendStats.audioSend=[],this.lastSendStats=void 0),this.uploadOutboundDenoiserStatsTimer&&window.clearInterval(this.uploadOutboundDenoiserStatsTimer),this.uploadOutboundDenoiserStatsTimer=void 0)}startUploadInboundStats(){this.uploadInboundStarted||(this.uploadInboundStarted=!0,this.uploadWRTCStatsTimer||this.startUploadWRTCStats(),this.uploadInboundExtStatsTimer&&window.clearInterval(this.uploadInboundExtStatsTimer),this.uploadInboundExtStatsTimer=window.setInterval((()=>{this.requestUpload&&this.requestRemoteMedia&&(this.requestRemoteMedia()||[]).forEach((e=>{let[t,i]=e;i.has(pT.VIDEO)&&t.videoTrack&&t.videoTrack.getProcessorStats().forEach((e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)})),i.has(pT.AUDIO)&&t.audioTrack&&t.audioTrack.getProcessorStats().forEach((e=>{this.requestUpload&&this.requestUpload(e.type,e.stats)}))}))}),2e3))}stopUploadInboundStats(){this.uploadInboundStarted&&(this.uploadInboundStarted=!1,this.lastRecvStats&&(this.lastRecvStats.videoRecv=[],this.lastRecvStats.audioRecv=[],this.lastRecvStats=void 0))}startUploadExtensionUsageStats(){if(this.uploadExtensionUsageStarted)return;this.uploadExtensionUsageStarted=!0,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer);const e=new Map;this.uploadExtUsageStatsTimer=window.setInterval((async()=>{const t=Date.now(),i={connectionInterval:Pw("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3,details:[],lts:t};let n=[];const r=this.requestAllTracks&&this.requestAllTracks()||[];for(const e of r)!e.muted&&e.enabled&&(n=n.concat(await e.getProcessorUsage()));const o=this.requestRemoteMedia&&this.requestRemoteMedia()||[];for(const[e,c]of o)c.has(pT.VIDEO)&&e.videoTrack&&(n=n.concat(await e.videoTrack.getProcessorUsage())),c.has(pT.AUDIO)&&e.audioTrack&&(n=n.concat(await e.audioTrack.getProcessorUsage()));if(0===n.length)return;i.details=function(e,t){const i={};for(const{id:s,value:a,level:c,direction:u}of e){var n;const e=null!==(n=t.get(s))&&void 0!==n?n:0,d=2===a?e+Pw("EXTENSION_USAGE_UPLOAD_INTERVAL")/1e3:e;var r,o;t.set(s,d),i[s]?(2===a&&(i[s].value=a),c>i[s].level&&(i[s].level=c),"remote"===u&&(i[s].remoteUidCount+=1),i[s].totalTs=null!==(r=t.get(s))&&void 0!==r?r:0):i[s]={value:a,level:c,remoteUidCount:"local"===u?0:1,totalTs:null!==(o=t.get(s))&&void 0!==o?o:0}}return Object.keys(i).map((e=>{const{level:t,value:n,totalTs:r}=i[e];return{id:e,level:t,value:n,totalTs:r}}))}(n,e);const s=Date.now(),a=s>t?s:t+1;this.requestUpload&&this.requestUpload(SS.EXTENSION_USAGE_STATS,{usageStats:i,sendTs:a})}),Pw("EXTENSION_USAGE_UPLOAD_INTERVAL"))}stopUploadExtensionUsageStats(){this.uploadExtensionUsageStarted&&(this.uploadExtensionUsageStarted=!1,this.uploadExtUsageStatsTimer&&window.clearInterval(this.uploadExtUsageStatsTimer),this.uploadExtUsageStatsTimer=void 0)}}class rD{get hasVideo(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}get hasAudio(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}get audioTrack(){if(this.hasAudio||this._audio_pre_subscribed)return this._audioTrack}get videoTrack(){if(this.hasVideo||this._video_pre_subscribed)return this._videoTrack}get dataChannels(){return this._dataChannels}constructor(e,t){oh(this,"uid",void 0),oh(this,"_uintid",void 0),oh(this,"_trust_in_room_",!0),oh(this,"_trust_audio_enabled_state_",!0),oh(this,"_trust_video_enabled_state_",!0),oh(this,"_trust_audio_mute_state_",!0),oh(this,"_trust_video_mute_state_",!0),oh(this,"_audio_muted_",!1),oh(this,"_video_muted_",!1),oh(this,"_audio_enabled_",!0),oh(this,"_video_enabled_",!0),oh(this,"_audio_added_",!1),oh(this,"_video_added_",!1),oh(this,"_is_pre_created",!1),oh(this,"_video_pre_subscribed",!1),oh(this,"_audio_pre_subscribed",!1),oh(this,"_trust_video_stream_added_state_",!0),oh(this,"_trust_audio_stream_added_state_",!0),oh(this,"_audioTrack",void 0),oh(this,"_videoTrack",void 0),oh(this,"_dataChannels",[]),oh(this,"_audioSSRC",void 0),oh(this,"_videoSSRC",void 0),oh(this,"_audioOrtc",void 0),oh(this,"_videoOrtc",void 0),oh(this,"_cname",void 0),oh(this,"_rtxSsrcId",void 0),oh(this,"_videoMid",void 0),oh(this,"_audioMid",void 0),this.uid=e,this._uintid=t}}var oD;function sD(e,t){var i;let n;switch(t){case gT.LocalAudioTrack:n=iT.Audio;break;case gT.LocalVideoTrack:n=Mn(i=e._hints).call(i,YC.SCREEN_TRACK)?iT.Screen:iT.High;break;case gT.LocalVideoLowTrack:n=iT.Low}return n}function aD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function cD(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?aD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):aD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}!function(e){e.SEND_ONLY="SEND_ONLY",e.RECEIVE_ONLY="RECEIVE_ONLY"}(oD||(oD={}));class uD extends rE{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(ET.StateChange,t,this._state)}constructor(e,t){super(),oh(this,"store",void 0),oh(this,"statsUploader",void 0),oh(this,"sendConnection",void 0),oh(this,"recvConnection",void 0),oh(this,"localTrackMap",new Map),oh(this,"remoteUserMap",new Map),oh(this,"localDataChannels",[]),oh(this,"pendingLocalTracks",[]),oh(this,"pendingRemoteTracks",[]),oh(this,"statsCollector",void 0),oh(this,"dtlsFailedCount",0),oh(this,"sendMutex",new YE("P2PChannel2-send-mutex")),oh(this,"recvMutex",new YE("P2PChannel2-recv-mutex")),oh(this,"_state",vT.Disconnected),oh(this,"_restartStates",["disconnected","failed"]),oh(this,"reconnectInterval",void 0),oh(this,"uploadUnplinkStarted",!1),oh(this,"uploadDownlinkStarted",!1),oh(this,"uplinkStateUploadInterval",void 0),oh(this,"downlinkStatsUploadInterval",void 0),oh(this,"handleMuteLocalTrack",(async(e,t,i)=>{const n=await this.sendMutex.lock("Locking from P2PChannel2.handleMuteLocalTrack");try{if(!this.sendConnection||this.state!==vT.Connected)return void i(new jv(Bv.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established."));const n=this.filterTobeMutedTracks(e);if(0===n.length)return void t();const s=n.find((e=>"videoLowTrack"===e[0]));s&&s[1].track._originMediaStreamTrack.stop(),await this.sendConnection.muteLocal(n.map((e=>{let[,{id:t}]=e;return t})));let a=!1;var r,o;a="video"===e.trackMediaType?!(null===(r=this.localTrackMap.get(gT.LocalAudioTrack))||void 0===r||!r.track._muted):void 0===(null===(o=this.localTrackMap.get(gT.LocalVideoTrack))||void 0===o?void 0:o.id);const c=this.createMuteMessage(n);await bE(this,ET.RequestMuteLocal,c);const u="video"===e.trackMediaType?PT.MUTE_LOCAL_VIDEO:PT.MUTE_LOCAL_AUDIO;await bE(this,ET.RequestP2PMuteLocal,{action:u,message:c,isMuteAll:a}),t()}catch(e){i(e)}finally{n()}})),oh(this,"handleUnmuteLocalTrack",(async(e,t,i)=>{const n=await this.sendMutex.lock("Locking from P2PChannel2.handleUnmuteLocalTrack");try{if(!this.sendConnection||this.state!==vT.Connected)return void i(new jv(Bv.INVALID_OPERATION,"Cannot call P2PChannel2.handleUnmuteLocalTrack before sendConnection established."));const n=this.filterTobeUnmutedTracks(e);if(0===n.length)return void t();await this.sendConnection.unmuteLocal(n.map((e=>{let[,{id:t}]=e;return t})));const r=this.createUnmuteMessage(n),o="video"===e.trackMediaType?PT.UNMUTE_LOCAL_VIDEO:PT.UNMUTE_LOCAL_AUDIO;await bE(this,ET.RequestP2PMuteLocal,{action:o,message:r}),t()}catch(e){i(e)}finally{n()}})),oh(this,"handleUpdateVideoEncoder",(async(e,t,i)=>{const n=await this.sendMutex.lock("Locking from P2PChannel2.handleSetVideoEncoder");try{const i=this.localTrackMap.get(gT.LocalVideoTrack);if(!this.sendConnection||!i||i.track!==e||this.state!==vT.Connected)return void t();const{id:n,track:r}=i;n&&(await this.sendConnection.updateSendParameters(n,r),await this.sendConnection.updateEncoderConfig(n,r),this.emit(ET.UpdateVideoEncoder,r)),t()}catch(e){i(e)}finally{n()}})),oh(this,"handleSetOptimizationMode",(async(e,t,i)=>{const n=await this.sendMutex.lock("Locking from P2PChannel2.handleSetOptimizationMode");try{const i=this.localTrackMap.get(gT.LocalVideoTrack);if(!this.sendConnection||!i||i.track!==e||this.state!==vT.Connected)return;const{id:n,track:r}=i;n&&await this.sendConnection.updateSendParameters(n,r),t()}catch(e){i(e)}finally{n()}})),oh(this,"handleReplaceTrack",(async(e,t,i,n)=>{let r;Yw.debug("[".concat(this.store.clientId,"] P2PChannel2 handleReplaceTrack for [track-id-").concat(e.getTrackId(),"]")),"boolean"==typeof n&&n||(r=await this.sendMutex.lock("From P2PChannel2.handleReplaceTrack"));try{var o;const i=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:i}]=t;return e===i}));if(!this.sendConnection||!i||void 0===i[1].id||this.state!==vT.Connected)return void t();if(await(null===(o=this.sendConnection)||void 0===o?void 0:o.replaceTrack(e,i[1].id)),i[0]===gT.LocalVideoTrack&&MC().supportDualStreamEncoding){const t=this.localTrackMap.get(gT.LocalVideoLowTrack);if(t){const i=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=i,t.track._originMediaStreamTrack=i,await new nv(((e,i)=>{this.handleReplaceTrack(t.track,e,i,!0)}))}}t()}catch(e){i(e)}finally{var s;null===(s=r)||void 0===s||s()}})),oh(this,"handleGetLocalVideoStats",(e=>{e(this.statsCollector.getLocalVideoTrackStats())})),oh(this,"handleGetLocalAudioStats",(e=>{e(this.statsCollector.getLocalAudioTrackStats())})),oh(this,"handleGetRemoteVideoStats",(e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid])),oh(this,"handleGetRemoteAudioStats",(e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid])),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new nD(e),this.bindStatsUploaderEvents(),this.reconnectInterval=window.setInterval((()=>{[this.sendConnection,this.recvConnection].forEach((e=>{e&&("disconnected"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||this.handleDisconnect(e.direction))}))}),Pw("ICE_RESTART_INTERVAL"))}async startP2PConnection(e,t){throw new jv(Bv.NOT_SUPPORTED,"p2p mode does not support startP2PConnection.")}async connect(e,t,i,n,r,o){throw new jv(Bv.NOT_SUPPORTED,"p2p mode does not support connect.")}async startP2P(e,t){let i;try{if(t){this.recvConnection&&(Yw.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset recvConnection.")),this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection)),i=await this.recvMutex.lock("From P2PChannel.startP2P"),this.recvConnection=new BP(e,this.store,CS.RECEIVE_ONLY),this.bindConnectionEvents(this.recvConnection);const n=await this.recvConnection.establish(t);return{iceParameters:n.iceParameters,dtlsParameters:n.dtlsParameters,sdp:n.sdp}}{this.state=vT.New,this.sendConnection&&(Yw.warning("[".concat(this.store.clientId,"] P2PChannel.startP2P reset sendConnection.")),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection)),i=await this.sendMutex.lock("From P2PChannel.startP2P"),this.sendConnection=new BP(e,this.store),this.store.peerConnectionStart(),this.bindConnectionEvents(this.sendConnection);const t=await this.sendConnection.establish();return{iceParameters:t.iceParameters,dtlsParameters:t.dtlsParameters,sdp:t.sdp}}}finally{i&&i()}}async p2pConnect(e){if(!this.sendConnection)throw new jv(Bv.UNEXPECTED_ERROR,"Cannot P2PChannel2.p2pConnect before P2PChannel2.startP2PConnection .");this.store.peerConnectionStart(),await this.sendConnection.connect(e),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=vT.Connected}async addRemoteCandidate(e,t){if(t===CS.RECEIVE_ONLY){if(!this.sendConnection)throw new jv(Bv.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.sendConnection.addRemoteCandidate(e)}else{if(!this.recvConnection)throw new jv(Bv.UNEXPECTED_ERROR,"Cannot P2PChannel2.connect before P2PChannel2.addRemoteCandidate .");await this.recvConnection.addRemoteCandidate(e)}}publish(e,t,i){var n=this;return Nk((function*(){const r=yield wk(n.sendMutex.lock("From P2PChannel.publish"));try{if(!n.sendConnection||n.state!==vT.Connected){n.throwIfTrackTypeNotMatch(e);const t=e.filter((e=>-1===n.pendingLocalTracks.indexOf(e)));return void(n.pendingLocalTracks=n.pendingLocalTracks.concat(t))}n.store.pubId=n.store.pubId+1,bk.markPublishStart(n.store.clientId,n.store.pubId);const r=n.filterTobePublishedTracks(e,t,i);if(0===r.length)return void(yield wk(n.tryToUnmuteAudio(e)));r.forEach((e=>{let{track:t,type:i}=e;const r=Date.now();n.store.publish(t.getTrackId(),i===gT.LocalAudioTrack?"audio":"video",r)})),n.bindLocalTrackEvents(r);const o=yield wk(n.sendConnection.send(r.map((e=>{let{track:t}=e;return t})),n.store.codec,n.store.audioCodec)),s=(yield wk(o.next())).value,a=n.createGatewayPublishMessage(r,s);try{yield a}catch(e){throw o.throw(e),(null==e?void 0:e.code)===Bv.WS_ABORT&&r.forEach((e=>{let{track:t}=e;-1===n.pendingLocalTracks.indexOf(t)&&n.pendingLocalTracks.push(t)})),n.unbindLocalTrackEvents(r),e}yield wk(o.next()),r.forEach((e=>{let{type:t}=e;n.statsCollector.addLocalStats(t)})),n.statsUploader.startUploadOutboundStats(),n.assignLocalTracks(r,s),r.forEach((e=>{let{track:t,type:i}=e;const r=Date.now();n.store.publish(t.getTrackId(),i===gT.LocalAudioTrack?"audio":"video",void 0,r)})),n.startUploadUplinkState()}finally{r()}}))()}async unpublish(e){if(!this.sendConnection||this.state!==vT.Connected)return void(0===e.length?this.pendingLocalTracks.length=0:this.pendingLocalTracks=this.pendingLocalTracks.filter((t=>!Mn(e).call(e,t))));const t=this.filterTobeUnpublishedTracks(e);if(0===t.length)return;const i=t.find((e=>"videoLowTrack"===e[0]));i&&i[1].track.close();const n=this.createGatewayUnpublishMessage(t);if(await this.sendConnection.stopSending(t.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map((e=>{let[t,{track:i}]=e;return{type:t,track:i}}))),t.forEach((e=>{let[t]=e;this.statsCollector.removeLocalStats(t)})),0===this.localTrackMap.size&&(this.statsUploader.stopUploadOutboundStats(),this.stopUploadUplinkState()),this.sendConnection&&this.state===vT.Connected)return i&&i[1].track.close(),n;e.forEach((e=>{const t=this.pendingLocalTracks.indexOf(e);-1!==t&&this.pendingLocalTracks.splice(t,1)}))}startUploadUplinkState(){if(this.uploadUnplinkStarted)return;this.uploadUnplinkStarted=!0,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval);const e=()=>{const e=[],t=[];Array.from(this.localTrackMap.entries()).forEach((i=>{let[n,{track:r,ssrcs:o}]=i;const s={stream_type:sD(r,n),ssrcs:o};r._muted||!r._enabled?e.push(s):t.push(s)})),e.length>0&&e.forEach((e=>{bE(this,ET.RequestMuteLocal,[e])})),t.length>0&&t.forEach((e=>{bE(this,ET.RequestUnmuteLocal,[e])}))};e(),this.uplinkStateUploadInterval=window.setInterval((()=>{e()}),3e3)}stopUploadUplinkState(){this.uploadUnplinkStarted&&(this.uploadUnplinkStarted=!1,this.uplinkStateUploadInterval&&window.clearInterval(this.uplinkStateUploadInterval))}publishLowStream(e){return Nk((function*(){throw new jv(Bv.NOT_SUPPORTED,"p2p mode does not support publishLowStream.")}))()}async republish(){this.pendingLocalTracks.length>0&&(Yw.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await EE(this,ET.RequestRePublish,this.pendingLocalTracks),this.emit(ET.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[])}async unpublishLowStream(){throw new jv(Bv.NOT_SUPPORTED,"p2p mode does not support unpublishLowStream.")}async subscribe(e,t,i,n){var r;if(!this.recvConnection)throw new jv(Bv.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");if(null!==(r=this.remoteUserMap.get(e))&&void 0!==r&&r.has(t))return;const{track:o,mid:s,transceiver:a}=await this.recvConnection.receive(t,[{ssrcId:i}],String(e.uid),n);t===pT.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(o):(e._audioTrack=new FA(o,e.uid,e._uintid,this.store),Yw.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),a&&e._audioTrack._updateRtpTransceiver(a),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoSSRC=i,e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(o):(e._videoTrack=new jA(o,e.uid,e._uintid,this.store),Yw.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),a&&e._videoTrack._updateRtpTransceiver(a),this.bindRemoteTrackEvents(e,e._videoTrack));const c=this.remoteUserMap.get(e);c?c.set(t,s):this.remoteUserMap.set(e,new Map([[t,s]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats(),this.startUploadDownlinkState();const u=this.pendingRemoteTracks.findIndex((i=>{let{user:n,kind:r}=i;return n.uid===e.uid&&t===r}));-1!==u&&(this.pendingRemoteTracks.splice(u,1),this.emit(ET.MediaReconnectEnd,e.uid))}async mockSubscribe(e,t,i,n){if(!this.recvConnection)throw new jv(Bv.INVALID_OPERATION,"Cannot subscribe remote user when recvConnection disconnected.");await this.recvConnection.mockReceive(t,[{ssrcId:i}],String(e.uid),n)}async unsubscribe(e,t,i){const n=this.pendingRemoteTracks.filter((i=>{let{user:n,kind:r}=i;return void 0!==t?n.uid===e.uid&&t===r:n.uid===e.uid}));if(n.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),this.recvConnection||i||n.forEach((t=>{let{kind:i}=t;var n;if(i===pT.AUDIO)null===(n=e._audioTrack)||void 0===n||n._destroy(),e._audioTrack=void 0;else if(i===pT.VIDEO){var r;null===(r=e._videoTrack)||void 0===r||r._destroy(),e._videoTrack=void 0}})),!this.recvConnection)return;const r=this.filterTobeUnSubscribedTracks(e,t);0!==r.length&&(await this.recvConnection.stopReceiving(r.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawRemoteTracks(r),0===this.remoteUserMap.size&&(this.statsUploader.stopUploadInboundStats(),this.stopUploadDownlinkState()),r.forEach((e=>{let[t,{kind:n}]=e;var r,o;if(n===pT.VIDEO&&t._videoSSRC&&(null===(r=this.recvConnection)||void 0===r||r.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),n===pT.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),i||(null===(o=t._videoTrack)||void 0===o||o._destroy(),t._videoTrack=void 0);else if(n===pT.AUDIO){var s;this.unbindRemoteTrackEvents(t._audioTrack),i||(null===(s=t._audioTrack)||void 0===s||s._destroy(),t._audioTrack=void 0)}})),r.forEach((e=>{let[,{kind:t}]=e;bE(this,ET.RequestP2PMuteRemote,t)})))}startUploadDownlinkState(){if(this.uploadDownlinkStarted)return;this.uploadDownlinkStarted=!0,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval);const e=()=>Array.from(this.remoteUserMap.entries()).forEach((e=>{let[,t]=e;[pT.VIDEO,pT.AUDIO].forEach((e=>{t.has(e)?bE(this,ET.RequestP2PUnmuteRemote,e):bE(this,ET.RequestP2PMuteRemote,e)}))}));e(),this.downlinkStatsUploadInterval=window.setInterval((()=>{e()}),3e3)}stopUploadDownlinkState(){this.uploadDownlinkStarted&&(this.uploadDownlinkStarted=!1,this.downlinkStatsUploadInterval&&window.clearInterval(this.downlinkStatsUploadInterval))}getAllDataChannels(){return this.localDataChannels}async massSubscribe(e){throw new jv(Bv.NOT_SUPPORTED,"p2p mode does not support massSubscribe.")}async massSubscribeNoLock(e){throw new jv(Bv.NOT_SUPPORTED,"p2p mode does not support massSubscribeNoLock.")}async massUnsubscribe(e){throw new jv(Bv.NOT_SUPPORTED,"p2p mode does not support massUnsubscribe.")}async massUnsubscribeNoLock(e){throw new jv(Bv.NOT_SUPPORTED,"p2p mode does not support massUnsubscribeNoLock.")}async muteRemote(e,t){if(!this.recvConnection)return;const i=this.remoteUserMap.get(e);if(!i)return void Yw.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid,"."));if(!i.get(t))return void Yw.warning("[".concat(this.store.clientId,"] P2PChannel2.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const n=t===pT.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==n&&this.recvConnection.setStatsRemoteVideoIsReady(n,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.recvConnection)return;const i=this.remoteUserMap.get(e);i?i.get(t)||Yw.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):Yw.warning("[".concat(this.store.clientId,"] P2PChannel2.unmuteRemote has no remote user ").concat(e.uid,"."))}getAllTracks(e){const t=this.localTrackMap.get(gT.LocalAudioTrack);if((null==t?void 0:t.track)instanceof fA){const i=t.track;return Array.from(this.localTrackMap.entries()).filter((e=>{let[t]=e;return t!==gT.LocalAudioTrack})).filter((t=>{let[i]=t;return!(e&&i===gT.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t})).concat(i.trackList)}return Array.from(this.localTrackMap.entries()).filter((t=>{let[i]=t;return!(e&&i===gT.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t}))}reportPublishEvent(e,t,i,n,r){if(e){const i=this.localTrackMap.get(gT.LocalAudioTrack),o=n?this.localTrackMap.get(gT.LocalVideoLowTrack):this.localTrackMap.get(gT.LocalVideoTrack);aS.publish(this.store.sessionId,{eventElapse:bk.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==i?void 0:i.track.getTrackLabel(),videoName:null==o?void 0:o.track.getTrackLabel(),screenshare:-1!==(null==o?void 0:o.track._hints.indexOf(YC.SCREEN_TRACK)),audio:!!i,video:!!o,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:r})}else{var o;i||(i=[]);const s=i.find((e=>e instanceof dA)),a=n?null===(o=this.localTrackMap.get(gT.LocalVideoTrack))||void 0===o?void 0:o.track:i.find((e=>e instanceof kA));aS.publish(this.store.sessionId,{eventElapse:bk.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==s?void 0:s.getTrackLabel(),videoName:null==a?void 0:a.getTrackLabel(),screenshare:-1!==(null==a?void 0:a._hints.indexOf(YC.SCREEN_TRACK)),audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:r})}}reportSubscribeEvent(e,t,i,n){const r=n===pT.VIDEO?i._videoSSRC:i._audioSSRC;r&&aS.subscribe(this.store.sessionId,{succ:e,ec:t,video:n===pT.VIDEO,audio:n===pT.AUDIO,peerid:i.uid,subscribeRequestid:n===pT.VIDEO?i._videoSSRC:i._audioSSRC,p2pid:this.store.p2pId,eventElapse:bk.measureFromSubscribeStart(this.store.clientId,r)})}reset(){Yw.debug("[".concat(this.store.clientId,"] P2PChannel2.reset")),this.sendMutex=new YE("P2PChannel2-send-mutex"),this.sendMutex=new YE("P2PChannel2-recv-mutex"),this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(gT.LocalAudioTrack);if((null==e?void 0:e.track)instanceof fA){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach((e=>{t.removeAudioTrack(e)}))}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.reconnectInterval&&(window.clearInterval(this.reconnectInterval),this.reconnectInterval=void 0),this.state=vT.Disconnected}getStats(e){var t,i;return e?null===(i=this.recvConnection)||void 0===i?void 0:i.getStats():null===(t=this.sendConnection)||void 0===t?void 0:t.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.recvConnection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(gT.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(gT.LocalVideoTrack);if(e)return{width:e.track._videoWidth||0,height:e.track._videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof kA||t&&t.track instanceof dA?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(e);return!!i&&(!t||i.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(e);return!!i&&(!t||i.has(t))}getRemoteMedia(e){var t;const i=Array.from(fh(t=this.remoteUserMap).call(t)).find((t=>t.uid===e));return i?{audioTrack:i.audioTrack,audioSSRC:i._audioSSRC,videoTrack:i.videoTrack,videoSSRC:i._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map((e=>{let[t]=e;return{uid:t.uid,level:t.audioTrack?100*t.audioTrack._source.getAccurateVolumeLevel():0}}));const t=this.localTrackMap.get(gT.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=ef(e).call(e,((e,t)=>e.level-t.level)),e}async disconnectForReconnect(){this.sendConnection&&this.recvConnection&&(Yw.debug("[".concat(this.store.clientId,"] P2PChannel2.disconnectForReconnect closing P2PConnection")),this.state=vT.Reconnecting,Pw("KEEP_LAST_FRAME")&&0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t]=e;var i;t._videoTrack&&t._videoTrack._player&&(null===(i=t._videoTrack._player.getVideoElement())||void 0===i||i.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())})),this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0,this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0,0!==this.localTrackMap.size&&(Array.from(this.localTrackMap.entries()).forEach((e=>{var t;let[i,{track:n}]=e;switch(i){case gT.LocalVideoTrack:Mn(t=n._hints).call(t,YC.LOW_STREAM)?n.close():this.pendingLocalTracks.push(n);break;case gT.LocalAudioTrack:n instanceof fA?this.pendingLocalTracks=this.pendingLocalTracks.concat(n.trackList):this.pendingLocalTracks.push(n);case gT.LocalVideoLowTrack:}})),this.emit(ET.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,i]=e;Array.from(fh(i).call(i)).forEach((e=>{this.setPendingRemoteMedia(t,e)})),this.emit(ET.MediaReconnectStart,t.uid)})),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),this.stopUploadUplinkState(),this.stopUploadDownlinkState(),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),Yw.debug("[".concat(this.store.clientId,"] P2PChannel2 disconnected, waiting to reconnect.")))}hasPendingRemoteMedia(e,t){for(const i of this.pendingRemoteTracks){const{user:n,kind:r}=i;if((e instanceof rD?e.uid:e)===n.uid&&t===r)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}async restartICE(e,t){let i,n;if(e===CS.SEND_ONLY){if(!this.sendConnection)throw new jv(Bv.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before sendConnection established.");i=await this.sendMutex.lock("From P2PChannel.restartICE"),n=this.sendConnection}else{if(!this.recvConnection)throw new jv(Bv.INVALID_OPERATION,"Cannot call P2PChannel2.handleMuteLocalTrack before recvConnection established.");i=await this.recvMutex.lock("From P2PChannel.restartICE"),n=this.recvConnection}try{if(t){const e=await n.restartICE(t);return n.isInRestartIce=!1,e}{const e=await n.restartICE();if(e){const t=await EE(this,ET.RequestP2PRestartICE,{direction:CS.RECEIVE_ONLY,iceParameter:e});await n.restartICE(t),n.isInRestartIce=!1}}}finally{i()}}getUplinkNetworkQuality(){if(!this.sendConnection)return 0;const e=this.sendConnection.getStats(),t=this.localTrackMap.get(gT.LocalVideoTrack),i=this.localTrackMap.get(gT.LocalAudioTrack),n=e.videoSend.find((e=>{var i;return e.ssrc===(null==t||null===(i=t.ssrcs)||void 0===i?void 0:i[0].ssrcId)})),r=e.audioSend.find((e=>{var t;return e.ssrc===(null==i||null===(t=i.ssrcs)||void 0===t?void 0:t[0].ssrcId)}));if(!n||!r)return 1;const o=yE(this,ET.NeedSignalRTT),s=n?n.rttMs:void 0,a=r?r.rttMs:void 0,c=s&&a?(s+a)/2:s||a,u=(c&&o?(c+o)/2:c||o)||0,d=100*e.sendPacketLossRate*.7/50+.3*u/1500,l=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,h=null==t?void 0:t.track;if(h&&h._encoderConfig&&-1===h._hints.indexOf(YC.SCREEN_TRACK)){const t=h._encoderConfig.bitrateMax,i=e.bitrate.actualEncoded;if(t&&i){const e=(1e3*t-i)/(1e3*t);return dS[e<.15?0:e<.3?1:e<.45?2:e<.6?3:4][l]}}return l}getDownlinkNetworkQuality(){if(!this.recvConnection)return 0;const e=this.recvConnection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach((i=>{let[n]=i;const r=n._audioSSRC,o=n._videoSSRC,s=e.audioRecv.find((e=>e.ssrc===r)),a=e.videoRecv.find((e=>e.ssrc===o));if(!s&&!a)return void(t+=1);const c=yE(this,ET.NeedSignalRTT),u=e.rtt,d=(u&&c?(u+c)/2:u||c)||0,l=s?s.jitterMs:void 0,h=e.recvPacketLossRate;let f=.7*h*100/50+.3*d/1500;l&&(f=.6*h*100/50+.2*d/1500+.2*l/400),t+=f<.1?1:f<.17?2:f<.36?3:f<.59?4:5})),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new nv(((t,i)=>{this.handleMuteLocalTrack(e,t,i)}))}filterTobePublishedTracks(e,t,i){const n=[],r=MC(),o=this.getAllTracks();e=IE(e=e.filter((e=>-1===o.indexOf(e))));let s=!1,a=!1;for(const c of e){if(c instanceof kA&&(this.localTrackMap.has(gT.LocalVideoTrack)||s?new jv(Bv.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(n.push({track:c,type:gT.LocalVideoTrack}),s=!0),t)){const e=this.getLowVideoTrack(c,i);n.push({track:e,type:gT.LocalVideoLowTrack})}if(c instanceof dA){const e=this.localTrackMap.get(gT.LocalAudioTrack);if(e){if(!(e.track instanceof fA))throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0)}else if(a){const e=n.find((e=>{let{type:t}=e;return t===gT.LocalAudioTrack}));if(!(e.track instanceof fA))throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c)}else{if(!r.webAudioMediaStreamDest||c instanceof fA||c._bypassWebAudio)n.push({track:c,type:gT.LocalAudioTrack});else{const e=new fA;e.addAudioTrack(c),n.push({track:e,type:gT.LocalAudioTrack})}a=!0}}}return n}filterTobeUnpublishedTracks(e){const t=[],i=this.getAllTracks();e=IE(e=e.filter((e=>-1!==i.indexOf(e))));for(const n of e){if(n instanceof dA){const e=this.localTrackMap.get(gT.LocalAudioTrack);if(!e)continue;e.track instanceof fA?(e.track.removeAudioTrack(n),this.unbindLocalAudioTrackEvents(n),0===e.track.trackList.length&&(t.push([gT.LocalAudioTrack,e]),e.track.close())):t.push([gT.LocalAudioTrack,e])}if(n instanceof kA){const e=this.localTrackMap.get(gT.LocalVideoTrack);if(!e)continue;t.push([gT.LocalVideoTrack,e]);const i=this.localTrackMap.get(gT.LocalVideoLowTrack);i&&t.push([gT.LocalVideoLowTrack,i])}}return t}bindLocalTrackEvents(e){e.forEach((e=>{let{track:t,type:i}=e;switch(i){case gT.LocalVideoTrack:t.addListener(zC.GET_STATS,this.handleGetLocalVideoStats),t.addListener(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(zC.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.addListener(zC.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),t.addListener(zC.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case gT.LocalAudioTrack:this.bindLocalAudioTrackEvents(t);case gT.LocalVideoLowTrack:}}))}bindLocalAudioTrackEvents(e,t){e instanceof fA?e.trackList.forEach((e=>{e.addListener(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(zC.GET_STATS,this.handleGetLocalAudioStats),e.addListener(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.addListener(zC.GET_STATS,this.handleGetLocalAudioStats),e.addListener(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(zC.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map((e=>{let[t,{track:i}]=e;return{track:i,type:t}}))),e.forEach((e=>{let{track:t,type:i}=e;switch(i){case gT.LocalVideoTrack:t.off(zC.GET_STATS,this.handleGetLocalVideoStats),t.off(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(zC.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(zC.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),t.off(zC.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case gT.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);case gT.LocalVideoLowTrack:}}))}unbindLocalAudioTrackEvents(e){e instanceof fA?e.trackList.forEach((e=>{e.off(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(zC.GET_STATS,this.handleGetLocalAudioStats),e.off(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.off(zC.GET_STATS,this.handleGetLocalAudioStats),e.off(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(zC.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof jA&&t.addListener(zC.GET_STATS,(t=>{t(this.handleGetRemoteVideoStats(e))})),t instanceof FA&&t.addListener(zC.GET_STATS,(t=>{t(this.handleGetRemoteAudioStats(e))}))}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(zC.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,i]=e;i.has(pT.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),i.has(pT.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)}))}createGatewayPublishMessage(e,t){return e.map(((e,i)=>{var n;let r,{track:o,type:s}=e;switch(s){case gT.LocalAudioTrack:r=iT.Audio;break;case gT.LocalVideoTrack:r=Mn(n=o._hints).call(n,YC.SCREEN_TRACK)?iT.Screen:iT.High;break;case gT.LocalVideoLowTrack:r=iT.Low}return{kind:s===gT.LocalAudioTrack?pT.AUDIO:pT.VIDEO,stream_type:r,mid:t[i].id,ssrcs:t[i].localSSRC,isMuted:o.muted||!o.enabled}}))}createGatewayUnpublishMessage(e){return e.map((e=>{var t;let i,[n,{track:r,ssrcs:o,id:s}]=e;switch(n){case gT.LocalVideoTrack:i=Mn(t=r._hints).call(t,YC.SCREEN_TRACK)?iT.Screen:iT.High;break;case gT.LocalAudioTrack:i=iT.Audio;break;case gT.LocalVideoLowTrack:i=iT.Low}return{stream_type:i,ssrcs:o,mid:s}}))}assignLocalTracks(e,t){e.forEach(((e,i)=>{let{track:n,type:r}=e;this.localTrackMap.set(r,{track:n,id:t[i].id,ssrcs:t[i].localSSRC})}))}withdrawLocalTracks(e){e.forEach((e=>{let[t]=e;this.localTrackMap.delete(t)}))}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{var i;Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: ").concat(e.name,".onConnectionStateChange(").concat(t,")")),this.emit(ET.PeerConnectionStateChange,t),"connected"!==t||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"connected"===t&&(e.isInRestartIce=!1),Mn(i=this._restartStates).call(i,t)&&!e.isInRestartIce&&("disconnected"===t&&await VE(800),"disconnected"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||this.handleDisconnect(e.direction))},e.onICEConnectionStateChange=e=>{"connected"!==e||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(e,")")),aS.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:e,tag:cE.TRACER}).onSuccess(),this.emit(ET.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(e,")"))},e.onDTLSTransportStateChange=e=>{Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(e,")"))},e.onDTLSTransportError=e=>{Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(e,")"))},e.onFirstAudioDecoded=e=>{var t;const i=Array.from(fh(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));var n;i&&(this.store.subscribe(i.uid,"audio",void 0,void 0,void 0,Date.now()),null===(n=i.audioTrack)||void 0===n||n.emit(eI.FIRST_FRAME_DECODED),aS.firstRemoteFrame(this.store.sessionId,$w.FIRST_AUDIO_DECODE,eS.FIRST_AUDIO_DECODE,{peer:i._uintid,subscribeElapse:bk.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t;const i=Array.from(fh(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));i&&aS.firstRemoteFrame(this.store.sessionId,$w.FIRST_AUDIO_RECEIVED,eS.FIRST_AUDIO_RECEIVED,{peer:i._uintid,subscribeElapse:bk.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,i)=>{this.reportVideoFirstFrameDecoded(e,t,i)},e.onFirstVideoReceived=e=>{var t;const i=Array.from(fh(t=this.remoteUserMap).call(t)).find((t=>t._videoSSRC===e));i&&aS.firstRemoteFrame(this.store.sessionId,$w.FIRST_VIDEO_RECEIVED,eS.FIRST_VIDEO_RECEIVED,{peer:i._uintid,subscribeElapse:bk.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(e,t)=>{const i="relay"===e.candidateType,n="relay"===t.candidateType;"unknown"!==t.candidateType&&i===n||this.emit(ET.ConnectionTypeChange,i),Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(PR(t))," -> ").concat(JSON.stringify(PR(e)),")"))},e.onSelectedRemoteCandidateChanged=(e,t)=>{Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(PR(t))," -> ").concat(JSON.stringify(PR(e)),")"))},e.onFirstVideoDecodedTimeout=e=>{this.reportVideoFirstFrameDecoded(e,void 0,void 0,!0)},e.onLocalCandidate=t=>{this.emit(ET.LocalCandidate,{candidate:t,direction:e.direction})}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0,e.onLocalCandidate=void 0}async handleDisconnect(e){const t=e===CS.SEND_ONLY?this.sendConnection:this.recvConnection;t&&!t.isInRestartIce&&(t.isInRestartIce=!0,Yw.debug("[".concat(this.store.clientId,"] [P2PChannel-").concat(t.name,"] start use restartICE")),e===CS.SEND_ONLY?this.restartICE(e):EE(this,ET.RequestP2PRestartICE,{direction:CS.SEND_ONLY}))}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const i=this.localTrackMap.get(gT.LocalAudioTrack);if(e instanceof dA&&(null==i?void 0:i.track)instanceof fA)return i.track.isActive||t.push([gT.LocalAudioTrack,i]),t;const n=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:i}]=t;return e===i}));if(n&&(t.push(n),n[0]===gT.LocalVideoTrack)){const e=this.localTrackMap.get(gT.LocalVideoLowTrack);e&&t.push([gT.LocalVideoLowTrack,e])}return t}filterTobeUnmutedTracks(e){const t=[],i=this.localTrackMap.get(gT.LocalAudioTrack);if(e instanceof dA&&(null==i?void 0:i.track)instanceof fA)return i.track.isActive&&t.push([gT.LocalAudioTrack,i]),t;const n=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:i}]=t;return e===i}));if(n)if(n[0]===gT.LocalVideoTrack){t.push(n);const e=this.localTrackMap.get(gT.LocalVideoLowTrack);e&&t.push([gT.LocalVideoLowTrack,e])}else t.push(n);return t}createMuteMessage(e){return e.map((e=>{var t;let i,[n,{track:r,ssrcs:o,id:s}]=e;switch(n){case gT.LocalAudioTrack:i=iT.Audio;break;case gT.LocalVideoTrack:i=Mn(t=r._hints).call(t,YC.SCREEN_TRACK)?iT.Screen:iT.High;break;case gT.LocalVideoLowTrack:i=iT.Low}return{stream_type:i,ssrcs:o,mid:s}}))}createUnmuteMessage(e){return e.map((e=>{var t;let i,[n,{track:r,ssrcs:o,id:s}]=e;switch(n){case gT.LocalAudioTrack:i=iT.Audio;break;case gT.LocalVideoTrack:i=Mn(t=r._hints).call(t,YC.SCREEN_TRACK)?iT.Screen:iT.High;break;case gT.LocalVideoLowTrack:i=iT.Low}return{stream_type:i,ssrcs:o,mid:s}}))}filterTobeUnSubscribedTracks(e,t){const i=[],n=this.remoteUserMap.get(e);if(!n)return i;if(t){const r=n.get(t);if(!r)return i;i.push([e,{kind:t,id:r}])}else Array.from(n.entries()).forEach((t=>{let[n,r]=t;i.push([e,{kind:n,id:r}])}));return i}createUnsubscribeMessage(e){const t=[];return e.forEach((e=>{let[i,{kind:n,id:r}]=e;switch(n){case pT.VIDEO:return void(i._videoSSRC&&t.push({stream_type:pT.VIDEO,ssrcId:i._videoSSRC}));case pT.AUDIO:return void(i._audioSSRC&&t.push({stream_type:pT.AUDIO,ssrcId:i._audioSSRC}))}})),t}withdrawRemoteTracks(e){e.forEach((e=>{let[t,{kind:i}]=e;const n=this.remoteUserMap.get(t);n&&(n.delete(i),0===Array.from(n.entries()).length&&this.remoteUserMap.delete(t))}))}async updateBitrateLimit(e){const t=this.localTrackMap.get(gT.LocalVideoTrack),i=this.localTrackMap.get(gT.LocalVideoLowTrack);t&&await t.track.setBitrateLimit(e.uplink),i&&e.low_stream_uplink&&await i.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){if(this.sendConnection&&this.recvConnection){const e=this.sendConnection.peerConnectionState,t=this.recvConnection.peerConnectionState;return"connected"!==e&&"connected"!==t}return!0}async tryToUnmuteAudio(e){for(let t=0;t<e.length;t++)if(e[t]instanceof dA){const i=this.filterTobeUnmutedTracks(e[t]);if(0===i.length)continue;const n=this.createUnmuteMessage(i);return void await bE(this,ET.RequestUnmuteLocal,n)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=e=>this.getStats(e),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()).filter((e=>{let[,{ssrcs:t}]=e;return!!t})),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.recvConnection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(ET.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(ET.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await VE(QE(this.dtlsFailedCount,XE)),this.emit(ET.RequestReconnect)}async reconnectP2P(){}canPublishLowStream(){return this.localTrackMap.has(gT.LocalVideoTrack)||this.pendingLocalTracks.some((e=>e instanceof kA))}throwIfTrackTypeNotMatch(e){if(e.filter((e=>e instanceof kA)).length>1)throw new jv(Bv.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter((e=>e instanceof dA)).length>1&&(e.some((e=>e instanceof dA&&e._bypassWebAudio))||!MC().webAudioMediaStreamDest))throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof kA&&this.pendingLocalTracks.some((e=>e instanceof kA)))throw new jv(Bv.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof dA&&this.pendingLocalTracks.some((e=>e instanceof dA))&&(!MC().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some((e=>e instanceof dA&&e._bypassWebAudio))))throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const i=!Pw("DISABLE_DUAL_STREAM_USE_ENCODING")&&MC().supportDualStreamEncoding,n=cD(cD({},{width:160,height:120,framerate:15,bitrate:50}),t);let r;r=i?e._mediaStreamTrack.clone():FP(e,n);const o=BE(8,"track-low-"),s=new kA(r,cD(cD({},i&&{scaleResolutionDownBy:kR(n,e)}),{},{frameRate:n.framerate,bitrateMax:n.bitrate,bitrateMin:n.bitrate}),void 0,void 0,o);return s.on(ZC.TRANSCEIVER_UPDATED,(t=>{e._updateRtpTransceiver(t,JC.LOW_STREAM)})),s._hints.push(YC.LOW_STREAM),e.addListener(zC.NEED_CLOSE,(()=>{s.close()})),s}async globalLock(){return this.recvMutex.lock("From P2PChannel2.globalLock")}reportVideoFirstFrameDecoded(e,t,i,n){var r;const o=Array.from(fh(r=this.remoteUserMap).call(r)).find((t=>t._videoSSRC===e));if(o){n||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());const r=this.store.keyMetrics,s=r.subscribe.find((e=>e.userId===o.uid&&"video"===e.type));aS.firstRemoteVideoDecode(this.store.sessionId,$w.FIRST_VIDEO_DECODE,eS.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:i,subscribeElapse:bk.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:r.requestAPEnd||0,apStart:r.requestAPStart||0,joinGwEnd:r.joinGatewayEnd||0,joinGwStart:r.joinGatewayStart||0,pcEnd:r.peerConnectionEnd||0,pcStart:r.peerConnectionStart||0,subscriberEnd:(null==s?void 0:s.subscribeEnd)||0,subscriberStart:(null==s?void 0:s.subscribeStart)||0,videoAddNotify:(null==s?void 0:s.streamAdded)||0,state:n?1:0})}}async remoteMediaSsrcChanged(e,t,i){if(!this.recvConnection)return!1;const n=this.remoteUserMap.get(e);if(!n)return!1;const r=n.get(t);if(!r)return!1;const o=await this.recvConnection.getRemoteSSRC(r);return void 0!==o&&o!==i}resetConnection(e){Yw.debug("[".concat(this.store.clientId,"] [P2PChannel2] reset connection to ").concat(e)),this.state===vT.Connected?(Yw.debug("[".concat(this.store.clientId,"] [P2PChannel2] fallback to websocket but P2PChannel2 state still connected, disconnect first")),this.disconnectForReconnect()):(this.sendConnection&&(this.sendConnection.close(),this.unbindConnectionEvents(this.sendConnection),this.sendConnection=void 0),this.recvConnection&&(this.recvConnection.close(),this.unbindConnectionEvents(this.recvConnection),this.recvConnection=void 0))}async publishDataChannel(e){throw new jv(Bv.NOT_SUPPORTED)}async unpublishDataChannel(e){throw new jv(Bv.NOT_SUPPORTED)}async subscribeDataChannel(e,t){throw new jv(Bv.NOT_SUPPORTED)}async unsubscribeDataChannel(e,t){throw new jv(Bv.NOT_SUPPORTED)}hasPendingRemoteDataChannel(e,t){throw new jv(Bv.NOT_SUPPORTED)}setPendingRemoteDataChannel(e,t){throw new jv(Bv.NOT_SUPPORTED)}async preConnect(e,t,i,n,r,o){throw new jv(Bv.NOT_SUPPORTED)}getEstablishParams(){throw new jv(Bv.NOT_SUPPORTED)}async reSubscribe(e){throw new jv(Bv.NOT_SUPPORTED)}async updateVideoStreamParameter(e,t){throw new jv(Bv.NOT_SUPPORTED)}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach((e=>{let[t,{track:i}]=e;t===gT.LocalVideoLowTrack?i._updateRtpTransceiver(void 0,JC.LOW_STREAM):i._updateRtpTransceiver(void 0)}))}}function dD(e){return function(t,i,n){const r=t[i];if("function"!=typeof r)throw new Error("Cannot use mutex on object property.");return n.value=async function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];switch(e){case oD.SEND_ONLY:{const e=await this.sendMutex.lock("From P2PChannel2.".concat(i));try{return await r.apply(this,n)}finally{e()}}case oD.RECEIVE_ONLY:{const e=await this.recvMutex.lock("From P2PChannel2.".concat(i));try{return await r.apply(this,n)}finally{e()}}default:{const e=await this.sendMutex.lock("From P2PChannel2.".concat(i)),t=await this.recvMutex.lock("From P2PChannel2.".concat(i));try{return await r.apply(this,n)}finally{e(),t()}}}},n}}function lD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function hD(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?lD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):lD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}VS([dD(oD.SEND_ONLY),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],uD.prototype,"p2pConnect",null),VS([dD(oD.SEND_ONLY),BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],uD.prototype,"unpublish",null),VS([dD(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],uD.prototype,"unpublishLowStream",null),VS([dD(oD.RECEIVE_ONLY),BS("design:type",Function),BS("design:paramtypes",[rD,String,Number,String]),BS("design:returntype",nv)],uD.prototype,"subscribe",null),VS([dD(oD.RECEIVE_ONLY),BS("design:type",Function),BS("design:paramtypes",[rD,String,Number,String]),BS("design:returntype",nv)],uD.prototype,"mockSubscribe",null),VS([dD(oD.RECEIVE_ONLY),BS("design:type",Function),BS("design:paramtypes",[rD,String,Boolean]),BS("design:returntype",nv)],uD.prototype,"unsubscribe",null),VS([dD(oD.RECEIVE_ONLY),BS("design:type",Function),BS("design:paramtypes",[rD,String]),BS("design:returntype",nv)],uD.prototype,"muteRemote",null),VS([dD(oD.RECEIVE_ONLY),BS("design:type",Function),BS("design:paramtypes",[rD,String]),BS("design:returntype",nv)],uD.prototype,"unmuteRemote",null),VS([dD(oD.RECEIVE_ONLY),BS("design:type",Function),BS("design:paramtypes",[rD,String]),BS("design:returntype",nv)],uD.prototype,"hasRemoteMediaWithLock",null),VS([dD(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],uD.prototype,"disconnectForReconnect",null),VS([dD(oD.RECEIVE_ONLY),BS("design:type",Function),BS("design:paramtypes",[rD,String,Number]),BS("design:returntype",nv)],uD.prototype,"remoteMediaSsrcChanged",null);class fD{constructor(e){oh(this,"store",void 0),oh(this,"onStatsException",void 0),oh(this,"onUploadPublishDuration",void 0),oh(this,"onStatsChanged",void 0),oh(this,"localStats",new Map),oh(this,"remoteStats",new Map),oh(this,"updateStatsInterval",void 0),oh(this,"trafficStats",void 0),oh(this,"trafficStatsPeerList",[]),oh(this,"uplinkStats",void 0),oh(this,"exceptionMonitor",void 0),oh(this,"p2pChannel",void 0),oh(this,"scalabilityMode",fS.L1T1),oh(this,"updateStats",(()=>{this.p2pChannel&&(this.updateRemoteStats(this.p2pChannel),this.updateLocalStats(this.p2pChannel))})),this.store=e,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new vk,this.exceptionMonitor.on("exception",((e,t,i)=>{this.onStatsException&&this.onStatsException(e,t,i)}))}reset(){this.localStats=new Map,this.remoteStats=new Map,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}getLocalAudioTrackStats(){return this.localStats.get(gT.LocalAudioTrack)||hD({},nI)}getLocalVideoTrackStats(){return this.localStats.get(gT.LocalVideoTrack)||hD({},rI)}getRemoteAudioTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const i=this.trafficStats.peer_delay.find((t=>t.peer_uid===e));return i&&(t.publishDuration=i.B_ppad+(Date.now()-this.trafficStats.timestamp)),t},i={};if(e){var n;const r=null===(n=this.remoteStats.get(e))||void 0===n?void 0:n.audioStats;r&&(i[e]=t(e,r))}else Array.from(this.remoteStats.entries()).forEach((e=>{let[n,{audioStats:r}]=e;r&&(i[n]=t(n,r))}));return i}getRemoteNetworkQualityStats(e){const t={};if(e){var i;const n=null===(i=this.remoteStats.get(e))||void 0===i?void 0:i.networkStats;n&&(t[e]=n)}else Array.from(this.remoteStats.entries()).forEach((e=>{let[i,{networkStats:n}]=e;n&&(t[i]=n)}));return t}getRemoteVideoTrackStats(e){const t=(e,t)=>{if(!this.trafficStats)return t;const i=this.trafficStats.peer_delay.find((t=>t.peer_uid===e));return i&&(t.publishDuration=i.B_ppvd+(Date.now()-this.trafficStats.timestamp)),t},i={};if(e){var n;const r=null===(n=this.remoteStats.get(e))||void 0===n?void 0:n.videoStats;r&&(i[e]=t(e,r))}else Array.from(this.remoteStats.entries()).forEach((e=>{let[n,{videoStats:r}]=e;r&&(i[n]=t(n,r))}));return i}getRTCStats(){let e=0,t=0,i=0,n=0;const r=this.localStats.get(gT.LocalAudioTrack);r&&(e+=r.sendBytes,t+=r.sendBitrate);const o=this.localStats.get(gT.LocalVideoTrack);o&&(e+=o.sendBytes,t+=o.sendBitrate);const s=this.localStats.get(gT.LocalVideoLowTrack);s&&(e+=s.sendBytes,t+=s.sendBitrate),this.remoteStats.forEach((e=>{let{audioStats:t,videoStats:r}=e;t&&(i+=t.receiveBytes,n+=t.receiveBitrate),r&&(i+=r.receiveBytes,n+=r.receiveBitrate)}));let a=1;return this.trafficStats&&(a+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:a,SendBitrate:t,SendBytes:e,RecvBytes:i,RecvBitrate:n,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}addLocalStats(e){this.localStats.set(e,void 0)}removeLocalStats(e){e?this.localStats.delete(e):this.localStats.clear()}addRemoteStats(e){this.remoteStats.set(e,{})}removeRemoteStats(e){e?this.remoteStats.delete(e):this.remoteStats.clear()}addP2PChannel(e){this.p2pChannel=e}updateTrafficStats(e){e.peer_delay=e.peer_delay.filter((e=>void 0!==e.B_ppad||void 0!==e.B_ppvd)),e.peer_delay.filter((e=>-1===this.trafficStatsPeerList.indexOf(e.peer_uid))).forEach((e=>{var t;const i=null===(t=this.p2pChannel)||void 0===t?void 0:t.getRemoteMedia(e.peer_uid),n=null!=i&&i.videoSSRC?bk.measureFromSubscribeStart(this.store.clientId,i.videoSSRC):0,r=null!=i&&i.audioSSRC?bk.measureFromSubscribeStart(this.store.clientId,i.audioSSRC):0;void 0!==e.B_ppad&&void 0!==e.B_ppvd&&(this.onUploadPublishDuration&&this.onUploadPublishDuration(e.peer_uid,e.B_ppad,e.B_ppvd,n>r?n:r),this.trafficStatsPeerList.push(e.peer_uid))})),this.trafficStats=e}updateUplinkStats(e){this.uplinkStats&&this.uplinkStats.B_fir!==e.B_fir&&Yw.debug("[".concat(this.store.clientId,"]: Period fir changes to ").concat(e.B_fir)),this.uplinkStats=e}static isRemoteVideoFreeze(e,t,i){if(!e)return!1;const n=!!i&&t.framesDecodeFreezeTime>i.framesDecodeFreezeTime,r=!i||t.framesDecodeCount>i.framesDecodeCount;return n||!r}static isRemoteAudioFreeze(e){return!!e&&e._isFreeze()}isLocalVideoFreeze(e){return!(!e.inputFrame||!e.sentFrame)&&e.inputFrame.frameRate>5&&e.sentFrame.frameRate<3}updateLocalStats(e){Array.from(this.localStats.entries()).forEach((t=>{let[i,n]=t;switch(i){case gT.LocalVideoTrack:case gT.LocalVideoLowTrack:{const t=n,o=hD({},rI),s=e.getStats(),a=e.getLocalMedia(i);if(s){const i=s.videoSend.find((e=>e.ssrc===(null==a?void 0:a.ssrcs[0].ssrcId)));if(i){const n=e.getLocalVideoSize(),r=e.getEncoderConfig(gT.LocalVideoTrack);"H264"!==i.codec&&"H265"!==i.codec&&"VP8"!==i.codec&&"VP9"!==i.codec&&"AV1X"!==i.codec&&"AV1"!==i.codec||(o.codecType=i.codec),o.sendBytes=i.bytes,o.sendBitrate=t?8*Math.max(0,o.sendBytes-t.sendBytes):0,i.inputFrame?(o.captureFrameRate=i.inputFrame.frameRate,o.captureResolutionHeight=i.inputFrame.height,o.captureResolutionWidth=i.inputFrame.width):n&&(o.captureResolutionWidth=n.width,o.captureResolutionHeight=n.height),i.sentFrame?(o.sendFrameRate=i.sentFrame.frameRate,o.sendResolutionHeight=i.sentFrame.height,o.sendResolutionWidth=i.sentFrame.width):n&&(o.sendResolutionWidth=n.width,o.sendResolutionHeight=n.height),i.avgEncodeMs&&(o.encodeDelay=i.avgEncodeMs),r&&r.bitrateMax&&(o.targetSendBitrate=1e3*r.bitrateMax),o.sendPackets=i.packets,o.sendPacketsLost=i.packetsLost,o.sendJitterMs=i.jitterMs,o.sendRttMs=i.rttMs,o.totalDuration=t?t.totalDuration+1:1,o.totalFreezeTime=t?t.totalFreezeTime:0,this.isLocalVideoFreeze(i)&&(o.totalFreezeTime+=1),i.scalabilityMode&&this.scalabilityMode!==i.scalabilityMode&&(Yw.debug("[".concat(this.store.clientId,"]: The scalabilityMode of the video sending stream is ").concat(i.scalabilityMode)),this.scalabilityMode=i.scalabilityMode)}this.trafficStats&&(o.currentPacketLossRate=(this.trafficStats.B_pvlr4||0)/100)}var r;this.localStats.set(i,o),((null==t?void 0:t.sendResolutionWidth)!==o.sendResolutionWidth||(null==t?void 0:t.sendResolutionHeight)!==o.sendResolutionHeight)&&(null===(r=this.onStatsChanged)||void 0===r||r.call(this,"resolution",{width:o.sendResolutionWidth,height:o.sendResolutionHeight})),o&&a&&this.exceptionMonitor.setLocalVideoStats(this.store.uid,a.track,o);break}case gT.LocalAudioTrack:{const t=n,r=hD({},nI),o=e.getStats(),s=e.getLocalMedia(i);if(o){const i=o.audioSend.find((e=>e.ssrc===(null==s?void 0:s.ssrcs[0].ssrcId)));if(i){if("opus"!==i.codec&&"aac"!==i.codec&&"PCMU"!==i.codec&&"PCMA"!==i.codec&&"G722"!==i.codec||(r.codecType=i.codec),i.inputLevel)r.sendVolumeLevel=Math.round(32767*i.inputLevel);else{const t=e.getLocalAudioVolume();t&&(r.sendVolumeLevel=Math.round(32767*t))}r.sendBytes=i.bytes,r.sendPackets=i.packets,r.sendPacketsLost=i.packetsLost,r.sendJitterMs=i.jitterMs,r.sendRttMs=i.rttMs,r.sendBitrate=t?8*Math.max(0,r.sendBytes-t.sendBytes):0}}this.trafficStats&&(r.currentPacketLossRate=(this.trafficStats.B_palr4||0)/100),this.localStats.set(gT.LocalAudioTrack,r),r&&s&&this.exceptionMonitor.setLocalAudioStats(this.store.uid,s.track,r);break}}}))}updateRemoteStats(e){Array.from(this.remoteStats.entries()).forEach((t=>{var i,n;let[r,{videoStats:o,audioStats:s,videoPcStats:a}]=t;const c=s,u=o,d=a,l=hD({},oI),h=hD({},aI),f=hD({},sI),{audioTrack:p,videoTrack:m,audioSSRC:_,videoSSRC:g}=e.getRemoteMedia(r);let v;v=e instanceof uD?e.getStats(!0):e.getStats();const E=null===(i=v)||void 0===i?void 0:i.audioRecv.find((e=>e.ssrc===_)),b=null===(n=v)||void 0===n?void 0:n.videoRecv.find((e=>e.ssrc===g)),y=this.trafficStats&&this.trafficStats.peer_delay.find((e=>e.peer_uid===r));if(E&&("opus"!==E.codec&&"aac"!==E.codec&&"PCMU"!==E.codec&&"PCMA"!==E.codec&&"G722"!==E.codec||(l.codecType=E.codec),E.outputLevel?l.receiveLevel=Math.round(32767*E.outputLevel):p&&(l.receiveLevel=Math.round(32767*p.getVolumeLevel())),l.receiveBytes=E.bytes,l.receivePackets=E.packets,l.receivePacketsLost=E.packetsLost,l.packetLossRate=l.receivePacketsLost/(l.receivePackets+l.receivePacketsLost),l.receiveBitrate=c?8*Math.max(0,l.receiveBytes-c.receiveBytes):0,l.totalDuration=c?c.totalDuration+1:1,l.totalFreezeTime=c?c.totalFreezeTime:0,l.freezeRate=l.totalFreezeTime/l.totalDuration,l.receiveDelay=E.jitterBufferMs,l.totalDuration>10&&fD.isRemoteAudioFreeze(p)&&(l.totalFreezeTime+=1)),b){"H264"!==b.codec&&"H265"!==b.codec&&"VP8"!==b.codec&&"VP9"!==b.codec&&"AV1X"!==b.codec&&"AV1"!==b.codec||(h.codecType=b.codec),h.receiveBytes=b.bytes,h.receiveBitrate=u?8*Math.max(0,h.receiveBytes-u.receiveBytes):0,h.decodeFrameRate=b.decodeFrameRate<0?0:b.decodeFrameRate,h.renderFrameRate=b.decodeFrameRate<0?0:b.decodeFrameRate,b.outputFrame&&(h.renderFrameRate=b.outputFrame.frameRate),b.receivedFrame?(h.receiveFrameRate=b.receivedFrame.frameRate,h.receiveResolutionHeight=b.receivedFrame.height,h.receiveResolutionWidth=b.receivedFrame.width):m&&(h.receiveResolutionHeight=m._videoHeight||0,h.receiveResolutionWidth=m._videoWidth||0),void 0!==b.framesRateFirefox&&(h.receiveFrameRate=Math.round(b.framesRateFirefox)),h.receivePackets=b.packets,h.receivePacketsLost=b.packetsLost,h.packetLossRate=h.receivePacketsLost/(h.receivePackets+h.receivePacketsLost),h.totalDuration=u?u.totalDuration+1:1,h.totalFreezeTime=u?u.totalFreezeTime:0,h.receiveDelay=b.jitterBufferMs||0;const t=!!g&&e.getRemoteVideoIsReady(g);m&&t&&fD.isRemoteVideoFreeze(m,b,d)&&(h.totalFreezeTime+=1),h.freezeRate=h.totalFreezeTime/h.totalDuration}y&&(l.end2EndDelay=y.B_ad,h.end2EndDelay=y.B_vd,l.transportDelay=y.B_ed,h.transportDelay=y.B_ed,l.currentPacketLossRate=y.B_ealr4/100,h.currentPacketLossRate=y.B_evlr4/100,f.uplinkNetworkQuality=y.B_punq?y.B_punq:0,f.downlinkNetworkQuality=y.B_pdnq?y.B_pdnq:0),this.remoteStats.set(r,{audioStats:l,videoStats:h,videoPcStats:b,networkStats:f}),p&&this.exceptionMonitor.setRemoteAudioStats(p,l),m&&this.exceptionMonitor.setRemoteVideoStats(m,h)}))}}function pD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function mD(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?pD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):pD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class _D extends rE{constructor(e,t,i,n){super(),oh(this,"spec",void 0),oh(this,"token",void 0),oh(this,"websocket",void 0),oh(this,"pingpongTimer",void 0),oh(this,"reconnectMode","retry"),oh(this,"serviceMode",void 0),oh(this,"reqId",0),oh(this,"commandReqId",0),oh(this,"handleWebSocketOpen",(()=>{this.reconnectMode="retry",this.startPingPong()})),oh(this,"handleWebSocketMessage",(e=>{if(!e.data)return;const t=JSON.parse(e.data);t.requestId?this.emit("@".concat(t.requestId,"-").concat(t.sid),t):this.serviceMode===AS.INJECT?this.emit(YS.INJECT_STREAM_STATUS,t):(aS.workerEvent(this.spec.sid,{actionType:"status",serverCode:t.code,workerType:this.serviceMode===AS.TRANSCODE?1:2}),this.emit(YS.PUBLISH_STREAM_STATUS,t))})),this.spec=t,this.token=e,this.serviceMode=n,this.websocket=new tR("live-streaming",i),this.websocket.on(IS.CONNECTED,this.handleWebSocketOpen),this.websocket.on(IS.ON_MESSAGE,this.handleWebSocketMessage),this.websocket.on(IS.REQUEST_NEW_URLS,((e,t)=>{EE(this,YS.REQUEST_NEW_ADDRESS).then(e).catch(t)})),this.websocket.on(IS.RECONNECTING,(()=>{this.websocket.reconnectMode=this.reconnectMode}))}init(e){return this.websocket.init(e)}async request(e,t,i,n){this.reqId+=1,"request"===e&&(this.commandReqId+=1);const r=this.commandReqId,o=this.reqId;if(!o||!this.websocket)throw new jS(Bv.UNEXPECTED_ERROR);const s=mD({command:e,sdkVersion:"4.20.0"===Iw?"0.0.1":Iw,seq:o,requestId:o,allocate:i,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(Date.now()/1e3)},t);if("closed"===this.websocket.state)throw new jS(Bv.WS_DISCONNECT);const a=()=>new nv(((e,t)=>{this.websocket.once(IS.CLOSED,(()=>t(new jS(Bv.WS_ABORT)))),this.websocket.once(IS.CONNECTED,e)}));"connected"!==this.websocket.state&&await a(),s.clientRequest&&(s.clientRequest.workerToken=this.token);const c=new nv(((e,t)=>{const i=()=>{t(new jS(Bv.WS_ABORT))};this.websocket.once(IS.RECONNECTING,i),this.websocket.once(IS.CLOSED,i),this.once("@".concat(o,"-").concat(this.spec.sid),(t=>{e(t)}))}));n&&aS.workerEvent(this.spec.sid,mD(mD({},n),{},{requestId:r,actionType:"request",payload:JSON.stringify(t.clientRequest),serverCode:0,code:0}));const u=Date.now();this.websocket.sendMessage(s);let d=null;try{d=await c}catch(n){if("closed"===this.websocket.state)throw n;return await a(),await this.request(e,t,i)}return n&&aS.workerEvent(this.spec.sid,mD(mD({},n),{},{requestId:r,actionType:"response",payload:JSON.stringify(d.serverResponse),serverCode:d.code,success:200===d.code,responseTime:Date.now()-u})),200!==d.code&&this.handleResponseError(d),d}tryNextAddress(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}close(){const e="4.20.0"===Iw?"0.0.1":Iw;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(Date.now()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}handleResponseError(e){switch(e.code){case XS.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void Yw.warning("live stream response already exists stream");case XS.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case XS.LIVE_STREAM_RESPONSE_BAD_STREAM:case XS.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new jS(Bv.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw();case XS.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return;throw new jS(Bv.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case XS.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new jS(Bv.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw();case XS.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const t=new jS(Bv.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(YS.WARNING,t,e.serverResponse.url)}case XS.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:{const t=new jS(Bv.LIVE_STREAMING_WARN_FREQUENT_REQUEST);return this.emit(YS.WARNING,t,e.serverResponse.url)}case XS.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new jS(Bv.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case XS.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new jS(Bv.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:e.code}).throw();case XS.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:{const t=new jS(Bv.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT);return this.emit(YS.WARNING,t,e.serverResponse.url)}case XS.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new jS(Bv.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw();case XS.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new jS(Bv.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case XS.LIVE_STREAM_RESPONSE_WORKER_LOST:case XS.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return;throw new jS(Bv.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case XS.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)return;if("UpdateTranscoding"===e.serverResponse.command||"ControlStream"===e.serverResponse.command)return new jS(Bv.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw();throw new jS(Bv.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case XS.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case XS.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case XS.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case XS.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new jS(Bv.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}).throw()}}startPingPong(){this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval((()=>{"connected"===this.websocket.state&&this.request("ping",{}).catch(FE)}),6e3)}}function gD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function vD(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?gD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):gD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class ED extends rE{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:XE,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:XE;super(),oh(this,"onLiveStreamWarning",void 0),oh(this,"onLiveStreamError",void 0),oh(this,"onInjectStatusChange",void 0),oh(this,"spec",void 0),oh(this,"retryTimeout",1e4),oh(this,"connection",void 0),oh(this,"httpRetryConfig",void 0),oh(this,"wsRetryConfig",void 0),oh(this,"streamingTasks",new Map),oh(this,"isStartingStreamingTask",!1),oh(this,"taskMutex",new YE("live-streaming")),oh(this,"cancelToken",gw.CancelToken.source()),oh(this,"transcodingConfig",void 0),oh(this,"injectConfig",vD({},zS)),oh(this,"injectLoopTimes",0),oh(this,"uapResponse",void 0),oh(this,"lastTaskId",1),oh(this,"statusError",new Map),this.spec=e,this.httpRetryConfig=i,this.wsRetryConfig=t}async setTranscodingConfig(e){const t=vD(vD({},KS),e);66!==t.videoCodecProfile&&77!==t.videoCodecProfile&&100!==t.videoCodecProfile&&(Yw.debug("[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ").concat(t.videoCodecProfile," -> 100")),t.videoCodecProfile=100),t.transcodingUsers||(t.transcodingUsers=t.userConfigs),t.transcodingUsers&&(t.transcodingUsers=t.transcodingUsers.map((e=>vD(vD(vD({},GS),e),{},{zOrder:e.zOrder?e.zOrder+1:1})))),function(e){zv(e.width)||Gv(e.width,"config.width",0,1e4),zv(e.height)||Gv(e.height,"config.height",0,1e4),zv(e.videoBitrate)||Gv(e.videoBitrate,"config.videoBitrate",1,1e6),zv(e.videoFrameRate)||Gv(e.videoFrameRate,"config.videoFrameRate"),zv(e.lowLatency)||Fv(e.lowLatency,"config.lowLatency"),zv(e.audioSampleRate)||Wv(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),zv(e.audioBitrate)||Gv(e.audioBitrate,"config.audioBitrate",1,128),zv(e.audioChannels)||Wv(e.audioChannels,"config.audioChannels",[1,2,3,4,5]),zv(e.videoGop)||Gv(e.videoGop,"config.videoGop"),zv(e.videoCodecProfile)||Wv(e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),zv(e.userCount)||Gv(e.userCount,"config.userCount",0,17),zv(e.backgroundColor)||Gv(e.backgroundColor,"config.backgroundColor",0,16777215),zv(e.userConfigExtraInfo)||qv(e.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),e.transcodingUsers&&!zv(e.transcodingUsers)&&(Kv(e.transcodingUsers,"config.transcodingUsers"),e.transcodingUsers.forEach(((e,t)=>{WS(e.uid),zv(e.x)||Gv(e.x,"transcodingUser[".concat(t,"].x"),0,1e4),zv(e.y)||Gv(e.y,"transcodingUser[".concat(t,"].y"),0,1e4),zv(e.width)||Gv(e.width,"transcodingUser[".concat(t,"].width"),0,1e4),zv(e.height)||Gv(e.height,"transcodingUser[".concat(t,"].height"),0,1e4),zv(e.zOrder)||Gv(e.zOrder-1,"transcodingUser[".concat(t,"].zOrder"),0,100),zv(e.alpha)||Gv(e.alpha,"transcodingUser[".concat(t,"].alpha"),0,1,!1)}))),zv(e.watermark)||qS(e.watermark,"watermark"),zv(e.backgroundImage)||qS(e.backgroundImage,"backgroundImage"),e.images&&!zv(e.images)&&(Kv(e.images,"config.images"),e.images.forEach(((e,t)=>{qS(e,"images[".concat(t,"]"))})))}(t);const i=[];t.images&&i.push(...t.images.map((e=>vD(vD(vD({},HS),e),{},{zOrder:255})))),t.backgroundImage&&(i.push(vD(vD(vD({},HS),t.backgroundImage),{},{zOrder:0})),delete t.backgroundImage),t.watermark&&(i.push(vD(vD(vD({},HS),t.watermark),{},{zOrder:255})),delete t.watermark),t.images=i,t.transcodingUsers&&(t.userConfigs=t.transcodingUsers.map((e=>vD({},e))),t.userCount=t.transcodingUsers.length,delete t.transcodingUsers);const n=(t.userConfigs||[]).map((e=>"number"==typeof e.uid?nv.resolve(e.uid):bC(e.uid,this.spec,this.cancelToken.token,this.httpRetryConfig)));if((await nv.all(n)).forEach(((e,i)=>{t.userConfigs&&t.userConfigs[i]&&(t.userConfigs[i].uid=e)})),this.transcodingConfig=t,this.connection)try{var r;const e=await this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Array.from(US(r=this.streamingTasks).call(r)).map((e=>e.taskId)).join("#")});Yw.debug("[".concat(this.spec.clientId,"] update live transcoding config success, code: ").concat(e.code,", config:"),JSON.stringify(this.transcodingConfig))}catch(e){if(!e.data||!e.data.retry)throw e;e.data.changeAddress&&this.connection.tryNextAddress(),this.streamingTasks.forEach((t=>{Yw.warning("[".concat(this.spec.clientId,"] live streaming receive error"),e.toString(),"try to republish",t.url),this.startLiveStreamingTask(t.url,t.mode,e).then((()=>{Yw.debug("[".concat(this.spec.clientId,"] live streaming republish ").concat(t.url," success"))})).catch((e=>{Yw.error("[".concat(this.spec.clientId,"] live streaming republish failed"),t.url,e.toString()),this.onLiveStreamError&&this.onLiveStreamError(t.url,e)}))}))}}setInjectStreamConfig(e,t){this.injectConfig=Object.assign({},this.injectConfig,e),this.injectLoopTimes=t}async startLiveStreamingTask(e,t,i){var n;if(Array.from(US(n=this.streamingTasks).call(n)).find((e=>e.mode===AS.INJECT))&&t===AS.INJECT)return new jS(Bv.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw();if(!this.transcodingConfig&&t===AS.TRANSCODE)throw new jS(Bv.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");let r={command:"PublishStream",ts:Date.now(),url:e,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0};Yw.debug("[".concat(this.spec.clientId,"] start live streaming ").concat(e,", mode: ").concat(t));const o=await this.taskMutex.lock();if(!this.connection&&i)return void o();if(this.streamingTasks.get(e)&&!i)return o(),new jS(Bv.LIVE_STREAMING_TASK_CONFLICT).throw();try{this.connection||(this.connection=await this.connect(t))}catch(e){throw o(),e}switch(t){case AS.TRANSCODE:r.transcodingConfig=vD({},this.transcodingConfig);break;case AS.RAW:break;case AS.INJECT:r={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:Date.now(),url:e,loopTimes:this.injectLoopTimes}}this.uapResponse&&this.uapResponse.vid&&(r.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0;const s=this.lastTaskId++;try{const n=new nv(((t,n)=>{VE(this.retryTimeout).then((()=>{if(i)return n(i);const t=this.statusError.get(e);return t?(this.statusError.delete(e),n(t)):void 0}))})),a=await nv.race([this.connection.request("request",{clientRequest:r},!0,{url:e,command:"PublishStream",workerType:t===AS.TRANSCODE?1:2,requestByUser:!i,tid:s.toString()}),n]);this.isStartingStreamingTask=!1,Yw.debug("[".concat(this.spec.clientId,"] live streaming started, code: ").concat(a.code)),this.streamingTasks.set(e,{clientRequest:r,mode:t,url:e,taskId:s}),o()}catch(n){if(o(),this.isStartingStreamingTask=!1,!n.data||!n.data.retry||i)throw n;return n.data.changeAddress?(this.connection.tryNextAddress(),await this.startLiveStreamingTask(e,t,n)):await this.startLiveStreamingTask(e,t,n)}}stopLiveStreamingTask(e){return new nv(((t,i)=>{const n=this.streamingTasks.get(e);if(!n||!this.connection)return new jS(Bv.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();const r=n.mode;n.abortTask=()=>{Yw.debug("[".concat(this.spec.clientId,"] stop live streaming success(worker exception)")),this.streamingTasks.delete(e),t()},this.connection.request("request",{clientRequest:{command:r===AS.INJECT?"UninjectStream":"UnpublishStream",url:n.url}},!1,{url:e,command:"UnPublishStream",workerType:r===AS.TRANSCODE?1:2,requestByUser:!0,tid:(this.lastTaskId++).toString()}).then((i=>{Yw.debug("[".concat(this.spec.clientId,"] stop live streaming success, code: ").concat(i.code)),this.streamingTasks.delete(e),0===this.streamingTasks.size&&r!==AS.INJECT&&(this.connection&&this.connection.close(),this.connection=void 0),t(),r===AS.INJECT&&this.onInjectStatusChange&&this.onInjectStatusChange(OS.INJECT_STREAM_STATUS_STOP_SUCCESS,this.spec.uid,e)})).catch(i)}))}async controlInjectStream(e,t,i,n){const r=this.streamingTasks.get(e);if(!r||!this.connection||r.mode!==AS.INJECT)throw new jS(Bv.INVALID_OPERATION,"can not find inject stream task to control");return(await this.connection.request("request",{clientRequest:{command:"ControlStream",url:e,control:t,audioVolume:i,position:n}})).serverResponse}resetAllTask(){var e;const t=Array.from(US(e=this.streamingTasks).call(e));this.terminate();for(const i of t)this.startLiveStreamingTask(i.url,i.mode).catch((e=>{this.onLiveStreamError&&this.onLiveStreamError(i.url,e)}))}terminate(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new Map,this.isStartingStreamingTask=!1,this.statusError=new Map,this.cancelToken=gw.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}async connect(e){if(this.connection)throw new jS(Bv.UNEXPECTED_ERROR,"live streaming connection has already connected");const t=await EE(this,JS.REQUEST_WORKER_MANAGER_LIST,e);return this.uapResponse=t,this.connection=new _D(t.workerToken,this.spec,this.wsRetryConfig,e),this.connection.on(YS.WARNING,((e,t)=>this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e))),this.connection.on(YS.PUBLISH_STREAM_STATUS,(e=>this.handlePublishStreamServer(e))),this.connection.on(YS.INJECT_STREAM_STATUS,(e=>this.handleInjectStreamServerStatus(e))),this.connection.on(YS.REQUEST_NEW_ADDRESS,((t,i)=>{if(!this.connection)return i(new jS(Bv.UNEXPECTED_ERROR,"can not get new live streaming address list"));EE(this,JS.REQUEST_WORKER_MANAGER_LIST,e).then((e=>{this.uapResponse=e,t(e.addressList)})).catch(i)})),await this.connection.init(t.addressList),this.connection}handlePublishStreamServer(e){const t=e.serverStatus&&e.serverStatus.url||"empty_url",i=this.streamingTasks.get(t),n=e.reason;switch(e.code){case XS.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case XS.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case XS.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case XS.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:{const n=new jS(Bv.LIVE_STREAMING_CDN_ERROR,"",{code:e.code});if(i)return Yw.error(n.toString()),this.onLiveStreamError&&this.onLiveStreamError(t,n);if(!this.isStartingStreamingTask)return;this.statusError.set(t,n)}case XS.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:{const e=new jS(Bv.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,n);return this.onLiveStreamWarning&&this.onLiveStreamWarning(t,e)}case XS.LIVE_STREAM_RESPONSE_WORKER_LOST:case XS.LIVE_STREAM_RESPONSE_WORKER_QUIT:{var r;if(!this.connection)return;this.connection.tryNextAddress();const t=Array.from(US(r=this.streamingTasks).call(r));for(const i of t)i.abortTask?i.abortTask():(Yw.warning("[".concat(this.spec.clientId,"] publish stream status code"),e.code,"try to republish",i.url),this.startLiveStreamingTask(i.url,i.mode,new jS(Bv.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then((()=>{Yw.debug("[".concat(this.spec.clientId,"] republish live stream success"),i.url)})).catch((e=>{Yw.error(e.toString()),this.onLiveStreamError&&this.onLiveStreamError(i.url,e)})));return}}}handleInjectStreamServerStatus(e){const t=Number(e.uid),i=e.serverStatus&&e.serverStatus.url;switch(e.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(OS.INJECT_STREAM_STATUS_START_SUCCESS,t,i));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(OS.INJECT_STREAM_STATUS_START_ALREADY_EXISTS,t,i),void this.streamingTasks.delete(i);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(OS.INJECT_STREAM_STATUS_START_UNAUTHORIZED,t,i),void this.streamingTasks.delete(i);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(OS.INJECT_STREAM_STATUS_BROKEN,t,i),void this.streamingTasks.delete(i);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(OS.INJECT_STREAM_STATUS_START_TIMEOUT,t,i),void this.streamingTasks.delete(i);default:return void Yw.debug("inject stream server status",e)}}hasUrl(e){return this.streamingTasks.has(e)}}class bD{constructor(){oh(this,"destChannelMediaInfos",new Map),oh(this,"srcChannelMediaInfo",void 0)}setSrcChannelInfo(e){cT(e),this.srcChannelMediaInfo=e}addDestChannelInfo(e){cT(e),this.destChannelMediaInfos.set(e.channelName,e)}removeDestChannelInfo(e){FS(e),this.destChannelMediaInfos.delete(e)}getSrcChannelMediaInfo(){return this.srcChannelMediaInfo}getDestChannelMediaInfo(){return this.destChannelMediaInfos}}function yD(e){if(!(e instanceof bD))return new jS(Bv.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();const t=e.getSrcChannelMediaInfo(),i=e.getDestChannelMediaInfo();return t?0===i.size?new jS(Bv.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new jS(Bv.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}class wD extends rE{constructor(e,t,i){super(),oh(this,"ws",void 0),oh(this,"requestId",1),oh(this,"heartBeatTimer",void 0),oh(this,"joinInfo",void 0),oh(this,"clientId",void 0),oh(this,"onOpen",(()=>{this.emit("open"),this.startHeartBeatCheck()})),oh(this,"onClose",(e=>{this.emit("close"),this.dispose()})),oh(this,"onMessage",(e=>{const t=JSON.parse(e.data);if(!t||"serverResponse"!==t.command||!t.requestId)return t&&"serverStatus"===t.command&&t.serverStatus&&t.serverStatus.command?(this.emit("status",t.serverStatus),void this.emit(t.serverStatus.command,t.serverStatus)):void 0;this.emit("req_".concat(t.requestId),t)})),this.joinInfo=e,this.clientId=t,this.ws=new tR("cross-channel-".concat(this.clientId),i),this.ws.on(IS.RECONNECTING,(()=>{this.ws.reconnectMode="retry",this.emit("reconnecting")})),this.ws.on(IS.CONNECTED,this.onOpen),this.ws.on(IS.ON_MESSAGE,this.onMessage),this.ws.on(IS.CLOSED,this.onClose)}isConnect(){return"connected"===this.ws.state}sendMessage(e){const t=this.requestId++;return e.requestId=t,e.seq=t,this.ws.sendMessage(e),t}waitStatus(e){return new nv(((t,i)=>{const n=window.setTimeout((()=>{i(new jS(Bv.TIMEOUT,"wait status timeout, status: ".concat(e)))}),5e3);this.once(e,(r=>{window.clearTimeout(n),r.state&&0!==r.state?i(new jS(Bv.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(e))):t(void 0)})),this.once("dispose",(()=>{window.clearTimeout(n),i(new jS(Bv.WS_ABORT))}))}))}async request(e){if("closed"===this.ws.state)throw new jS(Bv.WS_DISCONNECT);const t=()=>new nv(((e,t)=>{this.ws.once(IS.CLOSED,(()=>t(new jS(Bv.WS_ABORT)))),this.ws.once(IS.CONNECTED,e)}));"connected"!==this.ws.state&&await t();const i=this.sendMessage(e),n=new nv(((e,t)=>{const n=()=>{t(new jS(Bv.WS_ABORT))};this.ws.once(IS.RECONNECTING,n),this.ws.once(IS.CLOSED,n),this.once("req_".concat(i),e),VE(3e3).then((()=>{this.removeAllListeners("req_".concat(i)),this.ws.off(IS.RECONNECTING,n),this.ws.off(IS.CLOSED,n),t(new jS(Bv.TIMEOUT,"cross channel ws request timeout"))}))})),r=await n;if(!r||200!==r.code)throw new jS(Bv.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(JSON.stringify(r)));return r}async connect(e){this.ws.removeAllListeners(IS.REQUEST_NEW_URLS),this.ws.on(IS.REQUEST_NEW_URLS,(t=>{t(e)})),await this.ws.init(e)}dispose(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}sendPing(e){const t=this.requestId++;return e.requestId=t,this.ws.sendMessage(e),t}startHeartBeatCheck(){this.heartBeatTimer&&window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=window.setInterval((()=>{this.sendPing({command:"ping",appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sid:this.joinInfo.sid,ts:+new Date,requestId:0})}),3e3)}clearHeartBeatCheck(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}class SD extends rE{set state(e){e!==this._state&&(e!==eT.RELAY_STATE_FAILURE&&(this.errorCode=tT.RELAY_OK),this.emit("state",e,this.errorCode),this._state=e)}get state(){return this._state}constructor(e,t,i,n,r){super(),oh(this,"joinInfo",void 0),oh(this,"sid",void 0),oh(this,"clientId",void 0),oh(this,"cancelToken",gw.CancelToken.source()),oh(this,"workerToken",void 0),oh(this,"requestId",0),oh(this,"signal",void 0),oh(this,"prevChannelMediaConfig",void 0),oh(this,"httpRetryConfig",void 0),oh(this,"_resolution",void 0),oh(this,"_state",eT.RELAY_STATE_IDLE),oh(this,"errorCode",tT.RELAY_OK),oh(this,"onStatus",(e=>{Yw.debug("[".concat(this.clientId,"] ChannelMediaStatus: ").concat(JSON.stringify(e))),e&&e.command&&("onAudioPacketReceived"===e.command&&this.emit("event",$S.PACKET_RECEIVED_AUDIO_FROM_SRC),"onVideoPacketReceived"===e.command&&this.emit("event",$S.PACKET_RECEIVED_VIDEO_FROM_SRC),"onSrcTokenPrivilegeDidExpire"===e.command&&(this.errorCode=tT.SRC_TOKEN_EXPIRED,this.state=eT.RELAY_STATE_FAILURE),"onDestTokenPrivilegeDidExpire"===e.command&&(this.errorCode=tT.DEST_TOKEN_EXPIRED,this.state=eT.RELAY_STATE_FAILURE))})),oh(this,"onReconnect",(async()=>{Yw.debug("[".concat(this.clientId,"] ChannelMediaSocket disconnect, reconnecting")),this.emit("event",$S.NETWORK_DISCONNECTED),this.state=eT.RELAY_STATE_IDLE,this.prevChannelMediaConfig&&this.sendStartRelayMessage(this.prevChannelMediaConfig).catch((e=>{this.state!==eT.RELAY_STATE_IDLE&&(Yw.error("auto restart channel media relay failed",e.toString()),this.errorCode=tT.SERVER_CONNECTION_LOST,this.state=eT.RELAY_STATE_FAILURE)}))})),this.joinInfo=e,this.clientId=t,this.sid=jE(),this.signal=new wD(this.joinInfo,this.clientId,i),this.httpRetryConfig=n,this._resolution=r}async startChannelMediaRelay(e){if(this.state!==eT.RELAY_STATE_IDLE)throw new jS(Bv.INVALID_OPERATION);this.state=eT.RELAY_STATE_CONNECTING,await this.connect(),Yw.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success"));try{await this.sendStartRelayMessage(e)}catch(e){if(e.data&&e.data.serverResponse&&"SetSourceChannel"===e.data.serverResponse.command)throw new jS(Bv.CROSS_CHANNEL_FAILED_JOIN_SRC);if(e.data&&e.data.serverResponse&&"SetDestChannelStatus"===e.serverResponse.command)throw new jS(Bv.CROSS_CHANNEL_FAILED_JOIN_DEST);if(e.data&&e.data.serverResponse&&"StartPacketTransfer"===e.serverResponse.command)throw new jS(Bv.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST);throw e}this.prevChannelMediaConfig=e}async updateChannelMediaRelay(e){if(this.state!==eT.RELAY_STATE_RUNNING)throw new jS(Bv.INVALID_OPERATION);await this.sendUpdateMessage(e),this.prevChannelMediaConfig=e}async setVideoProfile(e){if(this._resolution=e,this.state!==eT.RELAY_STATE_RUNNING)throw new jS(Bv.INVALID_OPERATION);const t=this.genMessage(ZS.SetVideoProfile);await this.signal.request(t),Yw.debug("[".concat(this.clientId,"] startChannelMediaRelay: setVideoProfile success"))}async stopChannelMediaRelay(){await this.sendStopRelayMessage(),Yw.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state=eT.RELAY_STATE_IDLE,this.dispose()}dispose(){Yw.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=gw.CancelToken.source(),this.state=eT.RELAY_STATE_IDLE,this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}async connect(){const e=await TC(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);this.workerToken=e.workerToken,await this.signal.connect(e.addressList),this.emit("event",$S.NETWORK_CONNECTED),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect)}async sendStartRelayMessage(e){const t=this.genMessage(ZS.StopPacketTransfer);await this.signal.request(t),await this.signal.waitStatus("Normal Quit"),Yw.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success"));const i=this.genMessage(ZS.SetSdkProfile,e);await this.signal.request(i),Yw.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success"));const n=this.genMessage(ZS.SetSourceChannel,e);await this.signal.request(n),await this.signal.waitStatus("SetSourceChannelStatus"),this.emit("event",$S.PACKET_JOINED_SRC_CHANNEL),Yw.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success"));const r=this.genMessage(ZS.SetSourceUserId,e);await this.signal.request(r),Yw.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success"));const o=this.genMessage(ZS.SetDestChannel,e);await this.signal.request(o),await this.signal.waitStatus("SetDestChannelStatus"),this.emit("event",$S.PACKET_JOINED_DEST_CHANNEL),Yw.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success"));const s=this.genMessage(ZS.StartPacketTransfer,e);await this.signal.request(s),this.emit("event",$S.PACKET_SENT_TO_DEST_CHANNEL),this.state=eT.RELAY_STATE_RUNNING,Yw.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success")),this.setVideoProfile(this._resolution)}async sendUpdateMessage(e){const t=this.genMessage(ZS.UpdateDestChannel,e);await this.signal.request(t),this.emit("event",$S.PACKET_UPDATE_DEST_CHANNEL),Yw.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"))}async sendStopRelayMessage(){const e=this.genMessage(ZS.StopPacketTransfer);await this.signal.request(e),Yw.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"))}genMessage(e,t){const i=[],n=[],r=[];this.requestId+=1;const o={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Iw,sid:this.sid,ts:Date.now(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.20.0"===o.sdkVersion&&(o.sdkVersion="0.0.1");let s=null,a=null;switch(e){case ZS.SetSdkProfile:return o.clientRequest={command:"SetSdkProfile",type:"multi_channel"},o;case ZS.SetSourceChannel:if(a=t&&t.getSrcChannelMediaInfo(),!a)throw new jS(Bv.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceChannel",uid:"0",channelName:a.channelName,token:a.token||this.joinInfo.appId},o;case ZS.SetSourceUserId:if(a=t&&t.getSrcChannelMediaInfo(),!a)throw new jS(Bv.UNEXPECTED_ERROR,"can not find source config");return o.clientRequest={command:"SetSourceUserId",uid:a.uid+""},o;case ZS.SetDestChannel:if(s=t&&t.getDestChannelMediaInfo(),!s)throw new jS(Bv.UNEXPECTED_ERROR,"can not find dest config");return s.forEach((e=>{i.push(e.channelName),n.push(e.uid+""),r.push(e.token||this.joinInfo.appId)})),o.clientRequest={command:"SetDestChannel",channelName:i,uid:n,token:r},o;case ZS.StartPacketTransfer:return o.clientRequest={command:"StartPacketTransfer"},o;case ZS.Reconnect:return o.clientRequest={command:"Reconnect"},o;case ZS.StopPacketTransfer:return o.clientRequest={command:"StopPacketTransfer"},o;case ZS.UpdateDestChannel:if(s=t&&t.getDestChannelMediaInfo(),!s)throw new jS(Bv.UNEXPECTED_ERROR,"can not find dest config");return s.forEach((e=>{i.push(e.channelName),n.push(e.uid+""),r.push(e.token||this.joinInfo.appId)})),o.clientRequest={command:"UpdateDestChannel",channelName:i,uid:n,token:r},o;case ZS.SetVideoProfile:o.clientRequest={command:"SetVideoProfile",width:this._resolution.width,height:this._resolution.height}}return o}}function TD(e){var t={},i=!1;function n(t,n){return i=!0,{done:!1,value:new yk(n=new Ik((function(i){i(e[t](n))})),1)}}return t[void 0!==Vl&&th||"@@iterator"]=function(){return this},t.next=function(e){return i?(i=!1,e):n("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(i)throw i=!1,e;return n("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return i?(i=!1,e):n("return",e)}),t}var RD=o(Ak);function CD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function ID(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?CD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):CD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function AD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function OD(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?AD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):AD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class MD extends UT{get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Mn(t=Object.keys(Vw)).call(t,e)})))]}constructor(e,t){super(e,t),oh(this,"store",void 0),oh(this,"peerConnection",void 0),oh(this,"remoteSDP",void 0),oh(this,"initialOffer",void 0),oh(this,"statsFilter",void 0),oh(this,"useRTX",!1),oh(this,"localCapabilities",void 0),oh(this,"localCandidateCount",0),oh(this,"allCandidatesReceived",!1),oh(this,"establishPromise",void 0),oh(this,"mutex",new YE("P2PConnection-mutex")),this.store=t,this.peerConnection=new RTCPeerConnection(MD.resolvePCConfiguration(e),{optional:[{googDscp:!0}]}),this.statsFilter=pP(this.peerConnection,Pw("STATS_UPDATE_INTERVAL"),void 0,Sv()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(){try{const e=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=vP(e.sdp),i=gP(e.sdp,{filterRTX:!this.useRTX,filterVideoFec:Pw("FILTER_VIDEO_FEC"),filterAudioFec:Pw("FILTER_AUDIO_FEC"),filterAudioCodec:["opus"]});return this.localCapabilities=i,this.initialOffer=e,OD(OD({},t),{},{rtpCapabilities:{send:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},recv:{audioCodecs:[],audioExtensions:[],videoCodecs:[],videoExtensions:[]},sendrecv:i},offerSDP:e.sdp})}catch(e){throw new jv(Bv.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e,t,i,n,r,o){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{constructor(e){oh(this,"sessionDesc",void 0),oh(this,"localCapabilities",void 0),oh(this,"rtpCapabilities",void 0),oh(this,"candidates",void 0),oh(this,"iceParameters",void 0),oh(this,"dtlsParameters",void 0),oh(this,"setup",void 0),oh(this,"currentMidIndex",void 0),oh(this,"cname",void 0),e=OE(e);const{remoteIceParameters:t,remoteDtlsParameters:i,candidates:n,remoteRTPCapabilities:r,remoteSetup:o,localCapabilities:s,sdkCodec:a,cname:c}=e,u=Yk.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE audio video\na=msid-semantic: WMS\na=ice-lite\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:audio\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendrecv\na=rtcp-mux\na=rtcp-rsize\na=mid:video\n");this.rtpCapabilities=r,this.candidates=n,this.iceParameters=t,this.dtlsParameters=i,this.setup=o,this.localCapabilities=s,this.cname=c;for(let d=0;d<u.mediaDescriptions.length;d++){const e=u.mediaDescriptions[d];if(e.attributes.iceUfrag=t.iceUfrag,e.attributes.icePwd=t.icePwd,e.attributes.fingerprints=i.fingerprints,e.attributes.candidates=n,e.attributes.setup=o,"video"===e.media.mediaType){e.media.fmts=r.videoCodecs.map((e=>e.payloadType.toString(10)));let t=r.videoCodecs.filter((e=>{var t,i;return null===(t=e.rtpMap)||void 0===t?void 0:Mn(i=t.encodingName.toLowerCase()).call(i,a)}));0===t.length&&(t=r.videoCodecs),e.attributes.payloads=t,e.attributes.extmaps=r.videoExtensions}"audio"===e.media.mediaType&&(e.media.fmts=r.audioCodecs.map((e=>e.payloadType.toString(10))),e.attributes.payloads=r.audioCodecs,e.attributes.extmaps=r.audioExtensions),u.mediaDescriptions[d]=this.mungMediaDesc(e)}this.sessionDesc=u,this.currentMidIndex=u.mediaDescriptions.length-1}toString(){return Yk.print(this.sessionDesc)}send(e,t,i){const{ssrcs:n,ssrcGroups:r}=yP(t,this.cname),o=this.sessionDesc.mediaDescriptions.find((t=>e===pT.VIDEO?"video"===t.media.mediaType:"audio"===t.media.mediaType)),s=n[0].attributes.label,a=n[0].attributes.mslabel;return o.attributes.ssrcs=o.attributes.ssrcs.concat(n),o.attributes.ssrcGroups=o.attributes.ssrcGroups.concat(r),{id:s,mslabel:a}}batchSend(e){return e.map((e=>{let{kind:t,ssrcMsg:i}=e;return this.send(t,i,void 0)}))}stopSending(e){this.sessionDesc.mediaDescriptions.forEach((t=>{const i=[],n=[],r=[];t.attributes.ssrcs.forEach((t=>{Mn(e).call(e,t.attributes.label||"")?r.push(t):i.push(t)})),t.attributes.ssrcGroups.forEach((e=>{var t;Mn(t=r.map((e=>e.ssrcId))).call(t,e.ssrcIds[0])||n.push(e)})),t.attributes.ssrcs=i,t.attributes.ssrcGroups=n}))}mute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}receive(e,t,i){e.forEach(((e,t)=>{const i=e._mediaStreamTrack,n=this.sessionDesc.mediaDescriptions.findIndex((e=>e.attributes.mid===i.kind)),r=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[n],e);this.sessionDesc.mediaDescriptions[n]=r}))}stopReceiving(e){}updateCandidates(e){e===mT.TCP?this.candidates.forEach((e=>{-1===this.candidates.findIndex((t=>"tcp"===t.transport&&t.connectionAddress===e.connectionAddress&&t.port===e.port))&&this.candidates.push(ID(ID({},e),{},{foundation:"tcpcandidate",priority:Number(e.priority)-1+"",transport:"tcp",port:Number(e.port)+90+""}))})):this.candidates=this.candidates.filter((e=>"tcp"!==e.transport));for(const t of this.sessionDesc.mediaDescriptions)t.attributes.candidates=this.candidates}restartICE(e){e=OE(e),this.iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}predictReceivingMids(e){const t=[];for(let i=0;i<e;i++)t.push((this.currentMidIndex+i+1).toString(10));return t}mungRecvMediaDsec(e,t){const i=OE(e);return wP(i,t),TP(i,t),i}updateRecvMedia(e,t){const i=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==i){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],t);this.sessionDesc.mediaDescriptions[i]=e}}bumpMid(e){this.currentMidIndex+=e}updateTrackLabel(e,t,i){const n=this.sessionDesc.mediaDescriptions.find((t=>e===pT.VIDEO?"video"===t.attributes.mid:"audio"===t.attributes.mid));if(n){const e=n.attributes.ssrcs.find((e=>e.attributes.label===t));var r;e&&(e.attributes.label=i,null===(r=e.attributes.msid)||void 0===r||r.replace(t,i))}}mungMediaDesc(e){const t=OE(e);return SP(t),function(e){const t=e.attributes.extmaps.find((e=>"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.extensionName));t&&e.attributes.extmaps.splice(e.attributes.extmaps.indexOf(t),1),e.attributes.payloads.forEach((e=>{const t=e.rtcpFeedbacks.findIndex((e=>"transport-cc"===e.type));-1!==t&&e.rtcpFeedbacks.splice(t,1)}))}(t),t}getSSRC(e){for(const t of this.sessionDesc.mediaDescriptions)for(const i of t.attributes.ssrcs)if(i.attributes.label===e)return[i]}}({remoteIceParameters:e,remoteDtlsParameters:t,candidates:i,remoteRTPCapabilities:n.send,remoteSetup:r,localCapabilities:this.localCapabilities,sdkCodec:this.store.codec,cname:o});const s=this.remoteSDP.toString();await this.peerConnection.setLocalDescription(this.initialOffer),await this.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}async updateRemoteRTPCapabilities(e,t){throw new jv(Bv.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}send(e,t){var i=this;return Nk((function*(){const n=yield wk(i.mutex.lock());try{if(!i.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const n=e.map((e=>i.peerConnection.addTrack(e._mediaStreamTrack))),r=yield wk(i.peerConnection.createOffer()),o=Yk.parse(r.sdp),s=e.map((e=>{const t=e._mediaStreamTrack,n=o.mediaDescriptions.find((e=>e.attributes.mid===t.kind));if(!n)throw new Error("Cannot extract ssrc from mediaDescription.");return function(e,t,i){const n=e.attributes.ssrcs.filter((e=>e.attributes.label===t)),r=e.attributes.ssrcGroups;if(0===n.length)throw new Error("Cannot extract ssrc from plan-b SDP.");if(r&&n.length>1){const e=r.find((e=>-1!==e.ssrcIds.indexOf(n[0].ssrcId)));return e?[{ssrcId:e.ssrcIds[0],rtx:i?e.ssrcIds[1]:void 0}]:[{ssrcId:n[0].ssrcId}]}return[{ssrcId:n[0].ssrcId}]}(n,t.id,i.useRTX)}));let a;try{a=yield s}catch(e){throw n.forEach((e=>{wv()&&e.replaceTrack(null),i.peerConnection.removeTrack(e)})),e}const c=i.mungSendOfferSDP(r.sdp,e);i.remoteSDP.receive(e,t,a);const u=i.remoteSDP.toString();return yield wk(i.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield wk(i.applySendEncodings(n,e)),yield wk(i.peerConnection.setRemoteDescription({type:"answer",sdp:u})),e.map(((e,t)=>{const i=e._mediaStreamTrack.id;return{localSSRC:s[t],id:i}}))}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{n()}}))()}async stopSending(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getSenders().filter((t=>{var i;return-1!==e.indexOf((null===(i=t.track)||void 0===i?void 0:i.id)||"")}));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map((e=>{wv()&&e.replaceTrack(null),this.peerConnection.removeTrack(e)}));const i=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(i),this.remoteSDP.stopReceiving(e);const n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}}async receive(e,t,i,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{id:i,mslabel:r}=this.remoteSDP.send(e,t,n),o=new nv(((t,n)=>{const o=setTimeout((()=>{n(new Error("Cannot receive track, id: ".concat(i)))}),1e4),s=n=>{const a=mv();if(("Safari"===a.name&&11===Number(a.version)||Tv())&&n.track.id!==i&&n.streams[0].id===r){var c;const r=n.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(e,i,n.track.id),this.peerConnection.removeEventListener("track",s),clearTimeout(o),void t(r)}if(n.track.id===i)return this.peerConnection.removeEventListener("track",s),clearTimeout(o),void t(n.track)};this.peerConnection.addEventListener("track",s)})),s=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:s});const a=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(a),{track:await o,id:i}}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const i=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(i)}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){}async unmuteRemote(e){}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter((t=>{var i;return-1!==e.indexOf((null===(i=t.track)||void 0===i?void 0:i.id)||"")}));if(t.length!==e.length)throw new Error("sender' length doesn't match mids' length.");t.map((e=>{if(wv()&&e.track)e.track.enabled=!1;else{const t=e.getParameters();t.encodings.forEach((e=>e.active=!1)),e.setParameters(t)}}))}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getSenders().filter((t=>{var i;return-1!==e.indexOf((null===(i=t.track)||void 0===i?void 0:i.id)||"")}));if(t.length!==e.length)throw new Error("Senders' length doesn't match mids' length.");t.map((async e=>{if(wv()&&e.track)e.track.enabled=!0;else{const t=e.getParameters();t.encodings.forEach((e=>e.active=!0)),await e.setParameters(t)}}));const i=await this.peerConnection.createOffer();await this.peerConnection.setLocalDescription(i);const n=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return Nk((function*(){const i=yield wk(t.mutex.lock("From P2PConnection.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(MC().supportPCSetConfiguration){const i=t.peerConnection.getConfiguration(),n=e===mT.RELAY?"relay":"all";i.iceTransportPolicy!==n&&(Yw.debug("[".concat(t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(i.iceTransportPolicy,"] to [").concat(n,"]")),i.iceTransportPolicy=n,t.peerConnection.setConfiguration(i))}else if(e===mT.RELAY)return;e!==mT.RELAY&&t.remoteSDP.updateCandidates(e);const i=yield wk(t.peerConnection.createOffer({iceRestart:!0}));if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const n=vP(i.sdp),{remoteIceParameters:r}=yield n.iceParameters;t.remoteSDP.restartICE(r);const o=t.remoteSDP.toString();yield wk(t.peerConnection.setLocalDescription(i)),yield wk(t.peerConnection.setRemoteDescription({type:"answer",sdp:o}))}catch(e){Yw.warning("[".concat(t.store.clientId,"] restart ICE failed, abort operation"),e)}finally{i()}}))()}close(){var e;this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.statsFilter.destroy()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const e=await this.peerConnection.createOffer(),i=this.mungSendOfferSDP(e.sdp,[t]);this.remoteSDP.updateRecvMedia(t._mediaStreamTrack.kind,t);const n=this.remoteSDP.toString();await this.peerConnection.setLocalDescription({type:"offer",sdp:i}),await this.peerConnection.setRemoteDescription({type:"answer",sdp:n})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const i=this.peerConnection.getSenders().filter((t=>{var i;return(null===(i=t.track)||void 0===i?void 0:i.id)===e}));1===i.length&&await this.applySendEncodings(i,[t])}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const i=this.peerConnection.getSenders().find((e=>{var i;return(null===(i=e.track)||void 0===i?void 0:i.id)===t}));i&&await i.replaceTrack(e._mediaStreamTrack)}createDataChannels(e,t){throw new jv(Bv.NOT_SUPPORTED,"Planb mode does not support createDataChannels.")}stopDataChannels(e){throw new jv(Bv.NOT_SUPPORTED,"Planb mode does not support stopDataChannels.")}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,Yw.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout((()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,Yw.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))}),Pw("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(e){const t={iceServers:[],sdpSemantics:"plan-b"};return e.iceServers?t.iceServers=e.iceServers:e.turnServer&&"off"!==e.turnServer.mode&&(_E(e.turnServer.servers)?t.iceServers=e.turnServer.servers:(t.iceServers&&t.iceServers.push(...MD.turnServerConfigToIceServers(e.turnServer.servers)),Pw("USE_TURN_SERVER_OF_GATEWAY")&&t.iceServers&&e.turnServer.serversFromGateway&&t.iceServers.push(...MD.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(t.iceTransportPolicy="relay")})))),t}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}async updateRtpSenderEncodings(e,t){var i;if(t||(t=this.peerConnection.getSenders().find((t=>{var i;return(null===(i=t.track)||void 0===i?void 0:i.id)===e._mediaStreamTrack.id}))),!t)return Yw.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(!MC().supportSetRtpSenderParameters)return Yw.warn("Browser not support set rtp-sender parameters");const n={},r={};if(e instanceof kA)switch(e._optimizationMode){case"motion":n.degradationPreference="maintain-framerate";break;case"detail":n.degradationPreference="maintain-resolution";break;default:n.degradationPreference="balanced"}if(Pw("DSCP_TYPE")&&xv()){var o;const e=Pw("DSCP_TYPE");Mn(o=["very-low","low","medium","high"]).call(o,e)&&(r.networkPriority=e)}const s=t.getParameters(),a=null===(i=s.encodings)||void 0===i?void 0:i[0];a&&Object.assign(a,r),Object.assign(s,n),Yw.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(s.encodings))),await t.setParameters(s)}async applySendEncodings(e,t){try{if(!MC().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let i=0;i<e.length;i++){const n=e[i],r=t[i];n&&r&&await this.updateRtpSenderEncodings(r,n)}}catch(e){Yw.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t){const i=Yk.parse(e);return t.forEach(((e,t)=>{const n=e._mediaStreamTrack,r=i.mediaDescriptions.find((e=>e.attributes.mid===n.kind));r&&wP(r,e)})),Yk.print(i)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,i)=>{var n;null===(n=this.onFirstVideoDecoded)||void 0===n||n.call(this,e,t,i)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var i;null===(i=this.onSelectedLocalCandidateChanged)||void 0===i||i.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var i;null===(i=this.onSelectedRemoteCandidateChanged)||void 0===i||i.call(this,e,t)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const t=this.remoteSDP.batchSend(e).map(((t,i)=>{let{id:n,mslabel:r}=t;const{kind:o}=e[i];return new nv(((e,t)=>{const i=setTimeout((()=>{t(new Error("Cannot receive track, id: ".concat(n)))}),1e4),s=t=>{const a=mv();if("Safari"===a.name&&11===Number(a.version)&&t.track.id!==n&&t.streams[0].id===r){var c;const r=t.streams[0].getTracks()[0];return null===(c=this.remoteSDP)||void 0===c||c.updateTrackLabel(o,n,t.track.id),this.peerConnection.removeEventListener("track",s),clearTimeout(i),void e({track:r,id:n})}if(t.track.id===n)return this.peerConnection.removeEventListener("track",s),clearTimeout(i),void e({track:t.track,id:n})};this.peerConnection.addEventListener("track",s)}))})),i=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:i});const n=await this.peerConnection.createAnswer();return await this.peerConnection.setLocalDescription(n),await nv.all(t)}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return null==t?void 0:t[0].ssrcId}setConfiguration(e){if(MC().supportPCSetConfiguration){const t=MD.resolvePCConfiguration(e);this.peerConnection.setConfiguration(t)}}}function ND(e,t,i){const n=e[t];if("function"!=typeof n)throw new Error("Cannot use mutex on object property.");return i.value=async function(){const e=this.mutex,i=await e.lock("Locking from P2PConnection.".concat(t));try{for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return await n.apply(this,o)}finally{i()}},i}function kD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function PD(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?kD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):kD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}VS([ND,BS("design:type",Function),BS("design:paramtypes",[Object,Object,Array,Object,String,String]),BS("design:returntype",nv)],MD.prototype,"connect",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],MD.prototype,"stopSending",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[String,Array,String,Object]),BS("design:returntype",nv)],MD.prototype,"receive",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],MD.prototype,"stopReceiving",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],MD.prototype,"muteRemote",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],MD.prototype,"unmuteRemote",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],MD.prototype,"muteLocal",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],MD.prototype,"unmuteLocal",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],MD.prototype,"close",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],MD.prototype,"updateEncoderConfig",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],MD.prototype,"updateSendParameters",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[_I,String]),BS("design:returntype",nv)],MD.prototype,"replaceTrack",null),VS([ND,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],MD.prototype,"getRemoteSSRC",null);const DD="9",LD=4e4;function xD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function UD(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?xD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):xD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class VD extends UT{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get dtlsTransportState(){var e,t;return null!==(e=null===(t=this.peerConnection.getReceivers()[0])||void 0===t||null===(t=t.transport)||void 0===t?void 0:t.state)&&void 0!==e?e:null}get localCodecs(){return[...new Set(this.localCapabilities&&this.localCapabilities.send.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Mn(t=Object.keys(Vw)).call(t,e)})))]}constructor(e,t){super(e,t),oh(this,"store",void 0),oh(this,"peerConnection",void 0),oh(this,"remoteSDP",void 0),oh(this,"initialOffer",void 0),oh(this,"transportEventReceiver",void 0),oh(this,"statsFilter",void 0),oh(this,"useXR",Pw("USE_XR")),oh(this,"localCapabilities",void 0),oh(this,"remoteCodecs",void 0),oh(this,"localCandidateCount",0),oh(this,"allCandidatesReceived",!1),oh(this,"dataStreamChannelMap",new Map),oh(this,"establishPromise",void 0),oh(this,"mutex",new YE("P2PConnection-mutex")),this.store=t,this.peerConnection=new RTCPeerConnection(VD.resolvePCConfiguration(e),{optional:[{googDscp:!0}]}),this.statsFilter=pP(this.peerConnection,Pw("STATS_UPDATE_INTERVAL"),void 0,Sv()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async updateRemoteRTPCapabilities(e,t){if(this.remoteCodecs=t,this.remoteSDP)if(this.remoteSDP.updateRemoteCodec(e,t,this.store.codec)){const e=await this.peerConnection.createOffer(),t=this.logSDPExchange(e.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(e);const i=this.remoteSDP.toString();null==t||t(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}else Yw.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.");else Yw.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(t))}async establish(){try{this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.peerConnection.addTransceiver("audio",{direction:"recvonly"});const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=vP(e.sdp),i=await AP({filterRTX:!Pw("USE_PUB_RTX")&&!Pw("USE_SUB_RTX"),filterVideoFec:Pw("FILTER_VIDEO_FEC"),filterAudioFec:Pw("FILTER_AUDIO_FEC"),filterVideoCodec:Pw("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=NP(i),this.initialOffer=e,UD(UD({},t),{},{rtpCapabilities:i,offerSDP:e.sdp})}catch(e){throw new jv(Bv.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e,t,i,n,r,o){try{if(!this.initialOffer)throw new Error("Cannot establish P2PConnection without initial offer.");this.remoteSDP=new class{get localCapabilities(){return OE(this._localCapabilities)}get rtpCapabilities(){return OE(this._rtpCapabilities)}get candidates(){return OE(this._candidates)}get iceParameters(){return OE(this._iceParameters)}get dtlsParameters(){return OE(this._dtlsParameters)}constructor(e){oh(this,"sessionDesc",void 0),oh(this,"_localCapabilities",void 0),oh(this,"_rtpCapabilities",void 0),oh(this,"_candidates",void 0),oh(this,"_iceParameters",void 0),oh(this,"_dtlsParameters",void 0),oh(this,"setup",void 0),oh(this,"currentMidIndex",void 0),oh(this,"cname",void 0),oh(this,"firefoxSsrcMidMap",new Map),e=OE(e);const{remoteIceParameters:t,remoteDtlsParameters:i,candidates:n,remoteRTPCapabilities:r,remoteSetup:o,localCapabilities:s,cname:a}=e,c=Yk.parse("v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0 1\na=msid-semantic: WMS\na=ice-lite\nm=video 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:0\nm=audio 9 UDP/TLS/RTP/SAVPF 0\nc=IN IP4 127.0.0.1\na=rtcp:9 IN IP4 0.0.0.0\na=sendonly\na=rtcp-mux\na=rtcp-rsize\na=mid:1\n");this._rtpCapabilities=r,this._candidates=n,this._iceParameters=t,this._dtlsParameters=i,this._localCapabilities=s,this.setup=o,this.cname=a;const u=this.rtpCapabilities.send;for(const d of c.mediaDescriptions){if(d.attributes.iceUfrag=t.iceUfrag,d.attributes.icePwd=t.icePwd,d.attributes.fingerprints=i.fingerprints,d.attributes.candidates=n,d.attributes.setup=o,"video"===d.media.mediaType&&(d.media.fmts=u.videoCodecs.map((e=>e.payloadType.toString(10))),d.attributes.payloads=u.videoCodecs,d.attributes.extmaps=u.videoExtensions,Pw("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=yP([{ssrcId:LD,rtx:Pw("USE_SUB_RTX")?40001:void 0}],this.cname);d.attributes.ssrcs=e,d.attributes.ssrcGroups=t}if("audio"===d.media.mediaType&&(d.media.fmts=u.audioCodecs.map((e=>e.payloadType.toString(10))),d.attributes.payloads=u.audioCodecs,d.attributes.extmaps=u.audioExtensions,kP(d),Pw("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=yP([{ssrcId:2e4}],this.cname);d.attributes.ssrcs=e,d.attributes.ssrcGroups=t}}this.sessionDesc=c,this.currentMidIndex=c.mediaDescriptions.length-1}preloadRemoteMedia(){const e=Pw("PRELOAD_MEDIA_COUNT");this.rtpCapabilities;const t=this.candidates,i=this.dtlsParameters,n=this.iceParameters,r=this.rtpCapabilities.send;for(let o=1;o<e;o++){const e=2*o+2e4,s=2*o+LD,{ssrcs:a,ssrcGroups:c}=yP([{ssrcId:e}],this.cname),{ssrcs:u,ssrcGroups:d}=yP([{ssrcId:s,rtx:Pw("USE_SUB_RTX")?s+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:DD,protos:["UDP","TLS","RTP","SAVPF"],fmts:r.videoCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:n.iceUfrag,icePwd:n.icePwd,unrecognized:[],candidates:t,extmaps:r.videoExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:u,ssrcGroups:d,rtcpFeedbackWildcards:[],payloads:r.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*o)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:DD,protos:["UDP","TLS","RTP","SAVPF"],fmts:r.audioCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:n.iceUfrag,icePwd:n.icePwd,unrecognized:[],candidates:t,extmaps:r.audioExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:a,ssrcGroups:c,rtcpFeedbackWildcards:[],payloads:r.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*o+1)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Yk.print(this.sessionDesc)}send(e,t,i,n){const{ssrcs:r,ssrcGroups:o}=yP(t,this.cname,Pw("SYNC_GROUP")?i:void 0),s=this.findPreloadMediaDesc(r);if(s){if(Sv()&&this.firefoxSsrcMidMap.set(r[0].ssrcId,s.attributes.mid),n&&(n.twcc||n.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(s);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(s,n),{mid:s.attributes.mid,needExchangeSDP:!0}}return{mid:s.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,r);let i;return-1===t||1===t&&(wv()||Av())||0===t&&Pw("USE_SUB_RTX")||Ov()?(i=this.createOrRecycleSendMedia(e,r,o,"sendonly",n),this.updateBundleMids()):(i=OE(this.sessionDesc.mediaDescriptions[t]),i.attributes.direction="sendonly",i.attributes.ssrcs=r,i.attributes.ssrcGroups=o,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(i,n)),Sv()&&this.firefoxSsrcMidMap.set(r[0].ssrcId,i.attributes.mid),{mid:i.attributes.mid,needExchangeSDP:!0}}}sendDataChannel(){const{mediaDesc:e,needExchangeSDP:t}=this.createOrRecycleDataChannel();return this.updateBundleMids(),{mid:e.attributes.mid,needExchangeSDP:t}}batchSend(e){const t=e.map((e=>{let{kind:t,ssrcMsg:i,mslabel:n}=e;return this.send(t,i,n)})),i=[];let n=!1;return t.forEach((e=>{let{mid:t,needExchangeSDP:r}=e;r&&(n=!0),i.push(t)})),{mids:i,needExchangeSDP:n}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach((e=>{"0"===e.attributes.mid||Sv()||Ov()?e.attributes.ssrcs=[]:(e.attributes.ssrcs=[],e.attributes.direction="inactive",e.media.port="0")})),this.updateBundleMids()}mute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Mn(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="inactive"}))}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Mn(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="recvonly"}))}receive(e,t,i,n){e.forEach(((e,r)=>{this.createOrRecycleRecvMedia(e,[],"recvonly",t,i,n[r])})),this.updateBundleMids()}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach((e=>{e.media.port="0",e.attributes.direction="inactive"})),this.updateBundleMids()}updateCandidates(e){const t=this._candidates.filter((e=>"udp"===e.transport));if(e===mT.TCP){if(0===t.length)return;if(Pw("TCP_CANDIDATE_ONLY")){const e=this._candidates.filter((e=>"tcp"===e.transport));t.forEach((t=>{-1===e.findIndex((e=>e.connectionAddress===t.connectionAddress))&&e.push(PD(PD({},t),{},{foundation:"tcpcandidate",priority:Number(t.priority)-1+"",transport:"tcp",port:Number(t.port)+90+""}))})),this._candidates=e}else{const e=[];t.forEach((t=>{e.push(PD(PD({},t),{},{foundation:"tcpcandidate",priority:Number(t.priority)-1+"",transport:"tcp",port:Number(t.port)+90+""}))})),this._candidates=[...t,...e]}}else if(e===mT.RELAY){if(0!==t.length)return;{const e=this._candidates.filter((e=>"tcp"===e.transport));e.forEach((e=>{t.push(PD(PD({},e),{},{foundation:"udpcandidate",priority:Number(e.priority)+1+"",transport:"udp",port:Number(e.port)-90+""}))})),this._candidates=[...t,...e]}}else 0===t.length?(this._candidates.filter((e=>"tcp"===e.transport)).forEach((e=>{t.push(PD(PD({},e),{},{foundation:"udpcandidate",priority:Number(e.priority)+1+"",transport:"udp",port:Number(e.port)-90+""}))})),this._candidates=t):this._candidates=this._candidates.filter((e=>"tcp"!==e.transport));for(const i of this.sessionDesc.mediaDescriptions)i.attributes.candidates=this.candidates}restartICE(e){e=OE(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}predictReceivingMids(e){const t=[];for(let i=0;i<e;i++)t.push((this.currentMidIndex+i+1).toString(10));return t}findAvailableMediaIndex(e,t){return this.sessionDesc.mediaDescriptions.findIndex((i=>{const n=i.media.mediaType===e&&"0"!==i.media.port&&("sendonly"===i.attributes.direction||"sendrecv"===i.attributes.direction)&&0===i.attributes.ssrcs.length;if(Sv()){if(n){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==i.attributes.mid&&"1"!==i.attributes.mid)||!(!e||e!==i.attributes.mid)}return!1}return n}))}createOrRecycleDataChannel(){for(const i of this.sessionDesc.mediaDescriptions)if("application"===i.media.mediaType)return{mediaDesc:i,needExchangeSDP:!1};this.currentMidIndex+=1;const e="".concat(this.currentMidIndex),t={media:{mediaType:"application",port:DD,protos:["UDP","DTLS","SCTP"],fmts:["webrtc-datachannel"]},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:[],fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:[],ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:[],rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,mid:"".concat(e),sctpPort:"5000"}};return this.sessionDesc.mediaDescriptions.push(t),{mediaDesc:t,needExchangeSDP:!0}}createOrRecycleRecvMedia(e,t,i,n,r,o){const s=e._mediaStreamTrack.kind,a=this.rtpCapabilities.recv,c=DP(s,a,this.localCapabilities.send,s===pT.VIDEO?n:r),u=s===pT.VIDEO?a.videoExtensions:a.audioExtensions;this.currentMidIndex+=1;const d="".concat(this.currentMidIndex);let l={media:{mediaType:s,port:DD,protos:["UDP","TLS","RTP","SAVPF"],fmts:c.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:u,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(d)}};l=this.mungRecvMediaDsec(l,e,o);const h=this.findFirstClosedMedia(s);if(h){const e=this.sessionDesc.mediaDescriptions.indexOf(h);this.sessionDesc.mediaDescriptions[e]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}updateRemoteCodec(e,t,i){const n=[...new Set(this._rtpCapabilities.recv.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Mn(t=Object.keys(Vw)).call(t,e)})))],r=new Set(t);if(n.every((e=>r.has(e))))return Yw.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(t)),!1;const o=this._rtpCapabilities.recv.videoCodecs.filter((e=>t.some((t=>{var i;return Mn(i=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(i,t)}))));if(0===o.length)return Yw.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(n," codecs: ").concat(t)),!1;const s=[...new Set(o.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")))];let a;if(Yw.debug("updateRemoteCodec, from ".concat(n," to ").concat(s)),0===e.length)a=this.sessionDesc.mediaDescriptions.filter((e=>"video"===e.media.mediaType&&"recvonly"===e.attributes.direction));else if(a=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&Mn(e).call(e,t.attributes.mid)&&"recvonly"===t.attributes.direction)),a.length!==e.length)return Yw.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(e,", codecs: ").concat(t)),!1;this._rtpCapabilities.recv.videoCodecs=o;const c=this.localCapabilities.send,u=this.rtpCapabilities.recv,d=DP(pT.VIDEO,u,c,i);return a.forEach((e=>{const t=d.map((e=>e.payloadType.toString(10)));Yw.debug("updateRemoteCodec mid: ".concat(e.attributes.mid,", from ").concat(e.attributes.payloads," to ").concat(d)),e.attributes.payloads=d,e.media.fmts=t})),!0}createOrRecycleSendMedia(e,t,i,n,r){const o=this.rtpCapabilities.send,s=e===pT.VIDEO?o.videoCodecs:o.audioCodecs,a=e===pT.VIDEO?o.videoExtensions:o.audioExtensions;this.currentMidIndex+=1;const c="".concat(this.currentMidIndex);let u={media:{mediaType:e,port:DD,protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:a,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:i,rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(c)}};u=this.mungSendMediaDesc(u,r);const d=this.findFirstClosedMedia(e);if(d){const e=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[e]=u}else this.sessionDesc.mediaDescriptions.push(u);return u}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter((e=>"0"!==e.media.port)).map((e=>e.attributes.mid))}mungRecvMediaDsec(e,t,i){const n=OE(e);return SP(n),wP(n,t),TP(n,t),RP(n),CP(n,i,this.localCapabilities.send),n}mungSendMediaDesc(e,t){const i=OE(e);return CP(i,t,this.localCapabilities.recv),kP(i),i}updateRecvMedia(e,t){const i=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==i){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],t);this.sessionDesc.mediaDescriptions[i]=e}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find((t=>Sv()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port))}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find((t=>{var i;return(null===(i=t.attributes)||void 0===i||null===(i=i.ssrcs[0])||void 0===i?void 0:i.ssrcId)===e[0].ssrcId}))}getSSRC(e){var t;return null===(t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e)))||void 0===t?void 0:t.attributes.ssrcs}}({remoteIceParameters:e,remoteDtlsParameters:t,candidates:i,remoteRTPCapabilities:n,remoteSetup:r,localCapabilities:this.localCapabilities,cname:o}),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&this.remoteSDP.updateRemoteCodec([],this.remoteCodecs,this.store.codec);const s=this.remoteSDP.toString(),a=Yk.parse(this.initialOffer.sdp),c=a.mediaDescriptions.find((e=>"audio"===e.media.mediaType));c&&kP(c),this.useXR&&PP(a);const u=Yk.print(a),d=this.logSDPExchange(u||"","offer","local","connect");this.store.descriptionStart(),await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),null==d||d(s),await this.peerConnection.setRemoteDescription({type:"answer",sdp:s});const l=this.peerConnection.getTransceivers()[0];if(null!=l&&l.receiver&&this.tryBindTransportEvents(l.receiver),Pw("PRELOAD_MEDIA_COUNT")>0){this.remoteSDP.preloadRemoteMedia();const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t)}}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.connect failed; ".concat(e.toString()))}}send(e,t,i){var n=this;return Nk((function*(){const r=yield wk(n.mutex.lock("From P2PConnection.send"));try{if(!n.remoteSDP)throw new Error("Cannot call P2PConnection.send before remote SDP created");const o=[];e.forEach((e=>{const t=n.peerConnection.addTransceiver(e._mediaStreamTrack,{direction:"sendonly"});o.push(t),e._updateRtpTransceiver(t)})),Sv()&&!0===Pw("SIMULCAST")&&(yield wk(n.applySimulcastForFirefox(o,e)));const s=yield wk(n.peerConnection.createOffer()),a=n.remoteSDP.predictReceivingMids(e.length),c=n.mungSendOfferSDP(s.sdp,e,a),u=Yk.parse(c),d=a.map((e=>{const t=u.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return EP(t,Pw("USE_PUB_RTX"))}));let l;try{l=yield d}catch(r){l=[],n.remoteSDP.receive(e,t,i,l);const o=n.remoteSDP.toString();throw yield wk(n.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield wk(n.peerConnection.setRemoteDescription({type:"answer",sdp:o})),yield wk(n.stopSending(a,!0)),r}n.remoteSDP.receive(e,t,i,l);const h=n.remoteSDP.toString(),f=n.logSDPExchange(c,"offer","local","send");return yield wk(n.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield wk(n.applySimulcastEncodings(o,e)),yield wk(n.applySendEncodings(o,e)),null==f||f(h),yield wk(n.peerConnection.setRemoteDescription({type:"answer",sdp:h})),o.map(((e,t)=>{const i=a[t];return{localSSRC:d[t],id:i,transceiver:e}}))}catch(e){throw e instanceof jv?e:new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.send failed; ".concat(e.toString()))}finally{r()}}))()}async createDataChannels(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.createDataChannels before remote SDP created");let i=this.dataStreamChannelMap.get(e);i&&"open"===i.readyState?Yw.debug("[P2PConnection] Channels are already available and can be reused directly."):(i=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:Pw("DATASTREAM_MAX_RETRANSMITS")}),i.binaryType="arraybuffer",this.dataStreamChannelMap.set(e,i)),t.forEach((e=>{e._updateOriginDataChannel(i)}));const{needExchangeSDP:n}=this.remoteSDP.sendDataChannel();if(n){const e=this.remoteSDP.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const t=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(t),Yw.debug("[P2PConnection] createDataChannels by exchanging SDP.")}else Yw.debug("[P2PConnection] createDataChannels no need to exchange SDP.");return}catch(e){throw e instanceof jv?e:new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.createDataChannels failed; ".concat(e.toString()))}}async stopDataChannels(e){try{const t=this.dataStreamChannelMap.get(e);return null==t||t.close(),void this.dataStreamChannelMap.delete(e)}catch(e){throw e instanceof jv?e:new jv(Bv.DATACHANNEL_FAILED,"P2PConnection.stopDataChannels failed; ".concat(e.toString()))}}async stopSending(e,t){const i=t?void 0:await this.mutex.lock("From P2PConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter((t=>-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call P2PConnection.stopSending.");t.map((e=>{var t;e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)}));const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(i),this.remoteSDP.stopReceiving(e);const r=this.remoteSDP.toString();null==n||n(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.stopSending failed; ".concat(e.toString()))}finally{i&&i()}}async receive(e,t,i,n){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.receive ".concat(e," before remoteSDP created."));const{mid:r,needExchangeSDP:o}=this.remoteSDP.send(e,t,i,n);if(o){const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer(),o=this.mungReceiveAnswerSDP(n.sdp,r,e);null==i||i(o||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:o}),Yw.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," by exchanging SDP."))}else Yw.debug("[".concat(this.store.clientId,"] [P2PConnection] receive ").concat(e," no need to exchange SDP."));const s=this.peerConnection.getTransceivers().find((e=>e.mid===r));if(!s)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:s.receiver.track,id:r,transceiver:s}}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.batchReceive before remoteSDP created.");const{mids:t,needExchangeSDP:i}=this.remoteSDP.batchSend(e);if(i){const e=this.remoteSDP.toString(),t=this.logSDPExchange(e,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const i=await this.peerConnection.createAnswer();null==t||t(i.sdp||""),await this.peerConnection.setLocalDescription(i),Yw.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive by exchanging SDP."))}else Yw.debug("[".concat(this.store.clientId,"] [P2PConnection] batchReceive no need to exchange SDP."));return t.map((e=>{const t=this.peerConnection.getTransceivers().find((t=>t.mid===e));if(!t)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:t.receiver.track,id:e,transceiver:t}}))}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();null==i||i(n.sdp||""),await this.peerConnection.setLocalDescription(n)}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();null==i||i(n.sdp||""),await this.peerConnection.setLocalDescription(n)}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.muteRemote failed; ".concat(e.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();null==i||i(n.sdp||""),await this.peerConnection.setLocalDescription(n)}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteRemote failed; ".concat(e.toString()))}}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((e=>{e.direction="inactive"}));const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.muteRemote(e);const r=this.remoteSDP.toString();null==n||n(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((async(e,t)=>{e.direction="sendonly"}));const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.unmuteRemote(e);const r=this.remoteSDP.toString();null==n||n(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,"P2PConnection.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return Nk((function*(){const i=yield wk(t.mutex.lock("From P2PConnection.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(MC().supportPCSetConfiguration){const i=t.peerConnection.getConfiguration(),n=e===mT.RELAY?"relay":"all";i.iceTransportPolicy!==n&&(Yw.debug("[".concat(t.store.clientId,"] restartICE change iceTransportPolicy from [").concat(i.iceTransportPolicy,"] to [").concat(n,"]")),i.iceTransportPolicy=n,t.peerConnection.setConfiguration(i))}else if(e===mT.RELAY)return;t.remoteSDP.updateCandidates(e);const i=yield wk(t.peerConnection.createOffer({iceRestart:!0}));if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const n=vP(i.sdp),{remoteIceParameters:r}=yield n.iceParameters;t.remoteSDP.restartICE(r);const o=t.remoteSDP.toString(),s=t.logSDPExchange(i.sdp||"","offer","local","restartICE");t.store.descriptionStart(),yield wk(t.peerConnection.setLocalDescription(i)),null==s||s(o),yield wk(t.peerConnection.setRemoteDescription({type:"answer",sdp:o}))}catch(e){Yw.warning("[".concat(t.store.clientId,"] restart ICE failed, abort operation"),e)}finally{i()}}))()}close(){var e;this.peerConnection.close(),null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.tryUnbindTransportEvents(),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call P2PConnection.updateEncoderConfig before remote SDP created.");const i=await this.peerConnection.createOffer(),n=this.mungSendOfferSDP(i.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const r=this.remoteSDP.toString(),o=this.logSDPExchange(n,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),null==o||o(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jv(Bv.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const i=this.peerConnection.getTransceivers().filter((t=>t.mid===e));1===i.length&&(this.isVP8Simulcast(t)?Sv()||await this.applySimulcastEncodings(i,[t]):await this.applySendEncodings(i,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const i=this.peerConnection.getTransceivers().find((e=>e.mid===t));i&&await i.sender.replaceTrack(e._mediaStreamTrack)}async getSelectedCandidatePair(){const e=this.peerConnection.getReceivers();if(e.length>0&&e[0].transport&&e[0].transport.iceTransport&&e[0].transport.iceTransport.getSelectedCandidatePair&&e[0].transport.iceTransport.getSelectedCandidatePair()){const t=e[0].transport.iceTransport,{local:i,remote:n}=t.getSelectedCandidatePair();return{local:UD(UD({},Zk),{},{candidateType:i.type,protocol:i.protocol,address:i.address,port:i.port}),remote:UD(UD({},Zk),{},{candidateType:n.type,protocol:n.protocol,address:n.address,port:n.port})}}return this.statsFilter.getSelectedCandidatePair()}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,Yw.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout((()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,Yw.debug("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))}),Pw("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(e){const t={iceServers:[]};return e.iceServers?t.iceServers=e.iceServers:e.turnServer&&"off"!==e.turnServer.mode&&(_E(e.turnServer.servers)?t.iceServers=e.turnServer.servers:(t.iceServers&&t.iceServers.push(...VD.turnServerConfigToIceServers(e.turnServer.servers)),Pw("USE_TURN_SERVER_OF_GATEWAY")&&t.iceServers&&e.turnServer.serversFromGateway&&t.iceServers.push(...VD.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),Pw("FORCE_TURN_TCP")?t.iceTransportPolicy="relay":e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(t.iceTransportPolicy="relay")})))),Pw("ENABLE_ENCODED_TRANSFORM")&&MC().supportWebRTCEncodedTransform&&(t.encodedInsertableStreams=!0),t}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(RR(e.turnServerURL),":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&!Pw("FORCE_TURN_TCP")&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}tryBindTransportEvents(e){const t=e.transport;if(t){this.transportEventReceiver=e,t.onstatechange=()=>{var e;null!=t&&t.state&&(null===(e=this.onDTLSTransportStateChange)||void 0===e||e.call(this,t.state))},t.onerror=e=>{var t;null===(t=this.onDTLSTransportError)||void 0===t||t.call(this,"error"in e?e.error:e)};const i=t.iceTransport;i&&(i.onstatechange=()=>{const e=null==t?void 0:t.iceTransport.state;var i;e&&(null===(i=this.onICETransportStateChange)||void 0===i||i.call(this,e))},i.getSelectedCandidatePair&&(i.onselectedcandidatepairchange=()=>{if(i.getSelectedCandidatePair()){const{local:e,remote:t}=i.getSelectedCandidatePair();Yw.info("[".concat(this.store.clientId,"] [pc-").concat(this.store.p2pId,"] selectedcandidatepairchange: local ").concat(JSON.stringify({candidateType:e.type,protocol:e.protocol}),", remote ").concat(JSON.stringify({candidateType:t.type,protocol:t.protocol,address:t.address,port:t.port})," )"))}}))}}tryUnbindTransportEvents(){this.transportEventReceiver&&this.transportEventReceiver.transport&&(this.transportEventReceiver.transport.onstatechange=null,this.transportEventReceiver.transport.onerror=null,this.transportEventReceiver.transport.iceTransport&&(this.transportEventReceiver.transport.iceTransport.onstatechange=null))}async updateRtpSenderEncodings(e,t){var i;if(t||(t=this.peerConnection.getSenders().find((t=>t.track===e._mediaStreamTrack))),!t)return Yw.warn("[".concat(e.getTrackId(),"] no rtpSender found}"));if(this.isVP8Simulcast(e))return Yw.warn("[updateRtpSenderEncodings] Track is VP8 simulcast, please apply simulcast encodings");if(!MC().supportSetRtpSenderParameters)return Yw.warn("[updateRtpSenderEncodings] Browser not support set rtp-sender parameters");const n={},r={};switch(e._optimizationMode){case"motion":n.degradationPreference="maintain-framerate";break;case"detail":n.degradationPreference="maintain-resolution";break;default:n.degradationPreference="balanced"}if(e._encoderConfig){var o;const{bitrateMax:t,frameRate:i,scaleResolutionDownBy:n}=e._encoderConfig;t&&(r.maxBitrate=1e3*t),(Mn(o=e._hints).call(o,YC.LOW_STREAM)||e.isUseScaleResolutionDownBy)&&(i&&(r.maxFramerate=IR(i)),n&&n>=1&&(r.scaleResolutionDownBy=n))}if(Pw("DSCP_TYPE")&&xv()){var s;const e=Pw("DSCP_TYPE");Mn(s=["very-low","low","medium","high"]).call(s,e)&&(r.networkPriority=e)}const a=t.getParameters(),c=null===(i=a.encodings)||void 0===i?void 0:i[0];Sv()&&!c&&(n.encodings=[r]),c&&Object.assign(c,r),Object.assign(a,n),Yw.debug("[".concat(e.getTrackId(),"] updateRtpSenderEncodings: ").concat(JSON.stringify(a.encodings))),await t.setParameters(a)}async applySendEncodings(e,t){try{if(!MC().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let i=0;i<e.length;i++){const n=e[i],r=t[i];r instanceof kA&&!this.isVP8Simulcast(r)&&await this.updateRtpSenderEncodings(r,n.sender)}}catch(e){Yw.debug("[".concat(this.store.clientId,"] Apply RTPSendEncodings failed."))}}mungSendOfferSDP(e,t,i){const n=Yk.parse(e);return t.forEach(((e,t)=>{const r=i[t],o=n.mediaDescriptions.find((e=>e.attributes.mid===r));o&&(wP(o,e),IP(o,e,this.store.codec))})),Yk.print(n)}mungReceiveAnswerSDP(e,t,i){const n=Yk.parse(e),r=n.mediaDescriptions.find((e=>e.attributes.mid===t));return r&&(i===pT.AUDIO&&"audio"===r.media.mediaType&&kP(r),this.useXR&&PP(n)),Yk.print(n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,i)=>{var n;null===(n=this.onFirstVideoDecoded)||void 0===n||n.call(this,e,t,i)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var i;null===(i=this.onSelectedLocalCandidateChanged)||void 0===i||i.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var i;null===(i=this.onSelectedRemoteCandidateChanged)||void 0===i||i.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let a=0;a<e.length;a++){var i,n,r,o,s;const c=e[a],u=t[a];if(u instanceof kA&&!Mn(i=u._hints).call(i,YC.LOW_STREAM)&&null!==(n=u._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=u._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(o=u._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(s=u._scalabilityMode)||void 0===s?void 0:s.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const i=c.sender.getParameters();await c.sender.setParameters(Object.assign(i,e))}}}async applySimulcastEncodings(e,t){if(!Sv()&&e.length===t.length)for(let i=0;i<e.length;i++){const n=t[i];if(n instanceof kA&&this.isVP8Simulcast(n)){const t=e[i],r={},o={high:1e3*(n._encoderConfig.bitrateMax-50),medium:5e4};r.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const s=t.sender.getParameters();await t.sender.setParameters(Object.assign(s,r))}}}isVP8Simulcast(e){var t,i,n,r,o;return!!(e instanceof kA&&Pw("SIMULCAST")&&"vp8"===this.store.codec&&!Mn(t=e._hints).call(t,YC.LOW_STREAM)&&null!==(i=e._encoderConfig)&&void 0!==i&&i.bitrateMax&&(null===(n=e._encoderConfig)||void 0===n?void 0:n.bitrateMax)>200&&null!==(r=e._scalabilityMode)&&void 0!==r&&r.numSpatialLayers&&(null===(o=e._scalabilityMode)||void 0===o?void 0:o.numSpatialLayers)>1)}logSDPExchange(e,t,i,n){if(Pw("SDP_LOGGING"))return Yw.upload("[".concat(this.store.clientId,"] exchanging ").concat(i," ").concat(t," SDP during P2PConnection.").concat(n,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===i?"remote":"local",n)}:void 0}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return null==t?void 0:t[0].ssrcId}setConfiguration(e){if(MC().supportPCSetConfiguration){const t=VD.resolvePCConfiguration(e);this.peerConnection.setConfiguration(t)}}}function BD(e,t,i){const n=e[t];if("function"!=typeof n)throw new Error("Cannot use mutex on object property.");return i.value=async function(){const e=this.mutex,i=await e.lock("From P2PConnection.".concat(t));try{for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return await n.apply(this,o)}finally{i()}},i}function jD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function FD(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?jD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):jD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}VS([BD,BS("design:type",Function),BS("design:paramtypes",[Array,Array]),BS("design:returntype",nv)],VD.prototype,"updateRemoteRTPCapabilities",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[Object,Object,Array,Object,String,String]),BS("design:returntype",nv)],VD.prototype,"connect",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[Object,Array]),BS("design:returntype",nv)],VD.prototype,"createDataChannels",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[String,Array,String,Object]),BS("design:returntype",nv)],VD.prototype,"receive",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],VD.prototype,"batchReceive",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],VD.prototype,"stopReceiving",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],VD.prototype,"muteRemote",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],VD.prototype,"unmuteRemote",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],VD.prototype,"muteLocal",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],VD.prototype,"unmuteLocal",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],VD.prototype,"close",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],VD.prototype,"updateEncoderConfig",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],VD.prototype,"updateSendParameters",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[_I,String]),BS("design:returntype",nv)],VD.prototype,"replaceTrack",null),VS([BD,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],VD.prototype,"getRemoteSSRC",null);const WD="v=0\no=- 0 0 IN IP4 127.0.0.1\ns=AgoraGateway\nt=0 0\na=group:BUNDLE 0\na=msid-semantic: WMS\na=ice-lite\nm=application 9 UDP/DTLS/SCTP webrtc-datachannel\nc=IN IP4 127.0.0.1\na=mid:0\n",GD="9",HD=2e4,qD=4e4;class KD{get localCapabilities(){return OE(this._localCapabilities)}get rtpCapabilities(){return OE(this._rtpCapabilities)}get candidates(){return OE(this._candidates)}get iceParameters(){return OE(this._iceParameters)}get dtlsParameters(){return OE(this._dtlsParameters)}constructor(e){oh(this,"sessionDesc",void 0),oh(this,"_localCapabilities",void 0),oh(this,"_rtpCapabilities",void 0),oh(this,"_candidates",void 0),oh(this,"_iceParameters",void 0),oh(this,"_dtlsParameters",void 0),oh(this,"setup",void 0),oh(this,"currentMidIndex",void 0),oh(this,"cname",void 0),oh(this,"firefoxSsrcMidMap",new Map),e=OE(e);const{remoteIceParameters:t,remoteDtlsParameters:i,candidates:n,remoteRTPCapabilities:r,remoteSetup:o,localCapabilities:s,cname:a}=e,c=Yk.parse(WD);this._rtpCapabilities=r,this._candidates=n,this._iceParameters=t,this._dtlsParameters=i,this._localCapabilities=s,this.setup=o,this.cname=a;const u=this.rtpCapabilities.send;for(const d of c.mediaDescriptions){if(d.attributes.iceUfrag=t.iceUfrag,d.attributes.icePwd=t.icePwd,d.attributes.fingerprints=i.fingerprints,d.attributes.candidates=n,d.attributes.setup=o,"application"===d.media.mediaType&&(d.attributes.sctpPort="5000"),"video"===d.media.mediaType&&(d.media.fmts=u.videoCodecs.map((e=>e.payloadType.toString(10))),d.attributes.payloads=u.videoCodecs,d.attributes.extmaps=u.videoExtensions,Pw("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=yP([{ssrcId:qD,rtx:Pw("USE_SUB_RTX")?40001:void 0}],this.cname);d.attributes.ssrcs=e,d.attributes.ssrcGroups=t}if("audio"===d.media.mediaType&&(d.media.fmts=u.audioCodecs.map((e=>e.payloadType.toString(10))),d.attributes.payloads=u.audioCodecs,d.attributes.extmaps=u.audioExtensions,kP(d),Pw("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=yP([{ssrcId:HD}],this.cname);d.attributes.ssrcs=e,d.attributes.ssrcGroups=t}}this.sessionDesc=c,this.currentMidIndex=c.mediaDescriptions.length-1}updateRemoteRTPCapabilities(e){const t=Yk.parse(WD);this._rtpCapabilities=e;const i=this.rtpCapabilities.send;for(const n of t.mediaDescriptions){if(n.attributes.iceUfrag=this._iceParameters.iceUfrag,n.attributes.icePwd=this._iceParameters.icePwd,n.attributes.fingerprints=this._dtlsParameters.fingerprints,n.attributes.candidates=this._candidates,n.attributes.setup=this.setup,"application"===n.media.mediaType&&(n.attributes.sctpPort="5000"),"video"===n.media.mediaType&&(n.media.fmts=i.videoCodecs.map((e=>e.payloadType.toString(10))),n.attributes.payloads=i.videoCodecs,n.attributes.extmaps=i.videoExtensions,Pw("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=yP([{ssrcId:qD,rtx:Pw("USE_SUB_RTX")?40001:void 0}],this.cname);n.attributes.ssrcs=e,n.attributes.ssrcGroups=t}if("audio"===n.media.mediaType&&(n.media.fmts=i.audioCodecs.map((e=>e.payloadType.toString(10))),n.attributes.payloads=i.audioCodecs,n.attributes.extmaps=i.audioExtensions,Pw("PRELOAD_MEDIA_COUNT")>0)){const{ssrcs:e,ssrcGroups:t}=yP([{ssrcId:HD}],this.cname);n.attributes.ssrcs=e,n.attributes.ssrcGroups=t}}this.sessionDesc=t,this.currentMidIndex=t.mediaDescriptions.length-1}preloadRemoteMedia(e){this.rtpCapabilities;const t=this.candidates,i=this.dtlsParameters,n=this.iceParameters,r=this.rtpCapabilities.send;for(let o=1;o<e;o++){const e=2*o+HD,s=2*o+qD,{ssrcs:a,ssrcGroups:c}=yP([{ssrcId:e}],this.cname),{ssrcs:u,ssrcGroups:d}=yP([{ssrcId:s,rtx:Pw("USE_SUB_RTX")?s+1:void 0}],this.cname);this.sessionDesc.mediaDescriptions.push({media:{mediaType:"video",port:GD,protos:["UDP","TLS","RTP","SAVPF"],fmts:r.videoCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:n.iceUfrag,icePwd:n.icePwd,unrecognized:[],candidates:t,extmaps:r.videoExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:u,ssrcGroups:d,rtcpFeedbackWildcards:[],payloads:r.videoCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*o-1)}}),this.sessionDesc.mediaDescriptions.push({media:{mediaType:"audio",port:GD,protos:["UDP","TLS","RTP","SAVPF"],fmts:r.audioCodecs.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:n.iceUfrag,icePwd:n.icePwd,unrecognized:[],candidates:t,extmaps:r.audioExtensions,fingerprints:i.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:a,ssrcGroups:c,rtcpFeedbackWildcards:[],payloads:r.audioCodecs,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:"sendonly",rtcpMux:!0,rtcpRsize:!0,mid:"".concat(2*o)}}),this.currentMidIndex+=2}this.updateBundleMids()}toString(){return Yk.print(this.sessionDesc)}send(e,t,i,n){const{ssrcs:r,ssrcGroups:o}=yP(t,this.cname,Pw("SYNC_GROUP")?i:void 0),s=this.findPreloadMediaDesc(r);if(s){if(Sv()&&this.firefoxSsrcMidMap.set(r[0].ssrcId,s.attributes.mid),n&&(n.twcc||n.remb)){const e=this.sessionDesc.mediaDescriptions.indexOf(s);return this.sessionDesc.mediaDescriptions[e]=this.mungSendMediaDesc(s,n),{mid:s.attributes.mid,needExchangeSDP:!0}}return{mid:s.attributes.mid,needExchangeSDP:!1}}{const t=this.findAvailableMediaIndex(e,r);let i;return-1===t||wv()||Tv()||Av()||0===t&&Pw("USE_SUB_RTX")?(i=this.createOrRecycleSendMedia(e,r,o,"sendonly",n),this.updateBundleMids()):(i=OE(this.sessionDesc.mediaDescriptions[t]),i.attributes.direction="sendonly",i.attributes.ssrcs=r,i.attributes.ssrcGroups=o,this.sessionDesc.mediaDescriptions[t]=this.mungSendMediaDesc(i,n)),Sv()&&this.firefoxSsrcMidMap.set(r[0].ssrcId,i.attributes.mid),{mid:i.attributes.mid,needExchangeSDP:!0}}}batchSend(e){const t=e.map((e=>{let{kind:t,ssrcMsg:i,mslabel:n}=e;return this.send(t,i,n)})),i=[];let n=!1;return t.forEach((e=>{let{mid:t,needExchangeSDP:r}=e;r&&(n=!0),i.push(t)})),{mids:i,needExchangeSDP:n}}stopSending(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.stopSending.");t.forEach((e=>{"0"===e.attributes.mid||Sv()||wv()||Tv()?e.attributes.ssrcs=[]:(e.attributes.ssrcs=[],e.attributes.direction="inactive",e.media.port="0")})),this.updateBundleMids()}mute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.mute."));t.attributes.direction="inactive"}unmute(e){const t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("mediaDescription not found with ".concat(e," in remote SDP when calling RemoteSDP.unmute."));t.attributes.direction="sendonly"}muteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Mn(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="inactive"}))}unmuteRemote(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>Mn(e).call(e,t.attributes.mid||"")));if(t.length!==e.length)throw new Error("mediaDescriptions' length doesn't match mids' length when calling RemoteSDP.muteRemote.");t.forEach((e=>{e.attributes.direction="recvonly"}))}receive(e,t,i,n){e.forEach(((e,r)=>{this.createOrRecycleRecvMedia(e,[],"recvonly",t,i,n[r])})),this.updateBundleMids()}stopReceiving(e){const t=this.sessionDesc.mediaDescriptions.filter((t=>-1!==e.indexOf(t.attributes.mid)));if(t.length!==e.length)throw new Error("MediaDescriptions' length doesn't match mids's length when calling RemoteSDP.receive.");t.forEach((e=>{e.media.port="0",e.attributes.direction="inactive"})),this.updateBundleMids()}updateCandidates(e){e===mT.TCP?this._candidates.forEach((e=>{-1===this._candidates.findIndex((t=>"tcp"===t.transport&&t.connectionAddress===e.connectionAddress&&t.port===e.port))&&this._candidates.push(FD(FD({},e),{},{foundation:"tcpcandidate",priority:Number(e.priority)-1+"",transport:"tcp",port:Number(e.port)+90+""}))})):this._candidates=this._candidates.filter((e=>"tcp"!==e.transport));for(const t of this.sessionDesc.mediaDescriptions)t.attributes.candidates=this.candidates}restartICE(e){e=OE(e),this._iceParameters=e,this.sessionDesc.mediaDescriptions.forEach((t=>{t.attributes.iceUfrag=e.iceUfrag,t.attributes.icePwd=e.icePwd}))}predictReceivingMids(e){const t=[];for(let i=0;i<e;i++)t.push((this.currentMidIndex+i+1).toString(10));return t}findAvailableMediaIndex(e,t){return this.sessionDesc.mediaDescriptions.findIndex((i=>{const n=i.media.mediaType===e&&"0"!==i.media.port&&("sendonly"===i.attributes.direction||"sendrecv"===i.attributes.direction)&&0===i.attributes.ssrcs.length;if(Sv()){if(n){const e=this.firefoxSsrcMidMap.get(t[0].ssrcId);return!(e||"0"!==i.attributes.mid&&"1"!==i.attributes.mid)||!(!e||e!==i.attributes.mid)}return!1}return n}))}createOrRecycleRecvMedia(e,t,i,n,r,o){const s=e._mediaStreamTrack.kind,a=this.rtpCapabilities.recv,c=DP(s,a,this.localCapabilities.send,s===pT.VIDEO?n:r),u=s===pT.VIDEO?a.videoExtensions:a.audioExtensions;this.currentMidIndex+=1;const d="".concat(this.currentMidIndex);let l={media:{mediaType:s,port:GD,protos:["UDP","TLS","RTP","SAVPF"],fmts:c.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:u,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:[],rtcpFeedbackWildcards:[],payloads:c,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:i,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(d)}};l=this.mungRecvMediaDsec(l,e,o);const h=this.findFirstClosedMedia(s);if(h){const e=this.sessionDesc.mediaDescriptions.indexOf(h);this.sessionDesc.mediaDescriptions[e]=l}else this.sessionDesc.mediaDescriptions.push(l);return l}updateRemoteCodec(e,t,i){const n=[...new Set(this._rtpCapabilities.recv.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Mn(t=Object.keys(Vw)).call(t,e)})))],r=new Set(t);if(n.every((e=>r.has(e))))return Yw.debug("codecs has not changed, no need to updateRemoteCodec, codecs: ".concat(t)),!1;const o=this._rtpCapabilities.recv.videoCodecs.filter((e=>t.some((t=>{var i;return Mn(i=e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"").call(i,t)}))));if(0===o.length)return Yw.debug("updateRemoteCodec failed, because cannot find matched codec, remoteCapabilities codecs: ".concat(n," codecs: ").concat(t)),!1;const s=[...new Set(o.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")))];let a;if(Yw.debug("updateRemoteCodec, from ".concat(n," to ").concat(s)),0===e.length)a=this.sessionDesc.mediaDescriptions.filter((e=>"video"===e.media.mediaType&&"recvonly"===e.attributes.direction));else if(a=this.sessionDesc.mediaDescriptions.filter((t=>t.attributes.mid&&Mn(e).call(e,t.attributes.mid)&&"recvonly"===t.attributes.direction)),a.length!==e.length)return Yw.debug("updateRemoteCodec failed, because cannot find mids, mids: ".concat(e,", codecs: ").concat(t)),!1;this._rtpCapabilities.recv.videoCodecs=o;const c=this.localCapabilities.send,u=this.rtpCapabilities.recv,d=DP(pT.VIDEO,u,c,i);return a.forEach((e=>{const t=d.map((e=>e.payloadType.toString(10)));Yw.debug("updateRemoteCodec mid: ".concat(e.attributes.mid,", from ").concat(e.attributes.payloads," to ").concat(d)),e.attributes.payloads=d,e.media.fmts=t})),!0}createOrRecycleSendMedia(e,t,i,n,r){const o=this.rtpCapabilities.send,s=e===pT.VIDEO?o.videoCodecs:o.audioCodecs,a=e===pT.VIDEO?o.videoExtensions:o.audioExtensions;this.currentMidIndex+=1;const c="".concat(this.currentMidIndex);let u={media:{mediaType:e,port:GD,protos:["UDP","TLS","RTP","SAVPF"],fmts:s.map((e=>e.payloadType.toString(10)))},connections:[{nettype:"IN",addrtype:"IP4",address:"127.0.0.1"}],bandwidths:[],attributes:{iceUfrag:this.iceParameters.iceUfrag,icePwd:this.iceParameters.icePwd,unrecognized:[],candidates:this.candidates,extmaps:a,fingerprints:this.dtlsParameters.fingerprints,imageattr:[],msids:[],remoteCandidatesList:[],rids:[],ssrcs:t,ssrcGroups:i,rtcpFeedbackWildcards:[],payloads:s,rtcp:{port:"9",netType:"IN",addressType:"IP4",address:"0.0.0.0"},setup:this.setup,direction:n,rtcpMux:!0,rtcpRsize:!0,mid:"".concat(c)}};u=this.mungSendMediaDesc(u,r);const d=this.findFirstClosedMedia(e);if(d){const e=this.sessionDesc.mediaDescriptions.indexOf(d);this.sessionDesc.mediaDescriptions[e]=u}else this.sessionDesc.mediaDescriptions.push(u);return u}updateBundleMids(){this.sessionDesc.attributes.groups[0].identificationTag=this.sessionDesc.mediaDescriptions.filter((e=>"0"!==e.media.port)).map((e=>e.attributes.mid))}mungRecvMediaDsec(e,t,i){const n=OE(e);return SP(n),wP(n,t),TP(n,t),RP(n),CP(n,i,this.localCapabilities.send),n}mungSendMediaDesc(e,t){const i=OE(e);return CP(i,t,this.localCapabilities.recv),kP(i),i}updateRecvMedia(e,t){const i=this.sessionDesc.mediaDescriptions.findIndex((t=>t.attributes.mid===e));if(-1!==i){const e=this.mungRecvMediaDsec(this.sessionDesc.mediaDescriptions[i],t);this.sessionDesc.mediaDescriptions[i]=e}}bumpMid(e){this.currentMidIndex+=e}findFirstClosedMedia(e){return this.sessionDesc.mediaDescriptions.find((t=>Sv()?"0"===t.media.port&&t.media.mediaType===e:"0"===t.media.port))}findPreloadMediaDesc(e){return this.sessionDesc.mediaDescriptions.find((t=>{var i;return(null===(i=t.attributes)||void 0===i||null===(i=i.ssrcs[0])||void 0===i?void 0:i.ssrcId)===e[0].ssrcId}))}getSSRC(e){var t;return null===(t=this.sessionDesc.mediaDescriptions.find((t=>t.attributes.mid===e)))||void 0===t?void 0:t.attributes.ssrcs}}function zD(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function YD(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?zD(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):zD(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}class JD extends UT{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){let e;return this.localCapabilities&&(e=NP(this.localCapabilities)),[...new Set(e&&e.send.videoCodecs.map((e=>e.rtpMap&&e.rtpMap.encodingName.toLowerCase()||"")).filter((e=>{var t;return Mn(t=Object.keys(Vw)).call(t,e)})))]}constructor(e,t,i){super(e,t),oh(this,"store",void 0),oh(this,"peerConnection",void 0),oh(this,"remoteSDP",void 0),oh(this,"initialOffer",void 0),oh(this,"transportEventReceiver",void 0),oh(this,"statsFilter",void 0),oh(this,"useXR",Pw("USE_XR")),oh(this,"localCapabilities",void 0),oh(this,"localCandidateCount",0),oh(this,"allCandidatesReceived",!1),oh(this,"remoteCodecs",void 0),oh(this,"dataStreamChannelMap",new Map),oh(this,"establishPromise",void 0),oh(this,"mutex",new YE("NVExtentionsConnection-mutex")),oh(this,"rtcMedia",void 0),this.store=t,this.peerConnection=i,this.statsFilter=pP(this.peerConnection,Pw("STATS_UPDATE_INTERVAL"),void 0,Sv()?1200:void 0),this.bindPCEvents(),this.bindStatsEvents(),this.store.p2pId=this.store.p2pId+1,this.establishPromise=this.establish()}async establish(e){try{const e=await this.peerConnection.createOffer();if(!e.sdp)throw new Error("Cannot get initialOffer.sdp when trying to establish PeerConnection.");const t=vP(e.sdp),i=await AP({filterRTX:!Pw("USE_PUB_RTX")&&!Pw("USE_SUB_RTX"),filterVideoFec:Pw("FILTER_VIDEO_FEC"),filterAudioFec:Pw("FILTER_AUDIO_FEC"),filterVideoCodec:Pw("FILTER_VIDEO_CODEC")},{useXR:this.useXR});return this.localCapabilities=i,this.initialOffer=e,YD(YD({},t),{},{rtpCapabilities:i,offerSDP:e.sdp})}catch(e){throw new jS(Bv.GET_LOCAL_CONNECTION_PARAMS_FAILED,e.toString())}}async connect(e,t,i,n,r,o){try{if(!this.initialOffer)throw new Error("Cannot establish NVConnection without initial offer.");this.remoteSDP=new KD({remoteIceParameters:e,remoteDtlsParameters:t,candidates:i,remoteRTPCapabilities:n,remoteSetup:r,localCapabilities:NP(this.localCapabilities),cname:o});const s=this.remoteSDP.toString(),a=Yk.parse(this.initialOffer.sdp),c=a.mediaDescriptions.find((e=>"audio"===e.media.mediaType));c&&kP(c),this.useXR&&PP(a);const u=Yk.print(a),d=this.logSDPExchange(u||"","offer","local","connect");await this.peerConnection.setLocalDescription({type:"offer",sdp:u}),null==d||d(s),await this.peerConnection.setRemoteDescription({type:"answer",sdp:s})}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,"NV.connect failed; ".concat(e.toString()))}}async updateRemoteRTPCapabilities(e,t){if(this.remoteCodecs=t,this.remoteSDP)if(this.remoteSDP.updateRemoteCodec(e,t,this.store.codec)){const e=await this.peerConnection.createOffer(),t=this.logSDPExchange(e.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(e);const i=this.remoteSDP.toString();null==t||t(i),await this.peerConnection.setRemoteDescription({type:"answer",sdp:i})}else Yw.debug("[P2PConnection] updateRemoteRTPCapabilities no need to exchange SDP.");else Yw.debug("[P2PConnection] cannot updateRemoteRTPCapabilities before remote SDP created, local codecs: ".concat(this.localCodecs,", codecs: ").concat(t))}async updateRemoteConnect(e){var t,i,n,r;null===(t=this.remoteSDP)||void 0===t||t.updateRemoteRTPCapabilities(e),Array.isArray(this.remoteCodecs)&&this.remoteCodecs.length>0&&(null===(r=this.remoteSDP)||void 0===r||r.updateRemoteCodec([],this.remoteCodecs,this.store.codec)),null===(i=this.remoteSDP)||void 0===i||i.preloadRemoteMedia(2);const o=null===(n=this.remoteSDP)||void 0===n?void 0:n.toString();await this.peerConnection.setRemoteDescription({type:"offer",sdp:o});const s=await this.peerConnection.createAnswer();await this.peerConnection.setLocalDescription(s),Yw.debug("[NVExtentionsConnection] updateRemoteRTPCapabilities by exchanging SDP.")}send(e,t,i){var n=this;return Nk((function*(){const r=yield wk(n.mutex.lock("From NVExtentionsConnection.send"));try{if(!n.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.send before remote SDP created");const o=[];e.forEach((e=>{const t=n.peerConnection.addTransceiver(e._mediaStreamTrack,{direction:"sendonly"});o.push(t)})),Sv()&&!0===Pw("SIMULCAST")&&(yield wk(n.applySimulcastForFirefox(o,e)));const s=yield wk(n.peerConnection.createOffer()),a=n.remoteSDP.predictReceivingMids(e.length),c=n.mungSendOfferSDP(s.sdp,e,a),u=Yk.parse(c),d=a.map((e=>{const t=u.mediaDescriptions.find((t=>t.attributes.mid===e));if(!t)throw new Error("Cannot extract ssrc from mediaDescription.");return EP(t,Pw("USE_PUB_RTX"))}));let l;try{l=yield d}catch(r){l=[],n.remoteSDP.receive(e,t,i,l);const o=n.remoteSDP.toString();throw yield wk(n.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield wk(n.peerConnection.setRemoteDescription({type:"answer",sdp:o})),yield wk(n.stopSending(a,!0)),r}n.remoteSDP.receive(e,t,i,l);const h=n.remoteSDP.toString(),f=n.logSDPExchange(c,"offer","local","send");return yield wk(n.peerConnection.setLocalDescription({type:"offer",sdp:c})),yield wk(n.applySimulcastEncodings(o,e)),yield wk(n.applySendEncodings(o,e)),null==f||f(h),yield wk(n.peerConnection.setRemoteDescription({type:"answer",sdp:h})),o.map(((e,t)=>{const i=a[t];return{localSSRC:d[t],id:i,transceiver:e}}))}catch(e){throw e instanceof jS?e:new jS(Bv.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.send failed; ".concat(e.toString()))}finally{r()}}))()}async stopSending(e,t){const i=t?void 0:await this.mutex.lock("From NVExtentionsConnection.stopSending");try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopSending before remote SDP created");const t=this.peerConnection.getTransceivers().filter((t=>-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length when trying to call NVExtentionsConnection.stopSending.");t.map((e=>{var t;e.direction="inactive",null===(t=e.stop)||void 0===t||t.call(e)}));const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","stopSending");await this.peerConnection.setLocalDescription(i),this.remoteSDP.stopReceiving(e);const r=this.remoteSDP.toString();null==n||n(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.stopSending failed; ".concat(e.toString()))}finally{i&&i()}}async createDataChannels(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.createDataChannels before remote SDP created");let i=this.dataStreamChannelMap.get(e);return i&&"open"===i.readyState?Yw.debug("[P2PConnection] Channels are already available and can be reused directly."):(i=this.peerConnection.createDataChannel("datastream-channel",{ordered:!1,maxRetransmits:Pw("DATASTREAM_MAX_RETRANSMITS")}),i.binaryType="arraybuffer",this.dataStreamChannelMap.set(e,i)),void t.forEach((e=>{e._updateOriginDataChannel(i)}))}catch(e){throw e instanceof jS?e:new jS(Bv.DATACHANNEL_FAILED,"NVExtentionsConnection.createDataChannels failed; ".concat(e.toString()))}}async stopDataChannels(e){try{const t=this.dataStreamChannelMap.get(e);return null==t||t.close(),void this.dataStreamChannelMap.delete(e)}catch(e){throw e instanceof jS?e:new jS(Bv.DATACHANNEL_FAILED,"NVExtentionsConnection.stopDataChannels failed; ".concat(e.toString()))}}async receive(e,t,i,n){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.receive ".concat(e," before remoteSDP created."));const{mid:r,needExchangeSDP:o}=this.remoteSDP.send(e,t,i,n);if(o){const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer(),o=this.mungReceiveAnswerSDP(n.sdp,r,e);null==i||i(o||""),await this.peerConnection.setLocalDescription({type:"answer",sdp:o}),Yw.debug("[NVExtentionsConnection] receive ".concat(e," by exchanging SDP."))}else Yw.debug("[NVExtentionsConnection] receive ".concat(e," no need to exchange SDP."));const s=this.peerConnection.getTransceivers().find((e=>e.mid===r));if(!s)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:s.receiver.track,id:r}}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(e.toString()))}}async batchReceive(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.batchReceive before remoteSDP created.");const{mids:t,needExchangeSDP:i}=this.remoteSDP.batchSend(e);if(i){const e=this.remoteSDP.toString(),t=this.logSDPExchange(e,"offer","remote","receive");await this.peerConnection.setRemoteDescription({type:"offer",sdp:e});const i=await this.peerConnection.createAnswer();null==t||t(i.sdp||""),await this.peerConnection.setLocalDescription(i),Yw.debug("[NVExtentionsConnection] batchReceive by exchanging SDP.")}else Yw.debug("[NVExtentionsConnection] batchReceive no need to exchange SDP.");return t.map((e=>{const t=this.peerConnection.getTransceivers().find((t=>t.mid===e));if(!t)throw new Error("Cannot get transceiver after setLocalDescription.");return{track:t.receiver.track,id:e}}))}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.receive failed; ".concat(e.toString()))}}async stopReceiving(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.stopReceiving before remote SDP created.");this.remoteSDP.stopSending(e);const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","stopReceiving");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();null==i||i(n.sdp||""),await this.peerConnection.setLocalDescription(n)}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,"NVExtentionsConnection stopReceiving failed; ".concat(e.toString()))}}async muteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.mute(e);const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","muteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();null==i||i(n.sdp||""),await this.peerConnection.setLocalDescription(n)}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteRemote failed; ".concat(e.toString()))}}async unmuteRemote(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteRemote mid=".concat(e," before remote SDP created."));this.remoteSDP.unmute(e);const t=this.remoteSDP.toString(),i=this.logSDPExchange(t,"offer","remote","unmuteRemote");await this.peerConnection.setRemoteDescription({type:"offer",sdp:t});const n=await this.peerConnection.createAnswer();null==i||i(n.sdp||""),await this.peerConnection.setLocalDescription(n)}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteRemote failed; ".concat(e.toString()))}}async muteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.muteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((e=>{e.direction="inactive"}));const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","muteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.muteRemote(e);const r=this.remoteSDP.toString();null==n||n(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.muteLocal failed; ".concat(e.toString()))}}async unmuteLocal(e){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.unmuteLocal before remote SDP created.");const t=this.peerConnection.getTransceivers().filter((t=>t.mid&&-1!==e.indexOf(t.mid)));if(t.length!==e.length)throw new Error("Transceivers' length doesn't match mids' length.");t.map((async(e,t)=>{e.direction="sendonly"}));const i=await this.peerConnection.createOffer(),n=this.logSDPExchange(i.sdp||"","offer","local","unmuteLocal");await this.peerConnection.setLocalDescription(i),this.remoteSDP.unmuteRemote(e);const r=this.remoteSDP.toString();null==n||n(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,"NVExtentionsConnection.unmuteLocal failed; ".concat(e.toString()))}}restartICE(e){var t=this;return Nk((function*(){const i=yield wk(t.mutex.lock("From NVExtentionsConnection.restartICE"));try{if(!t.remoteSDP)throw new Error("Cannot restartICE before remoteSDP created.");if(MC().supportPCSetConfiguration){const i=t.peerConnection.getConfiguration(),n=e===mT.RELAY?"relay":"all";i.iceTransportPolicy!==n&&(Yw.debug("restartICE change iceTransportPolicy from [".concat(i.iceTransportPolicy,"] to [").concat(n,"]")),i.iceTransportPolicy=n,t.peerConnection.setConfiguration(i))}else if(e===mT.RELAY)return;e!==mT.RELAY&&t.remoteSDP.updateCandidates(e);const i=yield wk(t.peerConnection.createOffer({iceRestart:!0}));if(!i.sdp)throw new Error("Cannot restartICE because restart offer SDP does not exist.");const n=vP(i.sdp),{remoteIceParameters:r}=yield n.iceParameters;t.remoteSDP.restartICE(r);const o=t.remoteSDP.toString(),s=t.logSDPExchange(i.sdp||"","offer","local","restartICE");yield wk(t.peerConnection.setLocalDescription(i)),null==s||s(o),yield wk(t.peerConnection.setRemoteDescription({type:"answer",sdp:o}))}catch(e){Yw.warning("restart ICE failed, abort operation",e)}finally{i()}}))()}close(){var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,"closed"),this.unbindPCEvents(),this.unbindStatsEvents(),this.removeAllListeners(),this.transportEventReceiver=void 0,this.statsFilter.destroy(),this.dataStreamChannelMap.clear()}getStats(){return this.statsFilter.getStats()}getRemoteVideoIsReady(e){return this.statsFilter.getVideoIsReady(e)}async updateEncoderConfig(e,t){try{if(!this.remoteSDP)throw new Error("Cannot call NVExtentionsConnection.updateEncoderConfig before remote SDP created.");const i=await this.peerConnection.createOffer(),n=this.mungSendOfferSDP(i.sdp,[t],[e]);this.remoteSDP.updateRecvMedia(e,t);const r=this.remoteSDP.toString(),o=this.logSDPExchange(n,"offer","local","updateEncoderConfig");await this.peerConnection.setLocalDescription({type:"offer",sdp:n}),null==o||o(r),await this.peerConnection.setRemoteDescription({type:"answer",sdp:r})}catch(e){throw new jS(Bv.EXCHANGE_SDP_FAILED,e.toString())}}async updateSendParameters(e,t){const i=this.peerConnection.getTransceivers().filter((t=>t.mid===e));1===i.length&&(this.isVP8Simulcast(t)?Sv()||await this.applySimulcastEncodings(i,[t]):await this.applySendEncodings(i,[t]))}setStatsRemoteVideoIsReady(e,t){this.statsFilter.setVideoIsReady2(e,t)}async replaceTrack(e,t){const i=this.peerConnection.getTransceivers().find((e=>e.mid===t));i&&await i.sender.replaceTrack(e._mediaStreamTrack)}getP2PConnectionParams(){var e;if(null===(e=this.peerConnection.currentLocalDescription)||void 0===e||!e.sdp||!this.localCapabilities)throw new Error;return YD(YD({},vP(this.peerConnection.currentLocalDescription.sdp)),{},{rtpCapabilities:this.localCapabilities})}bindPCEvents(){this.peerConnection.oniceconnectionstatechange=()=>{var e;null===(e=this.onICEConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.iceConnectionState)},this.peerConnection.onconnectionstatechange=()=>{var e;null===(e=this.onConnectionStateChange)||void 0===e||e.call(this,this.peerConnection.connectionState)},this.peerConnection.onicecandidate=e=>{e.candidate?this.localCandidateCount+=1:(this.peerConnection.onicecandidate=null,this.allCandidatesReceived=!0,Yw.debug("[pc-".concat(this.store.p2pId,"] local candidate count"),this.localCandidateCount))},setTimeout((()=>{this.allCandidatesReceived||(this.allCandidatesReceived=!0,Yw.debug("[pc-".concat(this.store.p2pId,"] onicecandidate timeout, local candidate count"),this.localCandidateCount))}),Pw("CANDIDATE_TIMEOUT"))}unbindPCEvents(){this.peerConnection.oniceconnectionstatechange=null,this.peerConnection.onconnectionstatechange=null,this.peerConnection.onsignalingstatechange=null,this.peerConnection.onicecandidateerror=null,this.peerConnection.onicecandidate=null,this.peerConnection.ontrack=null}static resolvePCConfiguration(e){const t={iceServers:[]};return e.iceServers?t.iceServers=e.iceServers:e.turnServer&&"off"!==e.turnServer.mode&&(_E(e.turnServer.servers)?t.iceServers=e.turnServer.servers:(t.iceServers&&t.iceServers.push(...JD.turnServerConfigToIceServers(e.turnServer.servers)),Pw("USE_TURN_SERVER_OF_GATEWAY")&&t.iceServers&&e.turnServer.serversFromGateway&&t.iceServers.push(...JD.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),Pw("FORCE_TURN_TCP")?t.iceTransportPolicy="relay":e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(t.iceTransportPolicy="relay")})))),t}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(RR(e.turnServerURL),":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&!Pw("FORCE_TURN_TCP")&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}async applySendEncodings(e,t){try{if(!MC().supportSetRtpSenderParameters)return;if(e.length!==t.length)return;for(let d=0;d<e.length;d++){const l=e[d],h=t[d];if(h&&h instanceof kA){var i,n,r;if(this.isVP8Simulcast(h))continue;const e={},t={};switch(h._optimizationMode){case"motion":e.degradationPreference="maintain-framerate";break;case"detail":e.degradationPreference="maintain-resolution";break;default:e.degradationPreference="balanced"}var o,s,a,c;if(null!==(i=h._encoderConfig)&&void 0!==i&&i.bitrateMax&&(t.maxBitrate=1e3*(null===(o=h._encoderConfig)||void 0===o?void 0:o.bitrateMax)),Mn(n=h._hints).call(n,YC.LOW_STREAM)&&(null!==(s=h._encoderConfig)&&void 0!==s&&s.frameRate&&(t.maxFramerate=IR(h._encoderConfig.frameRate)),null!==(a=h._encoderConfig)&&void 0!==a&&a.scaleResolutionDownBy&&(null===(c=h._encoderConfig)||void 0===c?void 0:c.scaleResolutionDownBy)>1&&(t.scaleResolutionDownBy=h._encoderConfig.scaleResolutionDownBy)),Pw("DSCP_TYPE")&&xv()){var u;const e=Pw("DSCP_TYPE");Mn(u=["very-low","low","medium","high"]).call(u,e)&&(t.networkPriority=e)}const d=l.sender.getParameters(),f=null===(r=d.encodings)||void 0===r?void 0:r[0];Sv()&&!f&&(e.encodings=[t]),f&&Object.assign(f,t),Object.assign(d,e),await l.sender.setParameters(d)}}}catch(e){Yw.debug("Apply RTPSendEncodings failed.")}}mungSendOfferSDP(e,t,i){const n=Yk.parse(e);return t.forEach(((e,t)=>{const r=i[t],o=n.mediaDescriptions.find((e=>e.attributes.mid===r));o&&(wP(o,e),IP(o,e,this.store.codec))})),Yk.print(n)}mungReceiveAnswerSDP(e,t,i){const n=Yk.parse(e),r=n.mediaDescriptions.find((e=>e.attributes.mid===t));return r&&i===pT.AUDIO&&"audio"===r.media.mediaType&&kP(r),this.useXR&&PP(n),Yk.print(n)}bindStatsEvents(){this.statsFilter.onFirstAudioReceived=e=>{var t;null===(t=this.onFirstAudioReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoReceived=e=>{var t;null===(t=this.onFirstVideoReceived)||void 0===t||t.call(this,e)},this.statsFilter.onFirstAudioDecoded=e=>{var t;null===(t=this.onFirstAudioDecoded)||void 0===t||t.call(this,e)},this.statsFilter.onFirstVideoDecoded=(e,t,i)=>{var n;null===(n=this.onFirstVideoDecoded)||void 0===n||n.call(this,e,t,i)},this.statsFilter.onSelectedLocalCandidateChanged=(e,t)=>{var i;null===(i=this.onSelectedLocalCandidateChanged)||void 0===i||i.call(this,e,t)},this.statsFilter.onSelectedRemoteCandidateChanged=(e,t)=>{var i;null===(i=this.onSelectedRemoteCandidateChanged)||void 0===i||i.call(this,e,t)},this.statsFilter.onFirstVideoDecodedTimeout=e=>{var t;null===(t=this.onFirstVideoDecodedTimeout)||void 0===t||t.call(this,e)}}unbindStatsEvents(){this.statsFilter.onFirstAudioReceived=void 0,this.statsFilter.onFirstVideoReceived=void 0,this.statsFilter.onFirstAudioDecoded=void 0,this.statsFilter.onFirstVideoDecoded=void 0,this.statsFilter.onSelectedLocalCandidateChanged=void 0,this.statsFilter.onSelectedRemoteCandidateChanged=void 0,this.statsFilter.onFirstVideoDecodedTimeout=void 0}async applySimulcastForFirefox(e,t){if(e.length===t.length)for(let a=0;a<e.length;a++){var i,n,r,o,s;const c=e[a],u=t[a];if(u instanceof kA&&!Mn(i=u._hints).call(i,YC.LOW_STREAM)&&null!==(n=u._encoderConfig)&&void 0!==n&&n.bitrateMax&&(null===(r=u._encoderConfig)||void 0===r?void 0:r.bitrateMax)>200&&null!==(o=u._scalabilityMode)&&void 0!==o&&o.numSpatialLayers&&(null===(s=u._scalabilityMode)||void 0===s?void 0:s.numSpatialLayers)>1&&"vp8"===this.store.codec){const e={},t={high:1e3*(u._encoderConfig.bitrateMax-50),medium:5e4};e.encodings=[{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:4},{rid:"h",active:!0,maxBitrate:t.high}];const i=c.sender.getParameters();await c.sender.setParameters(Object.assign(i,e))}}}async applySimulcastEncodings(e,t){if(!Sv()&&e.length===t.length)for(let i=0;i<e.length;i++){const n=t[i];if(n instanceof kA&&this.isVP8Simulcast(n)){const t=e[i],r={},o={high:1e3*(n._encoderConfig.bitrateMax-50),medium:5e4};r.encodings=[{active:!0,adaptivePtime:!1,networkPriority:"high",priority:"high",maxBitrate:o.high},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:o.medium,scaleResolutionDownBy:4}];const s=t.sender.getParameters();await t.sender.setParameters(Object.assign(s,r))}}}isVP8Simulcast(e){var t,i,n,r,o;return!!(e instanceof kA&&Pw("SIMULCAST")&&"vp8"===this.store.codec&&!Mn(t=e._hints).call(t,YC.LOW_STREAM)&&null!==(i=e._encoderConfig)&&void 0!==i&&i.bitrateMax&&(null===(n=e._encoderConfig)||void 0===n?void 0:n.bitrateMax)>200&&null!==(r=e._scalabilityMode)&&void 0!==r&&r.numSpatialLayers&&(null===(o=e._scalabilityMode)||void 0===o?void 0:o.numSpatialLayers)>1)}logSDPExchange(e,t,i,n){if(Pw("SDP_LOGGING"))return Yw.upload("exchanging ".concat(i," ").concat(t," SDP during NVExtentionsConnection.").concat(n,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===i?"remote":"local",n)}:void 0}async getRemoteSSRC(e){if(!this.remoteSDP)return;const t=this.remoteSDP.getSSRC(e);return null==t?void 0:t[0].ssrcId}setConfiguration(e){if(MC().supportPCSetConfiguration){const t=JD.resolvePCConfiguration(e);this.peerConnection.setConfiguration(t)}}}function XD(e,t,i){const n=e[t];if("function"!=typeof n)throw new Error("Cannot use mutex on object property.");return i.value=async function(){const e=this.mutex,i=await e.lock("From NVExtentionsConnection.".concat(t));try{for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return await n.apply(this,o)}finally{i()}},i}function QD(e){var t,i,n,r=2;for("undefined"!=typeof Symbol&&(i=RD,n=Symbol.iterator);r--;){if(i&&null!=(t=e[i]))return t.call(e);if(n&&null!=(t=e[n]))return new ZD(t.call(e));i="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function ZD(e){function t(e){if(Object(e)!==e)return nv.reject(new TypeError(e+" is not an object."));var t=e.done;return nv.resolve(e.value).then((function(e){return{value:e,done:t}}))}return ZD=function(e){this.s=e,this.n=e.next},ZD.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var i=this.s.return;return void 0===i?nv.resolve({value:e,done:!0}):t(i.apply(this.s,arguments))},throw:function(e){var i=this.s.return;return void 0===i?nv.reject(e):t(i.apply(this.s,arguments))}},new ZD(e)}VS([XD,BS("design:type",Function),BS("design:paramtypes",[Object,Object,Array,Object,String,String]),BS("design:returntype",nv)],JD.prototype,"connect",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[Array,Array]),BS("design:returntype",nv)],JD.prototype,"updateRemoteRTPCapabilities",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],JD.prototype,"updateRemoteConnect",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[Object,Array]),BS("design:returntype",nv)],JD.prototype,"createDataChannels",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[String,Array,String,Object]),BS("design:returntype",nv)],JD.prototype,"receive",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],JD.prototype,"batchReceive",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],JD.prototype,"stopReceiving",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],JD.prototype,"muteRemote",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],JD.prototype,"unmuteRemote",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],JD.prototype,"muteLocal",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],JD.prototype,"unmuteLocal",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],JD.prototype,"close",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],JD.prototype,"updateEncoderConfig",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],JD.prototype,"updateSendParameters",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[_I,String]),BS("design:returntype",nv)],JD.prototype,"replaceTrack",null),VS([XD,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],JD.prototype,"getRemoteSSRC",null);class $D extends UT{get currentLocalDescription(){return this.peerConnection.currentLocalDescription}get currentRemoteDescription(){return this.peerConnection.currentRemoteDescription}get peerConnectionState(){return this.peerConnection.connectionState}get iceConnectionState(){return this.peerConnection.iceConnectionState}get localCodecs(){return this._p2pConnection.localCodecs}constructor(e,t){super(e,t),oh(this,"store",void 0),oh(this,"peerConnection",void 0),oh(this,"cname",void 0),oh(this,"mutex",new YE("DataChannelConnection-mutex")),oh(this,"dataChannel",void 0),oh(this,"_p2pConnection",void 0),oh(this,"establishPromise",void 0),oh(this,"_nvMedia",void 0),this.store=t,this.store.dcId=this.store.dcId+1,this.peerConnection=new RTCPeerConnection($D.resolvePCConfiguration(e),{optional:[{googDscp:!0}]}),this.dataChannel=this.peerConnection.createDataChannel("agora-signal",{ordered:!1,maxPacketLifeTime:50}),this.dataChannel.binaryType="arraybuffer",this._p2pConnection=new JD(e,t,this.peerConnection),this.bindPCEvents(),this.establishPromise=this._p2pConnection.establishPromise}async establish(){var e;const t=null===(e=this._nvMedia)||void 0===e?void 0:e.getLocalRtpCapabilities();return await this._p2pConnection.establish(t)}getP2PConnectionParams(){return this._p2pConnection.getP2PConnectionParams()}async connect(e,t,i,n,r,o){return this.cname=o,await this._p2pConnection.connect(e,t,i,n,r,o),await new nv(((e,t)=>{const n=setTimeout((()=>{this.closeSignal(),t(new jS(Bv.DATACHANNEL_CONNECTION_TIMEOUT,"Datachannel connection timed out, candidates: ".concat(JSON.stringify(i))))}),2e3);this.dataChannel.onopen=()=>{if("open"===this.dataChannel.readyState)return clearTimeout(n),void e()},this.dataChannel.onerror=e=>{this.closeSignal(),t(e)}})),{transmitter:this.dataChannel,close:this.closeSignal.bind(this)}}async updateRemoteRTPCapabilities(e,t){return this._p2pConnection.updateRemoteRTPCapabilities(e,t)}send(e,t,i){var n=this;return Nk((function*(){const r=yield wk(n.mutex.lock("From DataChannelConnection.send"));try{return yield*TD(QD(n._p2pConnection.send(e,t,i)))}finally{r()}}))()}async stopSending(e,t){return this._p2pConnection.stopSending(e,t)}async createDataChannels(e,t){return this._p2pConnection.createDataChannels(e,t)}async stopDataChannels(e){return this._p2pConnection.stopDataChannels(e)}async receive(e,t,i,n){return this._nvMedia?(Yw.debug("[DataChannelConnection] receive ".concat(e," by DataChannel.")),await this._nvMedia.reveiveByRTCMedia(e,t,this.cname)):(Yw.debug("[DataChannelConnection] receive ".concat(e," by WebRTC.")),await this._p2pConnection.receive(e,t,i,n))}async batchReceive(e){return[...await this._p2pConnection.batchReceive(e)]}async stopReceiving(e){return await this._p2pConnection.stopReceiving(e)}async muteRemote(e){return await this._p2pConnection.muteRemote(e)}async unmuteRemote(e){return await this._p2pConnection.unmuteRemote(e)}async muteLocal(e){return await this._p2pConnection.muteLocal(e)}async unmuteLocal(e){return await this._p2pConnection.unmuteLocal(e)}restartICE(e){var t=this;return Nk((function*(){return yield*TD(QD(t._p2pConnection.restartICE(e)))}))()}close(){var e;null===(e=this._nvMedia)||void 0===e||e.close(),this._p2pConnection.close(),this.unbindConnectionEvents(this._p2pConnection)}getStats(){return this._p2pConnection.getStats()}getRemoteVideoIsReady(e){return this._p2pConnection.getRemoteVideoIsReady(e)}updateRemoteConnect(e){var t;null===(t=this._nvMedia)||void 0===t||t.setRemoteRtpCapabilities(e),this._p2pConnection.updateRemoteConnect(e)}async updateEncoderConfig(e,t){return await this._p2pConnection.updateEncoderConfig(e,t)}async updateSendParameters(e,t){return await this._p2pConnection.updateSendParameters(e,t)}setStatsRemoteVideoIsReady(e,t){this._p2pConnection.setStatsRemoteVideoIsReady(e,t)}async replaceTrack(e,t){return await this._p2pConnection.replaceTrack(e,t)}async getRemoteSSRC(e){return this._p2pConnection.getRemoteSSRC(e)}logSDPExchange(e,t,i,n){if(Pw("SDP_LOGGING"))return Yw.upload("exchanging ".concat(i," ").concat(t," SDP during DataChannelConnection.").concat(n,"\n"),e),"offer"===t?e=>{this.logSDPExchange(e,"answer","local"===i?"remote":"local",n)}:void 0}static resolvePCConfiguration(e){const t={iceServers:[]};return e.iceServers?t.iceServers=e.iceServers:e.turnServer&&"off"!==e.turnServer.mode&&(_E(e.turnServer.servers)?t.iceServers=e.turnServer.servers:(t.iceServers&&t.iceServers.push(...$D.turnServerConfigToIceServers(e.turnServer.servers)),Pw("USE_TURN_SERVER_OF_GATEWAY")&&t.iceServers&&e.turnServer.serversFromGateway&&t.iceServers.push(...$D.turnServerConfigToIceServers(e.turnServer.serversFromGateway)),Pw("FORCE_TURN_TCP")?t.iceTransportPolicy="relay":e.turnServer.servers.concat(e.turnServer.serversFromGateway||[]).forEach((e=>{e.forceturn&&(t.iceTransportPolicy="relay")})))),t}static turnServerConfigToIceServers(e){const t=[];return e.forEach((e=>{e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turns:".concat(RR(e.turnServerURL),":").concat(e.tcpport,"?transport=tcp")}):(e.udpport&&!Pw("FORCE_TURN_TCP")&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:"turn:".concat(e.turnServerURL,":").concat(e.tcpport,"?transport=tcp")}))})),t}bindPCEvents(){this._p2pConnection.onICEConnectionStateChange=e=>{var t;return null===(t=this.onICEConnectionStateChange)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onConnectionStateChange=e=>{var t;return null===(t=this.onConnectionStateChange)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onDTLSTransportStateChange=e=>{var t;return null===(t=this.onDTLSTransportStateChange)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onDTLSTransportError=e=>{var t;return null===(t=this.onDTLSTransportError)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onICETransportStateChange=e=>{var t;return null===(t=this.onICETransportStateChange)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstAudioReceived=e=>{var t;return null===(t=this.onFirstAudioReceived)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstVideoReceived=e=>{var t;return null===(t=this.onFirstVideoReceived)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstAudioDecoded=e=>{var t;return null===(t=this.onFirstAudioDecoded)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onFirstVideoDecoded=(e,t,i)=>{var n;return null===(n=this.onFirstVideoDecoded)||void 0===n?void 0:n.call(this,e,t,i)},this._p2pConnection.onFirstVideoDecodedTimeout=e=>{var t;return null===(t=this.onFirstVideoDecodedTimeout)||void 0===t?void 0:t.call(this,e)},this._p2pConnection.onSelectedLocalCandidateChanged=(e,t)=>{var i;return null===(i=this.onSelectedLocalCandidateChanged)||void 0===i?void 0:i.call(this,e,t)},this._p2pConnection.onSelectedRemoteCandidateChanged=(e,t)=>{var i;return null===(i=this.onSelectedRemoteCandidateChanged)||void 0===i?void 0:i.call(this,e,t)}}closeSignal(){this.dataChannel.close(),this.peerConnection.close()}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0}setConfiguration(e){this._p2pConnection.setConfiguration(e)}}function eL(e,t,i){const n=e[t];if("function"!=typeof n)throw new Error("Cannot use mutex on object property.");return i.value=async function(){const e=this.mutex,i=await e.lock("From DataChannelConnection.".concat(t));try{for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return await n.apply(this,o)}finally{i()}},i}function tL(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function iL(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?tL(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tL(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function nL(e){var t,i,n,r=2;for("undefined"!=typeof Symbol&&(i=RD,n=Symbol.iterator);r--;){if(i&&null!=(t=e[i]))return t.call(e);if(n&&null!=(t=e[n]))return new rL(t.call(e));i="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function rL(e){function t(e){if(Object(e)!==e)return nv.reject(new TypeError(e+" is not an object."));var t=e.done;return nv.resolve(e.value).then((function(e){return{value:e,done:t}}))}return rL=function(e){this.s=e,this.n=e.next},rL.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var i=this.s.return;return void 0===i?nv.resolve({value:e,done:!0}):t(i.apply(this.s,arguments))},throw:function(e){var i=this.s.return;return void 0===i?nv.reject(e):t(i.apply(this.s,arguments))}},new rL(e)}VS([eL,BS("design:type",Function),BS("design:paramtypes",[Object,Object,Array,Object,String,String]),BS("design:returntype",nv)],$D.prototype,"connect",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[Array,Array]),BS("design:returntype",nv)],$D.prototype,"updateRemoteRTPCapabilities",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[Object,Array]),BS("design:returntype",nv)],$D.prototype,"createDataChannels",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[String,Array,String,Object]),BS("design:returntype",nv)],$D.prototype,"receive",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],$D.prototype,"stopReceiving",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],$D.prototype,"muteRemote",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],$D.prototype,"unmuteRemote",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],$D.prototype,"muteLocal",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],$D.prototype,"unmuteLocal",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],$D.prototype,"close",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],$D.prototype,"updateEncoderConfig",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[String,_I]),BS("design:returntype",nv)],$D.prototype,"updateSendParameters",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[_I,String]),BS("design:returntype",nv)],$D.prototype,"replaceTrack",null),VS([eL,BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],$D.prototype,"getRemoteSSRC",null);class oL extends rE{get state(){return this._state}set state(e){const t=this._state;this._state=e,this.emit(ET.StateChange,t,this._state)}constructor(e,t){super(),oh(this,"store",void 0),oh(this,"statsUploader",void 0),oh(this,"connection",void 0),oh(this,"localTrackMap",new Map),oh(this,"remoteUserMap",new Map),oh(this,"localDataChannels",[]),oh(this,"remoteDataChannelMap",new Map),oh(this,"pendingLocalTracks",[]),oh(this,"pendingRemoteTracks",[]),oh(this,"pendingLocalDataChannels",[]),oh(this,"pendingRemoteDataChannels",[]),oh(this,"statsCollector",void 0),oh(this,"isPlanB",!1),oh(this,"shouldForwardP2PCreation",void 0),oh(this,"iceFailedCount",0),oh(this,"dtlsFailedCount",0),oh(this,"mutex",new YE("P2PChannel-mutex")),oh(this,"_state",vT.Disconnected),oh(this,"_pcStatsUploadType",Pw("NEW_ICE_RESTART")?_T.FIRST_CONNECTION:_T.OLD_FIRST_CONNECTION),oh(this,"_isInRestartIce",!1),oh(this,"_isStartRestartIce",!1),oh(this,"_restartStates",["disconnected","failed"]),oh(this,"_restartTimer",void 0),oh(this,"_isFirstConnected",!0),oh(this,"handleMuteLocalTrack",(async(e,t,i)=>{const n=await this.mutex.lock("Locking from P2PChannel.handleMuteLocalTrack");try{if(!this.connection||this.state!==vT.Connected)return void i(new jv(Bv.INVALID_OPERATION,"Cannot call P2PChannel.handleMuteLocalTrack before connection established."));const n=this.filterTobeMutedTracks(e);if(0===n.length)return void t();const r=n.find((e=>"videoLowTrack"===e[0]));r&&r[1].track._originMediaStreamTrack.stop(),await this.connection.muteLocal(n.map((e=>{let[,{id:t}]=e;return t})));const o=this.createMuteMessage(n);await bE(this,ET.RequestMuteLocal,o),t()}catch(e){i(e)}finally{n()}})),oh(this,"handleUnmuteLocalTrack",(async(e,t,i)=>{const n=await this.mutex.lock("Locking from P2PChannel.handleUnmuteLocalTrack");try{if(!this.connection||this.state!==vT.Connected)return void i(new jv(Bv.INVALID_OPERATION,"Cannot call P2PChannel.handleUnmuteLocalTrack before connection established."));const n=this.filterTobeUnmutedTracks(e);if(0===n.length)return void t();const r=n.find((e=>"videoLowTrack"===e[0]));if(r){const t=r[1];if(t.track._originMediaStreamTrack.stop(),!Pw("DISABLE_DUAL_STREAM_USE_ENCODING")&&MC().supportDualStreamEncoding){const i=e._mediaStreamTrack.clone();t.track._mediaStreamTrack=i,t.track._originMediaStreamTrack=i}else{const i=FP(e,wE(this,ET.RequestLowStreamParameter));t.track._mediaStreamTrack=i,t.track._originMediaStreamTrack=i}await new nv(((e,i)=>{this.handleReplaceTrack(t.track,e,i,!0)}))}await this.connection.unmuteLocal(n.map((e=>{let[,{id:t}]=e;return t})));const o=this.createUnmuteMessage(n);await bE(this,ET.RequestUnmuteLocal,o),t()}catch(e){i(e)}finally{n()}})),oh(this,"handleUpdateVideoEncoder",(async(e,t,i)=>{const n=await this.mutex.lock("Locking from P2PChannel.handleSetVideoEncoder");try{const i=this.localTrackMap.get(gT.LocalVideoTrack);if(!this.connection||!i||i.track!==e||this.state!==vT.Connected)return void t();const{id:n,track:r}=i;await this.connection.updateSendParameters(n,r),await this.connection.updateEncoderConfig(n,r),this.emit(ET.UpdateVideoEncoder,r),t()}catch(e){i(e)}finally{n()}})),oh(this,"handleSetOptimizationMode",(async(e,t,i)=>{const n=await this.mutex.lock("Locking from P2PChannel.handleSetOptimizationMode");try{const i=this.localTrackMap.get(gT.LocalVideoTrack);if(!this.connection||!i||i.track!==e||this.state!==vT.Connected)return;const{id:n,track:r}=i;await this.connection.updateSendParameters(n,r),t()}catch(e){i(e)}finally{n()}})),oh(this,"handleReplaceTrack",(async(e,t,i,n)=>{let r;Yw.debug("[".concat(this.store.clientId,"] P2PChannel handleReplaceTrack for [track-id-").concat(e.getTrackId(),"]")),"boolean"==typeof n&&n||(r=await this.mutex.lock("From P2PChannel.handleReplaceTrack"));try{var o;const i=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:i}]=t;return e===i}));if(!this.connection||!i||this.state!==vT.Connected)return void t();if(await(null===(o=this.connection)||void 0===o?void 0:o.replaceTrack(e,i[1].id)),this.isPlanB){const t=i[1];t.id=e._mediaStreamTrack.id,this.localTrackMap.set(i[0],t)}if(i[0]===gT.LocalVideoTrack&&!Pw("DISABLE_DUAL_STREAM_USE_ENCODING")&&MC().supportDualStreamEncoding){const t=this.localTrackMap.get(gT.LocalVideoLowTrack);if(t){const i=e._mediaStreamTrack.clone();t.track._originMediaStreamTrack.stop(),t.track._mediaStreamTrack=i,t.track._originMediaStreamTrack=i,await new nv(((e,i)=>{this.handleReplaceTrack(t.track,e,i,!0)}))}}t()}catch(e){i(e)}finally{var s;null===(s=r)||void 0===s||s()}})),oh(this,"handleGetRTCStats",(e=>{e(this.statsCollector.getRTCStats())})),oh(this,"handleGetLocalVideoStats",(e=>{e(this.statsCollector.getLocalVideoTrackStats())})),oh(this,"handleGetLocalAudioStats",(e=>{e(this.statsCollector.getLocalAudioTrackStats())})),oh(this,"handleGetRemoteVideoStats",(e=>this.statsCollector.getRemoteVideoTrackStats(e.uid)[e.uid])),oh(this,"handleGetRemoteAudioStats",(e=>this.statsCollector.getRemoteAudioTrackStats(e.uid)[e.uid])),this.store=e,this.statsCollector=t,this.statsCollector.addP2PChannel(this),this.statsUploader=new nD(this.store),this.bindStatsUploaderEvents(),this.isPlanB=!MC().supportUnifiedPlan||Pw("CHROME_FORCE_PLAN_B")&&xv(),this.shouldForwardP2PCreation=Pw("FORWARD_P2P_CREATION")&&MC().supportPCSetConfiguration&&function(){const e=_v();return e===uv.ANDROID||e===uv.IOS||e===uv.HARMONY_OS}(),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new $D({},this.store):this.isPlanB?new MD({},this.store):new VD({},this.store),this.bindConnectionEvents(this.connection))}async startP2PConnection(e,t){var i;this.state=vT.New;const n=this.shouldForwardP2PCreation&&"closed"===(null===(i=this.connection)||void 0===i?void 0:i.peerConnectionState);if(this.shouldForwardP2PCreation&&!n||(n&&this.connection&&(Yw.warning("[".concat(this.store.clientId,"] P2PChannel.startP2PConnection ForwardP2P closed.")),this.connection.close(),this.unbindConnectionEvents(this.connection)),this.connection=this.store.useDataChannel?new $D(e,this.store):this.isPlanB?new MD(e,this.store):new VD(e,this.store),this.bindConnectionEvents(this.connection)),!this.connection)throw new jv(Bv.UNEXPECTED_ERROR,"Cannot P2PChannel.startConnection before P2PConnection initialization .");return this._pcStatsUploadType=Pw("NEW_ICE_RESTART")?_T.FIRST_CONNECTION:_T.OLD_FIRST_CONNECTION,this._isFirstConnected=!0,this._isInRestartIce=!1,this._isStartRestartIce=!1,this.connection.setConfiguration(e),this.connection.establishPromise}async connect(e,t,i,n,r,o){if(!this.connection)throw new jv(Bv.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.connection instanceof $D?this.connection.updateRemoteConnect(n):(this.store.peerConnectionStart(),await this.connection.connect(e,t,i,n,r,o),this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=vT.Connected)}updateRemoteRTPCapabilities(e){const t=Array.from(this.localTrackMap.entries()).filter((e=>{var t;let[i]=e;return Mn(t=[gT.LocalVideoLowTrack,gT.LocalVideoTrack]).call(t,i)})),i=t.map((e=>{let[,{id:t}]=e;return t})),n=t.map((e=>{let[t]=e;return t}));if(this.connection instanceof VD){if(aS.updateRemoteRTPCapabilities(this.store.sessionId,{trackTypes:JSON.stringify(n),localCodecs:JSON.stringify(this.connection.localCodecs),remoteCodecs:JSON.stringify(e)}),!Mn(e).call(e,this.store.codec)){const t=["vp8","h264"].find((t=>Mn(e).call(e,t)));t&&(this.store.codec=t,Yw.debug("[".concat(this.store.clientId,"] [").concat(this.store.p2pId," updateRemoteRTPCapabilities] default codec is not available, hence the fallback to ").concat(t,".")))}this.connection.updateRemoteRTPCapabilities(i,e)}}async preConnect(e,t,i,n,r,o){if(!this.connection)throw new jv(Bv.UNEXPECTED_ERROR,"Cannot P2PChannel.connect before P2PChannel.startP2PConnection .");this.store.peerConnectionStart();const s=await this.connection.connect(e,t,i,n,r,o);return this.statsUploader.startUploadTransportStats(),this.statsUploader.startUploadExtensionUsageStats(),this.state=vT.Connected,s}getEstablishParams(){if(this.connection instanceof $D)return this.connection.getP2PConnectionParams();throw new Error("Only DataChannelConnection needs to obtain establishParams")}async publishDataChannel(e){if(!this.connection){if(this.state===vT.Disconnected)throw new jv(Bv.UNEXPECTED_ERROR,"PeerConnection already disconnected.");const t=e.filter((e=>-1!==this.pendingLocalDataChannels.findIndex((t=>t.id===e.id))));return void(this.pendingLocalDataChannels=this.pendingLocalDataChannels.concat(t))}const t=this.filterTobePublishedDataChannels(e);0!==t.length&&(t.forEach((e=>{const t=Date.now();this.store.publish(e.id.toString(),"datachannel",t)})),await this.connection.createDataChannels(this.store.uid,t),t.forEach((e=>{this.localDataChannels.push(e);const t=Date.now();this.store.publish(e.id+"","datachannel",void 0,t)})))}publish(e,t,i){var n=this;return Nk((function*(){const r=yield wk(n.mutex.lock("From P2PChannel.publish"));try{if(!n.connection||n.state!==vT.Connected){if(n.state===vT.Disconnected)throw new jv(Bv.UNEXPECTED_ERROR,"PeerConnection already disconnected.");n.throwIfTrackTypeNotMatch(e);const t=e.filter((e=>-1===n.pendingLocalTracks.indexOf(e)));return void(n.pendingLocalTracks=n.pendingLocalTracks.concat(t))}n.store.pubId=n.store.pubId+1,bk.markPublishStart(n.store.clientId,n.store.pubId);const r=n.filterTobePublishedTracks(e,t,i);if(0===r.length)return void(yield wk(n.tryToUnmuteAudio(e)));yield*TD(nL(n.doPublish(n.connection,r)))}finally{r()}}))()}doPublish(e,t){var i=this;return Nk((function*(){t.forEach((e=>{let{track:t,type:n}=e;const r=Date.now();i.store.publish(t.getTrackId(),n===gT.LocalAudioTrack?"audio":"video",r)})),i.bindLocalTrackEvents(t);const n=yield wk(e.send(t.map((e=>{let{track:t}=e;return t})),i.store.codec,i.store.audioCodec)),r=(yield wk(n.next())).value,o=i.createGatewayPublishMessage(t,r);let s;try{s=yield o}catch(e){throw n.throw(e),(null==e?void 0:e.code)===Bv.WS_ABORT&&t.forEach((e=>{let{track:t}=e;-1===i.pendingLocalTracks.indexOf(t)&&i.pendingLocalTracks.push(t)})),i.unbindLocalTrackEvents(t),e}const a=i.mapPubResToRemoteConfig(o,s),c=(yield wk(n.next(a))).value;t.forEach((e=>{let{type:t}=e;i.statsCollector.addLocalStats(t)})),i.assignLocalTracks(t,c),i.statsUploader.startUploadOutboundStats(),t.forEach((e=>{let{track:t,type:n}=e;const r=Date.now();i.store.publish(t.getTrackId(),n===gT.LocalAudioTrack?"audio":"video",void 0,r)}))}))()}async updateVideoStreamParameter(e,t){const i=this.localTrackMap.get(t);if(!i)return;if(!(i.track instanceof kA))return Yw.warn("[updateVideoStreamParameter]: track is not an instance of LocalVideoTrack");if(!(this.connection instanceof VD||this.connection instanceof MD))return Yw.warn("[updateVideoStreamParameter]: connection is not P2PConnection or P2PConnectionPlanB");const{track:n}=i,r=function(e,t){const i={};return e.height&&e.width&&(i.scaleResolutionDownBy=kR(e,t)),i.maxFramerate=e.framerate?IR(e.framerate):void 0,i.maxBitrate=e.bitrate?1e3*e.bitrate:void 0,i}(e,n);if(n._encoderConfig||(n._encoderConfig={}),t!==gT.LocalVideoLowTrack||!Pw("DISABLE_DUAL_STREAM_USE_ENCODING")&&MC().supportDualStreamEncoding)null!=r.scaleResolutionDownBy&&(n._encoderConfig.scaleResolutionDownBy=r.scaleResolutionDownBy);else{const t=n._originMediaStreamTrack;if(!t.canvas)return Yw.warn("[".concat(n.getTrackId(),"] no canvas on track"));!function(e,t){const i=e.canvas;t.width&&(i.width=IR(t.width)),t.height&&(i.height=IR(t.height)),t.framerate&&(i.stopCapture&&i.stopCapture(),i.stopCapture=CI((()=>{!i.startCapture&&i.stopCapture&&i.stopCapture(),i.startCapture&&i.startCapture()}),IR(t.framerate)))}(t,e)}null!=r.maxBitrate&&(n._encoderConfig.bitrateMax=r.maxBitrate/1e3),null!=r.maxFramerate&&(n._encoderConfig.frameRate&&"object"==typeof n._encoderConfig.frameRate?n._encoderConfig.frameRate.max=r.maxFramerate:n._encoderConfig.frameRate={max:r.maxFramerate}),Yw.debug("[".concat(n.getTrackId(),"] LowStreamEncoderConfig: , ").concat(JSON.stringify(n._encoderConfig))),await this.connection.updateRtpSenderEncodings(n)}publishLowStream(e){var t=this;return Nk((function*(){if(!t.connection||t.state!==vT.Connected)return;const i=yield wk(t.mutex.lock("Locking from P2PChannel.publishLowStream"));try{const i=t.localTrackMap.get(gT.LocalVideoTrack);if(!i)throw new jv(Bv.UNEXPECTED_ERROR,"Could not find high stream");if(t.localTrackMap.has(gT.LocalVideoLowTrack))throw new jv(Bv.UNEXPECTED_ERROR,"[".concat(t.store.clientId,"] Can't publish low stream when stream already publish"));const r=[{track:t.getLowVideoTrack(i.track,e),type:gT.LocalVideoLowTrack}];if(yield*TD(nL(t.doPublish(t.connection,r))),i.track.muted||!i.track.enabled){var n;const e=null===(n=t.localTrackMap.get(gT.LocalVideoLowTrack))||void 0===n?void 0:n.id;void 0!==e&&(yield wk(t.connection.muteLocal([e])))}}finally{i()}}))()}async republish(){this.pendingLocalTracks.length>0&&(Yw.debug("[".concat(this.store.clientId,"] Emit P2PChannelEvents.RequestRePublish to republish tracks.")),await EE(this,ET.RequestRePublish,this.pendingLocalTracks),this.emit(ET.MediaReconnectEnd,this.store.uid),this.pendingLocalTracks=[]),this.pendingLocalDataChannels.length>0&&(Yw.debug("Emit P2PChannelEvents.RequestRePublishDataChannel to republish datachannels."),await EE(this,ET.RequestRePublishDataChannel,this.pendingLocalDataChannels),this.pendingLocalDataChannels=[])}async reSubscribe(e){for(let t=this.pendingRemoteTracks.length-1;t>=0;t--){const{user:e,kind:i}=this.pendingRemoteTracks[t];(i!==pT.AUDIO||e._audio_added_&&e._audioSSRC)&&(i!==pT.VIDEO||e._video_added_&&e._videoSSRC)||this.pendingRemoteTracks.splice(t,1)}if(e)await EE(this,ET.RequestReSubscribe,this.pendingRemoteTracks);else for(const{user:t,kind:i}of this.pendingRemoteTracks)await this.subscribe(t,i,i===pT.VIDEO?t._videoSSRC:t._audioSSRC);this.pendingRemoteTracks.forEach((e=>{let{user:t}=e;this.emit(ET.MediaReconnectEnd,t.uid)})),this.pendingRemoteTracks=[]}async unpublish(e){if(!this.connection||this.state!==vT.Connected)return void e.forEach((e=>{const t=this.pendingLocalTracks.indexOf(e);-1!==t&&this.pendingLocalTracks.splice(t,1)}));const t=this.filterTobeUnpublishedTracks(e);if(0===t.length)return;const i=t.find((e=>"videoLowTrack"===e[0]));return i&&i[1].track.close(),this.doUnpublish(this.connection,t)}async unpublishDataChannel(e){if(!this.connection||this.state!==vT.Connected)return void e.forEach((e=>{const t=this.pendingLocalDataChannels.indexOf(e);-1!==t&&this.pendingLocalDataChannels.splice(t,1)}));const t=this.filterTobeUnpublishedDataChannels(e);return 0!==t.length?(t.forEach((e=>{const t=this.localDataChannels.indexOf(e);-1!==t&&this.localDataChannels.splice(t,1)})),0===this.localDataChannels.length&&await this.connection.stopDataChannels(this.store.uid),t.map((e=>e.id))):void 0}async unpublishLowStream(){if(!this.connection||this.state!==vT.Connected)return;const e=this.localTrackMap.get(gT.LocalVideoLowTrack);if(!e)return;e.track.close();const t=[[gT.LocalVideoLowTrack,e]];return this.doUnpublish(this.connection,t)}async doUnpublish(e,t){const i=this.createGatewayUnpublishMessage(t);return await e.stopSending(t.map((e=>{let[,{id:t}]=e;return t}))),this.withdrawLocalTracks(t),this.unbindLocalTrackEvents(t.map((e=>{let[t,{track:i}]=e;return{type:t,track:i}}))),t.forEach((e=>{let[t]=e;this.statsCollector.removeLocalStats(t)})),0===this.localTrackMap.size&&this.statsUploader.stopUploadOutboundStats(),i}async subscribeDataChannel(e,t){if(!this.connection||this.state!==vT.Connected)throw new jv(Bv.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");const i=t.filter((t=>{var i;return!(null!==(i=this.remoteDataChannelMap.get(e))&&void 0!==i&&i.get(t.id))}));if(0!==i.length)return await this.connection.createDataChannels(e.uid,i),i.forEach((t=>{var i;this.remoteDataChannelMap.has(e)?null===(i=this.remoteDataChannelMap.get(e))||void 0===i||i.set(t.id,t):this.remoteDataChannelMap.set(e,new Map([[t.id,t]]));const n=this.pendingRemoteDataChannels.findIndex((i=>{let{user:n,id:r}=i;return n.uid===e.uid&&r===t.id}));-1!==n&&this.pendingRemoteDataChannels.splice(n,1)})),i.map((e=>e.id))}async subscribe(e,t,i,n,r){var o;if(!this.connection||this.state!==vT.Connected)throw new jv(Bv.INVALID_OPERATION,"Cannot subscribe remote user when peerConnection disconnected.");if(null!==(o=this.remoteUserMap.get(e))&&void 0!==o&&o.has(t))return;let s,a,c;if(r){const i=r.find((e=>{let{stream_type:i}=e;return i===t}));if(!i)throw new jv(Bv.UNEXPECTED_ERROR,"Cannot subscribe to remote ".concat(t," for user: ").concat(e.uid," because subscribe answer from gateway does not contain stream_type: ").concat(t,"."));const n=await this.connection.receive(t,i.ssrcs,String(e._uintid),i.attributes);this.connection instanceof VD&&(c=n.transceiver),s=n.track,a=n.id}else{const r=await this.connection.receive(t,[{ssrcId:i,rtx:n}],String(e._uintid),void 0);this.connection instanceof VD&&(c=r.transceiver),s=r.track,a=r.id}t===pT.AUDIO?(e._audioTrack?e._audioTrack._updateOriginMediaStreamTrack(s):(e._audioTrack=new FA(s,e.uid,e._uintid,this.store),Yw.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(e._audioTrack.getTrackId()))),c&&e._audioTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._audioTrack)):(e._videoTrack?e._videoTrack._updateOriginMediaStreamTrack(s):(e._videoTrack=new jA(s,e.uid,e._uintid,this.store),Yw.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(e._videoTrack.getTrackId()))),c&&e._videoTrack._updateRtpTransceiver(c),this.bindRemoteTrackEvents(e,e._videoTrack));const u=this.remoteUserMap.get(e);u?u.set(t,a):this.remoteUserMap.set(e,new Map([[t,a]])),this.statsCollector.addRemoteStats(e.uid),this.statsUploader.startUploadInboundStats();const d=this.pendingRemoteTracks.findIndex((i=>{let{user:n,kind:r}=i;return n.uid===e.uid&&t===r}));-1!==d&&(this.pendingRemoteTracks.splice(d,1),this.emit(ET.MediaReconnectEnd,e.uid))}async massSubscribe(e){return this.massSubscribeNoLock(e)}async massSubscribeNoLock(e){if(!this.connection||this.state!==vT.Connected)throw new jv(Bv.INVALID_OPERATION,"Cannot subscribeAll remote users when peerConnection disconnected.");e=e.filter((e=>{var t;let{user:i,mediaType:n}=e;return!(null!==(t=this.remoteUserMap.get(i))&&void 0!==t&&t.has(n))}));const t=await this.connection.batchReceive(e.map((e=>{let{user:t,mediaType:i,ssrcId:n,rtxSsrcId:r}=e;return{kind:i,ssrcMsg:[{ssrcId:n,rtx:r}],mslabel:String(t._uintid)}})));e.forEach(((e,i)=>{let{user:n,mediaType:r}=e;const{track:o,id:s,transceiver:a}=t[i];r===pT.AUDIO?(n._audioTrack?n._audioTrack._updateOriginMediaStreamTrack(o):(n._audioTrack=new FA(o,n.uid,n._uintid,this.store),Yw.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote audio track: ").concat(n._audioTrack.getTrackId()))),a&&n._audioTrack._updateRtpTransceiver(a),this.bindRemoteTrackEvents(n,n._audioTrack)):(n._videoTrack?n._videoTrack._updateOriginMediaStreamTrack(o):(n._videoTrack=new jA(o,n.uid,n._uintid,this.store),Yw.info("[".concat(this.store.clientId,"] [").concat(this.store.p2pId,"] create remote video track: ").concat(n._videoTrack.getTrackId()))),a&&n._videoTrack._updateRtpTransceiver(a),this.bindRemoteTrackEvents(n,n._videoTrack));const c=this.remoteUserMap.get(n);c?c.set(r,s):this.remoteUserMap.set(n,new Map([[r,s]])),this.statsCollector.addRemoteStats(n.uid),this.statsUploader.startUploadInboundStats();const u=this.pendingRemoteTracks.findIndex((e=>{let{user:t,kind:i}=e;return t.uid===n.uid&&r===i}));-1!==u&&(this.pendingRemoteTracks.splice(u,1),this.emit(ET.MediaReconnectEnd,n.uid))}))}async unsubscribe(e,t,i){const n=this.pendingRemoteTracks.filter((i=>{let{user:n,kind:r}=i;return void 0!==t?n.uid===e.uid&&t===r:n.uid===e.uid}));if(n.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),this.connection&&this.state===vT.Connected||i||n.forEach((t=>{let{kind:i}=t;var n;if(i===pT.AUDIO)null===(n=e._audioTrack)||void 0===n||n._destroy(),e._audioTrack=void 0;else if(i===pT.VIDEO){var r;null===(r=e._videoTrack)||void 0===r||r._destroy(),e._videoTrack=void 0}})),!this.connection||this.state!==vT.Connected)return;const r=this.filterTobeUnSubscribedTracks(e,t);if(0===r.length)return;await this.connection.stopReceiving(r.map((e=>{let[,{id:t}]=e;return t})));const o=this.createUnsubscribeMessage(r);return this.withdrawRemoteTracks(r),0===this.remoteUserMap.size&&this.statsUploader.stopUploadInboundStats(),r.forEach((e=>{let[t,{kind:n}]=e;var r,o;if(n===pT.VIDEO&&t._videoSSRC&&(null===(r=this.connection)||void 0===r||r.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),n===pT.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),i||(null===(o=t._videoTrack)||void 0===o||o._destroy(),t._videoTrack=void 0);else if(n===pT.AUDIO){var s;this.unbindRemoteTrackEvents(t._audioTrack),i||(null===(s=t._audioTrack)||void 0===s||s._destroy(),t._audioTrack=void 0)}})),o}async unsubscribeDataChannel(e,t){if(t.forEach((e=>{const t=this.pendingRemoteDataChannels.findIndex((t=>t.id===e.id));-1!==t&&this.pendingRemoteDataChannels.splice(t,1)})),!this.connection)return;const i=this.filterTobeUnSubscribedDataChannels(e,t);if(0===i.length)return;t.forEach((e=>{e._close()}));const n=this.remoteDataChannelMap.get(e);return i.forEach((e=>{n&&n.delete(e.id)})),n&&0===n.size&&(this.remoteDataChannelMap.delete(e),await this.connection.stopDataChannels(e.uid)),i.map((e=>e.id))}async massUnsubscribe(e){return this.massUnsubscribeNoLock(e)}async massUnsubscribeNoLock(e){let t=[];for(const{user:r,mediaType:o}of e){const e=this.pendingRemoteTracks.filter((e=>{let{user:t,kind:i}=e;return void 0!==o?t.uid===r.uid&&o===i:t.uid===r.uid}));e.forEach((e=>{const t=this.pendingRemoteTracks.indexOf(e);this.pendingRemoteTracks.splice(t,1)})),t=t.concat(e)}if(!this.connection||this.state!==vT.Connected)return void t.forEach((e=>{let{user:t,kind:i}=e;var n;if(i===pT.AUDIO)null===(n=t._audioTrack)||void 0===n||n._destroy(),t._audioTrack=void 0;else if(i===pT.VIDEO){var r;null===(r=t._videoTrack)||void 0===r||r._destroy(),t._videoTrack=void 0}}));const i=db(e).call(e,((e,t)=>{let{user:i,mediaType:n}=t;const r=this.filterTobeUnSubscribedTracks(i,n);return e.concat(r)}),[]);if(0===i.length)return;await this.connection.stopReceiving(i.map((e=>{let[,{id:t}]=e;return t})));const n=this.createUnsubscribeAllMessage(i);return this.withdrawRemoteTracks(i),0===this.remoteUserMap.size&&this.statsUploader.stopUploadInboundStats(),i.forEach((e=>{let[t,{kind:i}]=e;var n,r;if(i===pT.VIDEO&&t._videoSSRC&&(null===(n=this.connection)||void 0===n||n.setStatsRemoteVideoIsReady(t._videoSSRC,!1)),i===pT.VIDEO)this.unbindRemoteTrackEvents(t._videoTrack),null===(r=t._videoTrack)||void 0===r||r._destroy(),t._videoTrack=void 0;else if(i===pT.AUDIO){var o;this.unbindRemoteTrackEvents(t._audioTrack),null===(o=t._audioTrack)||void 0===o||o._destroy(),t._audioTrack=void 0}})),n}async muteRemote(e,t){if(!this.connection)return;const i=this.remoteUserMap.get(e);if(!i)return void Yw.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid,"."));if(!i.get(t))return void Yw.warning("[".concat(this.store.clientId,"] P2PChannel.muteRemote has no remote user ").concat(e.uid," media type ").concat(t,"."));const n=t===pT.VIDEO?e._videoSSRC:e._audioSSRC;void 0!==n&&this.connection.setStatsRemoteVideoIsReady(n,!1)}async unmuteRemote(e,t){return this.unmuteRemoteNoLock(e,t)}async unmuteRemoteNoLock(e,t){if(!this.connection)return;const i=this.remoteUserMap.get(e);i?i.get(t)||Yw.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid," media type ").concat(t,".")):Yw.warning("[".concat(this.store.clientId,"] P2PChannel.unmuteRemote has no remote user ").concat(e.uid,"."))}getAllTracks(e){const t=this.localTrackMap.get(gT.LocalAudioTrack);if((null==t?void 0:t.track)instanceof fA){const i=t.track;return Array.from(this.localTrackMap.entries()).filter((e=>{let[t]=e;return t!==gT.LocalAudioTrack})).filter((t=>{let[i]=t;return!(e&&i===gT.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t})).concat(i.trackList)}return Array.from(this.localTrackMap.entries()).filter((t=>{let[i]=t;return!(e&&i===gT.LocalVideoLowTrack)})).map((e=>{let[,{track:t}]=e;return t}))}getAllDataChannels(){return this.localDataChannels}reportPublishEvent(e,t,i,n,r){if(e){const i=this.localTrackMap.get(gT.LocalAudioTrack),o=n?this.localTrackMap.get(gT.LocalVideoLowTrack):this.localTrackMap.get(gT.LocalVideoTrack);aS.publish(this.store.sessionId,{eventElapse:bk.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==i?void 0:i.track.getTrackLabel(),videoName:null==o?void 0:o.track.getTrackLabel(),screenshare:-1!==(null==o?void 0:o.track._hints.indexOf(YC.SCREEN_TRACK)),audio:!!i,video:!!o,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:r})}else{var o;i||(i=[]);const s=i.find((e=>e instanceof dA)),a=n?null===(o=this.localTrackMap.get(gT.LocalVideoTrack))||void 0===o?void 0:o.track:i.find((e=>e instanceof kA));aS.publish(this.store.sessionId,{eventElapse:bk.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:e,ec:t,audioName:null==s?void 0:s.getTrackLabel(),videoName:null==a?void 0:a.getTrackLabel(),screenshare:-1!==(null==a?void 0:a._hints.indexOf(YC.SCREEN_TRACK)),audio:!!s,video:!!a,p2pid:this.store.p2pId,publishRequestid:this.store.pubId,extend:r})}}reportSubscribeEvent(e,t,i,n){const r=n===pT.VIDEO?i._videoSSRC:i._audioSSRC;r&&aS.subscribe(this.store.sessionId,{succ:e,ec:t,video:n===pT.VIDEO,audio:n===pT.AUDIO,peerid:i.uid,subscribeRequestid:n===pT.VIDEO?i._videoSSRC:i._audioSSRC,p2pid:this.store.p2pId,eventElapse:bk.measureFromSubscribeStart(this.store.clientId,r)})}reset(){Yw.debug("[".concat(this.store.clientId,"] P2PChannel.reset")),this.mutex=new YE("P2PChannel-mutex"),this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new $D({},this.store):this.isPlanB?new MD({},this.store):new VD({},this.store),this.bindConnectionEvents(this.connection)),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),this.statsUploader.stopUploadExtensionUsageStats(),this.unbindLocalTrackEvents(),this.unbindAllRemoteTrackEvents(),this.unbindRtpTransceiver();const e=this.localTrackMap.get(gT.LocalAudioTrack);if((null==e?void 0:e.track)instanceof fA){if(e.track.trackList.length>0){const t=e.track;e.track.trackList.forEach((e=>{t.removeAudioTrack(e)}))}e.track.close()}this.localTrackMap.clear(),this.remoteUserMap.clear(),this.statsCollector.removeRemoteStats(),this.statsCollector.removeLocalStats(),this.iceFailedCount=0,this.dtlsFailedCount=0,this.pendingLocalTracks=[],this.pendingRemoteTracks=[],this.localDataChannels=[],this.remoteDataChannelMap.clear(),this.pendingLocalDataChannels=[],this.pendingRemoteDataChannels=[],this.state=vT.Disconnected}getStats(){var e;return null===(e=this.connection)||void 0===e?void 0:e.getStats()}getRemoteVideoIsReady(e){var t;return(null===(t=this.connection)||void 0===t?void 0:t.getRemoteVideoIsReady(e))||!1}getLocalAudioVolume(){const e=this.localTrackMap.get(gT.LocalAudioTrack);if(e)return e.track.getVolumeLevel()}getLocalVideoSize(){const e=this.localTrackMap.get(gT.LocalVideoTrack);if(e)return{width:e.track._videoWidth||0,height:e.track._videoHeight||0}}getEncoderConfig(e){const t=this.localTrackMap.get(e);return t&&t.track instanceof kA||t&&t.track instanceof dA?t.track._encoderConfig:void 0}getLocalMedia(e){return this.localTrackMap.get(e)}hasLocalMedia(){return this.localTrackMap.size>0}hasRemoteMedia(e,t){if(!e)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(e);return!!i&&(!t||i.has(t))}async hasRemoteMediaWithLock(e,t){if(!e)return this.remoteUserMap.size>0;const i=this.remoteUserMap.get(e);return!!i&&(!t||i.has(t))}getRemoteMedia(e){var t;const i=Array.from(fh(t=this.remoteUserMap).call(t)).find((t=>t.uid===e));return i?{audioTrack:i.audioTrack,audioSSRC:i._audioSSRC,videoTrack:i.videoTrack,videoSSRC:i._videoSSRC}:{}}getAudioLevels(){let e=Array.from(this.remoteUserMap.entries()).map((e=>{let[t]=e;return{uid:t.uid,level:t.audioTrack?100*t.audioTrack._source.getAccurateVolumeLevel():0}}));const t=this.localTrackMap.get(gT.LocalAudioTrack);return t&&e.push({level:100*t.track._source.getAccurateVolumeLevel(),uid:this.store.uid}),e=ef(e).call(e,((e,t)=>e.level-t.level)),e}async disconnectForReconnect(){this.connection&&(Yw.debug("[".concat(this.store.clientId,"] P2PChannel.disconnectForReconnect closing P2PConnection")),this.state=vT.Reconnecting,Pw("KEEP_LAST_FRAME")&&0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t]=e;var i;t._videoTrack&&t._videoTrack._player&&(null===(i=t._videoTrack._player.getVideoElement())||void 0===i||i.pause(),t._videoTrack._player.isKeepLastFrame=!0,t._videoTrack._originMediaStreamTrack.stop())})),this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0,this.shouldForwardP2PCreation&&(this.connection=this.store.useDataChannel?new $D({},this.store):this.isPlanB?new MD({},this.store):new VD({},this.store),this.bindConnectionEvents(this.connection)),0!==this.localTrackMap.size&&(Array.from(this.localTrackMap.entries()).forEach((e=>{var t;let[i,{track:n}]=e;switch(i){case gT.LocalVideoTrack:Mn(t=n._hints).call(t,YC.LOW_STREAM)?n.close():this.pendingLocalTracks.push(n);break;case gT.LocalAudioTrack:n instanceof fA?this.pendingLocalTracks=this.pendingLocalTracks.concat(n.trackList):this.pendingLocalTracks.push(n);case gT.LocalVideoLowTrack:}})),this.emit(ET.MediaReconnectStart,this.store.uid)),this.unbindLocalTrackEvents(),this.localTrackMap.clear(),0!==this.remoteUserMap.size&&Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,i]=e;Array.from(fh(i).call(i)).forEach((e=>{this.setPendingRemoteMedia(t,e)})),this.emit(ET.MediaReconnectStart,t.uid)})),this.unbindAllRemoteTrackEvents(),this.remoteUserMap.clear(),0!==this.localDataChannels.length&&(this.localDataChannels.forEach((e=>{this.pendingLocalDataChannels.push(e)})),this.localDataChannels.length=0),0!==this.remoteDataChannelMap.size&&(Array.from(this.remoteDataChannelMap.entries()).forEach((e=>{let[t,i]=e;Array.from(fh(i).call(i)).forEach((e=>{this.setPendingRemoteDataChannel(t,e)}))})),this.remoteDataChannelMap.clear()),this.statsUploader.stopUploadOutboundStats(),this.statsUploader.stopUploadInboundStats(),this.statsUploader.stopUploadTransportStats(),Yw.debug("[".concat(this.store.clientId,"] P2PChannel disconnected, waiting to reconnect.")))}hasPendingRemoteDataChannel(e,t){for(const i of this.pendingRemoteDataChannels){const{user:n,id:r}=i;if((e instanceof rD?e.uid:e)===n.uid&&r===t)return!0}return!1}setPendingRemoteDataChannel(e,t){this.hasPendingRemoteDataChannel(e,t)||this.pendingRemoteDataChannels.push({user:e,id:t})}hasPendingRemoteMedia(e,t){for(const i of this.pendingRemoteTracks){const{user:n,kind:r}=i;if((e instanceof rD?e.uid:e)===n.uid&&t===r)return!0}return!1}setPendingRemoteMedia(e,t){this.hasPendingRemoteMedia(e,t)||this.pendingRemoteTracks.push({user:e,kind:t})}restartICE(e){var t=this;return Nk((function*(){if(!t.connection||t.state!==vT.Connected||t.connection instanceof $D)return;const i=yield wk(t.mutex.lock("From P2PChannel.restartICE"));let n;try{n=yield wk(t.connection.restartICE(e));const i=yield wk(n.next());if(i.done)return;const r=i.value,o=yield r;switch(t.reportPCDisconnectedOrFailed(e),e){case mT.TCP:t._pcStatsUploadType=_T.TCP_RESTART;break;case mT.RELAY:t._pcStatsUploadType=_T.RELAY_RESTART;break;default:t._pcStatsUploadType=_T.OLD_RESTART}t._isInRestartIce=!0,n.next(o)}catch(e){var r;null===(r=n)||void 0===r||r.throw(e)}finally{i()}}))()}getUplinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats(),t=this.localTrackMap.get(gT.LocalVideoTrack),i=this.localTrackMap.get(gT.LocalAudioTrack),n=e.videoSend.find((e=>e.ssrc===(null==t?void 0:t.ssrcs[0].ssrcId))),r=e.audioSend.find((e=>e.ssrc===(null==i?void 0:i.ssrcs[0].ssrcId)));if(!n||!r)return 1;const o=yE(this,ET.NeedSignalRTT),s=n?n.rttMs:void 0,a=r?r.rttMs:void 0,c=s&&a?(s+a)/2:s||a,u=(c&&o?(c+o)/2:c||o)||0,d=100*e.sendPacketLossRate*.7/50+.3*u/1500,l=d<.17?1:d<.36?2:d<.59?3:d<.1?4:5,h=null==t?void 0:t.track;if(h&&h._encoderConfig&&-1===h._hints.indexOf(YC.SCREEN_TRACK)){const t=h._encoderConfig.bitrateMax,i=e.bitrate.actualEncoded;if(t&&i){const e=(1e3*t-i)/(1e3*t);return dS[e<.15?0:e<.3?1:e<.45?2:e<.6?3:4][l]}}return l}getDownlinkNetworkQuality(){if(!this.connection)return 0;const e=this.connection.getStats();let t=0;return Array.from(this.remoteUserMap.entries()).forEach((i=>{let[n]=i;const r=n._audioSSRC,o=n._videoSSRC,s=e.audioRecv.find((e=>e.ssrc===r)),a=e.videoRecv.find((e=>e.ssrc===o));if(!s&&!a)return void(t+=1);const c=yE(this,ET.NeedSignalRTT),u=e.rtt,d=(u&&c?(u+c)/2:u||c)||0,l=s?s.jitterMs:void 0,h=e.recvPacketLossRate;let f=.7*h*100/50+.3*d/1500;l&&(f=.6*h*100/50+.2*d/1500+.2*l/400),t+=f<.1?1:f<.17?2:f<.36?3:f<.59?4:5})),this.remoteUserMap.size>0?Math.round(t/this.remoteUserMap.size):t}async muteLocalTrack(e){return new nv(((t,i)=>{this.handleMuteLocalTrack(e,t,i)}))}filterTobePublishedTracks(e,t,i){const n=[],r=MC(),o=this.getAllTracks();e=IE(e=e.filter((e=>-1===o.indexOf(e))));let s=!1,a=!1;for(const c of e){if(c instanceof kA&&(this.localTrackMap.has(gT.LocalVideoTrack)||s?new jv(Bv.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw():(n.push({track:c,type:gT.LocalVideoTrack}),s=!0),t)){const e=this.getLowVideoTrack(c,i);n.push({track:e,type:gT.LocalVideoLowTrack})}if(c instanceof dA){const e=this.localTrackMap.get(gT.LocalAudioTrack);if(e){if(!(e.track instanceof fA))throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c),this.bindLocalAudioTrackEvents(c,!0)}else if(a){const e=n.find((e=>{let{type:t}=e;return t===gT.LocalAudioTrack}));if(!(e.track instanceof fA))throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser does not support audio mixing");if(c._bypassWebAudio)throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio");e.track.addAudioTrack(c)}else{if(!r.webAudioMediaStreamDest||c instanceof fA||c._bypassWebAudio)n.push({track:c,type:gT.LocalAudioTrack});else{const e=new fA;e.addAudioTrack(c),n.push({track:e,type:gT.LocalAudioTrack})}a=!0}}}return n}filterTobeUnpublishedTracks(e){const t=[],i=this.getAllTracks();e=IE(e=e.filter((e=>-1!==i.indexOf(e))));for(const n of e){if(n instanceof dA){const e=this.localTrackMap.get(gT.LocalAudioTrack);if(!e)continue;e.track instanceof fA?(e.track.removeAudioTrack(n),this.unbindLocalAudioTrackEvents(n),0===e.track.trackList.length&&(t.push([gT.LocalAudioTrack,e]),e.track.close())):t.push([gT.LocalAudioTrack,e])}if(n instanceof kA){const e=this.localTrackMap.get(gT.LocalVideoTrack);if(!e)continue;t.push([gT.LocalVideoTrack,e]);const i=this.localTrackMap.get(gT.LocalVideoLowTrack);i&&t.push([gT.LocalVideoLowTrack,i])}}return t}filterTobePublishedDataChannels(e){return(e=IE(e)).filter((e=>-1===this.localDataChannels.findIndex((t=>t.id===e.id))))}filterTobeUnpublishedDataChannels(e){return(e=(e=IE(e)).filter((e=>-1!==this.localDataChannels.indexOf(e)))).filter((e=>e._originDataChannel))}bindLocalTrackEvents(e){e.forEach((e=>{let{track:t,type:i}=e;switch(i){case gT.LocalVideoTrack:t.addListener(zC.GET_STATS,this.handleGetLocalVideoStats),t.addListener(zC.GET_RTC_STATS,this.handleGetRTCStats),t.addListener(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.addListener(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.addListener(zC.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.addListener(zC.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),t.addListener(zC.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.addListener(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.addListener(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case gT.LocalAudioTrack:this.bindLocalAudioTrackEvents(t);case gT.LocalVideoLowTrack:}}))}bindLocalAudioTrackEvents(e,t){e instanceof fA?e.trackList.forEach((e=>{e.addListener(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(zC.GET_STATS,this.handleGetLocalAudioStats),e.addListener(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.addListener(zC.GET_STATS,this.handleGetLocalAudioStats),e.addListener(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.addListener(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.addListener(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.addListener(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack),t||e.addListener(zC.NEED_REPLACE_TRACK,this.handleReplaceTrack))}unbindLocalTrackEvents(e){e||(e=Array.from(this.localTrackMap.entries()).map((e=>{let[t,{track:i}]=e;return{track:i,type:t}}))),e.forEach((e=>{let{track:t,type:i}=e;switch(i){case gT.LocalVideoTrack:t.off(zC.GET_STATS,this.handleGetLocalVideoStats),t.off(zC.GET_RTC_STATS,this.handleGetRTCStats),t.off(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),t.off(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),t.off(zC.NEED_UPDATE_VIDEO_ENCODER,this.handleUpdateVideoEncoder),t.off(zC.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode),t.off(zC.NEED_REPLACE_TRACK,this.handleReplaceTrack),t.off(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),t.off(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack);break;case gT.LocalAudioTrack:this.unbindLocalAudioTrackEvents(t);case gT.LocalVideoLowTrack:}}))}unbindLocalAudioTrackEvents(e){e instanceof fA?e.trackList.forEach((e=>{e.off(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(zC.GET_STATS,this.handleGetLocalAudioStats),e.off(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack)})):(e.off(zC.GET_STATS,this.handleGetLocalAudioStats),e.off(zC.NEED_DISABLE_TRACK,this.handleMuteLocalTrack),e.off(zC.NEED_ENABLE_TRACK,this.handleUnmuteLocalTrack),e.off(zC.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(zC.NEED_MUTE_TRACK,this.handleMuteLocalTrack),e.off(zC.NEED_UNMUTE_TRACK,this.handleUnmuteLocalTrack))}bindRemoteTrackEvents(e,t){t instanceof jA&&t.addListener(zC.GET_STATS,(t=>{t(this.handleGetRemoteVideoStats(e))})),t instanceof FA&&t.addListener(zC.GET_STATS,(t=>{t(this.handleGetRemoteAudioStats(e))}))}unbindRemoteTrackEvents(e){e&&e.removeAllListeners(zC.GET_STATS)}unbindAllRemoteTrackEvents(){Array.from(this.remoteUserMap.entries()).forEach((e=>{let[t,i]=e;i.has(pT.AUDIO)&&this.unbindRemoteTrackEvents(t._audioTrack),i.has(pT.VIDEO)&&this.unbindRemoteTrackEvents(t._videoTrack)}))}createGatewayPublishMessage(e,t){return e.map(((e,i)=>{var n;let r,o,{track:s,type:a}=e;switch(a){case gT.LocalAudioTrack:r=iT.Audio,o={dtx:s instanceof lA&&s._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1};break;case gT.LocalVideoTrack:r=Mn(n=s._hints).call(n,YC.SCREEN_TRACK)?iT.Screen:iT.High,o=iL(iL({},AR(s)),{},{codec:this.store.codec});break;case gT.LocalVideoLowTrack:r=iT.Low,o=iL(iL({},AR(s)),{},{codec:this.store.codec})}return{stream_type:r,attributes:o,ssrcs:t[i]}}))}createGatewayUnpublishMessage(e){return e.map((e=>{var t;let i,[n,{track:r,ssrcs:o,id:s}]=e;switch(n){case gT.LocalVideoTrack:i=Mn(t=r._hints).call(t,YC.SCREEN_TRACK)?iT.Screen:iT.High;break;case gT.LocalAudioTrack:i=iT.Audio;break;case gT.LocalVideoLowTrack:i=iT.Low}return{stream_type:i,ssrcs:o,mid:s}}))}assignLocalTracks(e,t){e.forEach(((e,i)=>{let{track:n,type:r}=e;this.localTrackMap.set(r,{track:n,id:t[i].id,ssrcs:t[i].localSSRC})}))}withdrawLocalTracks(e){e.forEach((e=>{let[t]=e;this.localTrackMap.delete(t)}))}bindConnectionEvents(e){e.onConnectionStateChange=async t=>{if(Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onConnectionStateChange(").concat(t,")")),this.emit(ET.PeerConnectionStateChange,t),"connected"!==t||this.store.keyMetrics.peerConnectionEnd||this.store.peerConnectionEnd(),"connected"===t&&(this._restartTimer&&(clearTimeout(this._restartTimer),this._restartTimer=void 0),(this._isFirstConnected||this._isInRestartIce)&&this.reportPCStats(Date.now(),!0,this._pcStatsUploadType),this._isInRestartIce=!1,this._isFirstConnected=!1,this._isStartRestartIce=!1),Pw("NEW_ICE_RESTART")){var i;if(Mn(i=this._restartStates).call(i,t)){if(this._isStartRestartIce)return;this._isStartRestartIce=!0;const t=t=>{"disconnected"!==e.iceConnectionState&&"checking"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||(Yw.debug("[".concat(this.store.clientId,"] [P2PChannel] start use restartICE, type is ").concat(t)),"CONNECTED"===yE(this,ET.QueryClientConnectionState)&&this.emit(ET.RequestRestartICE,t))},i=()=>{"disconnected"!==e.iceConnectionState&&"checking"!==e.iceConnectionState&&"failed"!==e.iceConnectionState||(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),Yw.debug("[".concat(this.store.clientId,"] P2PConnection disconnected timeout, force reconnect")),setTimeout((()=>this.emit(ET.P2PLost)),0),this.iceFailedCount+=1,this.requestReconnect())},n=Pw("ICE_RESTART_INTERVAL");return void(this._restartTimer=window.setTimeout((()=>{if(Pw("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&MC().supportPCSetConfiguration)t(mT.RELAY),this._restartTimer=window.setTimeout(i,n);else if(Sv())t(mT.UDP),this._restartTimer=window.setTimeout(i,4e3);else{if(t(mT.TCP),MC().supportPCSetConfiguration)return void(this._restartTimer=window.setTimeout((()=>{t(mT.RELAY),this._restartTimer=window.setTimeout(i,n)}),n));this._restartTimer=window.setTimeout(i,n)}}),800))}}else{if("disconnected"===t&&"disconnected"===e.iceConnectionState)return setTimeout((()=>{"disconnected"===e.iceConnectionState&&Pw("ICE_RESTART")&&"CONNECTED"===yE(this,ET.QueryClientConnectionState)&&this.emit(ET.RequestRestartICE)}),800),void setTimeout((()=>{"disconnected"===e.peerConnectionState&&(Yw.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection disconnected timeout 4000ms, force reconnect")),this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isInRestartIce=!1,setTimeout((()=>this.emit(ET.P2PLost)),0),this.iceFailedCount+=1,this.requestReconnect())}),4e3);"failed"===t&&(Yw.debug("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection state failed, force reconnect")),this.reportPCDisconnectedOrFailed(),setTimeout((()=>this.emit(ET.P2PLost)),0),this.iceFailedCount+=1,await this.requestReconnect())}},e.onICEConnectionStateChange=e=>{"connected"!==e||this.store.keyMetrics.iceConnectionEnd||this.store.iceConnectionEnd(),Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICEConnectionStateChange(").concat(e,")")),aS.reportApiInvoke(this.store.sessionId,{name:"ICEConnectionStateChange",options:e,tag:cE.TRACER}).onSuccess(),this.emit(ET.IceConnectionStateChange,e)},e.onICETransportStateChange=e=>{Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onICETransportStateChange(").concat(e,")"))},e.onDTLSTransportStateChange=e=>{Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportStateChange(").concat(e,")"))},e.onDTLSTransportError=e=>{Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.onDTLSTransportError(").concat(e,")"))},e.onFirstAudioDecoded=e=>{var t;const i=Array.from(fh(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));var n;i&&(this.store.subscribe(i.uid,"audio",void 0,void 0,void 0,Date.now()),null===(n=i.audioTrack)||void 0===n||n.emit(eI.FIRST_FRAME_DECODED),aS.firstRemoteFrame(this.store.sessionId,$w.FIRST_AUDIO_DECODE,eS.FIRST_AUDIO_DECODE,{peer:i._uintid,subscribeElapse:bk.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId}))},e.onFirstAudioReceived=e=>{var t;const i=Array.from(fh(t=this.remoteUserMap).call(t)).find((t=>t._audioSSRC===e));i&&aS.firstRemoteFrame(this.store.sessionId,$w.FIRST_AUDIO_RECEIVED,eS.FIRST_AUDIO_RECEIVED,{peer:i._uintid,subscribeElapse:bk.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onFirstVideoDecoded=(e,t,i)=>{this.reportVideoFirstFrameDecoded(e,t,i)},e.onFirstVideoReceived=e=>{var t;const i=Array.from(fh(t=this.remoteUserMap).call(t)).find((t=>t._videoSSRC===e));i&&aS.firstRemoteFrame(this.store.sessionId,$w.FIRST_VIDEO_RECEIVED,eS.FIRST_VIDEO_RECEIVED,{peer:i._uintid,subscribeElapse:bk.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId})},e.onSelectedLocalCandidateChanged=(e,t)=>{const i="relay"===e.candidateType,n="relay"===t.candidateType;"unknown"!==t.candidateType&&i===n||this.emit(ET.ConnectionTypeChange,i),Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedLocalCandidateChanged(").concat(JSON.stringify(PR(t))," -> ").concat(JSON.stringify(PR(e)),")"))},e.onSelectedRemoteCandidateChanged=(e,t)=>{Yw.info("[".concat(this.store.clientId,"] [p2pId: ").concat(this.store.p2pId,"]: P2PConnection.SelectedRemoteCandidateChanged(").concat(JSON.stringify(PR(t))," -> ").concat(JSON.stringify(PR(e)),")"))},e.onFirstVideoDecodedTimeout=e=>{this.reportVideoFirstFrameDecoded(e,void 0,void 0,!0)}}unbindConnectionEvents(e){e.onConnectionStateChange=void 0,e.onICEConnectionStateChange=void 0,e.onICETransportStateChange=void 0,e.onDTLSTransportStateChange=void 0,e.onDTLSTransportError=void 0,e.onFirstAudioDecoded=void 0,e.onFirstAudioReceived=void 0,e.onFirstVideoDecoded=void 0,e.onFirstVideoReceived=void 0,e.onSelectedLocalCandidateChanged=void 0,e.onSelectedRemoteCandidateChanged=void 0,e.onFirstVideoDecodedTimeout=void 0}filterTobeMutedTracks(e){const t=[];if(-1===this.getAllTracks().indexOf(e))return t;const i=this.localTrackMap.get(gT.LocalAudioTrack);if(e instanceof dA&&(null==i?void 0:i.track)instanceof fA)return i.track.isActive||t.push([gT.LocalAudioTrack,i]),t;const n=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:i}]=t;return e===i}));if(n&&(t.push(n),n[0]===gT.LocalVideoTrack)){const e=this.localTrackMap.get(gT.LocalVideoLowTrack);e&&t.push([gT.LocalVideoLowTrack,e])}return t}filterTobeUnmutedTracks(e){const t=[],i=this.localTrackMap.get(gT.LocalAudioTrack);if(e instanceof dA&&(null==i?void 0:i.track)instanceof fA)return i.track.isActive&&t.push([gT.LocalAudioTrack,i]),t;const n=Array.from(this.localTrackMap.entries()).find((t=>{let[,{track:i}]=t;return e===i}));if(n)if(n[0]===gT.LocalVideoTrack){t.push(n);const e=this.localTrackMap.get(gT.LocalVideoLowTrack);e&&t.push([gT.LocalVideoLowTrack,e])}else t.push(n);return t}createMuteMessage(e){return e.map((e=>{var t;let i,[n,{track:r,ssrcs:o,id:s}]=e;switch(n){case gT.LocalAudioTrack:i=iT.Audio;break;case gT.LocalVideoTrack:i=Mn(t=r._hints).call(t,YC.SCREEN_TRACK)?iT.Screen:iT.High;break;case gT.LocalVideoLowTrack:i=iT.Low}return{stream_type:i,ssrcs:o,mid:s}}))}createUnmuteMessage(e){return e.map((e=>{var t;let i,[n,{track:r,ssrcs:o,id:s}]=e;switch(n){case gT.LocalAudioTrack:i=iT.Audio;break;case gT.LocalVideoTrack:i=Mn(t=r._hints).call(t,YC.SCREEN_TRACK)?iT.Screen:iT.High;break;case gT.LocalVideoLowTrack:i=iT.Low}return{stream_type:i,ssrcs:o,mid:s}}))}filterTobeUnSubscribedTracks(e,t){const i=[],n=this.remoteUserMap.get(e);if(!n)return i;if(t){const r=n.get(t);if(!r)return i;i.push([e,{kind:t,id:r}])}else Array.from(n.entries()).forEach((t=>{let[n,r]=t;i.push([e,{kind:n,id:r}])}));return i}filterTobeUnSubscribedDataChannels(e,t){const i=[];return t.forEach((t=>{var n;null!==(n=this.remoteDataChannelMap.get(e))&&void 0!==n&&n.has(t.id)&&i.push(t)})),i}createUnsubscribeMessage(e){const t=[];return e.forEach((e=>{let[i,{kind:n,id:r}]=e;switch(n){case pT.VIDEO:return void(i._videoSSRC&&t.push({stream_type:pT.VIDEO,ssrcId:i._videoSSRC}));case pT.AUDIO:return void(i._audioSSRC&&t.push({stream_type:pT.AUDIO,ssrcId:i._audioSSRC}))}})),t}createUnsubscribeAllMessage(e){const t=new Map;return e.forEach((e=>{let[i,{kind:n}]=e;if(t.has(i)){let e=t.get(i);n===pT.VIDEO?e|=oT.Video:e|=oT.Audio,t.set(i,e)}else n===pT.VIDEO?t.set(i,oT.Video):t.set(i,oT.Audio)})),{users:Array.from(t.entries()).map((e=>{let[t,i]=e;return{stream_id:t.uid,stream_type:i}}))}}withdrawRemoteTracks(e){e.forEach((e=>{let[t,{kind:i}]=e;const n=this.remoteUserMap.get(t);n&&(n.delete(i),0===Array.from(n.entries()).length&&this.remoteUserMap.delete(t))}))}async updateBitrateLimit(e){const t=this.localTrackMap.get(gT.LocalVideoTrack),i=this.localTrackMap.get(gT.LocalVideoLowTrack);t&&await t.track.setBitrateLimit(e.uplink),i&&e.low_stream_uplink&&await i.track.setBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})}isP2PDisconnected(){return!this.connection||"connected"!==this.connection.peerConnectionState}mapPubResToRemoteConfig(e,t){return e.map(((e,i)=>{var n;let{stream_type:r}=e;return null===(n=t.find((e=>{let{stream_type:t}=e;return r===t})))||void 0===n?void 0:n.attributes}))}async tryToUnmuteAudio(e){for(let i=0;i<e.length;i++)if(e[i]instanceof dA){var t;const n=this.filterTobeUnmutedTracks(e[i]);if(0===n.length)continue;await(null===(t=this.connection)||void 0===t?void 0:t.unmuteLocal(n.map((e=>{let[,{id:t}]=e;return t}))));const r=this.createUnmuteMessage(n);return void await bE(this,ET.RequestUnmuteLocal,r)}}bindStatsUploaderEvents(){this.statsUploader.requestStats=()=>this.getStats(),this.statsUploader.requestLocalMedia=()=>Array.from(this.localTrackMap.entries()),this.statsUploader.requestRemoteMedia=()=>Array.from(this.remoteUserMap.entries()),this.statsUploader.requestVideoIsReady=e=>{var t;return!(null===(t=this.connection)||void 0===t||!t.getRemoteVideoIsReady(e))},this.statsUploader.requestUpload=(e,t)=>this.emit(ET.RequestUpload,e,t),this.statsUploader.requestUploadStats=e=>this.emit(ET.RequestUploadStats,e),this.statsUploader.requestAllTracks=()=>this.getAllTracks()}unbindStatsUploaderEvents(){this.statsUploader.requestStats=void 0,this.statsUploader.requestLocalMedia=void 0,this.statsUploader.requestRemoteMedia=void 0,this.statsUploader.requestVideoIsReady=void 0}async requestReconnect(){this.dtlsFailedCount+=1,await VE(QE(this.dtlsFailedCount,XE)),this.emit(ET.RequestReconnect)}async reconnectP2P(){const e=Array.from(this.localTrackMap.entries()),t=this.createGatewayUnpublishMessage(e);Array.from(this.remoteUserMap.entries()),t.length>0&&await EE(this,ET.RequestUnpublishForReconnectPC,t),this.disconnectForReconnect(),this.emit(ET.RequestReconnectPC)}canPublishLowStream(){return this.localTrackMap.has(gT.LocalVideoTrack)||this.pendingLocalTracks.some((e=>e instanceof kA))}throwIfTrackTypeNotMatch(e){if(e.filter((e=>e instanceof kA)).length>1)throw new jv(Bv.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(e.filter((e=>e instanceof dA)).length>1&&(e.some((e=>e instanceof dA&&e._bypassWebAudio))||!MC().webAudioMediaStreamDest))throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode");for(const t of e){if(t instanceof kA&&this.pendingLocalTracks.some((e=>e instanceof kA)))throw new jv(Bv.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS);if(t instanceof dA&&this.pendingLocalTracks.some((e=>e instanceof dA))&&(!MC().webAudioMediaStreamDest||t._bypassWebAudio||this.pendingLocalTracks.some((e=>e instanceof dA&&e._bypassWebAudio))))throw new jv(Bv.NOT_SUPPORTED,"cannot publish multiple tracks which one of them configured with bypassWebAudio or your browser doesn't support MediaStreamDestNode")}}getLowVideoTrack(e,t){const i=!Pw("DISABLE_DUAL_STREAM_USE_ENCODING")&&MC().supportDualStreamEncoding,n=iL(iL({},{width:160,height:120,framerate:15,bitrate:50}),t);let r;r=i?e._mediaStreamTrack.clone():FP(e,n);const o=BE(8,"track-low-"),s=new kA(r,iL(iL({},i&&{scaleResolutionDownBy:kR(n,e)}),{},{frameRate:n.framerate,bitrateMax:n.bitrate,bitrateMin:n.bitrate}),void 0,void 0,o);return s.on(ZC.TRANSCEIVER_UPDATED,(t=>{e._updateRtpTransceiver(t,JC.LOW_STREAM)})),s._hints.push(YC.LOW_STREAM),e.addListener(zC.NEED_CLOSE,(()=>{s.close()})),s}async globalLock(){return this.mutex.lock("From P2PChannel.globalLock")}async reportPCStats(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(this.connection&&this.connection instanceof VD){var r,o,s,a;const c=this.store.keyMetrics.descriptionStart||0,{iceConnectionState:u,dtlsTransportState:d,peerConnectionState:l}=this.connection,{local:h,remote:f}=await this.connection.getSelectedCandidatePair();aS.pcStats(this.store.sessionId,{startTime:c,eventElapse:e-c||0,iceconnectionsate:u,dtlsstate:d,connectionstate:l,intSucc:t?1:2,error:n,selectedLocalCandidateProtocol:null!==(r=null==h?void 0:h.protocol)&&void 0!==r?r:"",selectedLocalCandidateType:null!==(o=h.candidateType)&&void 0!==o?o:"",selectedLocalCandidateAddress:"".concat(h.address,":").concat(h.port),selectedRemoteCandidateProtocol:null!==(s=f.protocol)&&void 0!==s?s:"",selectedRemoteCandidateType:null!==(a=f.candidateType)&&void 0!==a?a:"",selectedRemoteCandidateAddress:"".concat(f.address,":").concat(f.port),restartCnt:i})}}reportVideoFirstFrameDecoded(e,t,i,n){var r;const o=Array.from(fh(r=this.remoteUserMap).call(r)).find((t=>t._videoSSRC===e));if(o){n||this.store.subscribe(o.uid,"video",void 0,void 0,void 0,void 0,Date.now());const r=this.store.keyMetrics,s=r.subscribe.find((e=>e.userId===o.uid&&"video"===e.type));aS.firstRemoteVideoDecode(this.store.sessionId,$w.FIRST_VIDEO_DECODE,eS.FIRST_VIDEO_DECODE,{peer:o._uintid,videowidth:t,videoheight:i,subscribeElapse:bk.measureFromSubscribeStart(this.store.clientId,e),subscribeRequestid:e,p2pid:this.store.p2pId,apEnd:r.requestAPEnd||0,apStart:r.requestAPStart||0,joinGwEnd:r.joinGatewayEnd||0,joinGwStart:r.joinGatewayStart||0,pcEnd:r.peerConnectionEnd||0,pcStart:r.peerConnectionStart||0,subscriberEnd:(null==s?void 0:s.subscribeEnd)||0,subscriberStart:(null==s?void 0:s.subscribeStart)||0,videoAddNotify:(null==s?void 0:s.streamAdded)||0,state:n?1:0})}}async remoteMediaSsrcChanged(e,t,i){if(!this.connection)return!1;const n=this.remoteUserMap.get(e);if(!n)return!1;const r=n.get(t);if(!r)return!1;const o=await this.connection.getRemoteSSRC(r);return void 0!==o&&o!==i}resetConnection(e){Yw.debug("[".concat(this.store.clientId,"] [P2PChannel] reset connection to ").concat(e)),this.state===vT.Connected?(Yw.debug("[".concat(this.store.clientId,"] [P2PChannel] fallback to websocket but P2PChannel state still connected, disconnect first")),this.disconnectForReconnect()):(this.connection&&(this.connection.close(),this.unbindConnectionEvents(this.connection),this.connection=void 0),this.shouldForwardP2PCreation&&(this.connection=e===sT.datachannel?new $D({},this.store):this.isPlanB?new MD({},this.store):new VD({},this.store),this.bindConnectionEvents(this.connection)))}unbindRtpTransceiver(){0!==this.localTrackMap.size&&Array.from(this.localTrackMap.entries()).forEach((e=>{let[t,{track:i}]=e;t===gT.LocalVideoLowTrack?i._updateRtpTransceiver(void 0,JC.LOW_STREAM):i._updateRtpTransceiver(void 0)}))}reportPCDisconnectedOrFailed(e){this.connection&&this.connection instanceof VD&&("disconnected"!==this.connection.iceConnectionState&&"checking"!==this.connection.iceConnectionState&&"failed"!==this.connection.iceConnectionState||(this._isFirstConnected?(this.reportPCStats(Date.now(),!1,this._pcStatsUploadType),this._isFirstConnected=!1):this._pcStatsUploadType===_T.TCP_RESTART&&e===mT.RELAY?this.reportPCStats(Date.now(),!1,this._pcStatsUploadType):this.reportPCStats(Date.now(),!1,_T.DISCONNECTED_OR_FAILED)))}}function sL(e,t,i){const n=e[t];if("function"!=typeof n)throw new Error("Cannot use mutex on object property.");return i.value=async function(){const e=this.mutex,i=await e.lock("From P2PChannel.".concat(t));try{for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return await n.apply(this,o)}finally{i()}},i}function aL(e){let t=vL();return function(e,t){let i=e.appId;void 0!==i&&(kL(t,10),RL(t,i));let n=e.cid;void 0!==n&&(kL(t,16),kL(t,n));let r=e.cname;void 0!==r&&(kL(t,26),RL(t,r));let o=e.deviceId;void 0!==o&&(kL(t,34),RL(t,o));let s=e.elapse;void 0!==s&&(kL(t,40),PL(t,s));let a=e.fileSize;void 0!==a&&(kL(t,48),PL(t,_L(a)));let c=e.height;void 0!==c&&(kL(t,56),PL(t,_L(c)));let u=e.jpg;void 0!==u&&(kL(t,66),kL(t,u.length),function(e,t){let i=wL(e,t.length);e.bytes.set(t,i)}(t,u));let d=e.networkType;void 0!==d&&(kL(t,72),PL(t,_L(d)));let l=e.osType;void 0!==l&&(kL(t,80),PL(t,_L(l)));let h=e.requestId;void 0!==h&&(kL(t,90),RL(t,h));let f=e.sdkVersion;void 0!==f&&(kL(t,98),RL(t,f));let p=e.sequence;void 0!==p&&(kL(t,104),PL(t,_L(p)));let m=e.sid;void 0!==m&&(kL(t,114),RL(t,m));let _=e.timestamp;void 0!==_&&(kL(t,120),PL(t,_));let g=e.uid;void 0!==g&&(kL(t,128),kL(t,g));let v=e.vid;void 0!==v&&(kL(t,136),kL(t,v));let E=e.width;void 0!==E&&(kL(t,144),PL(t,_L(E)));let b=e.service;void 0!==b&&(kL(t,152),kL(t,b));let y=e.callbackData;void 0!==y&&(kL(t,162),RL(t,y));let w=e.jpgEncryption;void 0!==w&&(kL(t,168),kL(t,w));let S=e.requestType;void 0!==S&&(kL(t,176),kL(t,S));let T=e.scorePorn;void 0!==T&&(kL(t,185),ML(t,T));let R=e.scoreSexy;void 0!==R&&(kL(t,193),ML(t,R));let C=e.scoreNeutral;void 0!==C&&(kL(t,201),ML(t,C));let I=e.scene;void 0!==I&&(kL(t,208),kL(t,I));let A=e.ossFilePrefix;void 0!==A&&(kL(t,218),RL(t,A));let O=e.serviceVendor;if(void 0!==O)for(let M of O){kL(t,226);let e=vL();dL(M,e),kL(t,e.limit),CL(t,e),EL(e)}}(e,t),function(e){let t=e.bytes,i=e.limit;return t.length===i?t:t.subarray(0,i)}(t)}function cL(e){return function(e){let t={};e:for(;!yL(e);){let i=NL(e);switch(i>>>3){case 0:break e;case 1:t.code=NL(e);break;case 2:t.msg=TL(e,NL(e));break;case 3:{let i=lL(e);t.data=uL(e),e.limit=i;break}default:hL(e,7&i)}}return t}({bytes:t=e,offset:0,limit:t.length});var t}function uL(e){let t={};e:for(;!yL(e);){let i=NL(e);switch(i>>>3){case 0:break e;case 1:t.requestId=TL(e,NL(e));break;case 2:t.requestType=NL(e)>>>0;break;case 3:t.scorePorn=OL(e);break;case 4:t.scoreSexy=OL(e);break;case 5:t.scoreNeutral=OL(e);break;case 6:t.requestScene=NL(e)>>>0;break;case 7:t.scene=NL(e)>>>0;break;default:hL(e,7&i)}}return t}function dL(e,t){let i=e.service;void 0!==i&&(kL(t,8),kL(t,i));let n=e.vendor;void 0!==n&&(kL(t,16),kL(t,n));let r=e.token;void 0!==r&&(kL(t,26),RL(t,r));let o=e.callbackUrl;void 0!==o&&(kL(t,34),RL(t,o))}function lL(e){let t=NL(e),i=e.limit;return e.limit=e.offset+t,i}function hL(e,t){switch(t){case 0:for(;128&IL(e););break;case 2:bL(e,NL(e));break;case 5:bL(e,4);break;case 1:bL(e,8);break;default:throw new Error("Unimplemented type: "+t)}}VS([sL,BS("design:type",Function),BS("design:paramtypes",[Object,Boolean]),BS("design:returntype",nv)],oL.prototype,"startP2PConnection",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[Object,Object,Array,Object,String,String]),BS("design:returntype",nv)],oL.prototype,"connect",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",void 0)],oL.prototype,"updateRemoteRTPCapabilities",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[Object,Object,Array,Object,String,String]),BS("design:returntype",nv)],oL.prototype,"preConnect",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],oL.prototype,"publishDataChannel",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],oL.prototype,"unpublish",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],oL.prototype,"unpublishDataChannel",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],oL.prototype,"unpublishLowStream",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[rD,Array]),BS("design:returntype",nv)],oL.prototype,"subscribeDataChannel",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[rD,String,Number,Number,Array]),BS("design:returntype",nv)],oL.prototype,"subscribe",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],oL.prototype,"massSubscribe",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[rD,String,Boolean]),BS("design:returntype",nv)],oL.prototype,"unsubscribe",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[rD,Array]),BS("design:returntype",nv)],oL.prototype,"unsubscribeDataChannel",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],oL.prototype,"massUnsubscribe",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[rD,String]),BS("design:returntype",nv)],oL.prototype,"muteRemote",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[rD,String]),BS("design:returntype",nv)],oL.prototype,"unmuteRemote",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[rD,String]),BS("design:returntype",nv)],oL.prototype,"hasRemoteMediaWithLock",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],oL.prototype,"disconnectForReconnect",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],oL.prototype,"updateBitrateLimit",null),VS([sL,BS("design:type",Function),BS("design:paramtypes",[rD,String,Number]),BS("design:returntype",nv)],oL.prototype,"remoteMediaSsrcChanged",null);let fL=new Float32Array(1);new Uint8Array(fL.buffer);let pL=new Float64Array(1),mL=new Uint8Array(pL.buffer);function _L(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let gL=[];function vL(){const e=gL.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}function EL(e){gL.push(e)}function bL(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function yL(e){return e.offset>=e.limit}function wL(e,t){let i=e.bytes,n=e.offset,r=e.limit,o=n+t;if(o>i.length){let t=new Uint8Array(2*o);t.set(i),e.bytes=t}return e.offset=o,o>r&&(e.limit=o),n}function SL(e,t){let i=e.offset;if(i+t>e.limit)throw new Error("Read past limit");return e.offset+=t,i}function TL(e,t){let i=SL(e,t),n=String.fromCharCode,r=e.bytes,o="\ufffd",s="";for(let a=0;a<t;a++){let e,c,u,d,l=r[a+i];0==(128&l)?s+=n(l):192==(224&l)?a+1>=t?s+=o:(e=r[a+i+1],128!=(192&e)?s+=o:(d=(31&l)<<6|63&e,d<128?s+=o:(s+=n(d),a++))):224==(240&l)?a+2>=t?s+=o:(e=r[a+i+1],c=r[a+i+2],32896!=(49344&(e|c<<8))?s+=o:(d=(15&l)<<12|(63&e)<<6|63&c,d<2048||d>=55296&&d<=57343?s+=o:(s+=n(d),a+=2))):240==(248&l)?a+3>=t?s+=o:(e=r[a+i+1],c=r[a+i+2],u=r[a+i+3],8421504!=(12632256&(e|c<<8|u<<16))?s+=o:(d=(7&l)<<18|(63&e)<<12|(63&c)<<6|63&u,d<65536||d>1114111?s+=o:(d-=65536,s+=n(55296+(d>>10),56320+(1023&d)),a+=3))):s+=o}return s}function RL(e,t){let i=t.length,n=0;for(let s=0;s<i;s++){let e=t.charCodeAt(s);e>=55296&&e<=56319&&s+1<i&&(e=(e<<10)+t.charCodeAt(++s)-56613888),n+=e<128?1:e<2048?2:e<65536?3:4}kL(e,n);let r=wL(e,n),o=e.bytes;for(let s=0;s<i;s++){let e=t.charCodeAt(s);e>=55296&&e<=56319&&s+1<i&&(e=(e<<10)+t.charCodeAt(++s)-56613888),e<128?o[r++]=e:(e<2048?o[r++]=e>>6&31|192:(e<65536?o[r++]=e>>12&15|224:(o[r++]=e>>18&7|240,o[r++]=e>>12&63|128),o[r++]=e>>6&63|128),o[r++]=63&e|128)}}function CL(e,t){let i=wL(e,t.limit),n=e.bytes,r=t.bytes;for(let o=0,s=t.limit;o<s;o++)n[o+i]=r[o]}function IL(e){return e.bytes[SL(e,1)]}function AL(e,t){let i=wL(e,1);e.bytes[i]=t}function OL(e){let t=SL(e,8),i=e.bytes;return mL[0]=i[t++],mL[1]=i[t++],mL[2]=i[t++],mL[3]=i[t++],mL[4]=i[t++],mL[5]=i[t++],mL[6]=i[t++],mL[7]=i[t++],pL[0]}function ML(e,t){let i=wL(e,8),n=e.bytes;pL[0]=t,n[i++]=mL[0],n[i++]=mL[1],n[i++]=mL[2],n[i++]=mL[3],n[i++]=mL[4],n[i++]=mL[5],n[i++]=mL[6],n[i++]=mL[7]}function NL(e){let t,i=0,n=0;do{t=IL(e),i<32&&(n|=(127&t)<<i),i+=7}while(128&t);return n}function kL(e,t){for(t>>>=0;t>=128;)AL(e,127&t|128),t>>>=7;AL(e,t)}function PL(e,t){let i=t.low>>>0,n=(t.low>>>28|t.high<<4)>>>0,r=t.high>>>24,o=0===r?0===n?i<16384?i<128?1:2:i<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:r<128?9:10,s=wL(e,o),a=e.bytes;switch(o){case 10:a[s+9]=r>>>7&1;case 9:a[s+8]=9!==o?128|r:127&r;case 8:a[s+7]=8!==o?n>>>21|128:n>>>21&127;case 7:a[s+6]=7!==o?n>>>14|128:n>>>14&127;case 6:a[s+5]=6!==o?n>>>7|128:n>>>7&127;case 5:a[s+4]=5!==o?128|n:127&n;case 4:a[s+3]=4!==o?i>>>21|128:i>>>21&127;case 3:a[s+2]=3!==o?i>>>14|128:i>>>14&127;case 2:a[s+1]=2!==o?i>>>7|128:i>>>7&127;case 1:a[s]=1!==o?128|i:127&i}}function DL(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}const LL=new Map([["moderation",1],["supervise",2]]);class xL extends rE{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const t=this._connectionState;this._connectionState=e,this.emit(ST.CONNECTION_STATE_CHANGE,t,e)}get inspectType(){return this._inspectType}set inspectType(e){var t;this._inspectMode=db(t=e.map((e=>LL.get(e)||0))).call(t,((e,t)=>e+t)),this._inspectType=e}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this.qualityTimer&&(window.clearTimeout(this.qualityTimer),this.qualityTimer=null),this._quality>=1||(this.qualityTimer=window.setTimeout((()=>{this.quality=this._quality/this.qualityRatio}),6e4))}constructor(e){super(),oh(this,"name","AgoraRTCVideoContentInspect"),oh(this,"_connectionState",yT.CONNECTING),oh(this,"_innerConnectionState",void 0),oh(this,"sequence",0),oh(this,"inspectStartTime",void 0),oh(this,"workerManagerConnection",void 0),oh(this,"workerConnection",void 0),oh(this,"workerMessageLengthLimit",void 0),oh(this,"inspectIntervalMinimum",void 0),oh(this,"qualityRatio",void 0),oh(this,"_connectInfo",void 0),oh(this,"_cancelTokenSource",gw.CancelToken.source()),oh(this,"_retryConfig",void 0),oh(this,"wmSequence",0),oh(this,"inspectInterval",void 0),oh(this,"inspectTimer",null),oh(this,"ossFilePrefix",void 0),oh(this,"extraInfo",void 0),oh(this,"_inspectType",void 0),oh(this,"_inspectMode",void 0),oh(this,"_quality",1),oh(this,"qualityTimer",null),oh(this,"_inspectId",void 0),oh(this,"_needWorkUrlOnly",!1),oh(this,"inspectImage",(()=>{if(this.connectionState!==yT.CONNECTED)throw new jS(Bv.OPERATION_ABORTED,"content inspect service connection status is ".concat(this.connectionState));this.inspectTimer&&(window.clearInterval(this.inspectTimer),this.inspectTimer=null),this.inspectTimer=window.setInterval((()=>{this.connectionState===yT.CONNECTED?this.requestToInspectImage():Yw.debug("[".concat(this._inspectId,"] Inspect State is not connected , "),this.connectionState)}),this.inspectInterval<this.inspectIntervalMinimum?this.inspectIntervalMinimum:this.inspectInterval),this.requestToInspectImage()})),this._inspectId=BE(5,"inspect-"),this.workerMessageLengthLimit=Pw("VIDEO_INSPECT_WORKER_MESSAGE_LENGTH_LIMIT"),this.inspectIntervalMinimum=Pw("VIDEO_INSPECT_INTERVAL_MINIMUM"),this.qualityRatio=Pw("VIDEO_INSPECT_QUALITY_RATIO"),this.inspectInterval=e.interval,this.ossFilePrefix=e.ossFilePrefix,this.extraInfo=e.extraInfo,this.inspectType=e.inspectType,this.inspectStartTime=Number(Date.now()),this.workerManagerConnection=new tR("worker-manager-"+this._inspectId,XE),this.on(ST.STATE_CHANGE,((e,t)=>{this._innerConnectionState=e,Yw.debug("[".concat(this._inspectId,"] Inspect operation :").concat(wT[e]," ").concat(t||""))})),this.handleWorkerManagerEvents(),this.workerConnection=new tR("worker-"+this._inspectId,XE),this.handleWorkerEvents()}async init(e,t){this.emit(ST.STATE_CHANGE,wT.CONNECT_AP),this._connectInfo=e;const i=this._cancelTokenSource.token;return this._retryConfig=t,new nv(((n,r)=>{this.on(ST.CONNECTION_STATE_CHANGE,((e,t)=>{t===yT.CONNECTED&&n()})),this.requestAP(e,i,t).then((e=>{this.connectWorkerManager(e)})).catch((e=>{r(e)}))}))}async requestAP(e,t,i){const n=Pw("WEBCS_DOMAIN").map((e=>"https://".concat(e,"/api/v1"))),r=await function(e,t,i,n){let{appId:r,areaCode:o,cname:s,sid:a,token:c,uid:u}=t;mC++;const d="image_moderation_api",l={service_name:d,json_body:JSON.stringify({appId:r,areaCode:o,cname:s,command:"allocateEdge",requestId:mC,seq:mC,sid:a,token:c,ts:Date.now(),uid:u+""})};let h,f,p=e[0];return ZE((async()=>{h=Date.now();const e=await zR(p,{data:l,cancelToken:i,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(f=Date.now()-h,0!==e.code){const t=new jS(Bv.UNEXPECTED_RESPONSE,"image inspect ap error, code"+e.code,{retry:!0,responseTime:f});throw Yw.error(t.toString()),t}const t=JSON.parse(e.json_body);if(200!==t.code){const e=new jS(Bv.UNEXPECTED_RESPONSE,"image inspect ap error, code: ".concat(t.code,", reason: ").concat(t.reason),{code:t.code,responseTime:f});throw Yw.error(e.toString()),e}if(!t.servers||!Array.isArray(t.servers)||0===t.servers.length){const e=new jS(Bv.UNEXPECTED_RESPONSE,"image inspect ap empty server",{code:t.code,responseTime:f});throw Yw.error(e.toString()),e}const n=Pw("VIDEO_INSPECT_WORKER_MANAGER_HOST"),r=Pw("VIDEO_INSPECT_WORKER_MANAGER_PORT");return{addressList:t.servers.map((e=>{let{address:t,wss:i}=e;if(t&&i)return"wss://".concat(t.replace(/\./g,"-"),".").concat(n,":").concat(r||i)})).filter((e=>!!e)),workerToken:t.workerToken,vid:t.vid,responseTime:f}}),((t,i)=>(aS.apworkerEvent(a,{success:!0,sc:200,serviceName:d,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===i,responseTime:f,serverIp:e[i%e.length]}),!1)),((t,i)=>(aS.apworkerEvent(a,{success:!1,sc:t.data&&t.data.code||200,serviceName:d,responseTime:f,serverIp:e[i%e.length]}),!!(t.code!==Bv.OPERATION_ABORTED&&t.code!==Bv.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(p=e[(i+1)%e.length],!0))),n)}(n,e,t,i);this.emit(ST.STATE_CHANGE,wT.AP_CONNECTED);const{addressList:o}=r;return this.wmSequence++,o}async connectWorkerManager(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._needWorkUrlOnly=t,this.emit(ST.STATE_CHANGE,wT.CONNECT_WORKER_MANAGER),await this.workerManagerConnection.init(e,1e4)}async connectWorker(e){await this.workerConnection.init([e])}handleWorkerManagerEvents(){this.workerManagerConnection.on(IS.CONNECTED,(async()=>{this.emit(ST.STATE_CHANGE,wT.WORKER_MANAGER_CONNECTED,this.workerManagerConnection.url),this.workerManagerConnection.sendMessage({appId:this._connectInfo.appId,cname:this._connectInfo.cname,uid:this._connectInfo.uid+"",sdkVersion:"4.20.0",sid:this._connectInfo.sid,seq:this.wmSequence,ts:Number(Date.now()),requestId:Math.floor(1e12*Math.random()),allocate:!0,clientRequest:{command:"join"}},!0)})),this.workerManagerConnection.on(IS.CLOSED,(()=>{this._innerConnectionState<wT.GET_WORKER_MANAGER_RESPONSE&&Yw.debug("[".concat(this._inspectId,"] Inspect worker manager is closed before connecting worker"))})),this.workerManagerConnection.on(IS.FAILED,(()=>{this._innerConnectionState<wT.GET_WORKER_MANAGER_RESPONSE&&Yw.debug("[".concat(this._inspectId,"] Connecting inspect worker manager is failed before connecting worker"))})),this.workerManagerConnection.on(IS.RECONNECTING,(()=>{this._innerConnectionState<wT.GET_WORKER_MANAGER_RESPONSE&&Yw.debug("[".concat(this._inspectId,"] Inspect worker manager is reconnecting before connecting worker"))})),this.workerManagerConnection.on(IS.ON_MESSAGE,(async e=>{this.emit(ST.STATE_CHANGE,wT.GET_WORKER_MANAGER_RESPONSE);const t=this.workerManagerConnection.url;this.workerManagerConnection.close();const i=JSON.parse(e.data);if(200!==i.code)throw Yw.error("[".concat(this._inspectId,"] Unexpected code ").concat(i.code," from worker manager")),new jS(Bv.UNEXPECTED_RESPONSE,"response code of worker is unexpected",i);if(!(i.serverResponse&&i.serverResponse.portWss&&t))throw Yw.error("[".concat(this._inspectId,"] Unexpected content from worker manager : ").concat(JSON.stringify(i))),new jS(Bv.UNEXPECTED_RESPONSE,"response content of worker is unexpected",i);{const e=Pw("VIDEO_INSPECT_WORKER_PORT")||i.serverResponse.portWss,n=t.replace(/:\d+\/?$/,":".concat(e));this.emit(ST.STATE_CHANGE,wT.CONNECT_WORKER,n),this._needWorkUrlOnly?this.emit(ST.REQUEST_NEW_WORKER_URL,n):await this.connectWorker(n)}})),this.workerManagerConnection.on(IS.WILL_RECONNECT,((e,t,i)=>{i(e)})),this.workerManagerConnection.on(IS.REQUEST_NEW_URLS,((e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)}))}handleWorkerEvents(){this.workerConnection.on(IS.CONNECTED,(async()=>{this.emit(ST.STATE_CHANGE,wT.WORKER_CONNECTED,this.workerConnection.url),this.connectionState=yT.CONNECTED})),this.workerConnection.on(IS.ON_MESSAGE,(async e=>{if(e.data instanceof ArrayBuffer){const i=cL(new Uint8Array(e.data));if(Pw("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")&&Yw.debug("[".concat(this._inspectId,"] Response message for worker of inspect content "),JSON.stringify(i)),200===i.code){if(Array.isArray(this.inspectType)&&1===this.inspectType.length&&"supervise"===this.inspectType[0])return void this.emit(ST.INSPECT_RESULT,void 0,void 0);if(i.data&&i.data.scorePorn&&i.data.scoreSexy&&i.data.scoreNeutral){var t;const e={porn:i.data.scorePorn,sexy:i.data.scoreSexy,neutral:i.data.scoreNeutral},n=db(t=Object.keys(e)).call(t,((t,i)=>e[t]>e[i]?t:i),"porn"),r=Object.keys(e).find((e=>e===n));this.emit(ST.INSPECT_RESULT,r)}else this.emit(ST.INSPECT_RESULT,void 0,new jS(Bv.UNEXPECTED_RESPONSE,i.code+"","There is an unexpected data on message"))}else this.emit(ST.INSPECT_RESULT,void 0,new jS(Bv.UNEXPECTED_RESPONSE,i.code+"",i.msg))}else Yw.error("[".concat(this._inspectId,"] Unexpected message type from worker")),this.emit(ST.INSPECT_RESULT,void 0,new jS(Bv.UNEXPECTED_RESPONSE,"invalid worker message type"))})),this.workerConnection.on(IS.CLOSED,(()=>{this.connectionState=yT.CLOSED})),this.workerConnection.on(IS.FAILED,(()=>{this.connectionState=yT.CLOSED})),this.workerConnection.on(IS.RECONNECTING,(()=>{this.connectionState=this.connectionState===yT.CONNECTED?yT.RECONNECTING:yT.CONNECTING})),this.workerConnection.on(IS.WILL_RECONNECT,((e,t,i)=>{"recover"===e&&i(e),i("tryNext")})),this.workerConnection.on(IS.REQUEST_NEW_URLS,((e,t)=>{this.workerManagerConnection.close(),this.once(ST.REQUEST_NEW_WORKER_URL,(t=>{e([t])})),this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then((e=>{this.connectWorkerManager(e,!0)})).catch((e=>{t(e)}))}))}static intToLong(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}async requestToInspectImage(){this.sequence++;const e=yE(this,ST.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void this.emit(ST.INSPECT_RESULT,void 0,new jS(Bv.INVALID_OPERATION,"Only the track being played can be inspected"));const i=await this.generateRequestData(e,t);this.workerConnection.sendMessage(i,!0,!0)}else this.emit(ST.INSPECT_RESULT,void 0,new jS(Bv.INVALID_OPERATION,"Only the track being published can be inspected"))}async generateRequestData(e,t){let{appId:i,cname:n,cid:r,vid:o,sid:s,uid:a}=t;const c=Date.now(),u=await e.getCurrentFrameImage("image/jpeg",this.quality),d=await OA(u,i,n),l=this.sequence+"-"+r+"-"+a+"-"+c+"-"+BE(12,""),h={appId:i,cid:r,cname:n,deviceId:"",elapse:xL.intToLong(Number(c-this.inspectStartTime)),fileSize:d.byteLength,jpgEncryption:2,height:u.height,width:u.width,jpg:d,networkType:6,osType:7,requestId:l,sdkVersion:"4.20.0",sequence:this.sequence,sid:s,timestamp:xL.intToLong(c),uid:a,vid:o,service:this._inspectMode,callbackData:this.extraInfo,ossFilePrefix:this.ossFilePrefix};void 0===this.extraInfo&&delete h.callbackData,void 0===this.ossFilePrefix&&delete h.ossFilePrefix;const f=aL(h);if(f.byteLength<this.workerMessageLengthLimit){if(Pw("SHOW_VIDEO_INSPECT_WORKER_MESSAGE")){const e=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?DL(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):DL(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},h);delete e.jpg,Yw.debug("[".concat(this._inspectId,"] Request message for worker of inspect content "),JSON.stringify(e))}return f}{const t=this.quality*this.qualityRatio;return this.quality=t,await this.generateRequestData(e,{appId:i,cname:n,cid:r,vid:o,sid:s,uid:a})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=gw.CancelToken.source(),this.workerManagerConnection&&this.workerManagerConnection.close(),this.workerConnection&&this.workerConnection.close(),this.inspectTimer&&window.clearInterval(this.inspectTimer),this.inspectTimer=null,this.connectionState=yT.CLOSED,this.emit(ST.STATE_CHANGE,wT.CLOSED)}}function UL(e){let t=function(){const e=FL.pop();return e?(e.offset=e.limit=0,e):{bytes:new Uint8Array(64),offset:0,limit:0}}();return function(e,t){let i=e.appId;void 0!==i&&(ZL(t,10),YL(t,i));let n=e.cid;void 0!==n&&(ZL(t,16),ZL(t,n));let r=e.cname;void 0!==r&&(ZL(t,26),YL(t,r));let o=e.deviceId;void 0!==o&&(ZL(t,34),YL(t,o));let s=e.elapse;void 0!==s&&(ZL(t,40),ex(t,s));let a=e.fileSize;void 0!==a&&(ZL(t,48),ex(t,jL(a)));let c=e.height;void 0!==c&&(ZL(t,56),ex(t,jL(c)));let u=e.jpg;void 0!==u&&(ZL(t,66),ZL(t,u.length),KL(t,u));let d=e.networkType;void 0!==d&&(ZL(t,72),ex(t,jL(d)));let l=e.osType;void 0!==l&&(ZL(t,80),ex(t,jL(l)));let h=e.requestId;void 0!==h&&(ZL(t,90),YL(t,h));let f=e.sdkVersion;void 0!==f&&(ZL(t,98),YL(t,f));let p=e.sequence;void 0!==p&&(ZL(t,104),ex(t,jL(p)));let m=e.sid;void 0!==m&&(ZL(t,114),YL(t,m));let _=e.timestamp;void 0!==_&&(ZL(t,120),ex(t,_));let g=e.uid;void 0!==g&&(ZL(t,128),ZL(t,g));let v=e.vid;void 0!==v&&(ZL(t,136),ZL(t,v));let E=e.width;void 0!==E&&(ZL(t,144),ex(t,jL(E)));let b=e.service;void 0!==b&&(ZL(t,152),ZL(t,b));let y=e.callbackData;void 0!==y&&(ZL(t,162),ZL(t,y.length),KL(t,y));let w=e.ticket;void 0!==w&&(ZL(t,170),YL(t,w));let S=e.vendorConfigs;void 0!==S&&(ZL(t,178),YL(t,S))}(e,t),function(e){let t=e.bytes,i=e.limit;return t.length===i?t:t.subarray(0,i)}(t)}function VL(e){return function(e){let t={};e:for(;!GL(e);){let i=QL(e);switch(i>>>3){case 0:break e;case 1:t.code=QL(e);break;case 2:t.msg=zL(e,QL(e));break;case 3:t.requestId=zL(e,QL(e));break;case 4:t.timestamp=$L(e,!1);break;default:BL(e,7&i)}}return t}({bytes:t=e,offset:0,limit:t.length});var t}function BL(e,t){switch(t){case 0:for(;128&JL(e););break;case 2:WL(e,QL(e));break;case 5:WL(e,4);break;case 1:WL(e,8);break;default:throw new Error("Unimplemented type: "+t)}}function jL(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}let FL=[];function WL(e,t){if(e.offset+t>e.limit)throw new Error("Skip past limit");e.offset+=t}function GL(e){return e.offset>=e.limit}function HL(e,t){let i=e.bytes,n=e.offset,r=e.limit,o=n+t;if(o>i.length){let t=new Uint8Array(2*o);t.set(i),e.bytes=t}return e.offset=o,o>r&&(e.limit=o),n}function qL(e,t){let i=e.offset;if(i+t>e.limit)throw new Error("Read past limit");return e.offset+=t,i}function KL(e,t){let i=HL(e,t.length);e.bytes.set(t,i)}function zL(e,t){let i=qL(e,t),n=String.fromCharCode,r=e.bytes,o="\ufffd",s="";for(let a=0;a<t;a++){let e,c,u,d,l=r[a+i];0==(128&l)?s+=n(l):192==(224&l)?a+1>=t?s+=o:(e=r[a+i+1],128!=(192&e)?s+=o:(d=(31&l)<<6|63&e,d<128?s+=o:(s+=n(d),a++))):224==(240&l)?a+2>=t?s+=o:(e=r[a+i+1],c=r[a+i+2],32896!=(49344&(e|c<<8))?s+=o:(d=(15&l)<<12|(63&e)<<6|63&c,d<2048||d>=55296&&d<=57343?s+=o:(s+=n(d),a+=2))):240==(248&l)?a+3>=t?s+=o:(e=r[a+i+1],c=r[a+i+2],u=r[a+i+3],8421504!=(12632256&(e|c<<8|u<<16))?s+=o:(d=(7&l)<<18|(63&e)<<12|(63&c)<<6|63&u,d<65536||d>1114111?s+=o:(d-=65536,s+=n(55296+(d>>10),56320+(1023&d)),a+=3))):s+=o}return s}function YL(e,t){let i=t.length,n=0;for(let s=0;s<i;s++){let e=t.charCodeAt(s);e>=55296&&e<=56319&&s+1<i&&(e=(e<<10)+t.charCodeAt(++s)-56613888),n+=e<128?1:e<2048?2:e<65536?3:4}ZL(e,n);let r=HL(e,n),o=e.bytes;for(let s=0;s<i;s++){let e=t.charCodeAt(s);e>=55296&&e<=56319&&s+1<i&&(e=(e<<10)+t.charCodeAt(++s)-56613888),e<128?o[r++]=e:(e<2048?o[r++]=e>>6&31|192:(e<65536?o[r++]=e>>12&15|224:(o[r++]=e>>18&7|240,o[r++]=e>>12&63|128),o[r++]=e>>6&63|128),o[r++]=63&e|128)}}function JL(e){return e.bytes[qL(e,1)]}function XL(e,t){let i=HL(e,1);e.bytes[i]=t}function QL(e){let t,i=0,n=0;do{t=JL(e),i<32&&(n|=(127&t)<<i),i+=7}while(128&t);return n}function ZL(e,t){for(t>>>=0;t>=128;)XL(e,127&t|128),t>>>=7;XL(e,t)}function $L(e,t){let i,n=0,r=0,o=0;return i=JL(e),n=127&i,128&i&&(i=JL(e),n|=(127&i)<<7,128&i&&(i=JL(e),n|=(127&i)<<14,128&i&&(i=JL(e),n|=(127&i)<<21,128&i&&(i=JL(e),r=127&i,128&i&&(i=JL(e),r|=(127&i)<<7,128&i&&(i=JL(e),r|=(127&i)<<14,128&i&&(i=JL(e),r|=(127&i)<<21,128&i&&(i=JL(e),o=127&i,128&i&&(i=JL(e),o|=(127&i)<<7))))))))),{low:n|r<<28,high:r>>>4|o<<24,unsigned:t}}function ex(e,t){let i=t.low>>>0,n=(t.low>>>28|t.high<<4)>>>0,r=t.high>>>24,o=0===r?0===n?i<16384?i<128?1:2:i<1<<21?3:4:n<16384?n<128?5:6:n<1<<21?7:8:r<128?9:10,s=HL(e,o),a=e.bytes;switch(o){case 10:a[s+9]=r>>>7&1;case 9:a[s+8]=9!==o?128|r:127&r;case 8:a[s+7]=8!==o?n>>>21|128:n>>>21&127;case 7:a[s+6]=7!==o?n>>>14|128:n>>>14&127;case 6:a[s+5]=6!==o?n>>>7|128:n>>>7&127;case 5:a[s+4]=5!==o?128|n:127&n;case 4:a[s+3]=4!==o?i>>>21|128:i>>>21&127;case 3:a[s+2]=3!==o?i>>>14|128:i>>>14&127;case 2:a[s+1]=2!==o?i>>>7|128:i>>>7&127;case 1:a[s]=1!==o?128|i:127&i}}const tx={},ix={},nx=4294967296,rx=nx*nx,ox=rx/2,sx=lx(0,!0),ax=lx(0),cx=hx(0,-2147483648,!1),ux=hx(-1,2147483647,!1),dx=hx(-1,-1,!0);function lx(e,t){let i,n,r;return t?(r=0<=(e>>>=0)&&e<256)&&(n=ix[e],n)?n:(i=hx(e,0,!0),r&&(ix[e]=i),i):(r=-128<=(e|=0)&&e<128)&&(n=tx[e],n)?n:(i=hx(e,e<0?-1:0,!1),r&&(tx[e]=i),i)}function hx(e,t,i){return{low:0|e,high:0|t,unsigned:!!i}}function fx(e,t){if(isNaN(e))return t?sx:ax;if(t){if(e<0)return sx;if(e>=rx)return dx}else{if(e<=-ox)return cx;if(e+1>=ox)return ux}return e<0?t?sx:ax:hx(e%nx|0,e/nx|0,t)}function px(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}class mx extends rE{get connectionState(){return this._connectionState}set connectionState(e){if(this._connectionState===e)return;const t=this._connectionState;this._connectionState=e,this.emit(OT.CONNECTION_STATE_CHANGE,e,t)}get quality(){return this._quality}set quality(e){this._quality=e>1?1:e<.1?.1:e,this._qualityTimer&&(window.clearTimeout(this._qualityTimer),this._qualityTimer=null),this._quality>=1||(this._qualityTimer=window.setTimeout((()=>{this.quality=this._quality/this._qualityRatio}),6e4))}constructor(e){var t;super(),oh(this,"name","AgoraRTCImageModeration"),oh(this,"_connectionState",AT.CONNECTING),oh(this,"_sequence",0),oh(this,"_moderationStartTime",void 0),oh(this,"_workerConnection",void 0),oh(this,"_workerMessageLengthLimit",void 0),oh(this,"_qualityRatio",void 0),oh(this,"_connectInfo",void 0),oh(this,"_cancelTokenSource",gw.CancelToken.source()),oh(this,"_retryConfig",void 0),oh(this,"_moderationInterval",void 0),oh(this,"_moderationTimer",null),oh(this,"_moderationMode",1),oh(this,"_quality",1),oh(this,"_qualityTimer",null),oh(this,"_ticket",void 0),oh(this,"_moderationIntervalMinimum",void 0),oh(this,"_uploadFailedNum",0),oh(this,"_uploadNum",0),oh(this,"_uploadTimer",null),oh(this,"_extraInfo",void 0),oh(this,"_vendor",""),oh(this,"_encoder",new TextEncoder),oh(this,"_moderationId",void 0),oh(this,"inspectImage",(()=>{if(this.connectionState!==AT.CONNECTED)throw new jS(Bv.OPERATION_ABORTED,"image moderation service connection status is ".concat(this.connectionState));this._moderationTimer&&(window.clearInterval(this._moderationTimer),this._moderationTimer=null),this._moderationTimer=window.setInterval((()=>{this.connectionState===AT.CONNECTED?this.requestToInspectImage():Yw.debug("[".concat(this._moderationId,"] Moderation State is not connected , "),this.connectionState)}),this._moderationInterval<this._moderationIntervalMinimum?this._moderationIntervalMinimum:this._moderationInterval),this.requestToInspectImage()})),this._moderationId=BE(5,"image-moderation-"),this._workerMessageLengthLimit=Pw("IMAGE_MODERATION_WORKER_MESSAGE_LENGTH_LIMIT"),this._moderationIntervalMinimum=Pw("IMAGE_MODERATION_INTERVAL_MINIMUM"),this._moderationInterval=null!==(t=e.interval)&&void 0!==t?t:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),this._qualityRatio=Pw("IMAGE_MODERATION_QUALITY_RATIO"),this._moderationStartTime=Number(Date.now()),this._workerConnection=new tR("worker-"+this._moderationId,XE),this.on(OT.STATE_CHANGE,((e,t)=>{Yw.debug("[".concat(this._moderationId,"] Moderation operation :").concat(MT[e]," ").concat(t||""))})),this.handleWorkerEvents()}async init(e,t){this.emit(OT.STATE_CHANGE,MT.CONNECT_AP),this._connectInfo=e;const i=this._cancelTokenSource.token;return this._retryConfig=t,new nv(((n,r)=>{this.on(OT.CONNECTION_STATE_CHANGE,((e,t)=>{e===AT.CONNECTED&&n()})),this.requestAP(e,i,t).then((e=>{this.connectWorker(e)})).catch((e=>{r(e)}))}))}updateConfig(e){var t;this._moderationInterval=null!==(t=e.interval)&&void 0!==t?t:1e3,e.extraInfo&&(this._extraInfo=this._encoder.encode(e.extraInfo)),e.vendor&&(this._vendor=e.vendor),Yw.debug("[".concat(this._moderationId,"] updateConfig: ").concat(JSON.stringify(e))),this.connectionState===AT.CONNECTED&&this.inspectImage()}async requestAP(e,t,i){const n=Pw("WEBCS_DOMAIN").map((e=>"https://".concat(e,"/api/v1"))),r=await function(e,t,i,n){let{appId:r,areaCode:o,cname:s,sid:a,token:c,uid:u}=t;mC++;const d="moderation_plugin",l={service_name:d,json_body:JSON.stringify({appId:r,areaCode:o,cname:s,command:"allocateEdge",requestId:mC,seq:mC,sid:a,appToken:c,ts:Date.now(),uid:u+""})};let h,f,p=e[0];return ZE((async()=>{h=Date.now();const e=await zR(p,{data:l,cancelToken:i,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"},params:{action:"wrtc_gateway"}});if(f=Date.now()-h,0!==e.code){const t=new jS(Bv.UNEXPECTED_RESPONSE,"moderation plugin ap error, code"+e.code,{retry:!0,responseTime:f});throw Yw.error(t.toString()),t}const t=JSON.parse(e.json_body);if(200!==t.code){const e=new jS(Bv.UNEXPECTED_RESPONSE,"moderation plugin ap error, code: ".concat(t.code,", reason: ").concat(t.reason),{code:t.code,responseTime:f});throw Yw.error(e.toString()),e}if(!t.servers||!Array.isArray(t.servers)||0===t.servers.length){const e=new jS(Bv.UNEXPECTED_RESPONSE,"moderation plugin ap empty server",{code:t.code,responseTime:f});throw Yw.error(e.toString()),e}if(!t.servers.some((e=>!!e.wss))){const e=new jS(Bv.UNEXPECTED_RESPONSE,"moderation plugin ap empty port",{code:t.code,responseTime:f});throw Yw.error(e.toString()),e}const n=Pw("IMAGE_MODERATION_WORKER_HOST");return{addressList:t.servers.map((e=>{let{address:t,wss:i}=e;if(t&&i)return"wss://".concat(t.replace(/\./g,"-"),".").concat(n,":").concat(i,"/moderation")})).filter((e=>!!e)),workerToken:t.workerToken,vid:t.vid,ticket:t.appTicket,responseTime:f}}),((t,i)=>(aS.apworkerEvent(a,{success:!0,sc:200,serviceName:d,responseDetail:JSON.stringify(t.addressList),firstSuccess:0===i,responseTime:f,serverIp:e[i%e.length]}),!1)),((t,i)=>(aS.apworkerEvent(a,{success:!1,sc:t.data&&t.data.code||200,serviceName:d,responseTime:f,serverIp:e[i%e.length]}),!!(t.code!==Bv.OPERATION_ABORTED&&t.code!==Bv.UNEXPECTED_RESPONSE||t.data&&t.data.retry)&&(p=e[(i+1)%e.length],!0))),n)}(n,e,t,i);this.emit(OT.STATE_CHANGE,MT.AP_CONNECTED);const{addressList:o,ticket:s}=r;return this._ticket=s,o}async connectWorker(e){this.emit(OT.STATE_CHANGE,MT.CONNECT_WORKER),await this._workerConnection.init(e,1e4)}handleWorkerEvents(){this._workerConnection.on(IS.CONNECTED,(async()=>{this.emit(OT.STATE_CHANGE,MT.WORKER_CONNECTED,this._workerConnection.url),this.connectionState=AT.CONNECTED})),this._workerConnection.on(IS.CLOSED,(()=>{this.connectionState=AT.CLOSED})),this._workerConnection.on(IS.FAILED,(()=>{this.connectionState=AT.CLOSED})),this._workerConnection.on(IS.RECONNECTING,(()=>{this.connectionState=this.connectionState===AT.CONNECTED?AT.RECONNECTING:AT.CONNECTING})),this._workerConnection.on(IS.ON_MESSAGE,(async e=>{if(e.data instanceof ArrayBuffer){const t=VL(new Uint8Array(e.data));Pw("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&Yw.debug("[".concat(this._moderationId,"] Response message for worker of image moderation "),JSON.stringify(t)),this._uploadNum++,void 0===t.code||0===t.code||(this._uploadFailedNum++,Yw.error("[".concat(this._moderationId,"] Error response from worke, code is ").concat(t.code,", msg is ").concat(t.msg)),this._uploadTimer||(this._uploadTimer=window.setTimeout((()=>{aS.reportApiInvoke(this._connectInfo.sid||null,{name:aE.IMAGE_MODERATION_UPLOAD,options:[this._uploadFailedNum,this._uploadNum,t.code],tag:cE.TRACER}).onError(new jS(Bv.IMAGE_MODERATION_UPLOAD_FAILED,t.msg)),this._uploadTimer=null}),Pw("IMAGE_MODERATION_UPLOAD_REPORT_INTERVAL"))))}else Yw.error("[".concat(this._moderationId,"] Unexpected message type from worker"))})),this._workerConnection.on(IS.WILL_RECONNECT,((e,t,i)=>{"recover"===e&&i(e),i("tryNext")})),this._workerConnection.on(IS.REQUEST_NEW_URLS,((e,t)=>{this.requestAP(this._connectInfo,this._cancelTokenSource.token,this._retryConfig).then(e).catch(t)}))}static intToLong(e){return{low:e|=0,high:e>>31,unsigned:e>=0}}async requestToInspectImage(){const e=yE(this,OT.CLIENT_LOCAL_VIDEO_TRACK),t={appId:this._connectInfo.appId,cname:this._connectInfo.cname,cid:this._connectInfo.cid,sid:this._connectInfo.sid,uid:this._connectInfo.uid,vid:this._connectInfo.vid};if(e){if(!e.isPlaying)return void(Pw("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&Yw.debug("Only the track being played can be inspected"));this._sequence++;const i=await this.generateRequestData(e,t);this._workerConnection.sendMessage(i,!0,!0)}else Pw("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")&&Yw.debug("Only the track being published can be inspected")}async generateRequestData(e,t){let{appId:i,cname:n,cid:r,vid:o,sid:s,uid:a}=t;const c=Date.now(),u=await e.getCurrentFrameImage("image/jpeg",this.quality),d=await OA(u,i,n),l=this._sequence+"-"+r+"-"+a+"-"+c+"-"+BE(12,""),h={appId:i,cid:r,cname:n,deviceId:"",elapse:mx.intToLong(Number(c-this._moderationStartTime)),fileSize:u.buffer.byteLength,height:u.height,width:u.width,jpg:d,networkType:6,osType:7,requestId:l,sdkVersion:"4.20.0",sequence:this._sequence,sid:s,timestamp:fx(c),uid:a,vid:o,service:this._moderationMode,ticket:this._ticket,callbackData:this._extraInfo,vendorConfigs:this._vendor};void 0===this._extraInfo&&delete h.callbackData;const f=UL(h);if(f.byteLength<this._workerMessageLengthLimit){if(Pw("SHOW_IMAGE_MODERATION_WORKER_MESSAGE")){const e=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?px(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):px(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},h);delete e.jpg,Yw.debug("[".concat(this._moderationId,"] Request message for worker of image moderation service: "),JSON.stringify(e))}return f}{const t=this.quality*this._qualityRatio;return this.quality=t,await this.generateRequestData(e,{appId:i,cname:n,cid:r,vid:o,sid:s,uid:a})}}close(){this._cancelTokenSource.cancel(),this._cancelTokenSource=gw.CancelToken.source(),this._workerConnection&&this._workerConnection.close(),this._moderationTimer&&window.clearInterval(this._moderationTimer),this._moderationTimer=null,this._uploadTimer&&window.clearTimeout(this._uploadTimer),this._uploadTimer=null,this.connectionState=AT.CLOSED,this.emit(OT.STATE_CHANGE,MT.CLOSED)}}function _x(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function gx(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?_x(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):_x(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}const vx=Date.now(),Ex=20,bx=new Map,yx=new Map;async function wx(e){const t=bx.get(e),i=Array.isArray(t)&&t[t.length-1],n=yx.get(e);if(!i)return void(n.isSyncing=!1);const r={uid:i.uid,payload:PE(i.payload)};0===n.firstRecvTs&&(n.firstRecvTs=i.recvTs,n.firstSendTs=i.sendTs);const o=i.sendTs-n.firstSendTs,s=o-(Date.now()-n.firstRecvTs);s>0&&(n.firstRecvTs=Date.now()-o);let a=i.mediaDelay+s;a<=0?(t.pop(),Sx(i.context,r),a=0):a=Math.min(a,Ex),setTimeout((()=>t.length&&wx(e)),a)}function Sx(e,t){e.safeEmit(lE.STREAM_MESSAGE,t.uid,t.payload),e.onStreamMessage&&e.onStreamMessage(t)}function Tx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(!e.syncWithAudio)return Sx(i,{uid:e.uid,payload:PE(e.payload)});const n="".concat(i.id,"-").concat(e.uid),r=bx.get(n)||[],o=r.findIndex((t=>e.sendTs>=t.sendTs)),s=gx(gx({},e),{},{context:i,mediaDelay:t,recvTs:Date.now()});-1===o?r.push(s):r.splice(o,0,s),bx.set(n,r);let a=!1;var c;yx.has(n)?a=!(null===(c=yx.get(n))||void 0===c||!c.isSyncing):yx.set(n,{isSyncing:a,firstRecvTs:0,firstSendTs:0}),a||wx(n)}const Rx=mv().name;function Cx(){return!function(e,t,i){const n=mv();if(n.os!==uv.IOS||!n.osVersion)return!1;const r=n.osVersion.split(".");return i?t&&Number(r[0])===e&&Number(r[1])<t||Number(r[0])<e:t?Number(r[0])===e&&Number(r[1])<=t||Number(r[0])<e:Number(r[0])<=e}(16,0,!0)&&!function(e,t,i){const n=mv();if(n.name!==dv.SAFARI||!n.osVersion)return!1;const r=n.version.split(".");return i?t&&Number(r[0])===e&&Number(r[1])<t||Number(r[0])<e:t?Number(r[0])===e&&Number(r[1])<=t||Number(r[0])<e:Number(r[0])<=e}(16,0,!0)}function Ix(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Ax(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Ix(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ix(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}YE.setLogger(Yw);class Ox extends rE{get connectionState(){return this._gateway.state}get remoteUsers(){return this._users}get localTracks(){return this._p2pChannel.getAllTracks(!0)}get uid(){return this._uid}get channelName(){return this._channelName}get localDataChannels(){return this._p2pChannel.getAllDataChannels()}get mode(){return this._config.mode}get role(){var e;return(null===(e=this._config)||void 0===e?void 0:e.role)||"audience"}get codec(){return this._config.codec}get audioCodec(){return this._config.audioCodec||"opus"}get isStringUID(){return!!this._joinInfo&&!!this._joinInfo.stringUid}get __className__(){return"Client"}constructor(e){let t;if(super(),oh(this,"store",void 0),oh(this,"_uid",void 0),oh(this,"_channelName",void 0),oh(this,"_uintUid",void 0),oh(this,"_users",[]),oh(this,"_config",void 0),oh(this,"_clientId",void 0),oh(this,"_appId",void 0),oh(this,"_sessionId",null),oh(this,"_key",void 0),oh(this,"_rtmConfig",{}),oh(this,"_joinInfo",void 0),oh(this,"_gateway",void 0),oh(this,"_statsCollector",void 0),oh(this,"_configDistribute",void 0),oh(this,"_leaveMutex",new YE("client-leave")),oh(this,"_publishMutex",new YE("client-publish")),oh(this,"_renewTokenMutex",new YE("client-renewtoken")),oh(this,"_subscribeMutex",new YE("client-subscribe")),oh(this,"_encryptionMode","none"),oh(this,"_encryptionSecret",null),oh(this,"_encryptionSalt",null),oh(this,"_proxyServer",void 0),oh(this,"_turnServer",{servers:[],mode:"auto"}),oh(this,"_cloudProxyServerMode","disabled"),oh(this,"_isDualStreamEnabled",!1),oh(this,"_defaultStreamFallbackType",void 0),oh(this,"_lowStreamParameter",void 0),oh(this,"_streamFallbackTypeCacheMap",new Map),oh(this,"_remoteStreamTypeCacheMap",new Map),oh(this,"_axiosCancelSource",gw.CancelToken.source()),oh(this,"_audioVolumeIndicationInterval",void 0),oh(this,"_networkQualityInterval",void 0),oh(this,"_userOfflineTimeout",void 0),oh(this,"_streamRemovedTimeout",void 0),oh(this,"_injectStreamingClient",void 0),oh(this,"_liveTranscodeStreamingClient",void 0),oh(this,"_liveRawStreamingClient",void 0),oh(this,"_channelMediaRelayClient",void 0),oh(this,"_networkQualitySensitivity","normal"),oh(this,"_p2pChannel",void 0),oh(this,"_useLocalAccessPoint",!1),oh(this,"_setLocalAPVersion",void 0),oh(this,"_joinAndNotLeaveYet",!1),oh(this,"_numberOfJoinCount",0),oh(this,"_remoteDefaultVideoStreamType",void 0),oh(this,"_inspect",void 0),oh(this,"_moderation",void 0),oh(this,"_license",void 0),oh(this,"_pendingPublishedUsers",[]),oh(this,"ntpAlignErrorCount",0),oh(this,"remoteInboundOffset",0),oh(this,"_handleLocalTrackEnable",((e,t,i)=>{this.publish(e,!1).then(t).catch(i)})),oh(this,"_handleLocalTrackDisable",((e,t,i)=>{this.unpublish(e).then(t).catch(i)})),oh(this,"_handleUserOnline",(e=>{if(Pw("BLOCK_LOCAL_CLIENT")&&hS(e.uid,this.channelName))return void Yw.debug("[".concat(e.uid,"] will be ignored in local"));this.isStringUID&&"string"!=typeof e.uid&&Yw.error("[".concat(this._clientId,"] StringUID is Mixed with UintUID"));const t=this._users.find((t=>t.uid===e.uid));if(t)t._trust_in_room_=!0,t._is_pre_created&&(t._is_pre_created=!1,this.safeEmit(lE.USER_JOINED,t));else{const t=new rD(e.uid,e.uint_id||e.uid);this._users.push(t),Yw.debug("[".concat(this._clientId,"] user online"),e.uid),this.safeEmit(lE.USER_JOINED,t)}})),oh(this,"_handleUserOffline",(e=>{if(Pw("BLOCK_LOCAL_CLIENT")&&hS(e.uid,this.channelName))return;const t=this._users.find((t=>t.uid===e.uid));t&&(this._handleRemoveStream(e),this._handleRemoveDataChannels(e),t._audio_pre_subscribed||t._video_pre_subscribed?t._is_pre_created=!0:CE(this._users,t),this._remoteStreamTypeCacheMap.delete(t.uid),this._streamFallbackTypeCacheMap.delete(t.uid),Yw.debug("[".concat(this._clientId,"] user offline"),e.uid,"reason:",e.reason),this.safeEmit(lE.USER_LEAVED,t,e.reason))})),oh(this,"_handleAddAudioOrVideoStream",((e,t,i,n,r,o,s)=>{if(Pw("BLOCK_LOCAL_CLIENT")&&hS(t,this.channelName))return;const a=this._users.find((e=>e.uid===t));if(!a)return void Yw.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));Yw.debug("[".concat(this._clientId,"] stream added with uid ").concat(t,", type ").concat(e)),this.store.subscribe(a.uid,e,void 0,void 0,void 0,Date.now());const c="audio"===e?a.hasAudio:a.hasVideo;a._uintid||(a._uintid=r||t),"audio"===e?a._trust_audio_stream_added_state_=!0:a._trust_video_stream_added_state_=!0,"audio"===e?(a._audio_added_=!0,void 0!==i&&(a._audioSSRC=i),void 0!==n&&(a._cname=n),o&&(a._audioOrtc=o)):(a._video_added_=!0,void 0!==i&&(a._videoSSRC=i),void 0!==n&&(a._cname=n),void 0!==s&&(a._rtxSsrcId=s),o&&(a._videoOrtc=o)),("audio"===e?a.hasAudio:a.hasVideo)&&!c&&(Yw.info("[".concat(this._clientId,"] remote user ").concat(a.uid," published ").concat(e)),this.safeEmit(lE.USER_PUBLISHED,a,e)),"video"===e?aS.onGatewayStream(this._sessionId,$w.ON_ADD_VIDEO_STREAM,eS.ON_ADD_VIDEO_STREAM,{peer:r||t,ssrc:a._videoSSRC}):aS.onGatewayStream(this._sessionId,$w.ON_ADD_AUDIO_STREAM,eS.ON_ADD_AUDIO_STREAM,{peer:r||t,ssrc:a._audioSSRC}),this._p2pChannel.remoteMediaSsrcChanged(a,e,i).then((t=>{if(t&&(Yw.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(a.uid," after rejoin because SSRC id changed.")),this._p2pChannel instanceof oL))return this._p2pChannel.unsubscribe(a,e,!0).then((()=>this._subscribe(a,e,!0).catch((e=>{Yw.error("[".concat(this._clientId,"] resubscribe error"),e.toString())}))))})),this._p2pChannel.hasPendingRemoteMedia(a,e)&&(Yw.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(a.uid," after reconnect.")),this._subscribe(a,e,!0).catch((e=>{Yw.error("[".concat(this._clientId,"] resubscribe error"),e.toString())})))})),oh(this,"_handleRemoveStream",(e=>{if(Pw("BLOCK_LOCAL_CLIENT")&&hS(e.uid,this.channelName))return;const t=this._users.find((t=>t.uid===e.uid));if(!t)return void Yw.warning("[".concat(this._clientId,"] can not find target user!(on_remove_stream)"));Yw.debug("[".concat(this._clientId,"] stream removed with uid ").concat(e.uid));let i=()=>{};t.hasAudio&&t.hasVideo?i=()=>{Yw.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),this.safeEmit(lE.USER_UNPUBLISHED,t,"audio"),Yw.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),this.safeEmit(lE.USER_UNPUBLISHED,t,"video")}:t.hasVideo?i=()=>{Yw.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished video track")),this.safeEmit(lE.USER_UNPUBLISHED,t,"video")}:t.hasAudio&&(i=()=>{Yw.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished audio track")),this.safeEmit(lE.USER_UNPUBLISHED,t,"audio")}),t._video_pre_subscribed||t._audio_pre_subscribed||(t._trust_audio_stream_added_state_=!0,t._trust_video_stream_added_state_=!0,t._audio_added_=!1,t._video_added_=!1,this._p2pChannel instanceof oL&&this._p2pChannel.unsubscribe(t).then((e=>{if(e)return this._gateway.unsubscribe(e,t.uid)})),t._audioSSRC=void 0,t._videoSSRC=void 0,t._audioOrtc=void 0,t._videoOrtc=void 0,t._rtxSsrcId=void 0),aS.onGatewayStream(this._sessionId,$w.ON_REMOVE_STREAM,eS.ON_REMOVE_STREAM,{peer:e.uint_id||e.uid}),i()})),oh(this,"_handleSetStreamLocalEnable",((e,t,i)=>{if(Pw("BLOCK_LOCAL_CLIENT")&&hS(t,this.channelName))return;const n=this._users.find((e=>e.uid===t));if(!n)return void Yw.error("[".concat(this._clientId,"] can not find target user!(disable_local)"));Yw.debug("[".concat(this._clientId,"] local ").concat(e," ").concat(i?"enabled":"disabled"," with uid ").concat(t));const r="audio"===e?n.hasAudio:n.hasVideo;if("audio"===e){n._trust_audio_enabled_state_=!0;const e=n._audio_enabled_;if(n._audio_enabled_=i,n._audio_enabled_===e)return;{const e=n._audio_enabled_?"enable-local-audio":"disable-local-audio";Yw.debug("[".concat(this._clientId,"] user-info-updated, uid: ").concat(t,", msg: ").concat(e)),this.safeEmit(lE.USER_INFO_UPDATED,t,e)}}else{n._trust_video_enabled_state_=!0;const e=n._video_enabled_;if(n._video_enabled_=i,n._video_enabled_===e)return;{const e=n._video_enabled_?"enable-local-video":"disable-local-video";Yw.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(t,", msg: ").concat(e)),this.safeEmit(lE.USER_INFO_UPDATED,t,e)}}const o="audio"===e?n.hasAudio:n.hasVideo;return r!==o?!r&&o?(Yw.info("[".concat(this._clientId,"] remote user ").concat(t," published ").concat(e)),void this.safeEmit(lE.USER_PUBLISHED,n,e)):("video"===e&&n._videoTrack&&n._videoTrack._destroy(),"audio"===e&&n._audioTrack,this._p2pChannel.muteRemote(n,e),Yw.info("[".concat(this._clientId,"] remote user ").concat(t," unpublished ").concat(e)),void this.safeEmit(lE.USER_UNPUBLISHED,n,e)):void 0})),oh(this,"_handleMuteStream",((e,t,i)=>{if(Pw("BLOCK_LOCAL_CLIENT")&&hS(e,this.channelName))return;Yw.debug("[".concat(this._clientId,"] receive mute message"),e,t,i);const n=this._users.find((t=>t.uid===e));if(!n)return void Yw.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(e));const r="audio"===t?n.hasAudio:n.hasVideo;if("audio"===t){n._trust_audio_mute_state_=!0;const t=n._audio_muted_;if(n._audio_muted_=i,n._audio_muted_===t)return;{const t=n._audio_muted_?"mute-audio":"unmute-audio";Yw.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),this.safeEmit(lE.USER_INFO_UPDATED,e,t)}}else{n._trust_video_mute_state_=!0;const t=n._video_muted_;if(n._video_muted_=i,n._video_muted_===t)return;{const t=n._video_muted_?"mute-video":"unmute-video";Yw.debug("[".concat(this._clientId,"] user-info-update, uid: ").concat(e,", msg: ").concat(t)),this.safeEmit(lE.USER_INFO_UPDATED,e,t)}}const o="audio"===t?n.hasAudio:n.hasVideo;if(r!==o){if(!r&&o)return("audio"===t?n._audioSSRC:n._videoSSRC)?(Yw.info("[".concat(this._clientId,"] remote user ").concat(e," published ").concat(t)),void this.safeEmit(lE.USER_PUBLISHED,n,t)):void Yw.warning("[".concat(this._clientId,"] remote user ").concat(e," receive ").concat(t," unmute message  before add stream message, ").concat(t," SSRC doesn't exist yet."));"video"===t&&n._videoTrack&&!n._video_pre_subscribed&&n._videoTrack._destroy(),"audio"===t&&n._audioTrack,this._p2pChannel.muteRemote(n,t),Yw.info("[".concat(this._clientId,"] remote user ").concat(e," unpublished ").concat(t)),this.safeEmit(lE.USER_UNPUBLISHED,n,t)}})),oh(this,"_handleP2PLost",(async e=>{Yw.debug("[".concat(this._clientId,"] receive p2p lost"),e),parseInt(e.p2pid,10)===this.store.p2pId?await this._p2pChannel.requestReconnect():Yw.warning("[".concat(this._clientId,"] P2PLost stream not found"),e)})),oh(this,"_handleTokenWillExpire",(()=>{Yw.debug("[".concat(this._clientId,"] received message onTokenPrivilegeWillExpire")),this.safeEmit(lE.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)})),oh(this,"_handleBeforeUnload",(e=>{"beforeunload"===e.type&&void 0!==e.returnValue&&""!==e.returnValue||(this.leave(),Yw.info("[".concat(this._clientId,"] auto leave onbeforeunload or pagehide")))})),oh(this,"_handleUpdateNetworkQuality",(()=>{if("normal"===this._networkQualitySensitivity)return;if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void this.safeEmit(lE.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});const e={downlinkNetworkQuality:0,uplinkNetworkQuality:0};e.uplinkNetworkQuality=this._p2pChannel.getUplinkNetworkQuality(),e.downlinkNetworkQuality=this._p2pChannel.getDownlinkNetworkQuality(),this.safeEmit(lE.NETWORK_QUALITY,e)})),oh(this,"_handleP2PAddAudioOrVideoStream",((e,t,i,n)=>{const r=this._users.find((e=>e.uid===t));if(!r)return void Yw.error("[".concat(this._clientId,"] can not find target user!(on_add_stream)"));Yw.debug("[".concat(this._clientId,"] stream added with uid ").concat(t,", type ").concat(e)),this.store.subscribe(r.uid,e,void 0,void 0,void 0,Date.now());const o="audio"===e?r.hasAudio:r.hasVideo;"audio"===e?r._trust_audio_stream_added_state_=!0:r._trust_video_stream_added_state_=!0,"audio"===e?(r._audio_added_=!0,void 0!==i&&(r._audioSSRC=i),void 0!==n&&(r._audioMid=n)):(r._video_added_=!0,void 0!==i&&(r._videoSSRC=i),void 0!==n&&(r._videoMid=n)),("audio"===e?r.hasAudio:r.hasVideo)&&!o&&(Yw.info("[".concat(this._clientId,"] remote user ").concat(r.uid," published ").concat(e)),this.safeEmit(lE.USER_PUBLISHED,r,e)),this._p2pChannel.hasPendingRemoteMedia(r,e)&&(Yw.debug("[".concat(this._clientId,"] resubscribe ").concat(e," for user ").concat(r.uid," after reconnect.")),this._subscribe(r,e,!0).catch((e=>{Yw.error("[".concat(this._clientId,"] resubscribe error"),e.toString())})))})),this._config=e,this._clientId=BE(5,"client-"),this.store=new jw(e.codec,e.audioCodec,e.mode,this._clientId),this.store.clientCreated(),e.proxyServer&&this.setProxyServer(e.proxyServer,!0),e.turnServer&&this.setTurnServer(e.turnServer,!0),Yw.info("[".concat(this._clientId,"] Initializing AgoraRTC client v").concat(Iw," build: ").concat(Mw,", mode: ").concat(this.mode,", codec: ").concat(this.codec)),e.clientRoleOptions)try{vE(e.clientRoleOptions),t=Object.assign({},e.clientRoleOptions)}catch(e){Yw.warning("[".concat(this._clientId,"] ").concat(e.toString()))}this._statsCollector=new fD(this.store),this._statsCollector.onStatsException=(e,t,i)=>{Yw.debug("[".concat(this._clientId,"] receive exception msg, code: ").concat(e,", msg: ").concat(t,", uid: ").concat(i)),this.safeEmit(lE.EXCEPTION,{code:e,msg:t,uid:i})},this._statsCollector.onUploadPublishDuration=(e,t,i,n)=>{const r=this._users.find((t=>t.uid===e));r&&aS.peerPublishStatus(this._sessionId,{subscribeElapse:n,audioPublishDuration:t,videoPublishDuration:i,peer:r._uintid})},this.store.useDataChannel=MC().supportDataChannel&&Pw("SIGNAL_CHANNEL"),this.store.useP2P="p2p"===e.mode,this._gateway=new HR(this.store,{clientId:this._clientId,mode:this.mode,codec:this.codec,websocketRetryConfig:e.websocketRetryConfig||XE,httpRetryConfig:e.httpRetryConfig||XE,forceWaitGatewayResponse:void 0===e.forceWaitGatewayResponse||e.forceWaitGatewayResponse,statsCollector:this._statsCollector,role:e.role,clientRoleOptions:t}),this._configDistribute=new AC,this.store.useP2P?(this._p2pChannel=new uD(this.store,this._statsCollector),this._handleP2PEvents()):this._p2pChannel=new oL(this.store,this._statsCollector),this._handleP2PChannelEvents(),this._handleGatewayEvents(),this._handleGatewaySignalEvents()}async joinMeta(e,t,i,n,r){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];kw("JOIN_GATEWAY_USE_443PORT_ONLY",o),kw("JOIN_GATEWAY_USE_DUAL_DOMAIN",s);const a=this._gateway.signal.websocket;return a instanceof eR&&(a.use443PortOnly=o,a.tryDoubleDomain=s),async function(e,t,i){sv.get(e)||sv.set(e,[]),av.get(e)||av.set(e,t),cv.get(e)||cv.set(e,0);const n=sv.get(e),r=av.get(e);if(!n||!r)throw new Error("concurrent: deferQueue or maxConcurrency is null");if(cv.get(e)===r){const e=ov();n.push(e),await e.promise}cv.set(e,cv.get(e)+1);for(var o=arguments.length,s=new Array(o>3?o-3:0),a=3;a<o;a++)s[a-3]=arguments[a];const c=await i(...s);return cv.set(e,cv.get(e)-1),cv.get(e)===r-1&&n.length>0&&(n[0].resolve(),n.shift()),0===cv.get(e)&&(sv.set(e,[]),av.set(e,0),cv.set(e,0)),c}("client.join",Pw("JOIN_MAX_CONCURRENCY"),this.join.bind(this),e,t,i,n,r)}async join(e,t,i,n,r){const o=++this._numberOfJoinCount;this.store.joinStart(),n&&(this.store.uid=n);const s=Rw(),a=Cw()?window.isSecureContext:"Browser Not Support";if(!Cw()&&!s||!window.isSecureContext){const e="The website must be running in a secure context (About secure context: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts ), otherwise the media collection will be restricted by the browser";Yw.warning(e)}const c=jE();"DISCONNECTED"===this.connectionState&&(this.store.avoidJoinStart=Math.round(Date.now()),Yw.debug("[".concat(this._clientId,"] set avoidJoinStart to ").concat(this.store.avoidJoinStart)));const u=aS.reportApiInvoke(c,{name:aE.JOIN,options:[e,t,i,n],states:{isHttps:s,isSecureContext:a},tag:cE.TRACER});aS.setAppId(e);try{if(!i&&null!==i)throw new jS(Bv.INVALID_PARAMS,"Invalid token: ".concat(i,". If you don not use token, set it to null"));i&&qv(i,"token",1,2047),qv(e,"appid",1,2047),FS(t),n&&WS(n),r&&qv(r,"optionalInfo",1,2047)}catch(e){throw u.onError(e),e}if(Yw.info("[".concat(this._clientId,"] start join channel ").concat(t,", join number: ").concat(o)),this._leaveMutex.isLocked&&(Yw.debug("[".concat(this._clientId,"] join: waiting leave operation")),(await this._leaveMutex.lock())(),Yw.debug("[".concat(this._clientId,"] join: continue"))),this._joinAndNotLeaveYet=!0,"DISCONNECTED"!==this.connectionState){const e=new jS(Bv.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state"));throw u.onError(e),e}this._sessionId||(this._sessionId=c,this.store.sessionId=this._sessionId),this._gateway.state="CONNECTING";const d=Ax(Ax({},this._rtmConfig),{},{clientId:this._clientId,appId:e,sid:this._sessionId,cname:t,uid:"string"!=typeof n?n:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:i||e,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:r,license:this._license,useLocalAccessPoint:this._useLocalAccessPoint},void 0!==this._remoteDefaultVideoStreamType&&{defaultVideoStream:this._remoteDefaultVideoStreamType});if(this._useLocalAccessPoint&&(d.setLocalAPVersion=this._setLocalAPVersion),"string"==typeof n&&(d.stringUid=n,this._uintUid?(d.uid=this._uintUid,this._uintUid=void 0):d.uid=0),"none"!==this._encryptionMode&&this._encryptionSecret){if(d.aesmode=this._encryptionMode,d.aespassword=await iE(this._encryptionSecret),!this._joinAndNotLeaveYet)throw new jS(Bv.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this._encryptionSalt&&(d.aessalt=this._encryptionSalt)}this._startSession(this._sessionId,{channel:t,appId:e,stringUid:d.stringUid});const l=this._sessionId;setTimeout((()=>{"CONNECTING"===this.connectionState&&l===this._sessionId&&aS.joinChannelTimeout(this._sessionId,5)}),5e3);try{var h;let n;const r=d.cloudProxyServer;if(Mn(h=["proxy3","proxy4","proxy5"]).call(h,r)){const e=Pw("PROXY_SERVER_TYPE3");Array.isArray(e)?d.proxyServer=e[0]:d.proxyServer=e}if(aS.setProxyServer(d.proxyServer),Yw.setProxyServer(d.proxyServer),this.store.requestAPStart(),d.stringUid&&!d.uid){let e;[e,n]=await nv.all([bC(d.stringUid,d,this._axiosCancelSource.token,this._config.httpRetryConfig||XE,this.store),EC(d,this._axiosCancelSource.token,this._config.httpRetryConfig||XE,!0,this.store)]),Yw.debug("[".concat(this._clientId,"] getUserAccount Success ").concat(d.stringUid," => ").concat(e)),d.uid=e,n.gatewayInfo.uid=e,n.gatewayInfo.res.uid=e}else n=await EC(d,this._axiosCancelSource.token,this._config.httpRetryConfig||XE,!0,this.store);if(!this._joinAndNotLeaveYet)throw new jS(Bv.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));this.store.requestAPEnd(),setTimeout((()=>{this._configDistribute.startGetConfigDistribute(d,this._axiosCancelSource.token),this._configDistribute.on(hT.UPDATE_BITRATE_LIMIT,(e=>{this._p2pChannel.updateBitrateLimit(e)}))}),0),this._key=i||e;const o=n.gatewayInfo,s=d.uid?d.uid:o.uid;this._joinInfo=Ax(Ax({},d),{},{cid:o.cid,uid:s,vid:o.vid,apResponse:o.res,uni_lbs_ip:o.uni_lbs_ip,gatewayAddrs:o.gatewayAddrs}),this.store.intUid=s;const a=await this._joinGateway();if(!this._joinAndNotLeaveYet)throw new jS(Bv.INVALID_OPERATION,"[".concat(this._clientId,"] Client already left"));u.onSuccess(a),this._appId=e,this._channelName=d.cname,this._uid=a,this.store.uid=a,setTimeout((()=>{this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener(wv()?"beforeunload":"pagehide",this._handleBeforeUnload)}),0);const c=d.stringUid?"string uid: ".concat(d.stringUid,",uid: ").concat(d.uid):"uid: ".concat(this._uid);return Yw.info("[".concat(this._clientId,"] Joining channel success: channel: ").concat(t,",").concat(c)),setTimeout((()=>{Yw.startUpload()}),5e3),this.store.joinEnd(),f=this,Mn(lS).call(lS,f)||lS.push(f),a}catch(e){const t=Array.isArray(e)?e[0]:e;throw t&&t.code===Bv.OPERATION_ABORTED?Yw.warning("[".concat(this._clientId,"] join number: ").concat(o,", Joining channel failed, rollback"),t):Yw.error("[".concat(this._clientId,"] join number: ").concat(o,", Joining channel failed, rollback"),t),t.code!==Bv.OPERATION_ABORTED&&this._numberOfJoinCount===o&&(this._gateway.state="DISCONNECTED",this._reset()),u.onError(t),t}var f}_joinGateway(){if(!this._joinInfo||!this._key)throw new jS(Bv.INVALID_OPERATION);return this._gateway.join(this._joinInfo,this._key,!("disabled"!==this._joinInfo.cloudProxyServer||this._joinInfo.proxyServer||!Pw("JOIN_WITH_FALLBACK_SIGNAL_PROXY"))).then((e=>e)).catch((e=>{if(e.code===Bv.INIT_WEBSOCKET_TIMEOUT)return this._gateway.leave(!0,dE.FALLBACK),e;if(e.code===Bv.INIT_DATACHANNEL_TIMEOUT)return this._gateway.leave(!0,dE.FALLBACK),e;throw e})).then((e=>{if(e instanceof jS){if(e.code===Bv.INIT_WEBSOCKET_TIMEOUT){if(Yw.info("[".concat(this._clientId,"] join timeout, fallback to proxy")),!this._joinInfo||!this._key)throw new jS(Bv.INVALID_OPERATION);this._joinInfo.cloudProxyServer="fallback",this._cloudProxyServerMode="fallback",this.store.cloudProxyServerMode="fallback";const e=Pw("PROXY_SERVER_TYPE3");if(Array.isArray(e))if(this._joinInfo.apUrl){const t=/^https?:\/\/(.+?)(\/.*)?$/.exec(this._joinInfo.apUrl)[1].split("."),i=t.slice(t.length-2).join(".");e.forEach((e=>{this._joinInfo&&Mn(e).call(e,i)&&(this._joinInfo.proxyServer=e)})),this._joinInfo.proxyServer||(this._joinInfo.proxyServer=e[0])}else this._joinInfo.proxyServer=e[0];else this._joinInfo.proxyServer=e;const t=Pw("LOG_UPLOAD_SERVER").match(/.+:(\d{1,5})$/);return t&&t[1]&&"443"!==t[1]&&Yw.setProxyServer(this._joinInfo.proxyServer),"443"!==Pw("STATS_COLLECTOR_PORT").toString()&&aS.setProxyServer(this._joinInfo.proxyServer),aS.reportApiInvoke(this._sessionId,{name:aE.JOIN_FALLBACK_TO_PROXY,options:[this._joinInfo.proxyServer],tag:cE.TRACER}).onSuccess(),this.safeEmit(lE.JOIN_FALLBACK_TO_PROXY,this._joinInfo.proxyServer),Pw("JOIN_WITH_FALLBACK_MEDIA_PROXY_FORCE")&&this._joinInfo.turnServer.servers.forEach((e=>{"forceturn"in e&&(e.forceturn=!0)})),this._gateway.join(this._joinInfo,this._key)}if(Yw.info("[".concat(this._clientId,"] join by datachannel timeout, fallback to websocket")),!this._joinInfo||!this._key)throw new jS(Bv.INVALID_OPERATION);return aS.reportApiInvoke(this._sessionId,{name:aE.DATACHANNEL_FAILBACK,options:[this.store.clientId],tag:cE.TRACER}).onSuccess(),this._joinGateway()}return e})).then((e=>e))}async leave(){Yw.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener(wv()?"beforeunload":"pagehide",this._handleBeforeUnload),this._reset(),function(e){const t=lS.indexOf(e);-1!==t&&lS.splice(t,1)}(this);const e=await this._leaveMutex.lock();if("DISCONNECTED"===this.connectionState)return Yw.info("[".concat(this._clientId,"] Leaving channel repeated, success")),void e();await this._gateway.leave("CONNECTED"!==this.connectionState),Yw.info("[".concat(this._clientId,"] Leaving channel success")),this._joinAndNotLeaveYet=!1,this.store.resetJoinChannelServiceRecords(),e()}async publish(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!Array.isArray(e)){if(!(e instanceof _I))return this._publishDataChannel(e);e=[e]}if(0===e.length)throw new jS(Bv.INVALID_PARAMS,"param list is empty");const i=e;if("audience"===this._gateway.role)throw new jS(Bv.INVALID_OPERATION,"audience can not publish stream");for(const r of i){if(!(r instanceof _I))throw new jS(Bv.INVALID_PARAMS,"parameter is not local track");if(!r._enabled&&t)throw new jS(Bv.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(r.getTrackId()))}Yw.info("[".concat(this._clientId,"] Publishing tracks, id ").concat(i.map((e=>"".concat(e.getTrackId()," ")))));const n=await this._publishMutex.lock();await this._configDistribute.awaitConfigDistributeComplete(),t&&i.forEach((e=>{const t=this._configDistribute.getBitrateLimit();e instanceof kA&&t&&e.setBitrateLimit(t.uplink)}));try{await this._publishHighStream(i),Yw.info("[".concat(this._clientId,"] Publish success, id ").concat(i.map((e=>"".concat(e.getTrackId()," ")))))}catch(e){throw Yw.error("[".concat(this._clientId,"] publish error"),e.toString()),e}finally{n()}}async _publishDataChannel(e){Gv(e.id,"id",0,65535,!0),Fv(e.ordered,"ordered"),qv(e.metadata,"metadata",0,512),Yw.info("[".concat(this._clientId,"] Publishing datachannels, id ").concat(e.id));const t=await this._publishMutex.lock();try{if(-1!==this._p2pChannel.getAllDataChannels().findIndex((t=>t.id===e.id)))throw new jS(Bv.INVALID_PARAMS,"Invalid id: ".concat(e.id,". If you want to republish the datachannel, unpublish first"));if(!this._joinInfo||void 0===this._uid)throw new jS(Bv.INVALID_OPERATION,"Can't publish datachannel, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"can not publish datachannel in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&Pw("FORCE_TURN")&&!Pw("TURN_ENABLE_TCP")&&!Pw("TURN_ENABLE_UDP"))throw new jS(Bv.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");const t=new gk(e);await this._p2pChannel.publishDataChannel([t]);try{const i={streamId:e.id,ordered:e.ordered,maxRetransmits:Pw("DATASTREAM_MAX_RETRANSMITS"),metadata:e.metadata,channelId:t._originDataChannelId};await this._gateway.publishDataChannel(this._uid,i,!0)}catch(e){if(e.code!==Bv.DISCONNECT_P2P)throw e}return await t._waitTillOpen(),Yw.info("[".concat(this._clientId,"] Publish dataChannels success, id ").concat(t.id)),t}catch(e){throw Yw.error("[".concat(this._clientId,"] publish datachannels error"),e.toString()),e}finally{t()}}async unpublish(e){if(!this._joinInfo||void 0===this._uid)throw new jS(Bv.INVALID_OPERATION,"Can't unpublish stream, haven't joined yet!");let t=[];if(e)if(Array.isArray(e))t=e;else{if(!(e instanceof _I))return this._unpublishDataChannel([e]);t=[e]}else this.store.useP2P||await this._unpublishDataChannel(),t=this._p2pChannel.getAllTracks(!0);Yw.info("[".concat(this._clientId,"] Unpublish tracks, tracks ").concat(t.map((e=>"".concat(e.getTrackId()," ")))," "));const i=await this._publishMutex.lock();try{if(this._p2pChannel instanceof uD){const e=await this._p2pChannel.unpublish(t);e&&await this._gateway.sendExtensionMessage(NT.UNPUBLISH,{unpubMsg:e},!0)}else{const e=await this._p2pChannel.unpublish(t);e&&await this._gateway.unpublish(e,this._uid),Yw.info("[".concat(this._clientId,"] Unpublish success,tracks ").concat(t.map((e=>"".concat(e.getTrackId())))))}}catch(e){throw Yw.error("[".concat(this._clientId,"] unpublish error"),e.toString()),e}finally{i&&i()}}async _unpublishDataChannel(e){void 0!==e&&0!==e.length||(e=this._p2pChannel.getAllDataChannels()),Yw.info("[".concat(this._clientId,"] Unpublish datachannels, datachannels ").concat(e.map((e=>"".concat(e.id," ")))," "));const t=await this._publishMutex.lock();try{const t=await this._p2pChannel.unpublishDataChannel(e);t&&await this._gateway.unpublishDataChannel(t),Yw.info("[".concat(this._clientId,"] Unpublish dataChannel success,dataChannel ").concat(e.map((e=>"".concat(e.id)))))}catch(e){throw Yw.error("[".concat(this._clientId,"] unpublish dataChannel error"),e.toString()),e}finally{t&&t()}}async subscribe(e,t,i){return"datachannel"===t?this._subscribeDataChannel(e,i):this._subscribe(e,t)}async presubscribe(e,t){if(Wv(t,"mediaType",["audio","video"]),this._p2pChannel instanceof uD)throw new jS(Bv.INVALID_OPERATION,"can't presub at p2p mode");if(!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"can't presub when not join");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"can't presub in ".concat(this.connectionState," state"));const i=t===pT.AUDIO,n=t===pT.VIDEO,r=await this._subscribeMutex.lock();try{const{ssrcId:r,ortc:o,rtxSsrcId:s,cname:a,uint_id:c}=await this._gateway.presubscribe(e,t,!0);if(null==r)throw new jS(Bv.UNEXPECTED_RESPONSE,"no ssrc id");let u=this._users.find((t=>t.uid===e));u||(u=new rD(e,c||e),u._is_pre_created=!0,this._users.push(u)),a&&(u._cname=a),u._uintid||(u._uintid=c||e),i&&(u._audioSSRC=r,u._audio_pre_subscribed=!0,o&&(u._audioOrtc=o)),n&&(u._videoSSRC=r,u._video_pre_subscribed=!0,o&&(u._videoOrtc=o),null!=s&&(u._rtxSsrcId=s)),Yw.info("[".concat(this._clientId,"] presub succeed ssrc: ").concat(r)),await this._p2pChannel.subscribe(u,t,r,s,o);const d=i?u._audioTrack:u._videoTrack;if(!d)throw new jS(Bv.UNEXPECTED_ERROR,"can not find remote track in user");return i&&(u._trust_audio_stream_added_state_=!0,u._audio_added_=!0),n&&(u._trust_video_stream_added_state_=!0,u._video_added_=!0),d}catch(t){throw Yw.error("[".concat(this._clientId,"] presub user ").concat(e," error"),t),t}finally{r()}}async _subscribeDataChannel(e,t){var i;if(Gv(t,"channelId",0,65535,!0),!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"Can't subscribe datachannel, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"Can't subscribe datachannel in ".concat(this.connectionState," state"));if(!this._users.find((t=>t===e)))throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),new jS(Bv.INVALID_REMOTE_USER,"user is not in the channel");if(!e.hasAudio&&!e.hasVideo&&0===e._dataChannels.length)throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),new jS(Bv.INVALID_REMOTE_USER,"user is not published");const n=null===(i=e._dataChannels)||void 0===i?void 0:i.find((e=>e.id===t));if(!n)throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, remote datachannel is not published")),new jS(Bv.REMOTE_USER_IS_NOT_PUBLISHED);const r=await this._subscribeMutex.lock();Yw.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: datachannel"));try{const i=await this._p2pChannel.subscribeDataChannel(e,[n]);if(i&&Mn(i).call(i,n.id))try{var o;if(!n._originDataChannelId)throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType datachannel, cannot get RTCDatachannel")),new jS(Bv.REMOTE_USER_IS_NOT_PUBLISHED);const t={id:n.id,datachannelId:n._originDataChannelId,ordered:n.ordered,maxRetransmits:n.maxRetransmits,metadata:null!==(o=n.metadata)&&void 0!==o?o:""};await this._gateway.subscribeDataChannel(e.uid,t,!0)}catch(t){if((null==t?void 0:t.code)!==Bv.WS_ABORT)throw await this._p2pChannel.unsubscribeDataChannel(e,[n]),t;await this._p2pChannel.unsubscribeDataChannel(e,[n]),this._p2pChannel.setPendingRemoteDataChannel(e,n.id)}return await n._waitTillOpen(),Yw.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: datachannel")),n}finally{r()}}async _p2pSubscribe(e,t,i){if(Wv(t,"mediaType",["audio","video"]),!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find((t=>t===e))){const t=new jS(Bv.INVALID_REMOTE_USER,"user is not in the channel");throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),t}if(!e.hasAudio&&!e.hasVideo){const t=new jS(Bv.INVALID_REMOTE_USER,"user is not published");throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),t}if(!i&&("audio"===t&&!e.hasAudio||"video"===t&&!e.hasVideo)){const i=new jS(Bv.REMOTE_USER_IS_NOT_PUBLISHED);throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),i}const n=await this._subscribeMutex.lock();Yw.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const i="audio"===t?e._audioSSRC:e._videoSSRC,n="audio"===t?e._audioMid:e._videoMid;this.store.subscribe(e.uid,t,Date.now()),this._p2pChannel instanceof uD&&await this._p2pChannel.subscribe(e,t,i,n)}catch(e){throw e}Yw.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch((e=>{Yw.warning("[".concat(this._clientId,"] auto set fallback failed"),e)}));const i="audio"===t?e._audioTrack:e._videoTrack;if(!i)throw new jS(Bv.UNEXPECTED_ERROR,"can not find remote track in user object");return i}catch(t){throw Yw.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),t),t}finally{n()}}async _subscribe(e,t,i){if(this._p2pChannel instanceof uD)return this._p2pSubscribe(e,t);if(Wv(t,"mediaType",["audio","video"]),!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));if(!this._users.find((t=>t===e))){const t=new jS(Bv.INVALID_REMOTE_USER,"user is not in the channel");throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", this user is not in the channel")),t}if(!e.hasAudio&&!e.hasVideo){const t=new jS(Bv.INVALID_REMOTE_USER,"user is not published");throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid,", user is not published")),t}if(!(i||("audio"!==t||e.hasAudio&&void 0!==e._audioSSRC)&&("video"!==t||e.hasVideo&&void 0!==e._videoSSRC))){const i=new jS(Bv.REMOTE_USER_IS_NOT_PUBLISHED);throw Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(e.uid," with mediaType ").concat(t,", remote track is not published")),i}let n="audio"===t?e._audioSSRC:e._videoSSRC,r="audio"===t?e._audioOrtc:e._videoOrtc,o="video"===t?e._rtxSsrcId:void 0,s={stream_type:"audio"===t?pT.AUDIO:pT.VIDEO,ssrcId:n};const a=await this._subscribeMutex.lock();Yw.info("[".concat(this._clientId,"] subscribe user ").concat(e.uid,", mediaType: ").concat(t));try{if(await this._p2pChannel.hasRemoteMediaWithLock(e,t))await this._p2pChannel.unmuteRemote(e,t);else try{const a="audio"===t?e._audioSSRC:e._videoSSRC;void 0!==a&&a!==n&&(n=a,r="audio"===t?e._audioOrtc:e._videoOrtc,o="video"===t?e._rtxSsrcId:void 0,s={stream_type:"audio"===t?pT.AUDIO:pT.VIDEO,ssrcId:n}),bk.markSubscribeStart(this.store.clientId,n),this.store.subscribe(e.uid,t,Date.now()),await this._p2pChannel.subscribe(e,t,n,o,r);try{await this._gateway.subscribe(e.uid,s,!0)}catch(i){if((null==i?void 0:i.code)!==Bv.WS_ABORT)throw await this._p2pChannel.unsubscribe(e,t),i;await this._p2pChannel.unsubscribe(e,t,!0),this._p2pChannel.setPendingRemoteMedia(e,t)}this.store.subscribe(e.uid,t,void 0,Date.now()),this._p2pChannel.reportSubscribeEvent(!0,null,e,t)}catch(i){throw this._p2pChannel.reportSubscribeEvent(!1,null==i?void 0:i.code,e,t),i}Yw.info("[".concat(this._clientId,"] subscribe success user ").concat(e.uid,", mediaType: ").concat(t)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(e.uid,this._defaultStreamFallbackType).catch((e=>{Yw.warning("[".concat(this._clientId,"] auto set fallback failed"),e)}));const a="audio"===t?e._audioTrack:e._videoTrack;if(!a)throw new jS(Bv.UNEXPECTED_ERROR,"can not find remote track in user object");return a}catch(t){throw Yw.error("[".concat(this._clientId,"] subscribe user ").concat(e.uid," error"),t),t}finally{a()}}async massSubscribe(e){if(Kv(e,"subscribeList"),!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"Can't subscribe stream, not joined");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state"));const t=Date.now(),i=new Map,n=await this._subscribeMutex.lock();Yw.info("[".concat(this._clientId,"]start massSubscribe user ").concat(e.map((e=>{let{user:t,mediaType:i}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(i)})).join("; ")));const r=(e=[...e]).map((e=>{let{user:t,mediaType:i}=e;return{user:t,mediaType:i}})),o=await this._p2pChannel.globalLock();try{var s;for(let t=e.length-1;t>=0;t--){const n=e[t],{user:o,mediaType:s}=n;if(Wv(s,"mediaType",["audio","video"]),!o){const e=new jS(Bv.INVALID_PARAMS,"user property does not exist in subscribeList item");throw Yw.error("[".concat(this._clientId,"] user property does not exist in subscribeList item")),e}if(!this._users.find((e=>e===o))){const i=new jS(Bv.INVALID_REMOTE_USER,"user is not in the channel");Yw.error("[".concat(this._clientId,"] can not massSubscribe ").concat(o.uid,", this user is not in the channel")),r[t].error=i,e.splice(t,1);continue}if("audio"===s&&(!o.hasAudio||void 0===o._audioSSRC)||"video"===s&&(!o.hasVideo||void 0===o._videoSSRC)){const i=new jS(Bv.REMOTE_USER_IS_NOT_PUBLISHED);Yw.error("[".concat(this._clientId,"] can not subscribe ").concat(o.uid," with mediaType ").concat(s,", remote user is not published")),r[t].error=i,e.splice(t,1);continue}const a=oT.Video|oT.LwoVideo,c=i.get(o);if(c){if("video"===s?c&a:c&oT.Audio){e.splice(t,1),Yw.warning("[".concat(this._clientId,"] repeat massSubscribe user:").concat(o.uid,", mediaType:").concat(s," twice"));continue}i.set(o,c|("video"===s?a:oT.Audio))}else i.set(o,"video"===s?a:oT.Audio)}for(let t=e.length-1;t>=0;t--){const n=e[t],{user:r,mediaType:o}=n,s=oT.Video|oT.LwoVideo;if(this._p2pChannel.hasRemoteMedia(r,o)){await this._p2pChannel.unmuteRemoteNoLock(r,o);const n=i.get(r);i.set(r,"video"===o?n^s:n^oT.Audio),e.splice(t,1)}}this.store.massSubscribe(e.map((e=>({userId:e.user.uid,type:e.mediaType}))),t);const n=db(s=Array.from(i.entries())).call(s,((e,t)=>{let[i,n]=t;if(0===n)return e;const r={stream_id:i.uid,stream_type:n};return n&oT.Audio&&(r.audio_ssrc=i._audioSSRC),n&oT.Video&&(r.video_ssrc=i._videoSSRC),e.push(r),e}),[]);try{e.length>0&&await this._p2pChannel.massSubscribeNoLock(e.map((e=>{let{user:t,mediaType:i}=e;return{user:t,mediaType:i,ssrcId:i===pT.VIDEO?t._videoSSRC:t._audioSSRC,rtxSsrcId:i===pT.VIDEO?t._rtxSsrcId:void 0}})));const i=new Map;if(n.length>0){const e=await this._gateway.subscribeAll(n,!0);((null==e?void 0:e.users)||[]).forEach((e=>{let{stream_id:t,video_error_code:n,audio_error_code:r,error_code:o}=e;(n||r||o)&&i.set(t,{video_error_code:n,audio_error_code:r,error_code:o})}))}if(Array.from(i.entries()).length>0){const e=Array.from(i.entries()).map((e=>{let t,[i,n]=e;return n.error_code||n.video_error_code&&n.audio_error_code?t=void 0:n.video_error_code?t=pT.VIDEO:n.audio_error_code&&(t=pT.AUDIO),{user:this.remoteUsers.find((e=>e.uid===i)),mediaType:t}}));await this._p2pChannel.massUnsubscribeNoLock(e)}for(const e of r){const t=i.get(e.user.uid);if(t){const i=t.error_code||"audio"===e.mediaType&&t.audio_error_code||"video"===e.mediaType&&t.video_error_code;if(i){const t=FT(i);Yw.error("user:".concat(e.user.uid," mediaType:").concat(e.mediaType," has massSubscribe error ").concat(t.desc)),e.error=new jS(Bv.SUBSCRIBE_FAILED,"code ".concat(i,": ").concat(t.desc))}}e.error||("video"===e.mediaType?e.track=e.user.videoTrack:e.track=e.user.audioTrack)}return this.store.massSubscribe(r.filter((e=>!e.error)).map((e=>({userId:e.user.uid,type:e.mediaType}))),void 0,Date.now()),r.forEach((e=>{var i;aS.subscribe(this.store.sessionId,{succ:!!e.error,ec:(null===(i=e.error)||void 0===i?void 0:i.code)||null,video:e.mediaType===pT.VIDEO,audio:e.mediaType===pT.AUDIO,peerid:e.user.uid,subscribeRequestid:e.mediaType===pT.VIDEO?e.user._videoSSRC:e.user._audioSSRC,p2pid:this.store.p2pId,eventElapse:Math.floor(performance.now()-t)},!0)})),Yw.info("[".concat(this._clientId,"] massSubscribe success ").concat(e.map((e=>{let{user:t,mediaType:i}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(i)})).join("; "))),r}catch(t){throw await this._p2pChannel.massUnsubscribeNoLock(e),t}}finally{o(),n()}}async unsubscribe(e,t,i){if(t||this.store.useP2P){if("datachannel"===t)return this._unsubscribeDataChannel(e,i)}else await this._unsubscribeDataChannel(e,i);if(t&&Wv(t,"mediaType",["audio","video"]),!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"Can't unsubscribe stream, haven't joined yet!");if(!this._users.find((t=>t===e))){const t=new jS(Bv.INVALID_REMOTE_USER,"user is not in the channel");throw Yw.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),t}Yw.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: ").concat(t));const n=await this._subscribeMutex.lock();try{if(this._p2pChannel instanceof uD)await this._p2pChannel.unsubscribe(e,t);else{const i=await this._p2pChannel.unsubscribe(e,t);i&&await this._gateway.unsubscribe(i,e.uid),t&&"audio"!==t||(e._audio_pre_subscribed=!1),t&&"video"!==t||(e._video_pre_subscribed=!1),e._is_pre_created&&CE(this._users,e),Yw.info("[".concat(this._clientId,"] unsubscribe success uid: ").concat(e.uid,", mediaType: ").concat(t))}}catch(t){if(t.code===Bv.DISCONNECT_P2P)return void Yw.warning("disconnecting p2p, abort unsubscribe request.");throw Yw.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),t.toString()),t}finally{n()}}async _unsubscribeDataChannel(e,t){if(t&&Gv(t,"id",0,65535,!0),!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"Can't unsubscribe datachannel, haven't joined yet!");if(!this._users.find((t=>t===e))){const t=new jS(Bv.INVALID_REMOTE_USER,"user is not in the channel");throw Yw.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid,", user is not in the channel")),t}let i;if("number"==typeof t){const n=e._dataChannels.find((e=>e.id===t));n&&(i=[n])}else i=e._dataChannels;if(void 0===i){const i=new jS(Bv.REMOTE_USER_IS_NOT_PUBLISHED);throw Yw.error("[".concat(this._clientId,"] can not unsubscribe ").concat(e.uid," with channelId ").concat(t,", remote datachannel is not published")),i}Yw.info("[".concat(this._clientId,"] unsubscribe uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(i.map((e=>e.id))));try{const t=await this._p2pChannel.unsubscribeDataChannel(e,i);t&&await this._gateway.unsubscribeDataChannel(t,e.uid),Yw.info("[".concat(this._clientId,"] unsubscribe datachannel success uid: ").concat(e.uid,", mediaType: datachannel, ids: ").concat(t))}catch(t){if(t.code===Bv.DISCONNECT_P2P)return void Yw.warning("disconnecting p2p, abort unsubscribe request.");throw Yw.error("[".concat(this._clientId,"] unsubscribe user ").concat(e.uid," error"),t.toString()),t}}async massUnsubscribe(e){if(Kv(e,"unsubscribeList"),!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"Can't unsubscribeAll stream, haven't joined yet!");Yw.info("[".concat(this._clientId,"] start massUnsubscribe ").concat(e.map((e=>{let{user:t,mediaType:i}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(i,";")})).join())),e=[...e];const t=new Map;for(let i=e.length-1;i>=0;i--){const{user:n,mediaType:r}=e[i];if(!n){const e=new jS(Bv.INVALID_PARAMS,"user property does not exist in unsubscribeList item");throw Yw.error("[".concat(this._clientId,"] user property does not exist in unsubscribeList item")),e}if(Wv(r,"mediaType",["video","audio",void 0]),!this._users.find((e=>e===n))){Yw.warning("[".concat(this._clientId,"] can not unsubscribe ").concat(n.uid,", user is not in the channel")),e.splice(i,1);continue}const o=oT.Video|oT.LwoVideo;if(t.has(n)){const s=t.get(n);let a;switch(r){case"video":a=s&o;break;case"audio":a=s&oT.Audio;break;default:a=s&(oT.Audio|o)}if(a){Yw.warning("[".concat(this._clientId,"] repeat massUnsubscribe user:").concat(n.uid,",mediaType:").concat(r," twice.")),e.splice(i,1);continue}r?"audio"===r?t.set(n,s|oT.Audio):"video"===r&&t.set(n,s|o):t.set(n,s|oT.Audio|o)}else r?"audio"===r?t.set(n,oT.Audio):"video"===r&&t.set(n,o):t.set(n,oT.Audio|o)}try{const t=await this._p2pChannel.massUnsubscribe(e);t&&await this._gateway.massUnsubscribe(t),Yw.info("[".concat(this._clientId,"] massUnsubscribe success ").concat(e.map((e=>{let{user:t,mediaType:i}=e;return"user: ".concat(null==t?void 0:t.uid,", mediaType: ").concat(i,";")})).join()))}catch(e){if(e.code===Bv.DISCONNECT_P2P)return void Yw.warning("[".concat(this._clientId,"] disconnecting p2p, abort unsubscribe request."));throw Yw.error("[".concat(this._clientId,"] massUnsubscribe error"),e.toString()),e}}async setLowStreamParameter(e){!function(e){if(!e)throw new jv(Bv.INVALID_PARAMS);zv(e.width)||Hv(e.width,"streamParameter.width"),zv(e.height)||Hv(e.height,"streamParameter.height"),zv(e.framerate)||Hv(e.framerate,"streamParameter.framerate"),zv(e.bitrate)||Gv(e.bitrate,"streamParameter.bitrate")}(e),(!e.width&&e.height||e.width&&!e.height)&&Yw.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),Yw.info("[".concat(this._clientId,"] set low stream parameter to"),JSON.stringify(e));const t=this._configDistribute.getLowStreamConfigDistribute();if(t&&t.bitrate&&e.bitrate&&t.bitrate<e.bitrate&&(e.bitrate=t.bitrate),this._lowStreamParameter=e,this._isDualStreamEnabled)return this._p2pChannel.updateVideoStreamParameter(e,gT.LocalVideoLowTrack)}async enableDualStream(){if(!MC().supportDualStream)throw aS.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),new jS(Bv.NOT_SUPPORTED,"Your browser is not support dual stream");if(this._isDualStreamEnabled)throw new jS(Bv.INVALID_OPERATION,"Dual stream is already enabled");if(this._p2pChannel.canPublishLowStream())try{await this._publishLowStream()}catch(e){throw aS.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!1}),e}this._isDualStreamEnabled=!0,aS.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!0,succ:!0}),Yw.info("[".concat(this._clientId,"] enable dual stream"))}async disableDualStream(){if(this._isDualStreamEnabled){if(!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if(this._p2pChannel.getLocalMedia(gT.LocalVideoLowTrack))try{const e=await this._p2pChannel.unpublishLowStream();e&&await this._gateway.unpublish(e,this._joinInfo.stringUid||this._joinInfo.uid)}catch(e){throw aS.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!1}),e}this._isDualStreamEnabled=!1,aS.streamSwitch(this._sessionId,{lts:Date.now(),isdual:!1,succ:!0}),Yw.info("[".concat(this._clientId,"] disable dual stream"))}}async setClientRole(e,t){if(function(e){Wv(e,"role",["audience","host"])}(e),t&&vE(t),"rtc"===this.mode||"p2p"===this.mode)throw Yw.warning("[".concat(this._clientId,"]").concat(this.mode," mode can not use setClientRole")),new jS(Bv.INVALID_OPERATION,"".concat(this.mode," mode can not use setClientRole"));if(t&&t.level&&"host"===e)throw new jS(Bv.INVALID_OPERATION,"host mode can not set audience latency level");if("audience"===e&&this._p2pChannel.hasLocalMedia())throw new jS(Bv.INVALID_OPERATION,"can not set client role to audience when publishing stream");await this._gateway.setClientRole(e,t),this._config.role=e,Yw.info("[".concat(this._clientId,"] set client role to ").concat(e,", level: ").concat(t&&t.level))}getRemoteInboundOffset(){var e;const t=null===(e=this._p2pChannel.getStats())||void 0===e?void 0:e.audioSend[0];if(!t||!t.timestamp)return 0;const i=t.timestamp-Date.now();return Math.abs(i)>1e3+t.rttMs+100?this.ntpAlignErrorCount+=1:this.ntpAlignErrorCount=0,this.ntpAlignErrorCount>=3?i:0}getNtpWallTimeInMs(){return"visible"===document.visibilityState&&(this.remoteInboundOffset=this.getRemoteInboundOffset()),this.remoteInboundOffset+Date.now()+this._gateway.ntpOffset}setProxyServer(e,t){if(qv(e,"proxyServer"),!t){if("DISCONNECTED"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new jS(Bv.INVALID_OPERATION,"You have already set the proxy")}this._proxyServer=e,aS.setProxyServer(this._proxyServer),Yw.setProxyServer(this._proxyServer),Yw.info("[".concat(this._clientId,"] Set proxy server ").concat(t?"by initialize call":""," success."))}setTurnServer(e,t){if(Array.isArray(e)||(e=[e]),!t){if("DISCONNECTED"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode||this._useLocalAccessPoint)throw new jS(Bv.INVALID_OPERATION,"You have already set the proxy")}if(_E(e))return this._turnServer={servers:e,mode:"original-manual"},void Yw.info("[".concat(this._clientId,"] Set original turnserver ").concat(t?"by initialize call":""," success: ").concat(e.map((e=>e.urls)).join(","),"."));e.forEach((e=>gE(e))),this._turnServer={servers:e,mode:"manual"},Yw.info("[".concat(this._clientId,"] Set turnserver ").concat(t?"by initialize call":""," success."))}setLicense(e){if("DISCONNECTED"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"you should set license before join channel");if(qv(e,"license",32,32),!/^[A-Za-z\d]+$/.test(e))throw new jS(Bv.INVALID_PARAMS,"license should only contains characters from A-Z a-z 0-9");this._license=e,Yw.info("[".concat(this._clientId,"] set license success"),e)}startProxyServer(e){if("DISCONNECTED"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"Start proxy server before join channel");if(this._proxyServer||"manual"===this._turnServer.mode||this._useLocalAccessPoint)throw new jS(Bv.INVALID_OPERATION,"You have already set the proxy");const t=[3,4,5];let i;switch(void 0===e&&(e=3),e){case 1:case 2:throw new jS(Bv.NOT_SUPPORTED,"proxy mode 1/2 has been deprecated and not supported.");case 3:i="proxy3";break;case 4:i="proxy4";break;case 5:i="proxy5";break;default:throw new jS(Bv.INVALID_PARAMS,"proxy server mode must be ".concat(t.join("|")))}this._cloudProxyServerMode=i,this.store.cloudProxyServerMode=i,Yw.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode)}stopProxyServer(){if("DISCONNECTED"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"Stop proxy server after leave channel");aS.setProxyServer(),Yw.setProxyServer(),this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled",Yw.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]}}setLocalAccessPointsV2(e){if(!e.accessPoints)throw new jS(Bv.INVALID_PARAMS,"accessPoints is required.");Kv(e.accessPoints.serverList,"accessPoints.serverList"),qv(e.accessPoints.domain,"accessPoints.domain");const t=(e,t)=>{Gv(e,t,0,65535,!0)};let i=443;if(e.accessPoints.port&&(t(e.accessPoints.port,"accessPoints.port"),i=e.accessPoints.port),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new jS(Bv.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");Pw("CLOSE_AFB_FOR_LOCAL_AP")&&(kw("JOIN_WITH_FALLBACK_SIGNAL_PROXY",!1),kw("JOIN_WITH_FALLBACK_MEDIA_PROXY",!1));const n=/^((\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.){3}(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,r=e.accessPoints.domain,o=e.accessPoints.serverList.map((e=>n.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(r):e)),s=o.map((e=>"".concat(e,":").concat(i)));this._useLocalAccessPoint=!0,this._setLocalAPVersion=2,kw("WEBCS_DOMAIN",s),kw("WEBCS_DOMAIN_BACKUP_LIST",s),kw("GATEWAY_DOMAINS",[r]),e.report&&e.report.hostname&&Array.isArray(e.report.hostname)&&e.report.hostname.length?(Kv(e.report.hostname,"report.hostname"),kw("EVENT_REPORT_DOMAIN",e.report.hostname[0]),kw("EVENT_REPORT_BACKUP_DOMAIN",e.report.hostname[1]||e.report.hostname[0])):(kw("EVENT_REPORT_DOMAIN",o[0]),kw("EVENT_REPORT_BACKUP_DOMAIN",o[1]||o[0]));let a=6443;e.report&&e.report.port&&(t(e.report.port,"report.port"),a=e.report.port),kw("STATS_COLLECTOR_PORT",a),e.report?kw("ENABLE_EVENT_REPORT",!0):kw("ENABLE_EVENT_REPORT",!1);let c="";e.log&&e.log.hostname&&Array.isArray(e.log.hostname)&&e.log.hostname.length?(Kv(e.log.hostname,"log.hostname"),c=e.log.hostname[0]):c=o[0];let u=6444;e.log&&e.log.port&&(t(e.log.port,"log.port"),u=e.log.port),kw("LOG_UPLOAD_SERVER","".concat(c,":").concat(u));let d=[];e.cds&&e.cds.hostname&&Array.isArray(e.cds.hostname)&&e.cds.hostname.length?(Kv(e.cds.hostname,"cds.hostname"),d=e.cds.hostname):d=o;let l=443;e.cds&&e.cds.port&&(t(e.cds.port,"cds.port"),l=e.cds.port),kw("CDS_AP",d.map((e=>"".concat(e,":").concat(l)))),e.cds?kw("ENABLE_CONFIG_DISTRIBUTE",!0):kw("ENABLE_CONFIG_DISTRIBUTE",!1),Yw.info("set local access point v2 success")}setLocalAccessPoints(e,t){if(Kv(e,"serverList"),qv(t,"domain"),this._proxyServer||"disabled"!==this._cloudProxyServerMode)throw new jS(Bv.INVALID_OPERATION,"set local access point failed, You have already set the cloud proxy");const i=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/;e=e.map((e=>i.test(e)?"".concat(e.replace(/\./g,"-"),".").concat(t):e)),this._useLocalAccessPoint=!0,this._setLocalAPVersion=1,kw("WEBCS_DOMAIN",e),kw("WEBCS_DOMAIN_BACKUP_LIST",e),kw("GATEWAY_DOMAINS",[t]),kw("EVENT_REPORT_DOMAIN",e[0]),kw("EVENT_REPORT_BACKUP_DOMAIN",e[1]||e[0]),kw("LOG_UPLOAD_SERVER","".concat(e[0],":6444")),Yw.info("[".concat(this._clientId,"] set local access point success"))}async setRemoteDefaultVideoStreamType(e){if(Wv(e,"streamType",[0,1]),this._remoteDefaultVideoStreamType=e,this._joinInfo)try{await this._gateway.setDefaultRemoteVideoStreamType(e),this._joinInfo.defaultVideoStream=this._remoteDefaultVideoStreamType}catch(e){throw Yw.error("[".concat(this._clientId,"] set default remote video stream type error"),e.toString()),e}else Yw.debug("[".concat(this._clientId,"] haven't joined yet, cache remoteDefaultVideoStreamType ").concat(e))}async setRemoteVideoStreamType(e,t){Wv(t,"streamType",[0,1]);try{await this._gateway.setRemoteVideoStreamType(e,t),setTimeout((()=>{const t=this._users.find((t=>t.uid===e));t&&t.videoTrack&&t.videoTrack.updateMediaStreamTrackResolution()}),2e3)}catch(e){throw Yw.error("[".concat(this._clientId,"] set remote video stream type error"),e.toString()),e}Yw.info("[".concat(this._clientId,"] set remote ").concat(e," video stream type to ").concat(t)),this._remoteStreamTypeCacheMap.set(e,t)}async setStreamFallbackOption(e,t){Wv(t,"fallbackType",[0,1,2]);try{await this._gateway.setStreamFallbackOption(e,t)}catch(e){throw Yw.error("[".concat(this._clientId,"] set stream fallback option"),e.toString()),e}Yw.info("[".concat(this._clientId,"] set remote ").concat(e," stream fallback type to ").concat(t)),this._streamFallbackTypeCacheMap.set(e,t)}setEncryptionConfig(e,t,i){!function(e){Wv(e,"encryptionMode",["aes-128-xts","aes-256-xts","aes-128-ecb","sm4-128-ecb","aes-128-gcm","aes-256-gcm","aes-128-gcm2","aes-256-gcm2","none"])}(e),qv(t,"secret");const n=["aes-128-gcm2","aes-256-gcm2"];if(Mn(n).call(n,e)){if(!i||!(i instanceof Uint8Array&&32===i.length))throw new jS(Bv.INVALID_PARAMS,"salt must be an Uint8Array and exactly equal to 32 bytes")}else if(i)throw new jS(Bv.INVALID_PARAMS,"current encrypt mode does not need salt");new RegExp("^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'\"|{}\\[\\]])(?=.{8,})").test(t)||Yw.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      "),this._encryptionMode=e,this._encryptionSecret=t,i&&(this._encryptionSalt=DE(i))}async renewToken(e){if(qv(e,"token",1,2047),!this._key||!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"renewToken should not be called before user join");const t=this._key;this._key=e,this._joinInfo&&(this._joinInfo.token=e);const i=await this._renewTokenMutex.lock();try{if(Pw("USE_NEW_TOKEN")){Yw.debug("[".concat(this._clientId,"] start renew token with ticket from unilbs"));const t=await RC(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||XE);Yw.debug("[".concat(this._clientId,"] get ticket from unilbs success")),await this._gateway.renewToken({token:e,ticket:t})}else Yw.debug("[".concat(this._clientId,"] start renew token without ticket")),await this._gateway.renewToken({token:e});Yw.debug("[".concat(this._clientId,"] renewToken success"))}catch(e){throw this._key=t,this._joinInfo.token=t,Yw.error("[".concat(this._clientId,"] renewToken failed"),e.toString()),e}finally{i()}}enableAudioVolumeIndicator(){this._audioVolumeIndicationInterval?Yw.warning("you have already enabled audio volume indicator!"):this._audioVolumeIndicationInterval=window.setInterval((()=>{const e=this._p2pChannel.getAudioLevels();this.safeEmit(lE.VOLUME_INDICATOR,e)}),Pw("AUDIO_VOLUME_INDICATION_INTERVAL")||2e3)}getRTCStats(){const e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}async startLiveStreaming(e,t){if(!t){if("h264"!==this.codec)throw new jS(Bv.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264");if(!this._p2pChannel.hasLocalMedia())throw new jS(Bv.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming")}if(this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e))throw new jS(Bv.LIVE_STREAMING_TASK_CONFLICT);const i=t?AS.TRANSCODE:AS.RAW;return this._createLiveStreamingClient(i).startLiveStreamingTask(e,i)}setLiveTranscoding(e){return this._createLiveStreamingClient(AS.TRANSCODE).setTranscodingConfig(e)}async stopLiveStreaming(e){const t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient].filter((t=>t&&t.hasUrl(e)));if(!t.length)throw new jS(Bv.INVALID_PARAMS,"can not find live streaming url to stop");await nv.all(t.map((t=>t&&t.stopLiveStreamingTask(e))))}async addInjectStreamUrl(e,t){if(!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");const i=this._createLiveStreamingClient(AS.INJECT);i.setInjectStreamConfig(t,0),await i.startLiveStreamingTask(e,AS.INJECT)}async removeInjectStreamUrl(){var e;const t=this._createLiveStreamingClient(AS.INJECT),i=Array.from(US(e=t.streamingTasks).call(e)).find((e=>e.mode===AS.INJECT));if(!this._joinInfo||!i)throw new jS(Bv.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");await t.stopLiveStreamingTask(i.url)}async startChannelMediaRelay(e){yD(e);const t=this._createChannelMediaRelayClient();await t.startChannelMediaRelay(e)}async updateChannelMediaRelay(e){yD(e);const t=this._createChannelMediaRelayClient();await t.updateChannelMediaRelay(e)}async stopChannelMediaRelay(){const e=this._createChannelMediaRelayClient();await e.stopChannelMediaRelay(),this._statsCollector.onStatsChanged&&(this._statsCollector.onStatsChanged=void 0)}sendStreamMessage(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"can not send data stream, not joined");if(("string"==typeof e||e instanceof Uint8Array)&&(e={payload:e}),"string"==typeof e.payload){const t=new TextEncoder;e.payload=t.encode(e.payload)}if(new Blob([e.payload]).size>1024)throw new jS(Bv.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(wS.DATA_STREAM,{payload:DE(e.payload),syncWithAudio:e.syncWithAudio,sendTs:Date.now()-vx},!t)}sendMetadata(e){if(!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"can not send metadata, not joined");if(new Blob([e]).size>1024)throw new jS(Bv.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(wS.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:DE(e)})}async sendCustomReportMessage(e){if(Array.isArray(e)||(e=[e]),e.forEach(Qw),!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"can not send custom report, not joined");await aS.sendCustomReportMessage(this._joinInfo.sid,e)}getLocalAudioStats(){return this._statsCollector.getLocalAudioTrackStats()}getRemoteAudioStats(){return this._statsCollector.getRemoteAudioTrackStats()}getLocalVideoStats(){return this._statsCollector.getLocalVideoTrackStats()}getRemoteVideoStats(){return this._statsCollector.getRemoteVideoTrackStats()}getRemoteNetworkQuality(){return this._statsCollector.getRemoteNetworkQualityStats()}async pickSVCLayer(e,t){Wv(t.spatialLayer,"spatialLayer",[0,1,2,3]),Wv(t.temporalLayer,"temporalLayer",[0,1,2,3]);try{await this._gateway.pickSVCLayer(e,t)}catch(e){throw Yw.error("[".concat(this._clientId,"] pick SVC layer failed"),e.toString()),e}}async setRTMConfig(e){const{apRTM:t=!1,rtmFlag:i}=e;if(Fv(t,"apRTM"),Gv(i,"rtmFlag",0),this._rtmConfig.apRTM=t,this._rtmConfig.rtmFlag=i,Yw.debug("[".concat(this._clientId,"] setRTMconfig ").concat(JSON.stringify(e)," in ").concat(this.connectionState," state")),("CONNECTED"===this.connectionState||"RECONNECTING"===this.connectionState)&&this._joinInfo)return this._joinInfo.apRTM=t,this._joinInfo.rtmFlag=i,this._gateway.setRTM2Flag(i)}_reset(){if(Yw.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=gw.CancelToken.source(),this._streamFallbackTypeCacheMap=new Map,this._remoteStreamTypeCacheMap=new Map,this._configDistribute.stopGetConfigDistribute(),this._joinInfo=void 0,this._proxyServer=void 0,this._defaultStreamFallbackType=void 0,this._sessionId=null,this.store.sessionId=null,this._statsCollector.reset(),this._key=void 0,this._appId=void 0,this._uid=void 0,this.store.uid=void 0,this._channelName=void 0,this._encryptionMode="none",this._encryptionSecret=null,this._encryptionSalt=null,this._pendingPublishedUsers=[],this._users.forEach((e=>{e._audioTrack&&e._audioTrack._destroy(),e._videoTrack&&e._videoTrack._destroy(),e._dataChannels&&(e._dataChannels.forEach((e=>e._close())),e._dataChannels.length=0)})),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),"fallback"===this._cloudProxyServerMode&&(this._cloudProxyServerMode="disabled",this.store.cloudProxyServerMode="disabled"),this._p2pChannel.reset(),this._publishMutex=new YE("client-publish"),this._subscribeMutex=new YE("client-subscribe"),this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0),this._inspect)try{this._inspect.close(),this._inspect=void 0}catch(e){}if(this._moderation)try{this.setImageModeration(!1)}catch(e){}}_startSession(e,t){var i;const n=e||jE();e?Yw.debug("[".concat(this._clientId,"] new Session ").concat(n)):Yw.debug("[".concat(this._clientId,"] renewSession ").concat(this._sessionId," => ").concat(n));const r=e?"":this._sessionId||"";this._sessionId=n,this.store.sessionId=n;const o={lts:(new Date).getTime(),mode:this.mode,stringUid:(null==t?void 0:t.stringUid)||(null===(i=this._joinInfo)||void 0===i?void 0:i.stringUid),channelProfile:"live"===this.mode?1:0,channelMode:0,isABTestSuccess:Number(this._configDistribute.isSuccess),lsid:r,clientRole:"audience"===this.role?2:1};t?aS.sessionInit(this._sessionId,Ax({cname:t.channel,appid:t.appId},o)):this._joinInfo?aS.sessionInit(this._sessionId,Ax({cname:this._joinInfo.cname,appid:this._joinInfo.appId},o)):this._gateway.joinInfo&&aS.sessionInit(this._sessionId,Ax({cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId},o)),this._joinInfo&&(this._joinInfo.sid=n),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=n)}async _publishHighStream(e){if(!this._joinInfo||void 0===this._uid)throw new jS(Bv.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));if("auto"===this._turnServer.mode&&Pw("FORCE_TURN")&&!Pw("TURN_ENABLE_TCP")&&!Pw("TURN_ENABLE_UDP"))throw new jS(Bv.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");Yw.debug("[".concat(this._clientId,"] publish high stream"));try{const i=await this._p2pChannel.publish(e,this._isDualStreamEnabled,this._lowStreamParameter);if(this._p2pChannel instanceof uD){const t=(await i.next()).value;if(t){try{await this._gateway.sendExtensionMessage(NT.PUBLISH,t,!0)}catch(e){throw i.throw(e),e}await i.next()}this._p2pChannel.reportPublishEvent(!0,null)}else{const n=(await i.next()).value;if(n){var t;let r;try{r=await this._gateway.publish(this._uid,n,!0)}catch(e){if(e.code!==Bv.DISCONNECT_P2P)throw i.throw(e),e}await i.next((null===(t=r)||void 0===t?void 0:t.ortc)||[])}this._p2pChannel.reportPublishEvent(!0,null);for(const t of e)t instanceof kA&&t._encoderConfig&&this._gateway.setVideoProfile(t._encoderConfig),!t.muted&&t.enabled||await this._p2pChannel.muteLocalTrack(t)}}catch(t){if(this._p2pChannel.reportPublishEvent(!1,null==t?void 0:t.code,e),(null==t?void 0:t.code)===Bv.WS_ABORT)return;throw t}}async _publishLowStream(){if(!this._joinInfo||void 0===this._uid)throw new jS(Bv.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");if("CONNECTED"!==this.connectionState&&"RECONNECTING"!==this.connectionState)throw new jS(Bv.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));Yw.debug("[".concat(this._clientId,"] publish low stream"));const e=this._configDistribute.getLowStreamConfigDistribute();e&&e.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&e.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=e.bitrate));try{const e=await this._p2pChannel.publishLowStream(this._lowStreamParameter),i=(await e.next()).value;if(i){var t;let n;try{n=await this._gateway.publish(this._uid,i,!0)}catch(t){if(t.code!==Bv.DISCONNECT_P2P)throw e.throw(t),t}e.next((null===(t=n)||void 0===t?void 0:t.ortc)||[]),this._p2pChannel.reportPublishEvent(!0,null,void 0,!0)}}catch(e){if(this._p2pChannel.reportPublishEvent(!1,null==e?void 0:e.code,void 0,!0),(null==e?void 0:e.code)===Bv.WS_ABORT)return;throw e}}_createLiveStreamingClient(e){if(!this._joinInfo||!this._appId)return new jS(Bv.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();const t=()=>new ED(this._joinInfo,this._config.websocketRetryConfig||XE,this._config.httpRetryConfig||XE),i=e=>{e.onLiveStreamError=(e,t)=>{aS.reportApiInvoke(this._sessionId,{name:aE.ON_LIVE_STREAM_ERROR,options:[e,t],tag:cE.TRACER}).onSuccess(),this.safeEmit(lE.LIVE_STREAMING_ERROR,e,t)},e.onLiveStreamWarning=(e,t)=>{aS.reportApiInvoke(this._sessionId,{name:aE.ON_LIVE_STREAM_WARNING,options:[e,t],tag:cE.TRACER}).onSuccess(),this.safeEmit(lE.LIVE_STREAMING_WARNING,e,t)},e.on(JS.REQUEST_WORKER_MANAGER_LIST,((e,t,i)=>{if(!this._joinInfo)return i(new jS(Bv.INVALID_OPERATION,"can not find join info to get worker manager"));SC(e,this._joinInfo,this._axiosCancelSource.token,XE).then(t).catch(i)}))};switch(e){case AS.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=t(),i(this._liveRawStreamingClient)),this._liveRawStreamingClient;case AS.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=t(),i(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case AS.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=t(),this._injectStreamingClient.on(JS.REQUEST_WORKER_MANAGER_LIST,((e,t,i)=>{if(!this._joinInfo)return i(new jS(Bv.INVALID_OPERATION,"can not find join info to get worker manager"));SC(e,this._joinInfo,this._axiosCancelSource.token,XE).then(t).catch(i)})),this._injectStreamingClient.onInjectStatusChange=(e,t,i)=>{this.safeEmit(lE.INJECT_STREAM_STATUS,e,t,i)}),this._injectStreamingClient}}_createChannelMediaRelayClient(){if(!this._joinInfo)return new jS(Bv.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw();if(!this._channelMediaRelayClient){const{sendResolutionWidth:e,sendResolutionHeight:t}=this.getLocalVideoStats(),i={width:e,height:t};this._channelMediaRelayClient=new SD(this._joinInfo,this._clientId,this._config.websocketRetryConfig||XE,this._config.httpRetryConfig||XE,i),this._channelMediaRelayClient.on("state",(e=>{e===eT.RELAY_STATE_FAILURE&&this._channelMediaRelayClient&&this._channelMediaRelayClient.dispose(),this.safeEmit(lE.CHANNEL_MEDIA_RELAY_STATE,e)})),this._channelMediaRelayClient.on("event",(e=>{this.safeEmit(lE.CHANNEL_MEDIA_RELAY_EVENT,e)})),this._statsCollector.onStatsChanged=(e,t)=>{var i;"resolution"===e&&(null===(i=this._channelMediaRelayClient)||void 0===i||i.setVideoProfile(t))}}return this._channelMediaRelayClient}_handleUpdateDataChannel(e,t){const{added:i,deleted:n}=e,r=[];Array.isArray(i)&&i.length>0&&i.forEach((e=>{const{uid:i,stream_id:n,ordered:o,max_retrans_times:s,metadata:a}=e,c=this._users.find((e=>e._uintid===i));if(c){if(Yw.debug("[".concat(this._clientId,"] data_channel added with uid ").concat(i)),Mn(r).call(r,c)||r.push(c),c._uintid||(c._uintid=i),-1===c._dataChannels.findIndex((t=>t.id===e.stream_id))){const e={id:n,ordered:!!o,maxRetransmits:s,metadata:a},i=new _k(e);c._dataChannels.push(i),Yw.info("[".concat(this._clientId,"] remote user ").concat(c.uid," published datachannel")),t||this.safeEmit(lE.USER_PUBLISHED,c,"datachannel",e)}this._p2pChannel.hasPendingRemoteDataChannel(c,e.stream_id)&&(Yw.debug("[".concat(this._clientId,"] resubscribe datachannel for user ").concat(c.uid," after reconnect.")),this._subscribeDataChannel(c,e.stream_id).catch((e=>{Yw.error("[".concat(this._clientId,"] resubscribe datachannel error"),e.toString())})))}else Yw.error("[".concat(this._clientId,"] can not find target user!(on_add_data_channel)"))})),t&&(this.safeEmit(lE.PUBLISHED_USER_LIST,this._pendingPublishedUsers),this._pendingPublishedUsers=[]),Array.isArray(n)&&n.length>0&&n.forEach((e=>{const{uid:t,stream_id:i}=e,n=this._users.find((e=>e._uintid===t));if(!n)return void Yw.error("[".concat(this._clientId,"] can not find target user!(on_delete_data_channel)"));const r=n._dataChannels.find((t=>t.id===e.stream_id));r&&(Yw.debug("[".concat(this._clientId,"] data_stream delete with uid ").concat(t)),this._p2pChannel.unsubscribeDataChannel(n,[r]).then((e=>{if(n._dataChannels=n._dataChannels.filter((e=>e!==r)),e)return this._gateway.unsubscribeDataChannel(e,n.uid)})),Yw.info("[".concat(this._clientId,"] remote user ").concat(t," unpublished datachannel ,id:").concat(r.id)),this.safeEmit(lE.USER_UNPUBLISHED,n,"datachannel",r._config))}))}_handleRemoveDataChannels(e){const t=this._users.find((t=>t.uid===e.uid));if(t){if(void 0!==t._dataChannels&&t._dataChannels.length>0){Yw.debug("[".concat(this._clientId,"] datachannel removed with uid ").concat(e.uid));const i=()=>{Yw.info("[".concat(this._clientId,"] remote user ").concat(t.uid," unpublished datachannel")),t._dataChannels.forEach((e=>{this.safeEmit(lE.USER_UNPUBLISHED,t,"datachannel",e._config)}))};this._p2pChannel.unsubscribeDataChannel(t,t._dataChannels).then((e=>{if(e)return this._gateway.unsubscribeDataChannel(e,t.uid)})),i()}}else Yw.warning("[".concat(this._clientId,"] can not find target user!(on_remove_datachannel)"))}_handleGatewayEvents(){this._gateway.on(nT.DISCONNECT_P2P,(async()=>{await this._p2pChannel.disconnectForReconnect()})),this._gateway.on(nT.CONNECTION_STATE_CHANGE,((e,t,i)=>{var n;if(i===dE.FALLBACK)return;const r=()=>{this.safeEmit(lE.CONNECTION_STATE_CHANGE,e,t,i)};if(aS.reportApiInvoke(this._sessionId||(null===(n=this._gateway.joinInfo)||void 0===n?void 0:n.sid)||null,{name:aE.CONNECTION_STATE_CHANGE,options:[e,t,i],tag:cE.TRACER}).onSuccess(JSON.stringify({cur:e,prev:t,reason:i})),Yw.info("[".concat(this._clientId,"] connection state change: ").concat(t," -> ").concat(e)),"DISCONNECTED"===e)return this._reset(),void r();if("RECONNECTING"===e)this._users.forEach((e=>{e._trust_in_room_=!1,e._trust_audio_enabled_state_=!1,e._trust_video_enabled_state_=!1,e._trust_audio_mute_state_=!1,e._trust_video_mute_state_=!1,e._trust_audio_stream_added_state_=!1,e._trust_video_stream_added_state_=!1,e._is_pre_created||(e._audio_pre_subscribed||(e._audioSSRC=void 0,e._audioOrtc=void 0),e._video_pre_subscribed||(e._videoSSRC=void 0,e._videoOrtc=void 0,e._rtxSsrcId=void 0),e._cname=void 0)})),this._userOfflineTimeout&&window.clearTimeout(this._userOfflineTimeout),this._streamRemovedTimeout&&window.clearTimeout(this._streamRemovedTimeout),this._userOfflineTimeout=void 0,this._streamRemovedTimeout=void 0;else if("CONNECTED"===e){var o;this._streamFallbackTypeCacheMap.forEach(((e,t)=>{this._gateway.setStreamFallbackOption(t,e).catch((e=>{Yw.warning("[".concat(this._clientId,"] auto set stream fallback option failed"),e)}))})),this._remoteStreamTypeCacheMap.forEach(((e,t)=>{this._gateway.setRemoteVideoStreamType(t,e).catch((e=>{Yw.warning("[".concat(this._clientId,"] auto set remote stream type failed"),e)}))})),void 0!==this._remoteDefaultVideoStreamType&&void 0===(null===(o=this._joinInfo)||void 0===o?void 0:o.defaultVideoStream)&&this.setRemoteDefaultVideoStreamType(this._remoteDefaultVideoStreamType).then((()=>{Yw.debug("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway connected"))})).catch((e=>{Yw.error("[".concat(this._clientId,"] setRemoteDefaultVideoStreamType after gateway failed, ").concat(e))})),this.store.useP2P||(this._p2pChannel.republish(),this._userOfflineTimeout=window.setTimeout((()=>{"CONNECTED"===this.connectionState&&(this._userOfflineTimeout=void 0,this._users.filter((e=>!e._trust_in_room_)).forEach((e=>{Yw.debug("[".concat(this._clientId,"] user offline timeout, emit user offline ").concat(e.uid)),this._handleUserOffline({uid:e.uid})})))}),3e3),this._streamRemovedTimeout=window.setTimeout((()=>{"CONNECTED"===this.connectionState&&(this._streamRemovedTimeout=void 0,this._users.forEach((e=>{e._trust_audio_mute_state_||(Yw.debug("[".concat(this._clientId,"] auto dispatch audio unmute event ").concat(e.uid)),this._handleMuteStream(e.uid,pT.AUDIO,!1)),e._trust_video_mute_state_||(Yw.debug("[".concat(this._clientId,"] auto dispatch video unmute event ").concat(e.uid)),this._handleMuteStream(e.uid,pT.VIDEO,!1)),e._trust_audio_enabled_state_||(Yw.debug("[".concat(this._clientId,"] auto dispatch enable local audio ").concat(e.uid)),this._handleSetStreamLocalEnable("audio",e.uid,!0)),e._trust_video_enabled_state_||(Yw.debug("[".concat(this._clientId,"] auto dispatch enable local video ").concat(e.uid)),this._handleSetStreamLocalEnable("video",e.uid,!0)),e._trust_video_stream_added_state_||(Yw.debug("[".concat(this._clientId,"] auto dispatch reset video stream added ").concat(e.uid)),this._handleResetAddStream(e,"video")),e._trust_audio_stream_added_state_||(Yw.debug("[".concat(this._clientId,"] auto dispatch reset audio stream added ").concat(e.uid)),this._handleResetAddStream(e,"audio")),e._video_added_||e._audio_added_||(Yw.debug("[".concat(this._clientId,"] auto dispatch stream remove ").concat(e.uid)),this._handleRemoveStream({uid:e.uid,uint_id:e._uintid}))})))}),1e3))}r()})),this._gateway.on(nT.REQUEST_NEW_GATEWAY_LIST,((e,t)=>{if(!this._joinInfo)return t(new jS(Bv.UNEXPECTED_ERROR,"can not recover, no join info"));vC(this._joinInfo,this._axiosCancelSource.token,this._config.httpRetryConfig||XE,this.store).then((t=>{this._joinInfo&&(this._joinInfo.apResponse=t.gatewayInfo.res,this._joinInfo.gatewayAddrs=t.gatewayInfo.gatewayAddrs,this._joinInfo.uni_lbs_ip=t.gatewayInfo.uni_lbs_ip);const i=[];t.gatewayInfo.gatewayAddrs.forEach((e=>{let{address:t}=e;const[n,r]=t.split(":");this._joinInfo&&this._joinInfo.proxyServer?i.push({proxy:this._joinInfo.proxyServer,host:n,port:r}):i.push({host:n,port:r})})),e(i)})).catch(t)})),this._gateway.on(nT.NETWORK_QUALITY,(e=>{"normal"===this._networkQualitySensitivity&&this.safeEmit(lE.NETWORK_QUALITY,e)})),this._gateway.on(nT.STREAM_TYPE_CHANGE,((e,t)=>{this.safeEmit(lE.STREAM_TYPE_CHANGED,e,t),aS.reportApiInvoke(this._sessionId,{name:aE.STREAM_TYPE_CHANGE,options:[e,t],tag:cE.TRACER}).onSuccess(JSON.stringify({uid:e,streamType:t}))})),this._gateway.on(nT.IS_P2P_DISCONNECTED,(e=>{this._p2pChannel.isP2PDisconnected()?e(!0):this._p2pChannel.hasLocalMedia()||this._p2pChannel.hasRemoteMedia()?e(!1):e(!0)})),this._gateway.on(nT.NEED_RENEW_SESSION,(()=>{this._startSession()})),this._gateway.on(nT.REQUEST_P2P_CONNECTION_PARAMS,(async(e,t,i)=>{try{t(await this._p2pChannel.startP2PConnection(e))}catch(e){i(e)}})),this._gateway.on(nT.JOIN_RESPONSE,((e,t)=>{if(this.store.useP2P)return;const{dtlsParameters:i,iceParameters:n,candidates:r,rtpCapabilities:o,setup:s,cname:a}=bP(e.ortc,t);this._p2pChannel.connect(n,i,r,o,s,a)})),this._gateway.on(nT.REQUEST_DC_CONNECTION_PARAMS,(e=>{e(this._p2pChannel.getEstablishParams())})),this._gateway.on(nT.RESET_SIGNAL,(e=>{this._p2pChannel.resetConnection(e),this._handleGatewaySignalEvents()})),this._gateway.on(nT.DATACHANNEL_FAILBACK,(()=>{this._joinGateway()})),this._gateway.on(nT.DATACHANNEL_PRECONNECT,(async(e,t,i,n)=>{var r,o,s,a,c,u;await this._p2pChannel.startP2PConnection({turnServer:null===(r=this._joinInfo)||void 0===r?void 0:r.turnServer},!0);const d=function(e,t){let i;return t&&t.ip&&"number"==typeof t.port?(i=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip,port:t.port.toString(),type:"host",extension:{}}],Yw.debug("Using remote candidate from AP ".concat(t.ip,":").concat(t.port)),t.ip6&&(i.push({foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:t.ip6,port:t.port.toString(),type:"host",extension:{}}),Yw.debug("Using IPV6 remote candidate from AP ".concat(t.ip6,":").concat(t.port)))):i=[{foundation:"udpcandidate",componentId:"1",transport:"udp",priority:"2103266323",connectionAddress:e.ip,port:e.port.toString(),type:"host",extension:{}}],i}(e,t);return this._p2pChannel.preConnect({iceUfrag:"".concat(null===(o=this._joinInfo)||void 0===o?void 0:o.apResponse.cid,"_").concat(null===(s=this._joinInfo)||void 0===s?void 0:s.apResponse.cert),icePwd:"".concat(null===(a=this._joinInfo)||void 0===a?void 0:a.apResponse.cid,"_").concat(null===(c=this._joinInfo)||void 0===c?void 0:c.apResponse.cert)},{fingerprints:[{hashFunction:"sha-256",fingerprint:null!==(u=Pw("FINGERPRINT"))&&void 0!==u?u:e.fingerprint}]},d,{send:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]},recv:{audioCodecs:[],videoCodecs:[],audioExtensions:[],videoExtensions:[]}},"active","o/i14u9pJrxRKAsu").then(i).catch(n)}))}_handleGatewaySignalEvents(){this._gateway.signal.on(TS.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(TS.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(TS.ON_ADD_AUDIO_STREAM,(e=>this._handleAddAudioOrVideoStream("audio",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc))),this._gateway.signal.on(TS.ON_ADD_VIDEO_STREAM,(e=>this._handleAddAudioOrVideoStream("video",e.uid,e.ssrcId,e.cname,e.uint_id,e.ortc,e.rtxSsrcId))),this._gateway.signal.on(TS.ON_REMOTE_DATASTREAM_UPDATE,(e=>{this._handleUpdateDataChannel(e)})),this._gateway.signal.on(TS.ON_REMOTE_FULL_DATASTREAM_INFO,(e=>{this._handleUpdateDataChannel({added:e.datastreams,deleted:[]},!0)})),this._gateway.signal.on(TS.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(TS.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(TS.MUTE_AUDIO,(e=>this._handleMuteStream(e.uid,pT.AUDIO,!0))),this._gateway.signal.on(TS.UNMUTE_AUDIO,(e=>this._handleMuteStream(e.uid,pT.AUDIO,!1))),this._gateway.signal.on(TS.MUTE_VIDEO,(e=>this._handleMuteStream(e.uid,pT.VIDEO,!0))),this._gateway.signal.on(TS.UNMUTE_VIDEO,(e=>this._handleMuteStream(e.uid,pT.VIDEO,!1))),this._gateway.signal.on(TS.RECEIVE_METADATA,(e=>{const t=PE(e.metadata);this.safeEmit(lE.RECEIVE_METADATA,e.uid,t)})),this._gateway.signal.on(TS.ON_DATA_STREAM,(async e=>{if(!e)return;let t=0;if(e.ordered||e.syncWithAudio){const i=this._p2pChannel.getStats(),n=this.remoteUsers.find((t=>t.uid===e.uid)),r=null==i?void 0:i.audioRecv.find((e=>e.ssrc===(null==n?void 0:n._audioSSRC)));t=null==r?void 0:r.jitterBufferMs}null==t&&(t=0),Tx(e,t,{id:this._clientId,onStreamMessage:"function"==typeof this.onStreamMessage?this.onStreamMessage.bind(this):void 0,safeEmit:this.safeEmit.bind(this)})})),this._gateway.signal.on(TS.ON_CRYPT_ERROR,(()=>{kE((()=>{Yw.warning("[".concat(this._clientId,"] on crypt error")),this.safeEmit(lE.CRYPT_ERROR)}),this._sessionId)})),this._gateway.signal.on(TS.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(TS.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(()=>{Yw.warning("[".concat(this._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),this._gateway.leave(!0,dE.TOKEN_EXPIRE),this.safeEmit(lE.ON_TOKEN_PRIVILEGE_DID_EXPIRE),this._reset()})),this._gateway.signal.on(TS.ON_STREAM_FALLBACK_UPDATE,(e=>{Yw.debug("[".concat(this._clientId,"] stream fallback peerId: ").concat(e.stream_id,", attr: ").concat(e.stream_type)),this.safeEmit(lE.STREAM_FALLBACK,e.stream_id,1===e.stream_type?"fallback":"recover")})),this._gateway.signal.on(TS.ON_PUBLISH_STREAM,(e=>{this.uid===this._uid&&(this._p2pChannel.reportPublishEvent(!0,null,void 0,!1,JSON.stringify({proxy:e.proxy})),Yw.info("[".concat(this._clientId,"] on publish stream, ").concat(JSON.stringify(e))))})),this._gateway.signal.on(TS.ENABLE_LOCAL_VIDEO,(e=>{this._handleSetStreamLocalEnable("video",e.uid,!0)})),this._gateway.signal.on(TS.DISABLE_LOCAL_VIDEO,(e=>{this._handleSetStreamLocalEnable("video",e.uid,!1)})),this._gateway.signal.on(yS.REQUEST_TIMEOUT,((e,t)=>{if(this._joinInfo)switch(e){case wS.PUBLISH:{if(!t)return;const e=t.ortc;if(e){var i,n;const r=e.some((e=>{let{stream_type:t}=e;return t===iT.Audio})),o=e.some((e=>{let{stream_type:t}=e;return t!==iT.Audio})),s=e.some((e=>{let{stream_type:t}=e;return t===iT.Screen||t===iT.ScreenLow}));"offer"===t.state&&aS.publish(this._joinInfo.sid,{eventElapse:bk.measureFromPublishStart(this.store.clientId,this.store.pubId),succ:!1,ec:Bv.TIMEOUT,audio:r,video:o,p2pid:t.p2p_id,publishRequestid:this.store.pubId,screenshare:s,audioName:r?null===(i=e.find((e=>{let{stream_type:t}=e;return t===iT.Audio})))||void 0===i||null===(i=i.ssrcs[0])||void 0===i?void 0:i.ssrcId.toString():void 0,videoName:o?null===(n=e.find((e=>{let{stream_type:t}=e;return t!==iT.Audio})))||void 0===n||null===(n=n.ssrcs[0])||void 0===n?void 0:n.ssrcId.toString():void 0})}break}case wS.SUBSCRIBE:t&&aS.subscribe(this._joinInfo.sid,{succ:!1,ec:Bv.TIMEOUT,audio:t.stream_type===pT.AUDIO,video:t.stream_type===pT.VIDEO,peerid:t.stream_id,subscribeRequestid:t.ssrcId,p2pid:this.store.p2pId,eventElapse:bk.measureFromSubscribeStart(this.store.clientId,t.ssrcId)})}})),this._gateway.signal.on(TS.ON_P2P_OK,(e=>{this.uid,this._uid})),this._gateway.signal.on(TS.ON_PUBLISHED_USER_LIST,(e=>{if(null==e||!e.users)return;Pw("BLOCK_LOCAL_CLIENT")&&(e.users=e.users.filter((e=>!hS(e.string_id||e.stream_id,this.channelName))));const t=[],i=[];for(const n of e.users){let e=this._users.find((e=>e._uintid===n.stream_id));e?e._trust_in_room_=!0:(e=new rD(n.string_id||n.stream_id,n.stream_id),this._users.push(e),0===this.getListeners(lE.PUBLISHED_USER_LIST).length&&(Yw.debug("[".concat(this._clientId,"] user online"),n.stream_id),this.safeEmit(lE.USER_JOINED,e)));const r=oT.Audio&n.stream_type,o=(oT.Video|oT.LwoVideo)&n.stream_type,s=0!=(65280&n.stream_type),a=r&&e.hasAudio,c=o&&e.hasVideo;o&&(e._trust_video_stream_added_state_=!0,e._video_added_=!0,e._videoSSRC=n.video_ssrc,e._rtxSsrcId=n.video_rtx),r&&(e._trust_audio_stream_added_state_=!0,e._audio_added_=!0,e._audioSSRC=n.audio_ssrc),r&&!a&&0===this.getListeners(lE.PUBLISHED_USER_LIST).length&&(Yw.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published audio")),this.safeEmit(lE.USER_PUBLISHED,e,"audio")),o&&!c&&0===this.getListeners(lE.PUBLISHED_USER_LIST).length&&(Yw.info("[".concat(this._clientId,"] remote user ").concat(e.uid," published video")),this.safeEmit(lE.USER_PUBLISHED,e,"video")),(r&&!a||o&&!c||s)&&t.push(e),o&&this._p2pChannel.hasPendingRemoteMedia(e,"video")&&i.push({user:e,mediaType:"video"}),r&&this._p2pChannel.hasPendingRemoteMedia(e,"audio")&&i.push({user:e,mediaType:"audio"})}i.length>0&&(Yw.debug("[".concat(this._clientId,"] RE massSubscribe after reconnect ").concat(i.map((e=>"user: ".concat(e.user.uid,", mediaType: ").concat(e.mediaType))).join("; ")," ")),this.massSubscribe(i).catch((e=>{Yw.error("[".concat(this._clientId,"] mass resubscribe error"),e.toString())}))),this.getListeners(lE.PUBLISHED_USER_LIST).length>0?Pw("ENABLE_DATASTREAM_2")?this._pendingPublishedUsers=t:(Yw.info("[".concat(this._clientId,"] client emit user-list event, users: ").concat(t.map((e=>e.uid)).join(", "))),this.safeEmit(lE.PUBLISHED_USER_LIST,t)):Yw.info("[".concat(this._clientId,"] client not emit user-list event case there is no user-list listener, users: ").concat(t.map((e=>e.uid)).join(", ")))})),this._gateway.signal.on(TS.ON_RTP_CAPABILITY_CHANGE,(e=>{const{video_codec:t}=e;this._p2pChannel instanceof oL&&this._p2pChannel.updateRemoteRTPCapabilities(t.map((e=>e.toLowerCase())).filter((e=>{var t;return Mn(t=Object.keys(Vw)).call(t,e)})))}))}_handleP2PEvents(){this._gateway.signal.on(TS.ON_USER_OFFLINE,(()=>{this._p2pChannel.disconnectForReconnect()})),this._gateway.signal.on(NT.PUBLISH,((e,t,i)=>{const{uid:n}=e;e.forEach((e=>{const{kind:r,ssrcs:o,mid:s,isMuted:a}=e;this._handleP2PAddAudioOrVideoStream(r,n,o[0].ssrcId,s);const c=this._users.find((e=>e.uid===n));return c&&this._p2pChannel instanceof uD?this._p2pChannel.mockSubscribe(c,r,o[0].ssrcId,s).then((()=>{t()})).catch(i):t(),this._handleMuteStream(n,r,!!a)}))})),this._gateway.signal.on(NT.CALL,(async(e,t,i)=>{if(this._p2pChannel instanceof uD)try{var n;t(await this._p2pChannel.startP2P({turnServer:null===(n=this._joinInfo)||void 0===n?void 0:n.turnServer},e))}catch(e){i(e)}})),this._gateway.signal.on(yS.P2P_CONNECTION,(async e=>{this._p2pChannel instanceof uD&&await this._p2pChannel.p2pConnect(e)})),this._gateway.signal.on(NT.UNPUBLISH,(async(e,t,i)=>{if(this._p2pChannel instanceof uD){const{unpubMsg:n,uid:r}=e,o=this._users.find((e=>e.uid===r));if(!o)return Yw.warning("[".concat(this._clientId,"] can not find remote user, ignore mute event, uid: ").concat(r)),void t();try{n.forEach((async e=>{let{stream_type:t}=e;const i=t===iT.Audio?pT.AUDIO:pT.VIDEO;await this._p2pChannel.unsubscribe(o,i),this._handleMuteStream(r,i,!0)})),t()}catch(e){i(e)}}})),this._gateway.signal.on(NT.CONTROL,(async(e,t)=>{const{action:i}=e;switch(i){case PT.MUTE_LOCAL_VIDEO:this._handleMuteStream(t,pT.VIDEO,!0);break;case PT.MUTE_LOCAL_AUDIO:this._handleMuteStream(t,pT.AUDIO,!0);break;case PT.UNMUTE_LOCAL_VIDEO:this._handleP2PAddAudioOrVideoStream("video",t),this._handleMuteStream(t,pT.VIDEO,!1);break;case PT.UNMUTE_LOCAL_AUDIO:this._handleP2PAddAudioOrVideoStream("audio",t),this._handleMuteStream(t,pT.AUDIO,!1)}})),this._gateway.signal.on(NT.RESTART_ICE,(async(e,t,i)=>{if(this._p2pChannel instanceof uD)try{const{direction:i,iceParameter:n}=e;i!==CS.SEND_ONLY||n?t(await this._p2pChannel.restartICE(i,n)):(this._p2pChannel.handleDisconnect(i),t())}catch(e){i(e)}})),this._gateway.signal.on(NT.CANDIDATE,(e=>{if(this._p2pChannel instanceof uD){const{candidate:t,direction:i}=e;this._p2pChannel.addRemoteCandidate(t,i)}})),this._p2pChannel.on(ET.RequestP2PRestartICE,(async(e,t,i)=>{try{const{direction:i}=e;t(await this._gateway.sendExtensionMessage(NT.RESTART_ICE,e,i===CS.SEND_ONLY))}catch(e){i(e)}})),this._p2pChannel.on(ET.LocalCandidate,(e=>{this._gateway.sendExtensionMessage(NT.CANDIDATE,JSON.stringify(e),!0)})),this._p2pChannel.on(ET.RequestP2PMuteLocal,(async(e,t,i)=>{try{await this._gateway.sendExtensionMessage(NT.CONTROL,e,!0),t()}catch(e){i(e)}})),this._p2pChannel.on(ET.RequestP2PUnmuteRemote,(async(e,t,i)=>{if(this._joinInfo)try{await this._gateway.unmuteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===Bv.DISCONNECT_P2P?t():i(e)}else t()})),this._p2pChannel.on(ET.RequestP2PMuteRemote,(async(e,t,i)=>{if(this._joinInfo)try{await this._gateway.muteRemote(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===Bv.DISCONNECT_P2P?t():i(e)}else t()})),this._p2pChannel.on(ET.StateChange,((e,t)=>{t===vT.Connected&&this._p2pChannel.republish()}))}_handleP2PChannelEvents(){this._p2pChannel.on(ET.RequestMuteLocal,(async(e,t,i)=>{if(this._joinInfo)try{await this._gateway.muteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===Bv.DISCONNECT_P2P?t():i(e)}else t()})),this._p2pChannel.on(ET.RequestUnmuteLocal,(async(e,t,i)=>{if(this._joinInfo)try{await this._gateway.unmuteLocal(e,this._joinInfo.stringUid||this._joinInfo.uid),t()}catch(e){e.code===Bv.DISCONNECT_P2P?t():i(e)}else t()})),this._p2pChannel.on(ET.RequestRePublish,((e,t,i)=>{this.publish(e,!1).then(t).catch(i)})),this._p2pChannel.on(ET.RequestRePublishDataChannel,((e,t,i)=>{nv.all(e.map((async e=>{await this._p2pChannel.publishDataChannel([e]);const t={streamId:e.id,ordered:e.ordered,maxRetransmits:e.maxRetransmits,metadata:e.metadata,channelId:e._originDataChannelId};try{await this._gateway.publishDataChannel(this._uid,t,!0)}catch(e){if(e.code!==Bv.DISCONNECT_P2P)throw e}}))).then(t).catch(i)})),this._p2pChannel.on(ET.RequestReSubscribe,(async(e,t,i)=>{try{for(const{user:t,kind:i}of e)i===pT.VIDEO?await this.subscribe(t,"video"):await this.subscribe(t,"audio");t()}catch(e){i(e)}})),this._p2pChannel.on(ET.RequestUpload,((e,t)=>{this._gateway.upload(e,t)})),this._p2pChannel.on(ET.RequestUploadStats,(e=>{this._gateway.uploadWRTCStats(e)})),this._p2pChannel.on(ET.MediaReconnectStart,(e=>{this.safeEmit(lE.MEDIA_RECONNECT_START,e)})),this._p2pChannel.on(ET.MediaReconnectEnd,(e=>{this.safeEmit(lE.MEDIA_RECONNECT_END,e)})),this._p2pChannel.on(ET.NeedSignalRTT,(e=>{e(this._gateway.getSignalRTT())})),this._p2pChannel.on(ET.RequestRestartICE,(async e=>{if(this._p2pChannel instanceof uD)return;const t=await this._p2pChannel.restartICE(e),i=await t.next();if(i.done)return;const n=i.value;let r;try{r=await this._gateway.restartICE({iceParameters:n})}catch(e){return void t.throw(e)}const{iceParameters:o}=function(e){const t=e.iceParameters;return{iceParameters:{iceUfrag:t.iceUfrag,icePwd:t.icePwd}}}(r);await t.next({remoteIceParameters:o})})),this._p2pChannel.on(ET.RequestReconnect,(async()=>{this._gateway.reconnect()})),this._p2pChannel.on(ET.RequestReconnectPC,(async()=>{var e;const{iceParameters:t,dtlsParameters:i,rtpCapabilities:n}=await this._p2pChannel.startP2PConnection({turnServer:null===(e=this._joinInfo)||void 0===e?void 0:e.turnServer}),{gatewayEstablishParams:r,gatewayAddress:o}=await this._gateway.reconnectPC({iceParameters:t,dtlsParameters:i,rtpCapabilities:n}),{dtlsParameters:s,iceParameters:a,candidates:c,rtpCapabilities:u,setup:d,cname:l}=bP(r,o);await this._p2pChannel.connect(a,s,c,u,d,l),await this._p2pChannel.republish(),await this._p2pChannel.reSubscribe()})),this._p2pChannel.on(ET.RequestUnpublishForReconnectPC,(async(e,t,i)=>{this._joinInfo&&void 0!==this._uid?(await this._gateway.unpublish(e,this._uid),t()):i()})),this._p2pChannel.on(ET.P2PLost,(()=>{this.safeEmit(lE.P2P_LOST,this.store.uid)})),this._p2pChannel.on(ET.UpdateVideoEncoder,(e=>{e._encoderConfig&&this._gateway.setVideoProfile(e._encoderConfig)})),this._p2pChannel.on(ET.ConnectionTypeChange,(e=>{this.safeEmit(lE.IS_USING_CLOUD_PROXY,e)})),this._p2pChannel.on(ET.RequestLowStreamParameter,(e=>{e(this._lowStreamParameter||{width:160,height:120,framerate:15,bitrate:50})})),this._p2pChannel.on(ET.QueryClientConnectionState,(e=>{e(this.connectionState)}))}getKeyMetrics(){return this.store.keyMetrics}async enableContentInspect(e){if("CONNECTED"!==this.connectionState||!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"[".concat(this._clientId,"] Client did not join channel"));if(this._inspect)throw new jS(Bv.INVALID_OPERATION,"[".concat(this._clientId,"] Inspect content service already in connecting/connected state"));if(!e)throw new jS(Bv.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig is necessary"));if(!e.inspectType||!Array.isArray(e.inspectType))throw new jS(Bv.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.inspectType is necessary and is an instance of Array."));{const t=[...new Set(e.inspectType)];t.forEach((e=>{var t;if(!Mn(t=["supervise","moderation"]).call(t,e))throw new jS(Bv.INVALID_PARAMS,"[".concat(this._clientId,"] ").concat(e," is not a valid inspect type."))})),e.inspectType=t}if(e&&e.extraInfo&&e.extraInfo.length>1024)throw new jS(Bv.INVALID_PARAMS,"[".concat(this._clientId,"] inspectConfig.extraInfo length cannot exceed 1024 bytes"));try{const t=new xL(e);this._inspect=t,this.handleVideoInspectEvents(this._inspect),await t.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},XE)}catch(e){throw Array.isArray(e)?e[0]:e}}async disableContentInspect(){if(!this._inspect)throw new jS(Bv.INVALID_OPERATION,"[".concat(this._clientId,"] inspectVideoContent not started"));try{this._inspect.close(),this._inspect=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}async setImageModeration(e,t){if(Fv(e,"enabled"),e){if(!t)throw new jS(Bv.INVALID_PARAMS,"[".concat(this._clientId,"] config is necessary"));if(Gv(t.interval,"interval",1e3,1/0),t&&t.extraInfo&&t.extraInfo.length>1024)throw new jS(Bv.INVALID_PARAMS,"[".concat(this._clientId,"] config.extraInfo length cannot exceed 1024 bytes"));if(t&&t.vendor&&t.vendor.length>1024)throw new jS(Bv.INVALID_PARAMS,"[".concat(this._clientId,"] config.vendor length cannot exceed 1024 bytes"));if("CONNECTED"!==this.connectionState||!this._joinInfo)throw new jS(Bv.INVALID_OPERATION,"[".concat(this._clientId,'] can not enable image moderation, not joined"'));try{if(this._moderation)return void this._moderation.updateConfig(t);const e=new mx(t);this._moderation=e,this.handleImageModerationEvents(this._moderation),await e.init({appId:this._joinInfo.appId,areaCode:"",cname:this._joinInfo.cname,sid:this._joinInfo.sid,token:this._joinInfo.token,uid:this._joinInfo.uid,cid:this._joinInfo.cid,vid:this._joinInfo.vid?Number(this._joinInfo.vid):0},XE)}catch(e){throw Array.isArray(e)?e[0]:e}}else{if(!this._moderation)throw new jS(Bv.INVALID_OPERATION,"[".concat(this._clientId,"] image moderation not started"));try{this._moderation.close(),this._moderation.removeAllListeners(),this._moderation=void 0}catch(e){throw Array.isArray(e)?e[0]:e}}}setP2PTransport(e){if(function(e){Wv(e,"transport",["default","auto","relay","sd-rtn"])}(e),"p2p"!==this.mode)throw new jS(Bv.INVALID_OPERATION,"only p2p mode can set p2pTransport");this.store.p2pTransport=e,Yw.info("[".concat(this._clientId,"] set client p2pTransport to ").concat(e))}handleImageModerationEvents(e){e.on(OT.CONNECTION_STATE_CHANGE,((t,i)=>{if(this.safeEmit(lE.IMAGE_MODERATION_CONNECTION_STATE_CHANGE,t,i),t===AT.CONNECTED){if("CONNECTED"!==this.connectionState)throw this.setImageModeration(!1),new jS(Bv.OPERATION_ABORTED,"Image moderation was cancelled because it left the channel");e.inspectImage()}})),e.on(OT.CLIENT_LOCAL_VIDEO_TRACK,(e=>{e(this.localTracks.filter((e=>"video"===e.trackMediaType))[0])}))}handleVideoInspectEvents(e){e.on(ST.CONNECTION_STATE_CHANGE,((t,i)=>{if(this.safeEmit(lE.CONTENT_INSPECT_CONNECTION_STATE_CHANGE,t,i),i===yT.CONNECTED){if("CONNECTED"!==this.connectionState)return void this.safeEmit(lE.CONTENT_INSPECT_ERROR,new jS(Bv.OPERATION_ABORTED,"Content inspect was cancelled because it left the channel"));e.inspectImage()}})),e.on(ST.INSPECT_RESULT,((e,t)=>{var i;if((null==t?void 0:t.code)===Bv.INVALID_OPERATION&&"DISCONNECTED"===this.connectionState)return Yw.debug("Stop inspect content because that has left channel"),null==this||null===(i=this._inspect)||void 0===i||i.close(),void(this._inspect=void 0);this.safeEmit(lE.CONTENT_INSPECT_RESULT,e,t)})),e.on(ST.CLIENT_LOCAL_VIDEO_TRACK,(e=>{e(this.localTracks.filter((e=>"video"===e.trackMediaType))[0])}))}getJoinChannelServiceRecords(){return Yw.debug("getJoinChannelServiceRecords"),this.store.joinChannelServiceRecords}async setPublishAudioFilterEnabled(e){Fv(e,"enabled"),kw("ENABLE_PUBLISH_AUDIO_FILTER",e),this._joinInfo&&await this._gateway.setPublishAudioFilterEnabled(e)}_handleResetAddStream(e,t){switch(t){case"audio":e._audio_added_=!1,e._trust_audio_stream_added_state_=!0;break;case"video":e._video_added_=!1,e._trust_video_stream_added_state_=!0}}}VS([sS(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],Ox.prototype,"leave",null),VS([sS({argsMap:(e,t)=>{if(!Array.isArray(t)){if(!(t instanceof _I))return[t];t=[t]}return t.map((e=>e?Object(e).toString():"null"))}}),BS("design:type",Function),BS("design:paramtypes",[Object,Boolean]),BS("design:returntype",nv)],Ox.prototype,"publish",null),VS([sS({argsMap:(e,t)=>(t||(t=[]),t instanceof gk?[t.getChannelId()]:(Array.isArray(t)||(t=[t]),t.map((e=>e.getTrackId()))))}),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],Ox.prototype,"unpublish",null),VS([sS({argsMap:(e,t,i,n)=>[t.uid,i,n]}),BS("design:type",Function),BS("design:paramtypes",[rD,String,Number]),BS("design:returntype",nv)],Ox.prototype,"subscribe",null),VS([sS({argsMap:(e,t,i)=>[t,i]}),BS("design:type",Function),BS("design:paramtypes",[Object,String]),BS("design:returntype",nv)],Ox.prototype,"presubscribe",null),VS([sS({argsMap:(e,t)=>t.map((e=>{let{user:t,mediaType:i}=e;return[null==t?void 0:t.uid,i]}))}),BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],Ox.prototype,"massSubscribe",null),VS([sS({argsMap:(e,t,i,n)=>[t.uid,i,n]}),BS("design:type",Function),BS("design:paramtypes",[rD,String,Number]),BS("design:returntype",nv)],Ox.prototype,"unsubscribe",null),VS([sS({argsMap:(e,t)=>t.map((e=>{let{user:t,mediaType:i}=e;return{uid:null==t?void 0:t.uid,mediaType:i}}))}),BS("design:type",Function),BS("design:paramtypes",[Array]),BS("design:returntype",nv)],Ox.prototype,"massUnsubscribe",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],Ox.prototype,"setLowStreamParameter",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],Ox.prototype,"enableDualStream",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],Ox.prototype,"disableDualStream",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[String,Object]),BS("design:returntype",nv)],Ox.prototype,"setClientRole",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[String,Boolean]),BS("design:returntype",void 0)],Ox.prototype,"setProxyServer",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Object,Boolean]),BS("design:returntype",void 0)],Ox.prototype,"setTurnServer",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",void 0)],Ox.prototype,"setLicense",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Number]),BS("design:returntype",void 0)],Ox.prototype,"startProxyServer",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],Ox.prototype,"stopProxyServer",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",void 0)],Ox.prototype,"setLocalAccessPointsV2",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Array,String]),BS("design:returntype",void 0)],Ox.prototype,"setLocalAccessPoints",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Number]),BS("design:returntype",nv)],Ox.prototype,"setRemoteDefaultVideoStreamType",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Object,Number]),BS("design:returntype",nv)],Ox.prototype,"setRemoteVideoStreamType",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Object,Number]),BS("design:returntype",nv)],Ox.prototype,"setStreamFallbackOption",null),VS([sS({argsMap:(e,t)=>[t]}),BS("design:type",Function),BS("design:paramtypes",[String,String,Uint8Array]),BS("design:returntype",void 0)],Ox.prototype,"setEncryptionConfig",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],Ox.prototype,"renewToken",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",void 0)],Ox.prototype,"enableAudioVolumeIndicator",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[String,Boolean]),BS("design:returntype",nv)],Ox.prototype,"startLiveStreaming",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],Ox.prototype,"setLiveTranscoding",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",nv)],Ox.prototype,"stopLiveStreaming",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[String,Object]),BS("design:returntype",nv)],Ox.prototype,"addInjectStreamUrl",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],Ox.prototype,"removeInjectStreamUrl",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[bD]),BS("design:returntype",nv)],Ox.prototype,"startChannelMediaRelay",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[bD]),BS("design:returntype",nv)],Ox.prototype,"updateChannelMediaRelay",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],Ox.prototype,"stopChannelMediaRelay",null),VS([sS({argsMap:(e,t)=>(Array.isArray(t)||(t=[t]),[JSON.stringify(t)])}),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],Ox.prototype,"sendCustomReportMessage",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Object,Object]),BS("design:returntype",nv)],Ox.prototype,"pickSVCLayer",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],Ox.prototype,"setRTMConfig",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Object]),BS("design:returntype",nv)],Ox.prototype,"enableContentInspect",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",nv)],Ox.prototype,"disableContentInspect",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Boolean,Object]),BS("design:returntype",nv)],Ox.prototype,"setImageModeration",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[String]),BS("design:returntype",void 0)],Ox.prototype,"setP2PTransport",null),VS([sS({reportResult:!0}),BS("design:type",Function),BS("design:paramtypes",[]),BS("design:returntype",Array)],Ox.prototype,"getJoinChannelServiceRecords",null),VS([sS(),BS("design:type",Function),BS("design:paramtypes",[Boolean]),BS("design:returntype",nv)],Ox.prototype,"setPublishAudioFilterEnabled",null);class Mx{constructor(e,t){oh(this,"id",0),oh(this,"element",void 0),oh(this,"peerPair",void 0),oh(this,"context",void 0),oh(this,"audioPlayerElement",void 0),oh(this,"audioTrack",void 0),Mx.count+=1,this.id=Mx.count,this.element=e,this.context=t}initPeers(){this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=e=>{const t=document.createElement("audio");t.srcObject=new MediaStream([e.track]),t.play(),this.audioPlayerElement=t}}async switchSdp(){if(!this.peerPair)return;const e=async(e,t)=>{const i="offer"===t?await e.createOffer():await e.createAnswer();return await e.setLocalDescription(i),"complete"===e.iceGatheringState?e.localDescription:new nv((t=>{e.onicegatheringstatechange=()=>{"complete"===e.iceGatheringState&&t(e.localDescription)}}))},t=async(e,t)=>await e.setRemoteDescription(t);try{const i=await e(this.peerPair[0],"offer");await t(this.peerPair[1],i);const n=await e(this.peerPair[1],"answer");await t(this.peerPair[0],n)}catch(e){throw new jS(Bv.LOCAL_AEC_ERROR,e.toString()).print()}}async getTracksFromMediaElement(e){if(this.audioTrack)return this.audioTrack;let t;try{e instanceof HTMLVideoElement&&(e.captureStream?e.captureStream():e.mozCaptureStream()),t=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(e).connect(t)}catch(e){throw new jS(Bv.LOCAL_AEC_ERROR,e.toString()).print()}if(!t)throw new jS(Bv.LOCAL_AEC_ERROR,"no dest node when local aec").print();const i=t.stream.getAudioTracks()[0];return this.audioTrack=i,i}getElement(){return this.element}async startEchoCancellation(){this.context.resume(),this.peerPair&&this.close(),this.initPeers();const e=this.element,t=await this.getTracksFromMediaElement(e);this.peerPair&&this.peerPair[0].addTrack(t),await this.switchSdp()}close(){Yw.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&this.peerPair.forEach((e=>{e.close()})),this.peerPair=void 0,this.audioPlayerElement=void 0}}oh(Mx,"count",0);const Nx=window.AudioContext||window.webkitAudioContext;class kx{constructor(){oh(this,"units",[]),oh(this,"context",void 0)}processExternalMediaAEC(e){if(!this._doesEnvironmentNeedAEC())return Yw.debug("the system does not need to process local aec"),-1;this.context||(this.context=new Nx);let t=this.units.find((t=>t&&t.getElement()===e));return t||(t=new Mx(e,this.context),this.units.push(t)),t.startEchoCancellation(),Yw.debug("start processing local audio echo cancellation, id is",t.id),t.id}_doesEnvironmentNeedAEC(){return mv().name!==dv.SAFARI}}VS([sS({report:aS}),BS("design:type",Function),BS("design:paramtypes",[HTMLAudioElement]),BS("design:returntype",Number)],kx.prototype,"processExternalMediaAEC",null);const Px=new kx;function Dx(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function Lx(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Dx(Object(i),!0).forEach((function(t){oh(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Dx(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}const xx=window||document;function Ux(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!xx)return;const i=Bx._cspEventHandlerPointer;if(i&&t)return void console.error(i,t);const n=e=>{if(!(e&&e.blockedURI&&(Bx.onSecurityPolicyViolation||Bx.getListeners(CT.SECURITY_POLICY_VIOLATION).length>0)))return;const t=e.blockedURI;Pw("CSP_DETECTED_HOSTNAME_LIST").some((e=>Mn(t).call(t,e)))&&(Bx.onSecurityPolicyViolation&&"function"==typeof Bx.onSecurityPolicyViolation&&Bx.onSecurityPolicyViolation(e),Bx.getListeners(CT.SECURITY_POLICY_VIOLATION).length>0&&Bx.safeEmit(CT.SECURITY_POLICY_VIOLATION,e))};i&&xx.removeEventListener("securitypolicyviolation",i),(t||e&&"function"==typeof e||Bx.getListeners(CT.SECURITY_POLICY_VIOLATION).length>0)&&xx.addEventListener("securitypolicyviolation",n),Bx._cspEventHandlerPointer=n}kw("PROCESS_ID","process-".concat(BE(8,""),"-").concat(BE(4,""),"-").concat(BE(4,""),"-").concat(BE(4,""),"-").concat(BE(12,""))),function(){let e;try{e=window.localStorage.getItem("websdk_ng_global_parameter")}catch(e){return void Yw.error("Error loading sdk config",e.message)}if(e)try{const t=JSON.parse(window.atob(e)),i=Date.now();Yw.debug("Loading global parameters from cache",t),Object.keys(t).forEach((e=>{if(Object.prototype.hasOwnProperty.call(Nw,e)){const{value:n,expires:r}=t[e];if(r&&r<=i)return;Dw[e]=n,Nw[e]=n}}))}catch(r){Yw.error("Error loading mutableParamsCache: ".concat(e),r.message)}}(),Array.isArray(Dw.AREAS)&&Dw.AREAS.length>0&&iC(Dw.AREAS,!0);const Vx=(e,t,i)=>{Yw.debug("setParameter key:".concat(e,", value:").concat(JSON.stringify(t))),kw(e,t,i)},Bx=function(e){const t=new rE,i=e,n={getListeners:t.getListeners.bind(t),on:(e,i)=>(function(e,t){e===CT.SECURITY_POLICY_VIOLATION&&Ux(t,!0)}(e,i),t.on.bind(t)(e,i)),addListener:t.addListener.bind(t),once:t.once.bind(t),off:t.off.bind(t),removeAllListeners:t.removeAllListeners.bind(t),emit:t.emit.bind(t),safeEmit:t.safeEmit.bind(t)};return Lx(Lx({},i),n)}({__TRACK_LIST__:qC,VERSION:Iw,BUILD:Mw,ESM_BUNDLER:!1,ESM:!1,UMD:!0,DEV:!1,setParameter:Vx,getParameter:Pw,getSupportedCodec:async function(){let e={audio:[],video:[]};try{let t=new RTCPeerConnection;t.addTransceiver("video",{direction:"recvonly"}),t.addTransceiver("audio",{direction:"recvonly"});const i=(await t.createOffer()).sdp;if(!i)return e;t.close(),t=null,e=function(e){const t={video:[],audio:[]};return e.match(/ VP8/i)&&t.video.push("VP8"),e.match(/ VP9/i)&&t.video.push("VP9"),e.match(/ AV1/i)&&t.video.push("AV1"),e.match(/ H264/i)&&t.video.push("H264"),e.match(/ H265/i)&&t.video.push("H265"),e.match(/ opus/i)&&t.audio.push("OPUS"),e.match(/ PCMU/i)&&t.audio.push("PCMU"),e.match(/ PCMA/i)&&t.audio.push("PCMA"),e.match(/ G722/i)&&t.audio.push("G722"),t}(i)}catch(e){throw new jS(Bv.CREATE_OFFER_FAILED,e.toString&&e.toString()).print()}return e},checkSystemRequirements:function(){const e=aS.reportApiInvoke(null,{name:aE.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:cE.TRACER});let t=!1;try{const e=window.RTCPeerConnection,i=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,n=window.WebSocket;t=!!(e&&i&&n)}catch(e){return Yw.error("check system requirement failed: ",e),!1}let i=!1;const n=mv();n.name===dv.CHROME&&Number(n.version)>=58&&(!bv()||Ev())&&(i=!0),n.name===dv.FIREFOX&&Number(n.version)>=56&&(i=!0),n.name===dv.OPERA&&Number(n.version)>=45&&(i=!0),n.name===dv.SAFARI&&Number(n.version)>=11&&(i=!0),(Dv()||mv().name===dv.QQ)&&(i=!0),Yw.debug("checkSystemRequirements, api:",t,"browser",i);const r=t&&i;return e.onSuccess(r),r},getDevices:function(e){return FI.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return FI.getRecordingDevices(e)},getCameras:function(e){return FI.getCamerasDevices(e)},getElectronScreenSources:kI,getPlaybackDevices:function(e){return FI.getSpeakers(e)},createClient:function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{codec:"vp8",audioCodec:"opus",mode:"rtc"};const i=aS.reportApiInvoke(null,{name:aE.CREATE_CLIENT,options:[t],tag:cE.TRACER});try{!function(e){Wv(e.codec,"config.codec",["vp8","vp9","av1","h264","h265"]),Wv(e.mode,"config.mode",["rtc","live","p2p"]),void 0!==e.audioCodec&&Wv(e.audioCodec,"config.audioCodec",["opus","pcmu","pcma","g722"]),void 0!==e.proxyServer&&qv(e.proxyServer,"config.proxyServer",1,1e4),void 0!==e.turnServer&&gE(e.turnServer),void 0!==e.httpRetryConfig&&mE(e.httpRetryConfig),void 0!==e.websocketRetryConfig&&mE(e.websocketRetryConfig)}(t)}catch(e){throw i.onError(e),e}return Cx()||("vp9"===t.codec&&(t.codec="vp8",Yw.debug("browser not support vp9, force use vp8")),kw("UNSUPPORTED_VIDEO_CODEC",["vp9"])),void 0===t.audioCodec&&(t.audioCodec="opus"),i.onSuccess(),new Ox(Ax(Ax({forceWaitGatewayResponse:!0},t),{},{role:Mn(e=["rtc","p2p"]).call(e,t.mode)?"host":t.role||"audience"}))},createCameraVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.CREATE_CAM_VIDEO_TRACK,options:[LA({},e)]}),i=pA(e),n=BE(8,"track-cam-");let r=null;const o="720p_auto"===e.encoderConfig;Yw.info("start create camera video track with config",JSON.stringify(e),"trackId",n);try{r=(await UI({video:i},n)).getVideoTracks()[0]||null}catch(e){throw t.onError(e),e}if(!r){const e=new jv(Bv.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(e),e.throw(Yw)}e.optimizationMode&&xA(n,r,e,jC(e.encoderConfig));const s=new PA(r,e,i,e.scalabiltyMode?WC(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,n);return o&&s.startMonitorStats(),t.onSuccess(s.getTrackId()),Yw.info("create camera video success, trackId:",n),s},createCustomVideoTrack:function(e){const t=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),i=new kA(e.mediaStreamTrack,{width:e.width,height:e.height,frameRate:e.frameRate,bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?WC(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,BE(8,"track-cus-"),[YC.CUSTOM_TRACK]);return t.onSuccess(i.getTrackId()),Yw.info("create custom video track success with config",e,"trackId",i.getTrackId()),i},createScreenVideoTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"disable";const i=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.CREATE_SCREEN_VIDEO_TRACK,options:[LA({},e),t]}),n="720p_auto"===e.encoderConfig;e.encoderConfig?"string"==typeof e.encoderConfig||e.encoderConfig.width&&e.encoderConfig.height||(e.encoderConfig.width={max:1920},e.encoderConfig.height={max:1080}):e.encoderConfig="1080p_2";const r=function(e){const t={};e.screenSourceType&&(t.mediaSource=e.screenSourceType),e.extensionId&&yv()&&(t.extensionId=e.extensionId);const{displaySurface:i,selfBrowserSurface:n,surfaceSwitching:r,systemAudio:o}=e;(Rv(107)||Cv(107)||Iv(93))&&(i&&(Wv(i,"displaySurface",["browser","window","monitor"]),t.displaySurface=i),n?(Wv(n,"selfBrowserSurface",["exclude","include"]),t.selfBrowserSurface=n):t.selfBrowserSurface="include",r&&(Wv(r,"surfaceSwitching",["exclude","include"]),t.surfaceSwitching=r)),(Rv(105)||Cv(105)||Iv(91))&&o&&(Wv(o,"systemAudio",["exclude","include"]),t.systemAudio=o),e.electronScreenSourceId&&(t.sourceId=e.electronScreenSourceId);const s=e.encoderConfig?FC(e.encoderConfig):null;return t.mandatory={chromeMediaSource:"desktop",maxWidth:s?s.width:void 0,maxHeight:s?s.height:void 0},s&&(s.frameRate&&("number"==typeof s.frameRate?(t.mandatory.maxFrameRate=s.frameRate,t.mandatory.minFrameRate=s.frameRate):(t.mandatory.maxFrameRate=s.frameRate.max||s.frameRate.ideal||s.frameRate.exact||void 0,t.mandatory.minFrameRate=s.frameRate.min||s.frameRate.ideal||s.frameRate.exact||void 0),t.frameRate=s.frameRate),s.width&&(t.width=s.width),s.height&&(t.height=s.height)),t}(e),o=BE(8,"track-scr-v-");let s=null,a=null;const c=MC();if(!c.supportShareAudio&&"enable"===t){const e=new jv(Bv.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio");return i.onError(e),e.throw(Yw)}Yw.info("start create screen video track with config",e,"withAudio",t,"trackId",o);try{const e=await UI({screen:r,screenAudio:"auto"===t?c.supportShareAudio:"enable"===t},o);s=e.getVideoTracks()[0]||null,a=e.getAudioTracks()[0]||null}catch(e){throw i.onError(e),e}if(!s){const e=new jv(Bv.UNEXPECTED_ERROR,"can not find track in media stream");return i.onError(e),e.throw(Yw)}if(!a&&"enable"===t){s&&s.stop();const e=new jv(Bv.SHARE_AUDIO_NOT_ALLOWED);return i.onError(e),e.throw(Yw)}e.optimizationMode||(e.optimizationMode="detail"),e.optimizationMode&&(xA(o,s,e,e.encoderConfig&&FC(e.encoderConfig)||void 0),e.encoderConfig&&"string"!=typeof e.encoderConfig&&(e.encoderConfig.bitrateMin=e.encoderConfig.bitrateMax));const u=new kA(s,e.encoderConfig?FC(e.encoderConfig):{},e.scalabiltyMode?WC(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode,o,[YC.SCREEN_TRACK]);if(n&&u.startMonitorStats(),!a)return i.onSuccess(u.getTrackId()),Yw.info("create screen video track success","video:",u.getTrackId()),u;const d=new dA(a,void 0,BE(8,"track-scr-a-"),!1,!0);return i.onSuccess([u.getTrackId(),d.getTrackId()]),Yw.info("create screen video track success","video:",u.getTrackId(),"audio:",d.getTrackId()),[u,d]},createMicrophoneAndCameraTracks:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.CREATE_MIC_AND_CAM_TRACKS,options:[e,t]}),n="720p_auto"===t.encoderConfig,r=pA(t),o=mA(e),s=BE(8,"track-mic-"),a=BE(8,"track-cam-");let c=null,u=null;Yw.info("start create camera video track(".concat(a,") and microphone audio track(").concat(s,") with config, audio: ").concat(JSON.stringify(e),", video: ").concat(JSON.stringify(t)));try{const e=await UI({audio:o,video:r},"".concat(s,"-").concat(a));c=e.getAudioTracks()[0],u=e.getVideoTracks()[0]}catch(e){throw i.onError(e),e}if(!c||!u){const e=new jv(Bv.UNEXPECTED_ERROR,"can not find tracks in media stream");return i.onError(e),e.throw(Yw)}t.optimizationMode&&xA(a,u,t,jC(t.encoderConfig));const d=new lA(c,e,o,s),l=new PA(u,t,r,t.scalabiltyMode?WC(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,a);return n&&l.startMonitorStats(),i.onSuccess([d.getTrackId(),l.getTrackId()]),Yw.info("create camera video track(".concat(a,") and microphone audio track(").concat(s,") success")),[d,l]},createMicrophoneAudioTrack:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.CREATE_MIC_AUDIO_TRACK,options:[e]}),i=mA(e),n=BE(8,"track-mic-");let r=null;Yw.info("start create microphone audio track with config",JSON.stringify(e),"trackId",n);try{r=(await UI({audio:i},n)).getAudioTracks()[0]||null}catch(e){throw t.onError(e),e}if(!r){const e=new jv(Bv.UNEXPECTED_ERROR,"can not find track in media stream");return t.onError(e),e.throw(Yw)}const o=new lA(r,e,i,n);return t.onSuccess(o.getTrackId()),Yw.info("create microphone audio track success, trackId:",n),o},createCustomAudioTrack:function(e){const t=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),i=new dA(e.mediaStreamTrack,e.encoderConfig?HC(e.encoderConfig):{},BE(8,"track-cus-"),!1,!0);return Yw.info("create custom audio track success with config",e,"trackId",i.getTrackId()),t.onSuccess(i.getTrackId()),i},createBufferSourceAudioTrack:async function(e){var t;const{cacheOnlineFile:i,encoderConfig:n}=e;let{source:r}=e;const o={source:r instanceof AudioBuffer?"AudioBuffer":r instanceof File?null!==(t=File.name)&&void 0!==t?t:"File":r,cacheOnlineFile:i,encoderConfig:n},s=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.CREATE_BUFFER_AUDIO_TRACK,options:[o]});if(Pw("DISABLE_WEBAUDIO"))throw new jv(Bv.NOT_SUPPORTED,"can not create BufferSourceAudioTrack when WebAudio disabled");const a=BE(8,"track-buf-");Yw.info("start create buffer source audio track with config",JSON.stringify(o),"trackId",a);const c=r;if(!(r instanceof AudioBuffer))try{r=await vA(r,i)}catch(e){return s.onError(e),e.throw(Yw)}const u=new _A(r),d=new hA(c,u,n?HC(n):{},a);return Yw.info("create buffer source audio track success, trackId:",a),s.onSuccess(d.getTrackId()),d},setAppType:function(e){if(Yw.debug("setAppType: ".concat(e)),!(Number.isInteger(e)&&e>=0))throw Yw.debug("Invalid appType"),new jS(Bv.INVALID_PARAMS,"invalid app type",e);kw("APP_TYPE",Math.floor(e))},setLogLevel:function(e){Yw.setLogLevel(e)},enableLogUpload:function(){Pw("USE_NEW_LOG")?kw("UPLOAD_LOG",!0):Yw.enableLogUpload()},disableLogUpload:function(){Pw("USE_NEW_LOG")?kw("UPLOAD_LOG",!1):Yw.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new bD},checkAudioTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const i=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof dA||e instanceof FA)){const e=new jS(Bv.INVALID_TRACK,"the parameter is not a audio track");return i.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const n=e instanceof dA?e.getTrackLabel():"remote_track",r=e.getVolumeLevel();let o=r,s=r;const a=Date.now();return new nv((r=>{const c=setInterval((()=>{const u=e.getVolumeLevel();o=u>o?u:o,s=u<s?u:s;const d=o-s>1e-4,l=Date.now()-a;if(d||l>t){clearInterval(c);const t=d,s={duration:l,deviceLabel:n,maxVolumeLevel:o,result:t};Yw.info("[track-".concat(e.getTrackId(),"] check audio track active completed. ").concat(JSON.stringify(s))),i.onSuccess(s),r(t)}}),200)}))},checkVideoTrackIsActive:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;const i=aS.reportApiInvoke(null,{tag:cE.TRACER,name:aE.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[t]});if(!(e instanceof kA||e instanceof jA)){const e=new jS(Bv.INVALID_TRACK,"the parameter is not a video track");return i.onError(e),e.throw()}t&&t<1e3&&(t=1e3);const n=e instanceof kA?e.getTrackLabel():"remote_track",r=e.getMediaStreamTrack(!0),o=document.createElement("video");o.style.width="1px",o.style.height="1px",o.setAttribute("muted",""),o.muted=!0,o.setAttribute("playsinline",""),o.controls=!1,(wv()||vv())&&(o.style.opacity="0.01",o.style.position="fixed",o.style.left="0",o.style.top="0",document.body.appendChild(o)),o.srcObject=new MediaStream([r]),o.play();const s=document.createElement("canvas");s.width=160,s.height=120;let a=0,c=0;try{const e=Date.now();a=await function(e,t,i,n){let r,o=0,s=null;return new nv(((a,c)=>{function u(){o>n&&r&&(r(),a(o));const t=i.getContext("2d");if(!t){const e=new jS(Bv.UNEXPECTED_ERROR,"can not get canvas 2d context.");return Yw.error(e.toString()),void c(e)}t.drawImage(e,0,0,160,120);const u=t.getImageData(0,0,i.width,i.height),d=Math.floor(u.data.length/3);if(s){for(let e=0;e<d;e+=3)if(u.data[e]!==s[e])return o+=1,void(s=u.data);s=u.data}else s=u.data}setTimeout((()=>{r&&(r(),a(o))}),t),r=CI((()=>{u()}),30)}))}(o,t,s,4),c=Date.now()-e}catch(e){throw i.onError(e),e}Rx===dv.SAFARI&&(o.pause(),o.remove()),o.srcObject=null;const u=a>4,d={duration:c,changedPicNum:a,deviceLabel:n,result:u};return Yw.info("[track-".concat(e.getTrackId(),"] check video track active completed. ").concat(JSON.stringify(d))),i.onSuccess(d),u},setArea:iC,audioElementPlayCenter:JI,resumeAudioContext:function(){JI.autoResumeAfterInterruption(!0)},processExternalMediaAEC:function(e){Px.processExternalMediaAEC(e)},registerExtensions:function(e){const t=Pw("PLUGIN_INFO")||[];e.forEach((e=>{"name"in e&&!Mn(t).call(t,e.name)&&t.push(e.name);const i=e;i.__registered__=!0,i.logger.hookLog=Yw.extLog,i.reporter.hookApiInvoke=aS.extApiInvoke,i.parameters&&Object.keys(i.parameters).forEach((e=>{i.parameters[e]=Pw(e)}))})),Vx("PLUGIN_INFO",t)},ChannelMediaRelayError:tT,ChannelMediaRelayEvent:$S,ChannelMediaRelayState:eT,RemoteStreamFallbackType:QC,RemoteStreamType:XC,ConnectionDisconnectedReason:dE,AudienceLatencyLevelType:uE,AREAS:aT});return Object.defineProperties(Bx,{onAudioAutoplayFailed:{get:()=>GI.onAudioAutoplayFailed,set:e=>{GI.onAudioAutoplayFailed=e}},onAutoplayFailed:{get:()=>GI.onAutoplayFailed,set:e=>{GI.onAutoplayFailed=e}},_onSecurityPolicyViolation:{value:void 0,writable:!0},_cspEventHandlerPointer:{value:void 0,writable:!0},onSecurityPolicyViolation:{get:()=>Bx._onSecurityPolicyViolation,set(e){Bx._onSecurityPolicyViolation=e,Ux(e)}},__CLIENT_LIST__:{get:()=>Pw("SHOW_GLOBAL_CLIENT_LIST")?lS:[]}}),FI.on(lI.CAMERA_DEVICE_CHANGED,(e=>{Yw.info("camera device changed",JSON.stringify(e)),Bx.onCameraChanged&&Bx.onCameraChanged(e),Bx.safeEmit(CT.CAMERA_CHANGED,e)})),FI.on(lI.RECORDING_DEVICE_CHANGED,(e=>{Yw.info("microphone device changed",JSON.stringify(e)),Bx.onMicrophoneChanged&&Bx.onMicrophoneChanged(e),Bx.safeEmit(CT.MICROPHONE_CHANGED,e)})),FI.on(lI.PLAYOUT_DEVICE_CHANGED,(e=>{Yw.debug("playout device changed",JSON.stringify(e)),Bx.onPlaybackDeviceChanged&&Bx.onPlaybackDeviceChanged(e),Bx.safeEmit(CT.PLAYBACK_DEVICE_CHANGED,e)})),JI.onAutoplayFailed=()=>{Yw.info("detect audio element autoplay failed"),GI.onAudioAutoplayFailed&&GI.onAudioAutoplayFailed()},bI.on("autoplay-failed",(()=>{Yw.info("detect webaudio autoplay failed"),GI.onAudioAutoplayFailed&&GI.onAudioAutoplayFailed(),Bx.safeEmit(CT.AUTOPLAY_FAILED)})),bI.on(NC.STATE_CHANGE,((e,t)=>{Yw.info("audio context state changed: ".concat(t," => ").concat(e)),Bx.onAudioContextStateChanged&&Bx.onAudioContextStateChanged(e,t),Bx.safeEmit(CT.AUDIO_CONTEXT_STATE_CHANGED,e,t)})),SE.on(pE.NETWORK_STATE_CHANGE,((e,t)=>{Yw.info("[network-indicator] network state changed, ".concat(t," => ").concat(e))})),window&&(window.__ARTC__=Bx),Bx}()}).call(this,i(9),i(6),i(7).Buffer)},function(e,t,i){"use strict";i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return d})),i.d(t,"d",(function(){return l}));var n=i(152);function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),i)}function o(e){if(e.type)return e;if("#"===e.charAt(0))return o(function(e){e=e.substr(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),i=e.match(t);return i&&1===i[0].length&&(i=i.map((function(e){return e+e}))),i?"rgb".concat(4===i.length?"a":"","(").concat(i.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}(e));var t=e.indexOf("("),i=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla"].indexOf(i))throw new Error(Object(n.a)(3,e));var r=e.substring(t+1,e.length-1).split(",");return{type:i,values:r=r.map((function(e){return parseFloat(e)}))}}function s(e){var t=e.type,i=e.values;return-1!==t.indexOf("rgb")?i=i.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(i[1]="".concat(i[1],"%"),i[2]="".concat(i[2],"%")),"".concat(t,"(").concat(i.join(", "),")")}function a(e,t){var i=c(e),n=c(t);return(Math.max(i,n)+.05)/(Math.min(i,n)+.05)}function c(e){var t="hsl"===(e=o(e)).type?o(function(e){var t=(e=o(e)).values,i=t[0],n=t[1]/100,r=t[2]/100,a=n*Math.min(r,1-r),c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+i/30)%12;return r-a*Math.max(Math.min(t-3,9-t,1),-1)},u="rgb",d=[Math.round(255*c(0)),Math.round(255*c(8)),Math.round(255*c(4))];return"hsla"===e.type&&(u+="a",d.push(t[3])),s({type:u,values:d})}(e)).values:e.values;return t=t.map((function(e){return(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function u(e,t){return e=o(e),t=r(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),e.values[3]=t,s(e)}function d(e,t){if(e=o(e),t=r(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb"))for(var i=0;i<3;i+=1)e.values[i]*=1-t;return s(e)}function l(e,t){if(e=o(e),t=r(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var i=0;i<3;i+=1)e.values[i]+=(255-e.values[i])*t;return s(e)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(152);function r(e){if("string"!==typeof e)throw new Error(Object(n.a)(7));return e.charAt(0).toUpperCase()+e.slice(1)}},function(e,t,i){"use strict";var n=i(11),r=i(2);function o(e,t){return 55296===(64512&e.charCodeAt(t))&&(!(t<0||t+1>=e.length)&&56320===(64512&e.charCodeAt(t+1)))}function s(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function a(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=r,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var i=[];if("string"===typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!==0&&(e="0"+e),r=0;r<e.length;r+=2)i.push(parseInt(e[r]+e[r+1],16))}else for(var n=0,r=0;r<e.length;r++){var s=e.charCodeAt(r);s<128?i[n++]=s:s<2048?(i[n++]=s>>6|192,i[n++]=63&s|128):o(e,r)?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),i[n++]=s>>18|240,i[n++]=s>>12&63|128,i[n++]=s>>6&63|128,i[n++]=63&s|128):(i[n++]=s>>12|224,i[n++]=s>>6&63|128,i[n++]=63&s|128)}else for(r=0;r<e.length;r++)i[r]=0|e[r];return i},t.toHex=function(e){for(var t="",i=0;i<e.length;i++)t+=a(e[i].toString(16));return t},t.htonl=s,t.toHex32=function(e,t){for(var i="",n=0;n<e.length;n++){var r=e[n];"little"===t&&(r=s(r)),i+=c(r.toString(16))}return i},t.zero2=a,t.zero8=c,t.join32=function(e,t,i,r){var o=i-t;n(o%4===0);for(var s=new Array(o/4),a=0,c=t;a<s.length;a++,c+=4){var u;u="big"===r?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],s[a]=u>>>0}return s},t.split32=function(e,t){for(var i=new Array(4*e.length),n=0,r=0;n<e.length;n++,r+=4){var o=e[n];"big"===t?(i[r]=o>>>24,i[r+1]=o>>>16&255,i[r+2]=o>>>8&255,i[r+3]=255&o):(i[r+3]=o>>>24,i[r+2]=o>>>16&255,i[r+1]=o>>>8&255,i[r]=255&o)}return i},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,i){return e+t+i>>>0},t.sum32_4=function(e,t,i,n){return e+t+i+n>>>0},t.sum32_5=function(e,t,i,n,r){return e+t+i+n+r>>>0},t.sum64=function(e,t,i,n){var r=e[t],o=n+e[t+1]>>>0,s=(o<n?1:0)+i+r;e[t]=s>>>0,e[t+1]=o},t.sum64_hi=function(e,t,i,n){return(t+n>>>0<t?1:0)+e+i>>>0},t.sum64_lo=function(e,t,i,n){return t+n>>>0},t.sum64_4_hi=function(e,t,i,n,r,o,s,a){var c=0,u=t;return c+=(u=u+n>>>0)<t?1:0,c+=(u=u+o>>>0)<o?1:0,e+i+r+s+(c+=(u=u+a>>>0)<a?1:0)>>>0},t.sum64_4_lo=function(e,t,i,n,r,o,s,a){return t+n+o+a>>>0},t.sum64_5_hi=function(e,t,i,n,r,o,s,a,c,u){var d=0,l=t;return d+=(l=l+n>>>0)<t?1:0,d+=(l=l+o>>>0)<o?1:0,d+=(l=l+a>>>0)<a?1:0,e+i+r+s+c+(d+=(l=l+u>>>0)<u?1:0)>>>0},t.sum64_5_lo=function(e,t,i,n,r,o,s,a,c,u){return t+n+o+a+u>>>0},t.rotr64_hi=function(e,t,i){return(t<<32-i|e>>>i)>>>0},t.rotr64_lo=function(e,t,i){return(e<<32-i|t>>>i)>>>0},t.shr64_hi=function(e,t,i){return e>>>i},t.shr64_lo=function(e,t,i){return(e<<32-i|t>>>i)>>>0}},function(e,t,i){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";var n=i(1),r=i(5),o=i(0),s=i.n(o),a=i(140),c=i.n(a),u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d="object"===("undefined"===typeof window?"undefined":u(window))&&"object"===("undefined"===typeof document?"undefined":u(document))&&9===document.nodeType;var l=i(17);function h(e){var t=function(e,t){if("object"!=Object(l.a)(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=Object(l.a)(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Object(l.a)(t)?t:String(t)}function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,h(n.key),n)}}function p(e,t,i){return t&&f(e.prototype,t),i&&f(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}var m=i(48),_=i(49),g=i(38),v={}.constructor;function E(e){if(null==e||"object"!==typeof e)return e;if(Array.isArray(e))return e.map(E);if(e.constructor!==v)return e;var t={};for(var i in e)t[i]=E(e[i]);return t}function b(e,t,i){void 0===e&&(e="unnamed");var n=i.jss,r=E(t),o=n.plugins.onCreateRule(e,r,i);return o||(e[0],null)}var y=function(e,t){for(var i="",n=0;n<e.length&&"!important"!==e[n];n++)i&&(i+=t),i+=e[n];return i},w=function(e){if(!Array.isArray(e))return e;var t="";if(Array.isArray(e[0]))for(var i=0;i<e.length&&"!important"!==e[i];i++)t&&(t+=", "),t+=y(e[i]," ");else t=y(e,", ");return"!important"===e[e.length-1]&&(t+=" !important"),t};function S(e){return e&&!1===e.format?{linebreak:"",space:""}:{linebreak:"\n",space:" "}}function T(e,t){for(var i="",n=0;n<t;n++)i+="  ";return i+e}function R(e,t,i){void 0===i&&(i={});var n="";if(!t)return n;var r=i.indent,o=void 0===r?0:r,s=t.fallbacks;!1===i.format&&(o=-1/0);var a=S(i),c=a.linebreak,u=a.space;if(e&&o++,s)if(Array.isArray(s))for(var d=0;d<s.length;d++){var l=s[d];for(var h in l){var f=l[h];null!=f&&(n&&(n+=c),n+=T(h+":"+u+w(f)+";",o))}}else for(var p in s){var m=s[p];null!=m&&(n&&(n+=c),n+=T(p+":"+u+w(m)+";",o))}for(var _ in t){var g=t[_];null!=g&&"fallbacks"!==_&&(n&&(n+=c),n+=T(_+":"+u+w(g)+";",o))}return(n||i.allowEmpty)&&e?(n&&(n=""+c+n+c),T(""+e+u+"{"+n,--o)+T("}",o)):n}var C=/([[\].#*$><+~=|^:(),"'`\s])/g,I="undefined"!==typeof CSS&&CSS.escape,A=function(e){return I?I(e):e.replace(C,"\\$1")},O=function(){function e(e,t,i){this.type="style",this.isProcessed=!1;var n=i.sheet,r=i.Renderer;this.key=e,this.options=i,this.style=t,n?this.renderer=n.renderer:r&&(this.renderer=new r)}return e.prototype.prop=function(e,t,i){if(void 0===t)return this.style[e];var n=!!i&&i.force;if(!n&&this.style[e]===t)return this;var r=t;i&&!1===i.process||(r=this.options.jss.plugins.onChangeValue(t,e,this));var o=null==r||!1===r,s=e in this.style;if(o&&!s&&!n)return this;var a=o&&s;if(a?delete this.style[e]:this.style[e]=r,this.renderable&&this.renderer)return a?this.renderer.removeProperty(this.renderable,e):this.renderer.setProperty(this.renderable,e,r),this;var c=this.options.sheet;return c&&c.attached,this},e}(),M=function(e){function t(t,i,n){var r;r=e.call(this,t,i,n)||this;var o=n.selector,s=n.scoped,a=n.sheet,c=n.generateId;return o?r.selectorText=o:!1!==s&&(r.id=c(Object(_.a)(Object(_.a)(r)),a),r.selectorText="."+A(r.id)),r}Object(m.a)(t,e);var i=t.prototype;return i.applyTo=function(e){var t=this.renderer;if(t){var i=this.toJSON();for(var n in i)t.setProperty(e,n,i[n])}return this},i.toJSON=function(){var e={};for(var t in this.style){var i=this.style[t];"object"!==typeof i?e[t]=i:Array.isArray(i)&&(e[t]=w(i))}return e},i.toString=function(e){var t=this.options.sheet,i=!!t&&t.options.link?Object(n.a)({},e,{allowEmpty:!0}):e;return R(this.selectorText,this.style,i)},p(t,[{key:"selector",set:function(e){if(e!==this.selectorText){this.selectorText=e;var t=this.renderer,i=this.renderable;if(i&&t)t.setSelector(i,e)||t.replaceRule(i,this)}},get:function(){return this.selectorText}}]),t}(O),N={onCreateRule:function(e,t,i){return"@"===e[0]||i.parent&&"keyframes"===i.parent.type?null:new M(e,t,i)}},k={indent:1,children:!0},P=/@([\w-]+)/,D=function(){function e(e,t,i){this.type="conditional",this.isProcessed=!1,this.key=e;var r=e.match(P);for(var o in this.at=r?r[1]:"unknown",this.query=i.name||"@"+this.at,this.options=i,this.rules=new ne(Object(n.a)({},i,{parent:this})),t)this.rules.add(o,t[o]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.indexOf=function(e){return this.rules.indexOf(e)},t.addRule=function(e,t,i){var n=this.rules.add(e,t,i);return n?(this.options.jss.plugins.onProcessRule(n),n):null},t.replaceRule=function(e,t,i){var n=this.rules.replace(e,t,i);return n&&this.options.jss.plugins.onProcessRule(n),n},t.toString=function(e){void 0===e&&(e=k);var t=S(e).linebreak;if(null==e.indent&&(e.indent=k.indent),null==e.children&&(e.children=k.children),!1===e.children)return this.query+" {}";var i=this.rules.toString(e);return i?this.query+" {"+t+i+t+"}":""},e}(),L=/@container|@media|@supports\s+/,x={onCreateRule:function(e,t,i){return L.test(e)?new D(e,t,i):null}},U={indent:1,children:!0},V=/@keyframes\s+([\w-]+)/,B=function(){function e(e,t,i){this.type="keyframes",this.at="@keyframes",this.isProcessed=!1;var r=e.match(V);r&&r[1]?this.name=r[1]:this.name="noname",this.key=this.type+"-"+this.name,this.options=i;var o=i.scoped,s=i.sheet,a=i.generateId;for(var c in this.id=!1===o?this.name:A(a(this,s)),this.rules=new ne(Object(n.a)({},i,{parent:this})),t)this.rules.add(c,t[c],Object(n.a)({},i,{parent:this}));this.rules.process()}return e.prototype.toString=function(e){void 0===e&&(e=U);var t=S(e).linebreak;if(null==e.indent&&(e.indent=U.indent),null==e.children&&(e.children=U.children),!1===e.children)return this.at+" "+this.id+" {}";var i=this.rules.toString(e);return i&&(i=""+t+i+t),this.at+" "+this.id+" {"+i+"}"},e}(),j=/@keyframes\s+/,F=/\$([\w-]+)/g,W=function(e,t){return"string"===typeof e?e.replace(F,(function(e,i){return i in t?t[i]:e})):e},G=function(e,t,i){var n=e[t],r=W(n,i);r!==n&&(e[t]=r)},H={onCreateRule:function(e,t,i){return"string"===typeof e&&j.test(e)?new B(e,t,i):null},onProcessStyle:function(e,t,i){return"style"===t.type&&i?("animation-name"in e&&G(e,"animation-name",i.keyframes),"animation"in e&&G(e,"animation",i.keyframes),e):e},onChangeValue:function(e,t,i){var n=i.options.sheet;if(!n)return e;switch(t){case"animation":case"animation-name":return W(e,n.keyframes);default:return e}}},q=function(e){function t(){return e.apply(this,arguments)||this}return Object(m.a)(t,e),t.prototype.toString=function(e){var t=this.options.sheet,i=!!t&&t.options.link?Object(n.a)({},e,{allowEmpty:!0}):e;return R(this.key,this.style,i)},t}(O),K={onCreateRule:function(e,t,i){return i.parent&&"keyframes"===i.parent.type?new q(e,t,i):null}},z=function(){function e(e,t,i){this.type="font-face",this.at="@font-face",this.isProcessed=!1,this.key=e,this.style=t,this.options=i}return e.prototype.toString=function(e){var t=S(e).linebreak;if(Array.isArray(this.style)){for(var i="",n=0;n<this.style.length;n++)i+=R(this.at,this.style[n]),this.style[n+1]&&(i+=t);return i}return R(this.at,this.style,e)},e}(),Y=/@font-face/,J={onCreateRule:function(e,t,i){return Y.test(e)?new z(e,t,i):null}},X=function(){function e(e,t,i){this.type="viewport",this.at="@viewport",this.isProcessed=!1,this.key=e,this.style=t,this.options=i}return e.prototype.toString=function(e){return R(this.key,this.style,e)},e}(),Q={onCreateRule:function(e,t,i){return"@viewport"===e||"@-ms-viewport"===e?new X(e,t,i):null}},Z=function(){function e(e,t,i){this.type="simple",this.isProcessed=!1,this.key=e,this.value=t,this.options=i}return e.prototype.toString=function(e){if(Array.isArray(this.value)){for(var t="",i=0;i<this.value.length;i++)t+=this.key+" "+this.value[i]+";",this.value[i+1]&&(t+="\n");return t}return this.key+" "+this.value+";"},e}(),$={"@charset":!0,"@import":!0,"@namespace":!0},ee=[N,x,H,K,J,Q,{onCreateRule:function(e,t,i){return e in $?new Z(e,t,i):null}}],te={process:!0},ie={force:!0,process:!0},ne=function(){function e(e){this.map={},this.raw={},this.index=[],this.counter=0,this.options=e,this.classes=e.classes,this.keyframes=e.keyframes}var t=e.prototype;return t.add=function(e,t,i){var r=this.options,o=r.parent,s=r.sheet,a=r.jss,c=r.Renderer,u=r.generateId,d=r.scoped,l=Object(n.a)({classes:this.classes,parent:o,sheet:s,jss:a,Renderer:c,generateId:u,scoped:d,name:e,keyframes:this.keyframes,selector:void 0},i),h=e;e in this.raw&&(h=e+"-d"+this.counter++),this.raw[h]=t,h in this.classes&&(l.selector="."+A(this.classes[h]));var f=b(h,t,l);if(!f)return null;this.register(f);var p=void 0===l.index?this.index.length:l.index;return this.index.splice(p,0,f),f},t.replace=function(e,t,i){var r=this.get(e),o=this.index.indexOf(r);r&&this.remove(r);var s=i;return-1!==o&&(s=Object(n.a)({},i,{index:o})),this.add(e,t,s)},t.get=function(e){return this.map[e]},t.remove=function(e){this.unregister(e),delete this.raw[e.key],this.index.splice(this.index.indexOf(e),1)},t.indexOf=function(e){return this.index.indexOf(e)},t.process=function(){var e=this.options.jss.plugins;this.index.slice(0).forEach(e.onProcessRule,e)},t.register=function(e){this.map[e.key]=e,e instanceof M?(this.map[e.selector]=e,e.id&&(this.classes[e.key]=e.id)):e instanceof B&&this.keyframes&&(this.keyframes[e.name]=e.id)},t.unregister=function(e){delete this.map[e.key],e instanceof M?(delete this.map[e.selector],delete this.classes[e.key]):e instanceof B&&delete this.keyframes[e.name]},t.update=function(){var e,t,i;if("string"===typeof(arguments.length<=0?void 0:arguments[0])?(e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1],i=arguments.length<=2?void 0:arguments[2]):(t=arguments.length<=0?void 0:arguments[0],i=arguments.length<=1?void 0:arguments[1],e=null),e)this.updateOne(this.get(e),t,i);else for(var n=0;n<this.index.length;n++)this.updateOne(this.index[n],t,i)},t.updateOne=function(t,i,n){void 0===n&&(n=te);var r=this.options,o=r.jss.plugins,s=r.sheet;if(t.rules instanceof e)t.rules.update(i,n);else{var a=t.style;if(o.onUpdate(i,t,s,n),n.process&&a&&a!==t.style){for(var c in o.onProcessStyle(t.style,t,s),t.style){var u=t.style[c];u!==a[c]&&t.prop(c,u,ie)}for(var d in a){var l=t.style[d],h=a[d];null==l&&l!==h&&t.prop(d,null,ie)}}}},t.toString=function(e){for(var t="",i=this.options.sheet,n=!!i&&i.options.link,r=S(e).linebreak,o=0;o<this.index.length;o++){var s=this.index[o].toString(e);(s||n)&&(t&&(t+=r),t+=s)}return t},e}(),re=function(){function e(e,t){for(var i in this.attached=!1,this.deployed=!1,this.classes={},this.keyframes={},this.options=Object(n.a)({},t,{sheet:this,parent:this,classes:this.classes,keyframes:this.keyframes}),t.Renderer&&(this.renderer=new t.Renderer(this)),this.rules=new ne(this.options),e)this.rules.add(i,e[i]);this.rules.process()}var t=e.prototype;return t.attach=function(){return this.attached||(this.renderer&&this.renderer.attach(),this.attached=!0,this.deployed||this.deploy()),this},t.detach=function(){return this.attached?(this.renderer&&this.renderer.detach(),this.attached=!1,this):this},t.addRule=function(e,t,i){var n=this.queue;this.attached&&!n&&(this.queue=[]);var r=this.rules.add(e,t,i);return r?(this.options.jss.plugins.onProcessRule(r),this.attached?this.deployed?(n?n.push(r):(this.insertRule(r),this.queue&&(this.queue.forEach(this.insertRule,this),this.queue=void 0)),r):r:(this.deployed=!1,r)):null},t.replaceRule=function(e,t,i){var n=this.rules.get(e);if(!n)return this.addRule(e,t,i);var r=this.rules.replace(e,t,i);return r&&this.options.jss.plugins.onProcessRule(r),this.attached?this.deployed?(this.renderer&&(r?n.renderable&&this.renderer.replaceRule(n.renderable,r):this.renderer.deleteRule(n)),r):r:(this.deployed=!1,r)},t.insertRule=function(e){this.renderer&&this.renderer.insertRule(e)},t.addRules=function(e,t){var i=[];for(var n in e){var r=this.addRule(n,e[n],t);r&&i.push(r)}return i},t.getRule=function(e){return this.rules.get(e)},t.deleteRule=function(e){var t="object"===typeof e?e:this.rules.get(e);return!(!t||this.attached&&!t.renderable)&&(this.rules.remove(t),!(this.attached&&t.renderable&&this.renderer)||this.renderer.deleteRule(t.renderable))},t.indexOf=function(e){return this.rules.indexOf(e)},t.deploy=function(){return this.renderer&&this.renderer.deploy(),this.deployed=!0,this},t.update=function(){var e;return(e=this.rules).update.apply(e,arguments),this},t.updateOne=function(e,t,i){return this.rules.updateOne(e,t,i),this},t.toString=function(e){return this.rules.toString(e)},e}(),oe=function(){function e(){this.plugins={internal:[],external:[]},this.registry={}}var t=e.prototype;return t.onCreateRule=function(e,t,i){for(var n=0;n<this.registry.onCreateRule.length;n++){var r=this.registry.onCreateRule[n](e,t,i);if(r)return r}return null},t.onProcessRule=function(e){if(!e.isProcessed){for(var t=e.options.sheet,i=0;i<this.registry.onProcessRule.length;i++)this.registry.onProcessRule[i](e,t);e.style&&this.onProcessStyle(e.style,e,t),e.isProcessed=!0}},t.onProcessStyle=function(e,t,i){for(var n=0;n<this.registry.onProcessStyle.length;n++)t.style=this.registry.onProcessStyle[n](t.style,t,i)},t.onProcessSheet=function(e){for(var t=0;t<this.registry.onProcessSheet.length;t++)this.registry.onProcessSheet[t](e)},t.onUpdate=function(e,t,i,n){for(var r=0;r<this.registry.onUpdate.length;r++)this.registry.onUpdate[r](e,t,i,n)},t.onChangeValue=function(e,t,i){for(var n=e,r=0;r<this.registry.onChangeValue.length;r++)n=this.registry.onChangeValue[r](n,t,i);return n},t.use=function(e,t){void 0===t&&(t={queue:"external"});var i=this.plugins[t.queue];-1===i.indexOf(e)&&(i.push(e),this.registry=[].concat(this.plugins.external,this.plugins.internal).reduce((function(e,t){for(var i in t)i in e&&e[i].push(t[i]);return e}),{onCreateRule:[],onProcessRule:[],onProcessStyle:[],onProcessSheet:[],onChangeValue:[],onUpdate:[]}))},e}(),se=new(function(){function e(){this.registry=[]}var t=e.prototype;return t.add=function(e){var t=this.registry,i=e.options.index;if(-1===t.indexOf(e))if(0===t.length||i>=this.index)t.push(e);else for(var n=0;n<t.length;n++)if(t[n].options.index>i)return void t.splice(n,0,e)},t.reset=function(){this.registry=[]},t.remove=function(e){var t=this.registry.indexOf(e);this.registry.splice(t,1)},t.toString=function(e){for(var t=void 0===e?{}:e,i=t.attached,n=Object(g.a)(t,["attached"]),r=S(n).linebreak,o="",s=0;s<this.registry.length;s++){var a=this.registry[s];null!=i&&a.attached!==i||(o&&(o+=r),o+=a.toString(n))}return o},p(e,[{key:"index",get:function(){return 0===this.registry.length?0:this.registry[this.registry.length-1].options.index}}]),e}()),ae="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window&&window.Math===Math?window:"undefined"!==typeof self&&self.Math===Math?self:Function("return this")(),ce="2f1acc6c3a606b082e5eef5e54414ffb";null==ae[ce]&&(ae[ce]=0);var ue=ae[ce]++,de=function(e){void 0===e&&(e={});var t=0;return function(i,n){t+=1;var r="",o="";return n&&(n.options.classNamePrefix&&(o=n.options.classNamePrefix),null!=n.options.jss.id&&(r=String(n.options.jss.id))),e.minify?""+(o||"c")+ue+r+t:o+i.key+"-"+ue+(r?"-"+r:"")+"-"+t}},le=function(e){var t;return function(){return t||(t=e()),t}},he=function(e,t){try{return e.attributeStyleMap?e.attributeStyleMap.get(t):e.style.getPropertyValue(t)}catch(i){return""}},fe=function(e,t,i){try{var n=i;if(Array.isArray(i)&&(n=w(i)),e.attributeStyleMap)e.attributeStyleMap.set(t,n);else{var r=n?n.indexOf("!important"):-1,o=r>-1?n.substr(0,r-1):n;e.style.setProperty(t,o,r>-1?"important":"")}}catch(s){return!1}return!0},pe=function(e,t){try{e.attributeStyleMap?e.attributeStyleMap.delete(t):e.style.removeProperty(t)}catch(i){}},me=function(e,t){return e.selectorText=t,e.selectorText===t},_e=le((function(){return document.querySelector("head")}));function ge(e){var t=se.registry;if(t.length>0){var i=function(e,t){for(var i=0;i<e.length;i++){var n=e[i];if(n.attached&&n.options.index>t.index&&n.options.insertionPoint===t.insertionPoint)return n}return null}(t,e);if(i&&i.renderer)return{parent:i.renderer.element.parentNode,node:i.renderer.element};if(i=function(e,t){for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.attached&&n.options.insertionPoint===t.insertionPoint)return n}return null}(t,e),i&&i.renderer)return{parent:i.renderer.element.parentNode,node:i.renderer.element.nextSibling}}var n=e.insertionPoint;if(n&&"string"===typeof n){var r=function(e){for(var t=_e(),i=0;i<t.childNodes.length;i++){var n=t.childNodes[i];if(8===n.nodeType&&n.nodeValue.trim()===e)return n}return null}(n);if(r)return{parent:r.parentNode,node:r.nextSibling}}return!1}var ve=le((function(){var e=document.querySelector('meta[property="csp-nonce"]');return e?e.getAttribute("content"):null})),Ee=function(e,t,i){try{"insertRule"in e?e.insertRule(t,i):"appendRule"in e&&e.appendRule(t)}catch(n){return!1}return e.cssRules[i]},be=function(e,t){var i=e.cssRules.length;return void 0===t||t>i?i:t},ye=function(){function e(e){this.getPropertyValue=he,this.setProperty=fe,this.removeProperty=pe,this.setSelector=me,this.hasInsertedRules=!1,this.cssRules=[],e&&se.add(e),this.sheet=e;var t=this.sheet?this.sheet.options:{},i=t.media,n=t.meta,r=t.element;this.element=r||function(){var e=document.createElement("style");return e.textContent="\n",e}(),this.element.setAttribute("data-jss",""),i&&this.element.setAttribute("media",i),n&&this.element.setAttribute("data-meta",n);var o=ve();o&&this.element.setAttribute("nonce",o)}var t=e.prototype;return t.attach=function(){if(!this.element.parentNode&&this.sheet){!function(e,t){var i=t.insertionPoint,n=ge(t);if(!1!==n&&n.parent)n.parent.insertBefore(e,n.node);else if(i&&"number"===typeof i.nodeType){var r=i,o=r.parentNode;o&&o.insertBefore(e,r.nextSibling)}else _e().appendChild(e)}(this.element,this.sheet.options);var e=Boolean(this.sheet&&this.sheet.deployed);this.hasInsertedRules&&e&&(this.hasInsertedRules=!1,this.deploy())}},t.detach=function(){if(this.sheet){var e=this.element.parentNode;e&&e.removeChild(this.element),this.sheet.options.link&&(this.cssRules=[],this.element.textContent="\n")}},t.deploy=function(){var e=this.sheet;e&&(e.options.link?this.insertRules(e.rules):this.element.textContent="\n"+e.toString()+"\n")},t.insertRules=function(e,t){for(var i=0;i<e.index.length;i++)this.insertRule(e.index[i],i,t)},t.insertRule=function(e,t,i){if(void 0===i&&(i=this.element.sheet),e.rules){var n=e,r=i;if("conditional"===e.type||"keyframes"===e.type){var o=be(i,t);if(!1===(r=Ee(i,n.toString({children:!1}),o)))return!1;this.refCssRule(e,o,r)}return this.insertRules(n.rules,r),r}var s=e.toString();if(!s)return!1;var a=be(i,t),c=Ee(i,s,a);return!1!==c&&(this.hasInsertedRules=!0,this.refCssRule(e,a,c),c)},t.refCssRule=function(e,t,i){e.renderable=i,e.options.parent instanceof re&&this.cssRules.splice(t,0,i)},t.deleteRule=function(e){var t=this.element.sheet,i=this.indexOf(e);return-1!==i&&(t.deleteRule(i),this.cssRules.splice(i,1),!0)},t.indexOf=function(e){return this.cssRules.indexOf(e)},t.replaceRule=function(e,t){var i=this.indexOf(e);return-1!==i&&(this.element.sheet.deleteRule(i),this.cssRules.splice(i,1),this.insertRule(t,i))},t.getRules=function(){return this.element.sheet.cssRules},e}(),we=0,Se=function(){function e(e){this.id=we++,this.version="10.10.0",this.plugins=new oe,this.options={id:{minify:!1},createGenerateId:de,Renderer:d?ye:null,plugins:[]},this.generateId=de({minify:!1});for(var t=0;t<ee.length;t++)this.plugins.use(ee[t],{queue:"internal"});this.setup(e)}var t=e.prototype;return t.setup=function(e){return void 0===e&&(e={}),e.createGenerateId&&(this.options.createGenerateId=e.createGenerateId),e.id&&(this.options.id=Object(n.a)({},this.options.id,e.id)),(e.createGenerateId||e.id)&&(this.generateId=this.options.createGenerateId(this.options.id)),null!=e.insertionPoint&&(this.options.insertionPoint=e.insertionPoint),"Renderer"in e&&(this.options.Renderer=e.Renderer),e.plugins&&this.use.apply(this,e.plugins),this},t.createStyleSheet=function(e,t){void 0===t&&(t={});var i=t.index;"number"!==typeof i&&(i=0===se.index?0:se.index+1);var r=new re(e,Object(n.a)({},t,{jss:this,generateId:t.generateId||this.generateId,insertionPoint:this.options.insertionPoint,Renderer:this.options.Renderer,index:i}));return this.plugins.onProcessSheet(r),r},t.removeStyleSheet=function(e){return e.detach(),se.remove(e),this},t.createRule=function(e,t,i){if(void 0===t&&(t={}),void 0===i&&(i={}),"object"===typeof e)return this.createRule(void 0,e,t);var r=Object(n.a)({},i,{name:e,jss:this,Renderer:this.options.Renderer});r.generateId||(r.generateId=this.generateId),r.classes||(r.classes={}),r.keyframes||(r.keyframes={});var o=b(e,t,r);return o&&this.plugins.onProcessRule(o),o},t.use=function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.forEach((function(t){e.plugins.use(t)})),this},e}(),Te=function(e){return new Se(e)},Re="object"===typeof CSS&&null!=CSS&&"number"in CSS;function Ce(e){var t=null;for(var i in e){var n=e[i],r=typeof n;if("function"===r)t||(t={}),t[i]=n;else if("object"===r&&null!==n&&!Array.isArray(n)){var o=Ce(n);o&&(t||(t={}),t[i]=o)}}return t}Te();function Ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.baseClasses,i=e.newClasses;e.Component;if(!i)return t;var r=Object(n.a)({},t);return Object.keys(i).forEach((function(e){i[e]&&(r[e]="".concat(t[e]," ").concat(i[e]))})),r}var Ae={set:function(e,t,i,n){var r=e.get(t);r||(r=new Map,e.set(t,r)),r.set(i,n)},get:function(e,t,i){var n=e.get(t);return n?n.get(i):void 0},delete:function(e,t,i){e.get(t).delete(i)}},Oe=Ae;var Me=s.a.createContext(null);function Ne(){return s.a.useContext(Me)}var ke="function"===typeof Symbol&&Symbol.for?Symbol.for("mui.nested"):"__THEME_NESTED__",Pe=["checked","disabled","error","focused","focusVisible","required","expanded","selected"];var De=Date.now(),Le="fnValues"+De,xe="fnStyle"+ ++De,Ue=function(){return{onCreateRule:function(e,t,i){if("function"!==typeof t)return null;var n=b(e,{},i);return n[xe]=t,n},onProcessStyle:function(e,t){if(Le in t||xe in t)return e;var i={};for(var n in e){var r=e[n];"function"===typeof r&&(delete e[n],i[n]=r)}return t[Le]=i,e},onUpdate:function(e,t,i,n){var r=t,o=r[xe];o&&(r.style=o(e)||{});var s=r[Le];if(s)for(var a in s)r.prop(a,s[a](e),n)}}},Ve="@global",Be="@global ",je=function(){function e(e,t,i){for(var r in this.type="global",this.at=Ve,this.isProcessed=!1,this.key=e,this.options=i,this.rules=new ne(Object(n.a)({},i,{parent:this})),t)this.rules.add(r,t[r]);this.rules.process()}var t=e.prototype;return t.getRule=function(e){return this.rules.get(e)},t.addRule=function(e,t,i){var n=this.rules.add(e,t,i);return n&&this.options.jss.plugins.onProcessRule(n),n},t.replaceRule=function(e,t,i){var n=this.rules.replace(e,t,i);return n&&this.options.jss.plugins.onProcessRule(n),n},t.indexOf=function(e){return this.rules.indexOf(e)},t.toString=function(e){return this.rules.toString(e)},e}(),Fe=function(){function e(e,t,i){this.type="global",this.at=Ve,this.isProcessed=!1,this.key=e,this.options=i;var r=e.substr(8);this.rule=i.jss.createRule(r,t,Object(n.a)({},i,{parent:this}))}return e.prototype.toString=function(e){return this.rule?this.rule.toString(e):""},e}(),We=/\s*,\s*/g;function Ge(e,t){for(var i=e.split(We),n="",r=0;r<i.length;r++)n+=t+" "+i[r].trim(),i[r+1]&&(n+=", ");return n}var He=function(){return{onCreateRule:function(e,t,i){if(!e)return null;if(e===Ve)return new je(e,t,i);if("@"===e[0]&&e.substr(0,8)===Be)return new Fe(e,t,i);var n=i.parent;return n&&("global"===n.type||n.options.parent&&"global"===n.options.parent.type)&&(i.scoped=!1),i.selector||!1!==i.scoped||(i.selector=e),null},onProcessRule:function(e,t){"style"===e.type&&t&&(function(e,t){var i=e.options,r=e.style,o=r?r[Ve]:null;if(o){for(var s in o)t.addRule(s,o[s],Object(n.a)({},i,{selector:Ge(s,e.selector)}));delete r[Ve]}}(e,t),function(e,t){var i=e.options,r=e.style;for(var o in r)if("@"===o[0]&&o.substr(0,Ve.length)===Ve){var s=Ge(o.substr(Ve.length),e.selector);t.addRule(s,r[o],Object(n.a)({},i,{selector:s})),delete r[o]}}(e,t))}}},qe=/\s*,\s*/g,Ke=/&/g,ze=/\$([\w-]+)/g;var Ye=function(){function e(e,t){return function(i,n){var r=e.getRule(n)||t&&t.getRule(n);return r?r.selector:n}}function t(e,t){for(var i=t.split(qe),n=e.split(qe),r="",o=0;o<i.length;o++)for(var s=i[o],a=0;a<n.length;a++){var c=n[a];r&&(r+=", "),r+=-1!==c.indexOf("&")?c.replace(Ke,s):s+" "+c}return r}function i(e,t,i){if(i)return Object(n.a)({},i,{index:i.index+1});var r=e.options.nestingLevel;r=void 0===r?1:r+1;var o=Object(n.a)({},e.options,{nestingLevel:r,index:t.indexOf(e)+1});return delete o.name,o}return{onProcessStyle:function(r,o,s){if("style"!==o.type)return r;var a,c,u=o,d=u.options.parent;for(var l in r){var h=-1!==l.indexOf("&"),f="@"===l[0];if(h||f){if(a=i(u,d,a),h){var p=t(l,u.selector);c||(c=e(d,s)),p=p.replace(ze,c);var m=u.key+"-"+l;"replaceRule"in d?d.replaceRule(m,r[l],Object(n.a)({},a,{selector:p})):d.addRule(m,r[l],Object(n.a)({},a,{selector:p}))}else f&&d.addRule(l,{},a).addRule(u.key,r[l],{selector:u.selector});delete r[l]}}return r}}},Je=/[A-Z]/g,Xe=/^ms-/,Qe={};function Ze(e){return"-"+e.toLowerCase()}var $e=function(e){if(Qe.hasOwnProperty(e))return Qe[e];var t=e.replace(Je,Ze);return Qe[e]=Xe.test(t)?"-"+t:t};function et(e){var t={};for(var i in e){t[0===i.indexOf("--")?i:$e(i)]=e[i]}return e.fallbacks&&(Array.isArray(e.fallbacks)?t.fallbacks=e.fallbacks.map(et):t.fallbacks=et(e.fallbacks)),t}var tt=function(){return{onProcessStyle:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)e[t]=et(e[t]);return e}return et(e)},onChangeValue:function(e,t,i){if(0===t.indexOf("--"))return e;var n=$e(t);return t===n?e:(i.prop(n,e),null)}}},it=Re&&CSS?CSS.px:"px",nt=Re&&CSS?CSS.ms:"ms",rt=Re&&CSS?CSS.percent:"%";function ot(e){var t=/(-[a-z])/g,i=function(e){return e[1].toUpperCase()},n={};for(var r in e)n[r]=e[r],n[r.replace(t,i)]=e[r];return n}var st=ot({"animation-delay":nt,"animation-duration":nt,"background-position":it,"background-position-x":it,"background-position-y":it,"background-size":it,border:it,"border-bottom":it,"border-bottom-left-radius":it,"border-bottom-right-radius":it,"border-bottom-width":it,"border-left":it,"border-left-width":it,"border-radius":it,"border-right":it,"border-right-width":it,"border-top":it,"border-top-left-radius":it,"border-top-right-radius":it,"border-top-width":it,"border-width":it,"border-block":it,"border-block-end":it,"border-block-end-width":it,"border-block-start":it,"border-block-start-width":it,"border-block-width":it,"border-inline":it,"border-inline-end":it,"border-inline-end-width":it,"border-inline-start":it,"border-inline-start-width":it,"border-inline-width":it,"border-start-start-radius":it,"border-start-end-radius":it,"border-end-start-radius":it,"border-end-end-radius":it,margin:it,"margin-bottom":it,"margin-left":it,"margin-right":it,"margin-top":it,"margin-block":it,"margin-block-end":it,"margin-block-start":it,"margin-inline":it,"margin-inline-end":it,"margin-inline-start":it,padding:it,"padding-bottom":it,"padding-left":it,"padding-right":it,"padding-top":it,"padding-block":it,"padding-block-end":it,"padding-block-start":it,"padding-inline":it,"padding-inline-end":it,"padding-inline-start":it,"mask-position-x":it,"mask-position-y":it,"mask-size":it,height:it,width:it,"min-height":it,"max-height":it,"min-width":it,"max-width":it,bottom:it,left:it,top:it,right:it,inset:it,"inset-block":it,"inset-block-end":it,"inset-block-start":it,"inset-inline":it,"inset-inline-end":it,"inset-inline-start":it,"box-shadow":it,"text-shadow":it,"column-gap":it,"column-rule":it,"column-rule-width":it,"column-width":it,"font-size":it,"font-size-delta":it,"letter-spacing":it,"text-decoration-thickness":it,"text-indent":it,"text-stroke":it,"text-stroke-width":it,"word-spacing":it,motion:it,"motion-offset":it,outline:it,"outline-offset":it,"outline-width":it,perspective:it,"perspective-origin-x":rt,"perspective-origin-y":rt,"transform-origin":rt,"transform-origin-x":rt,"transform-origin-y":rt,"transform-origin-z":rt,"transition-delay":nt,"transition-duration":nt,"vertical-align":it,"flex-basis":it,"shape-margin":it,size:it,gap:it,grid:it,"grid-gap":it,"row-gap":it,"grid-row-gap":it,"grid-column-gap":it,"grid-template-rows":it,"grid-template-columns":it,"grid-auto-rows":it,"grid-auto-columns":it,"box-shadow-x":it,"box-shadow-y":it,"box-shadow-blur":it,"box-shadow-spread":it,"font-line-height":it,"text-shadow-x":it,"text-shadow-y":it,"text-shadow-blur":it});function at(e,t,i){if(null==t)return t;if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]=at(e,t[n],i);else if("object"===typeof t)if("fallbacks"===e)for(var r in t)t[r]=at(r,t[r],i);else for(var o in t)t[o]=at(e+"-"+o,t[o],i);else if("number"===typeof t&&!1===isNaN(t)){var s=i[e]||st[e];return!s||0===t&&s===it?t.toString():"function"===typeof s?s(t).toString():""+t+s}return t}var ct=function(e){void 0===e&&(e={});var t=ot(e);return{onProcessStyle:function(e,i){if("style"!==i.type)return e;for(var n in e)e[n]=at(n,e[n],t);return e},onChangeValue:function(e,i){return at(i,e,t)}}},ut=i(40),dt="",lt="",ht="",ft="",pt=d&&"ontouchstart"in document.documentElement;if(d){var mt={Moz:"-moz-",ms:"-ms-",O:"-o-",Webkit:"-webkit-"},_t=document.createElement("p").style;for(var gt in mt)if(gt+"Transform"in _t){dt=gt,lt=mt[gt];break}"Webkit"===dt&&"msHyphens"in _t&&(dt="ms",lt=mt.ms,ft="edge"),"Webkit"===dt&&"-apple-trailing-word"in _t&&(ht="apple")}var vt={js:dt,css:lt,vendor:ht,browser:ft,isTouch:pt};var Et={noPrefill:["appearance"],supportedProperty:function(e){return"appearance"===e&&("ms"===vt.js?"-webkit-"+e:vt.css+e)}},bt={noPrefill:["color-adjust"],supportedProperty:function(e){return"color-adjust"===e&&("Webkit"===vt.js?vt.css+"print-"+e:e)}},yt=/[-\s]+(.)?/g;function wt(e,t){return t?t.toUpperCase():""}function St(e){return e.replace(yt,wt)}function Tt(e){return St("-"+e)}var Rt,Ct={noPrefill:["mask"],supportedProperty:function(e,t){if(!/^mask/.test(e))return!1;if("Webkit"===vt.js){var i="mask-image";if(St(i)in t)return e;if(vt.js+Tt(i)in t)return vt.css+e}return e}},It={noPrefill:["text-orientation"],supportedProperty:function(e){return"text-orientation"===e&&("apple"!==vt.vendor||vt.isTouch?e:vt.css+e)}},At={noPrefill:["transform"],supportedProperty:function(e,t,i){return"transform"===e&&(i.transform?e:vt.css+e)}},Ot={noPrefill:["transition"],supportedProperty:function(e,t,i){return"transition"===e&&(i.transition?e:vt.css+e)}},Mt={noPrefill:["writing-mode"],supportedProperty:function(e){return"writing-mode"===e&&("Webkit"===vt.js||"ms"===vt.js&&"edge"!==vt.browser?vt.css+e:e)}},Nt={noPrefill:["user-select"],supportedProperty:function(e){return"user-select"===e&&("Moz"===vt.js||"ms"===vt.js||"apple"===vt.vendor?vt.css+e:e)}},kt={supportedProperty:function(e,t){return!!/^break-/.test(e)&&("Webkit"===vt.js?"WebkitColumn"+Tt(e)in t&&vt.css+"column-"+e:"Moz"===vt.js&&("page"+Tt(e)in t&&"page-"+e))}},Pt={supportedProperty:function(e,t){if(!/^(border|margin|padding)-inline/.test(e))return!1;if("Moz"===vt.js)return e;var i=e.replace("-inline","");return vt.js+Tt(i)in t&&vt.css+i}},Dt={supportedProperty:function(e,t){return St(e)in t&&e}},Lt={supportedProperty:function(e,t){var i=Tt(e);return"-"===e[0]||"-"===e[0]&&"-"===e[1]?e:vt.js+i in t?vt.css+e:"Webkit"!==vt.js&&"Webkit"+i in t&&"-webkit-"+e}},xt={supportedProperty:function(e){return"scroll-snap"===e.substring(0,11)&&("ms"===vt.js?""+vt.css+e:e)}},Ut={supportedProperty:function(e){return"overscroll-behavior"===e&&("ms"===vt.js?vt.css+"scroll-chaining":e)}},Vt={"flex-grow":"flex-positive","flex-shrink":"flex-negative","flex-basis":"flex-preferred-size","justify-content":"flex-pack",order:"flex-order","align-items":"flex-align","align-content":"flex-line-pack"},Bt={supportedProperty:function(e,t){var i=Vt[e];return!!i&&(vt.js+Tt(i)in t&&vt.css+i)}},jt={flex:"box-flex","flex-grow":"box-flex","flex-direction":["box-orient","box-direction"],order:"box-ordinal-group","align-items":"box-align","flex-flow":["box-orient","box-direction"],"justify-content":"box-pack"},Ft=Object.keys(jt),Wt=function(e){return vt.css+e},Gt=[Et,bt,Ct,It,At,Ot,Mt,Nt,kt,Pt,Dt,Lt,xt,Ut,Bt,{supportedProperty:function(e,t,i){var n=i.multiple;if(Ft.indexOf(e)>-1){var r=jt[e];if(!Array.isArray(r))return vt.js+Tt(r)in t&&vt.css+r;if(!n)return!1;for(var o=0;o<r.length;o++)if(!(vt.js+Tt(r[0])in t))return!1;return r.map(Wt)}return!1}}],Ht=Gt.filter((function(e){return e.supportedProperty})).map((function(e){return e.supportedProperty})),qt=Gt.filter((function(e){return e.noPrefill})).reduce((function(e,t){return e.push.apply(e,Object(ut.a)(t.noPrefill)),e}),[]),Kt={};if(d){Rt=document.createElement("p");var zt=window.getComputedStyle(document.documentElement,"");for(var Yt in zt)isNaN(Yt)||(Kt[zt[Yt]]=zt[Yt]);qt.forEach((function(e){return delete Kt[e]}))}function Jt(e,t){if(void 0===t&&(t={}),!Rt)return e;if(null!=Kt[e])return Kt[e];"transition"!==e&&"transform"!==e||(t[e]=e in Rt.style);for(var i=0;i<Ht.length&&(Kt[e]=Ht[i](e,Rt.style,t),!Kt[e]);i++);try{Rt.style[e]=""}catch(n){return!1}return Kt[e]}var Xt,Qt={},Zt={transition:1,"transition-property":1,"-webkit-transition":1,"-webkit-transition-property":1},$t=/(^\s*[\w-]+)|, (\s*[\w-]+)(?![^()]*\))/g;function ei(e,t,i){if("var"===t)return"var";if("all"===t)return"all";if("all"===i)return", all";var n=t?Jt(t):", "+Jt(i);return n||(t||i)}function ti(e,t){var i=t;if(!Xt||"content"===e)return t;if("string"!==typeof i||!isNaN(parseInt(i,10)))return i;var n=e+i;if(null!=Qt[n])return Qt[n];try{Xt.style[e]=i}catch(r){return Qt[n]=!1,!1}if(Zt[e])i=i.replace($t,ei);else if(""===Xt.style[e]&&("-ms-flex"===(i=vt.css+i)&&(Xt.style[e]="-ms-flexbox"),Xt.style[e]=i,""===Xt.style[e]))return Qt[n]=!1,!1;return Xt.style[e]="",Qt[n]=i,Qt[n]}d&&(Xt=document.createElement("p"));var ii=function(){function e(t){for(var i in t){var n=t[i];if("fallbacks"===i&&Array.isArray(n))t[i]=n.map(e);else{var r=!1,o=Jt(i);o&&o!==i&&(r=!0);var s=!1,a=ti(o,w(n));a&&a!==n&&(s=!0),(r||s)&&(r&&delete t[i],t[o||i]=a||n)}}return t}return{onProcessRule:function(e){if("keyframes"===e.type){var t=e;t.at="-"===(i=t.at)[1]||"ms"===vt.js?i:"@"+vt.css+"keyframes"+i.substr(10)}var i},onProcessStyle:function(t,i){return"style"!==i.type?t:e(t)},onChangeValue:function(e,t){return ti(t,w(e))||e}}};var ni=function(){var e=function(e,t){return e.length===t.length?e>t?1:-1:e.length-t.length};return{onProcessStyle:function(t,i){if("style"!==i.type)return t;for(var n={},r=Object.keys(t).sort(e),o=0;o<r.length;o++)n[r[o]]=t[r[o]];return n}}};function ri(){return{plugins:[Ue(),He(),Ye(),tt(),ct(),"undefined"===typeof window?null:ii(),ni()]}}var oi=Te(ri()),si=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.disableGlobal,i=void 0!==t&&t,n=e.productionPrefix,r=void 0===n?"jss":n,o=e.seed,s=void 0===o?"":o,a=""===s?"":"".concat(s,"-"),c=0,u=function(){return c+=1};return function(e,t){var n=t.options.name;if(n&&0===n.indexOf("Mui")&&!t.options.link&&!i){if(-1!==Pe.indexOf(e.key))return"Mui-".concat(e.key);var o="".concat(a).concat(n,"-").concat(e.key);return t.options.theme[ke]&&""===s?"".concat(o,"-").concat(u()):o}return"".concat(a).concat(r).concat(u())}}(),ai={disableGeneration:!1,generateClassName:si,jss:oi,sheetsCache:null,sheetsManager:new Map,sheetsRegistry:null},ci=s.a.createContext(ai);var ui=-1e9;function di(e){return e&&"object"===Object(l.a)(e)&&e.constructor===Object}function li(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},r=i.clone?Object(n.a)({},e):e;return di(e)&&di(t)&&Object.keys(t).forEach((function(n){"__proto__"!==n&&(di(t[n])&&n in e?r[n]=li(e[n],t[n],i):r[n]=t[n])})),r}var hi={};function fi(e,t){var i=e.state,r=e.theme,o=e.stylesOptions,s=e.stylesCreator,a=e.name;if(!o.disableGeneration){var c=Oe.get(o.sheetsManager,s,r);c||(c={refs:0,staticSheet:null,dynamicStyles:null},Oe.set(o.sheetsManager,s,r,c));var u=Object(n.a)({},s.options,o,{theme:r,flip:"boolean"===typeof o.flip?o.flip:"rtl"===r.direction});u.generateId=u.serverGenerateClassName||u.generateClassName;var d=o.sheetsRegistry;if(0===c.refs){var l;o.sheetsCache&&(l=Oe.get(o.sheetsCache,s,r));var h=s.create(r,a);l||((l=o.jss.createStyleSheet(h,Object(n.a)({link:!1},u))).attach(),o.sheetsCache&&Oe.set(o.sheetsCache,s,r,l)),d&&d.add(l),c.staticSheet=l,c.dynamicStyles=Ce(h)}if(c.dynamicStyles){var f=o.jss.createStyleSheet(c.dynamicStyles,Object(n.a)({link:!0},u));f.update(t),f.attach(),i.dynamicSheet=f,i.classes=Ie({baseClasses:c.staticSheet.classes,newClasses:f.classes}),d&&d.add(f)}else i.classes=c.staticSheet.classes;c.refs+=1}}function pi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.name,o=t.classNamePrefix,a=t.Component,c=t.defaultTheme,u=void 0===c?hi:c,d=Object(r.a)(t,["name","classNamePrefix","Component","defaultTheme"]),l=function(e){var t="function"===typeof e;return{create:function(i,r){var o;try{o=t?e(i):e}catch(c){throw c}if(!r||!i.overrides||!i.overrides[r])return o;var s=i.overrides[r],a=Object(n.a)({},o);return Object.keys(s).forEach((function(e){a[e]=li(a[e],s[e])})),a},options:{}}}(e),h=i||o||"makeStyles";l.options={index:ui+=1,name:i,meta:h,classNamePrefix:h};return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Ne()||u,r=Object(n.a)({},s.a.useContext(ci),d),o=s.a.useRef(),c=s.a.useRef();!function(e,t){var i,n=s.a.useRef([]),r=s.a.useMemo((function(){return{}}),t);n.current!==r&&(n.current=r,i=e()),s.a.useEffect((function(){return function(){i&&i()}}),[r])}((function(){var n={name:i,state:{},stylesCreator:l,stylesOptions:r,theme:t};return fi(n,e),c.current=!1,o.current=n,function(){!function(e){var t=e.state,i=e.theme,n=e.stylesOptions,r=e.stylesCreator;if(!n.disableGeneration){var o=Oe.get(n.sheetsManager,r,i);o.refs-=1;var s=n.sheetsRegistry;0===o.refs&&(Oe.delete(n.sheetsManager,r,i),n.jss.removeStyleSheet(o.staticSheet),s&&s.remove(o.staticSheet)),t.dynamicSheet&&(n.jss.removeStyleSheet(t.dynamicSheet),s&&s.remove(t.dynamicSheet))}}(n)}}),[t,l]),s.a.useEffect((function(){c.current&&function(e,t){var i=e.state;i.dynamicSheet&&i.dynamicSheet.update(t)}(o.current,e),c.current=!0}));var h=function(e,t,i){var n=e.state;if(e.stylesOptions.disableGeneration)return t||{};n.cacheClasses||(n.cacheClasses={value:null,lastProp:null,lastJSS:{}});var r=!1;return n.classes!==n.cacheClasses.lastJSS&&(n.cacheClasses.lastJSS=n.classes,r=!0),t!==n.cacheClasses.lastProp&&(n.cacheClasses.lastProp=t,r=!0),r&&(n.cacheClasses.value=Ie({baseClasses:n.cacheClasses.lastJSS,newClasses:t,Component:i})),n.cacheClasses.value}(o.current,e.classes,a);return h}}var mi=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(i){var o=t.defaultTheme,a=t.withTheme,u=void 0!==a&&a,d=t.name,l=Object(r.a)(t,["defaultTheme","withTheme","name"]);var h=d,f=pi(e,Object(n.a)({defaultTheme:o,Component:i,name:d||i.displayName,classNamePrefix:h},l)),p=s.a.forwardRef((function(e,t){e.classes;var a,c=e.innerRef,l=Object(r.a)(e,["classes","innerRef"]),h=f(Object(n.a)({},i.defaultProps,e)),p=l;return("string"===typeof d||u)&&(a=Ne()||o,d&&(p=function(e){var t=e.theme,i=e.name,n=e.props;if(!t||!t.props||!t.props[i])return n;var r,o=t.props[i];for(r in o)void 0===n[r]&&(n[r]=o[r]);return n}({theme:a,name:d,props:l})),u&&!p.theme&&(p.theme=a)),s.a.createElement(i,Object(n.a)({ref:c||t,classes:h},p))}));return c()(p,i),p}};function _i(e,t,i){return(t=h(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var gi=["xs","sm","md","lg","xl"];function vi(e,t,i){var r;return Object(n.a)({gutters:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return console.warn(["Material-UI: theme.mixins.gutters() is deprecated.","You can use the source of the mixin directly:","\n      paddingLeft: theme.spacing(2),\n      paddingRight: theme.spacing(2),\n      [theme.breakpoints.up('sm')]: {\n        paddingLeft: theme.spacing(3),\n        paddingRight: theme.spacing(3),\n      },\n      "].join("\n")),Object(n.a)({paddingLeft:t(2),paddingRight:t(2)},i,_i({},e.up("sm"),Object(n.a)({paddingLeft:t(3),paddingRight:t(3)},i[e.up("sm")])))},toolbar:(r={minHeight:56},_i(r,"".concat(e.up("xs")," and (orientation: landscape)"),{minHeight:48}),_i(r,e.up("sm"),{minHeight:64}),r)},i)}var Ei=i(152),bi={black:"#000",white:"#fff"},yi={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#d5d5d5",A200:"#aaaaaa",A400:"#303030",A700:"#616161"},wi={50:"#e8eaf6",100:"#c5cae9",200:"#9fa8da",300:"#7986cb",400:"#5c6bc0",500:"#3f51b5",600:"#3949ab",700:"#303f9f",800:"#283593",900:"#1a237e",A100:"#8c9eff",A200:"#536dfe",A400:"#3d5afe",A700:"#304ffe"},Si={50:"#fce4ec",100:"#f8bbd0",200:"#f48fb1",300:"#f06292",400:"#ec407a",500:"#e91e63",600:"#d81b60",700:"#c2185b",800:"#ad1457",900:"#880e4f",A100:"#ff80ab",A200:"#ff4081",A400:"#f50057",A700:"#c51162"},Ti={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Ri={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Ci={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Ii={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},Ai=i(14),Oi={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.54)",disabled:"rgba(0, 0, 0, 0.38)",hint:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:bi.white,default:yi[50]},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},Mi={text:{primary:bi.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",hint:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:yi[800],default:"#303030"},action:{active:bi.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function Ni(e,t,i,n){var r=n.light||n,o=n.dark||1.5*n;e[t]||(e.hasOwnProperty(i)?e[t]=e[i]:"light"===t?e.light=Object(Ai.d)(e.main,r):"dark"===t&&(e.dark=Object(Ai.b)(e.main,o)))}function ki(e){return Math.round(1e5*e)/1e5}function Pi(e){return ki(e)}var Di={textTransform:"uppercase"},Li='"Roboto", "Helvetica", "Arial", sans-serif';function xi(e,t){var i="function"===typeof t?t(e):t,o=i.fontFamily,s=void 0===o?Li:o,a=i.fontSize,c=void 0===a?14:a,u=i.fontWeightLight,d=void 0===u?300:u,l=i.fontWeightRegular,h=void 0===l?400:l,f=i.fontWeightMedium,p=void 0===f?500:f,m=i.fontWeightBold,_=void 0===m?700:m,g=i.htmlFontSize,v=void 0===g?16:g,E=i.allVariants,b=i.pxToRem,y=Object(r.a)(i,["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"]);var w=c/14,S=b||function(e){return"".concat(e/v*w,"rem")},T=function(e,t,i,r,o){return Object(n.a)({fontFamily:s,fontWeight:e,fontSize:S(t),lineHeight:i},s===Li?{letterSpacing:"".concat(ki(r/t),"em")}:{},o,E)},R={h1:T(d,96,1.167,-1.5),h2:T(d,60,1.2,-.5),h3:T(h,48,1.167,0),h4:T(h,34,1.235,.25),h5:T(h,24,1.334,0),h6:T(p,20,1.6,.15),subtitle1:T(h,16,1.75,.15),subtitle2:T(p,14,1.57,.1),body1:T(h,16,1.5,.15),body2:T(h,14,1.43,.15),button:T(p,14,1.75,.4,Di),caption:T(h,12,1.66,.4),overline:T(h,12,2.66,1,Di)};return li(Object(n.a)({htmlFontSize:v,pxToRem:S,round:Pi,fontFamily:s,fontSize:c,fontWeightLight:d,fontWeightRegular:h,fontWeightMedium:p,fontWeightBold:_},R),y,{clone:!1})}function Ui(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var Vi=["none",Ui(0,2,1,-1,0,1,1,0,0,1,3,0),Ui(0,3,1,-2,0,2,2,0,0,1,5,0),Ui(0,3,3,-2,0,3,4,0,0,1,8,0),Ui(0,2,4,-1,0,4,5,0,0,1,10,0),Ui(0,3,5,-1,0,5,8,0,0,1,14,0),Ui(0,3,5,-1,0,6,10,0,0,1,18,0),Ui(0,4,5,-2,0,7,10,1,0,2,16,1),Ui(0,5,5,-3,0,8,10,1,0,3,14,2),Ui(0,5,6,-3,0,9,12,1,0,3,16,2),Ui(0,6,6,-3,0,10,14,1,0,4,18,3),Ui(0,6,7,-4,0,11,15,1,0,4,20,3),Ui(0,7,8,-4,0,12,17,2,0,5,22,4),Ui(0,7,8,-4,0,13,19,2,0,5,24,4),Ui(0,7,9,-4,0,14,21,2,0,5,26,4),Ui(0,8,9,-5,0,15,22,2,0,6,28,5),Ui(0,8,10,-5,0,16,24,2,0,6,30,5),Ui(0,8,11,-5,0,17,26,2,0,6,32,5),Ui(0,9,11,-5,0,18,28,2,0,7,34,6),Ui(0,9,12,-6,0,19,29,2,0,7,36,6),Ui(0,10,13,-6,0,20,31,3,0,8,38,7),Ui(0,10,13,-6,0,21,33,3,0,8,40,7),Ui(0,10,14,-6,0,22,35,3,0,8,42,7),Ui(0,11,14,-7,0,23,36,3,0,9,44,8),Ui(0,11,15,-7,0,24,38,3,0,9,46,8)],Bi={borderRadius:4},ji=i(143);var Fi=i(59),Wi=i(144);function Gi(e,t){return Object(ji.a)(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,o,s,a=[],c=!0,u=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;c=!1}else for(;!(c=(n=o.call(i)).done)&&(a.push(n.value),a.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=i.return&&(s=i.return(),Object(s)!==s))return}finally{if(u)throw r}}return a}}(e,t)||Object(Fi.a)(e,t)||Object(Wi.a)()}var Hi=function(e,t){return t?li(e,t,{clone:!1}):e},qi={xs:0,sm:600,md:960,lg:1280,xl:1920},Ki={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(qi[e],"px)")}};var zi={m:"margin",p:"padding"},Yi={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Ji={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Xi=function(e){var t={};return function(i){return void 0===t[i]&&(t[i]=e(i)),t[i]}}((function(e){if(e.length>2){if(!Ji[e])return[e];e=Ji[e]}var t=Gi(e.split(""),2),i=t[0],n=t[1],r=zi[i],o=Yi[n]||"";return Array.isArray(o)?o.map((function(e){return r+e})):[r+o]})),Qi=["m","mt","mr","mb","ml","mx","my","p","pt","pr","pb","pl","px","py","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY"];function Zi(e){var t=e.spacing||8;return"number"===typeof t?function(e){return t*e}:Array.isArray(t)?function(e){return t[e]}:"function"===typeof t?t:function(){}}function $i(e,t){return function(i){return e.reduce((function(e,n){return e[n]=function(e,t){if("string"===typeof t||null==t)return t;var i=e(Math.abs(t));return t>=0?i:"number"===typeof i?-i:"-".concat(i)}(t,i),e}),{})}}function en(e){var t=Zi(e.theme);return Object.keys(e).map((function(i){if(-1===Qi.indexOf(i))return null;var n=$i(Xi(i),t),r=e[i];return function(e,t,i){if(Array.isArray(t)){var n=e.theme.breakpoints||Ki;return t.reduce((function(e,r,o){return e[n.up(n.keys[o])]=i(t[o]),e}),{})}if("object"===Object(l.a)(t)){var r=e.theme.breakpoints||Ki;return Object.keys(t).reduce((function(e,n){return e[r.up(n)]=i(t[n]),e}),{})}return i(t)}(e,r,n)})).reduce(Hi,{})}en.propTypes={},en.filterProps=Qi;var tn={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},nn={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function rn(e){return"".concat(Math.round(e),"ms")}var on={easing:tn,duration:nn,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.duration,n=void 0===i?nn.standard:i,o=t.easing,s=void 0===o?tn.easeInOut:o,a=t.delay,c=void 0===a?0:a;Object(r.a)(t,["duration","easing","delay"]);return(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"===typeof n?n:rn(n)," ").concat(s," ").concat("string"===typeof c?c:rn(c))})).join(",")},getAutoHeightDuration:function(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}},sn={mobileStepper:1e3,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function an(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,i=void 0===t?{}:t,o=e.mixins,s=void 0===o?{}:o,a=e.palette,c=void 0===a?{}:a,u=e.spacing,d=e.typography,l=void 0===d?{}:d,h=Object(r.a)(e,["breakpoints","mixins","palette","spacing","typography"]),f=function(e){var t=e.primary,i=void 0===t?{light:wi[300],main:wi[500],dark:wi[700]}:t,o=e.secondary,s=void 0===o?{light:Si.A200,main:Si.A400,dark:Si.A700}:o,a=e.error,c=void 0===a?{light:Ti[300],main:Ti[500],dark:Ti[700]}:a,u=e.warning,d=void 0===u?{light:Ri[300],main:Ri[500],dark:Ri[700]}:u,l=e.info,h=void 0===l?{light:Ci[300],main:Ci[500],dark:Ci[700]}:l,f=e.success,p=void 0===f?{light:Ii[300],main:Ii[500],dark:Ii[700]}:f,m=e.type,_=void 0===m?"light":m,g=e.contrastThreshold,v=void 0===g?3:g,E=e.tonalOffset,b=void 0===E?.2:E,y=Object(r.a)(e,["primary","secondary","error","warning","info","success","type","contrastThreshold","tonalOffset"]);function w(e){return Object(Ai.c)(e,Mi.text.primary)>=v?Mi.text.primary:Oi.text.primary}var S=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:700;if(!(e=Object(n.a)({},e)).main&&e[t]&&(e.main=e[t]),!e.main)throw new Error(Object(Ei.a)(4,t));if("string"!==typeof e.main)throw new Error(Object(Ei.a)(5,JSON.stringify(e.main)));return Ni(e,"light",i,b),Ni(e,"dark",r,b),e.contrastText||(e.contrastText=w(e.main)),e},T={dark:Mi,light:Oi};return li(Object(n.a)({common:bi,type:_,primary:S(i),secondary:S(s,"A400","A200","A700"),error:S(c),warning:S(d),info:S(h),success:S(p),grey:yi,contrastThreshold:v,getContrastText:w,augmentColor:S,tonalOffset:b},T[_]),y)}(c),p=function(e){var t=e.values,i=void 0===t?{xs:0,sm:600,md:960,lg:1280,xl:1920}:t,o=e.unit,s=void 0===o?"px":o,a=e.step,c=void 0===a?5:a,u=Object(r.a)(e,["values","unit","step"]);function d(e){var t="number"===typeof i[e]?i[e]:e;return"@media (min-width:".concat(t).concat(s,")")}function l(e,t){var n=gi.indexOf(t);return n===gi.length-1?d(e):"@media (min-width:".concat("number"===typeof i[e]?i[e]:e).concat(s,") and ")+"(max-width:".concat((-1!==n&&"number"===typeof i[gi[n+1]]?i[gi[n+1]]:t)-c/100).concat(s,")")}return Object(n.a)({keys:gi,values:i,up:d,down:function(e){var t=gi.indexOf(e)+1,n=i[gi[t]];return t===gi.length?d("xs"):"@media (max-width:".concat(("number"===typeof n&&t>0?n:e)-c/100).concat(s,")")},between:l,only:function(e){return l(e,e)},width:function(e){return i[e]}},u)}(i),m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=Zi({spacing:e}),i=function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];return 0===i.length?t(1):1===i.length?t(i[0]):i.map((function(e){if("string"===typeof e)return e;var i=t(e);return"number"===typeof i?"".concat(i,"px"):i})).join(" ")};return Object.defineProperty(i,"unit",{get:function(){return e}}),i.mui=!0,i}(u),_=li({breakpoints:p,direction:"ltr",mixins:vi(p,m,s),overrides:{},palette:f,props:{},shadows:Vi,typography:xi(f,l),spacing:m,shape:Bi,transitions:on,zIndex:sn},h),g=arguments.length,v=new Array(g>1?g-1:0),E=1;E<g;E++)v[E-1]=arguments[E];return _=v.reduce((function(e,t){return li(e,t)}),_)}var cn=an();t.a=function(e,t){return mi(e,Object(n.a)({defaultTheme:cn},t))}},,function(e,t,i){(function(e){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function o(e,t,i){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:i(225).Buffer}catch(R){}function a(e,t){var i=e.charCodeAt(t);return i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:i-48&15}function c(e,t,i){var n=a(e,i);return i-1>=t&&(n|=a(e,i-1)<<4),n}function u(e,t,i,n){for(var r=0,o=Math.min(e.length,i),s=t;s<o;s++){var a=e.charCodeAt(s)-48;r*=n,r+=a>=49?a-49+10:a>=17?a-17+10:a}return r}o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,i){if("number"===typeof e)return this._initNumber(e,t,i);if("object"===typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var r=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(r++,this.negative=1),r<e.length&&(16===t?this._parseHex(e,r,i):(this._parseBase(e,t,r),"le"===i&&this._initArray(this.toArray(),t,i)))},o.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},o.prototype._initArray=function(e,t,i){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var o,s,a=0;if("be"===i)for(r=e.length-1,o=0;r>=0;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===i)for(r=0,o=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},o.prototype._parseHex=function(e,t,i){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,o=0,s=0;if("be"===i)for(n=e.length-1;n>=t;n-=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;this.strip()},o.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=t)n++;n--,r=r/t|0;for(var o=e.length-i,s=o%n,a=Math.min(o,o-s)+i,c=0,d=i;d<a;d+=n)c=u(e,d,d+n,t),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var l=1;for(c=u(e,d,e.length,t),d=0;d<s;d++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this.strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(e,t,i){i.negative=t.negative^e.negative;var n=e.length+t.length|0;i.length=n,n=n-1|0;var r=0|e.words[0],o=0|t.words[0],s=r*o,a=67108863&s,c=s/67108864|0;i.words[0]=a;for(var u=1;u<n;u++){for(var d=c>>>26,l=67108863&c,h=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=h;f++){var p=u-f|0;d+=(s=(r=0|e.words[p])*(o=0|t.words[f])+l)/67108864|0,l=67108863&s}i.words[u]=0|l,c=0|d}return 0!==c?i.words[u]=0|c:i.length--,i.strip()}o.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var r=0,o=0,s=0;s<this.length;s++){var a=this.words[s],c=(16777215&(a<<r|o)).toString(16);i=0!==(o=a>>>24-r&16777215)||s!==this.length-1?d[6-c.length]+c+i:c+i,(r+=2)>=26&&(r-=26,s--)}for(0!==o&&(i=o.toString(16)+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=l[e],f=h[e];i="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(f).toString(e);i=(p=p.idivn(f)).isZero()?m+i:d[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(e,t){return n("undefined"!==typeof s),this.toArrayLike(s,e,t)},o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,i){var r=this.byteLength(),o=i||Math.max(1,r);n(r<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,c="le"===t,u=new e(o),d=this.clone();if(c){for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[a]=s;for(;a<o;a++)u[a]=0}else{for(a=0;a<o-r;a++)u[a]=0;for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[o-a-1]=s}return u},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0===(8191&t)&&(i+=13,t>>>=13),0===(127&t)&&(i+=7,t>>>=7),0===(15&t)&&(i+=4,t>>>=4),0===(3&t)&&(i+=2,t>>>=2),0===(1&t)&&i++,i},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var n=0;n<i.length;n++)this.words[n]=t.words[n]^i.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this.strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var i=e/26|0,r=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<r:this.words[i]&~(1<<r),this.strip()},o.prototype.iadd=function(e){var t,i,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,n=e):(i=e,n=this);for(var r=0,o=0;o<n.length;o++)t=(0|i.words[o])+(0|n.words[o])+r,this.words[o]=67108863&t,r=t>>>26;for(;0!==r&&o<i.length;o++)t=(0|i.words[o])+r,this.words[o]=67108863&t,r=t>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,n,r=this.cmp(e);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(i=this,n=e):(i=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|i.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<i.length;s++)o=(t=(0|i.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,i){var n,r,o,s=e.words,a=t.words,c=i.words,u=0,d=0|s[0],l=8191&d,h=d>>>13,f=0|s[1],p=8191&f,m=f>>>13,_=0|s[2],g=8191&_,v=_>>>13,E=0|s[3],b=8191&E,y=E>>>13,w=0|s[4],S=8191&w,T=w>>>13,R=0|s[5],C=8191&R,I=R>>>13,A=0|s[6],O=8191&A,M=A>>>13,N=0|s[7],k=8191&N,P=N>>>13,D=0|s[8],L=8191&D,x=D>>>13,U=0|s[9],V=8191&U,B=U>>>13,j=0|a[0],F=8191&j,W=j>>>13,G=0|a[1],H=8191&G,q=G>>>13,K=0|a[2],z=8191&K,Y=K>>>13,J=0|a[3],X=8191&J,Q=J>>>13,Z=0|a[4],$=8191&Z,ee=Z>>>13,te=0|a[5],ie=8191&te,ne=te>>>13,re=0|a[6],oe=8191&re,se=re>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,de=0|a[8],le=8191&de,he=de>>>13,fe=0|a[9],pe=8191&fe,me=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var _e=(u+(n=Math.imul(l,F))|0)+((8191&(r=(r=Math.imul(l,W))+Math.imul(h,F)|0))<<13)|0;u=((o=Math.imul(h,W))+(r>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(p,F),r=(r=Math.imul(p,W))+Math.imul(m,F)|0,o=Math.imul(m,W);var ge=(u+(n=n+Math.imul(l,H)|0)|0)+((8191&(r=(r=r+Math.imul(l,q)|0)+Math.imul(h,H)|0))<<13)|0;u=((o=o+Math.imul(h,q)|0)+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,F),r=(r=Math.imul(g,W))+Math.imul(v,F)|0,o=Math.imul(v,W),n=n+Math.imul(p,H)|0,r=(r=r+Math.imul(p,q)|0)+Math.imul(m,H)|0,o=o+Math.imul(m,q)|0;var ve=(u+(n=n+Math.imul(l,z)|0)|0)+((8191&(r=(r=r+Math.imul(l,Y)|0)+Math.imul(h,z)|0))<<13)|0;u=((o=o+Math.imul(h,Y)|0)+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,F),r=(r=Math.imul(b,W))+Math.imul(y,F)|0,o=Math.imul(y,W),n=n+Math.imul(g,H)|0,r=(r=r+Math.imul(g,q)|0)+Math.imul(v,H)|0,o=o+Math.imul(v,q)|0,n=n+Math.imul(p,z)|0,r=(r=r+Math.imul(p,Y)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,Y)|0;var Ee=(u+(n=n+Math.imul(l,X)|0)|0)+((8191&(r=(r=r+Math.imul(l,Q)|0)+Math.imul(h,X)|0))<<13)|0;u=((o=o+Math.imul(h,Q)|0)+(r>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(S,F),r=(r=Math.imul(S,W))+Math.imul(T,F)|0,o=Math.imul(T,W),n=n+Math.imul(b,H)|0,r=(r=r+Math.imul(b,q)|0)+Math.imul(y,H)|0,o=o+Math.imul(y,q)|0,n=n+Math.imul(g,z)|0,r=(r=r+Math.imul(g,Y)|0)+Math.imul(v,z)|0,o=o+Math.imul(v,Y)|0,n=n+Math.imul(p,X)|0,r=(r=r+Math.imul(p,Q)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,Q)|0;var be=(u+(n=n+Math.imul(l,$)|0)|0)+((8191&(r=(r=r+Math.imul(l,ee)|0)+Math.imul(h,$)|0))<<13)|0;u=((o=o+Math.imul(h,ee)|0)+(r>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(C,F),r=(r=Math.imul(C,W))+Math.imul(I,F)|0,o=Math.imul(I,W),n=n+Math.imul(S,H)|0,r=(r=r+Math.imul(S,q)|0)+Math.imul(T,H)|0,o=o+Math.imul(T,q)|0,n=n+Math.imul(b,z)|0,r=(r=r+Math.imul(b,Y)|0)+Math.imul(y,z)|0,o=o+Math.imul(y,Y)|0,n=n+Math.imul(g,X)|0,r=(r=r+Math.imul(g,Q)|0)+Math.imul(v,X)|0,o=o+Math.imul(v,Q)|0,n=n+Math.imul(p,$)|0,r=(r=r+Math.imul(p,ee)|0)+Math.imul(m,$)|0,o=o+Math.imul(m,ee)|0;var ye=(u+(n=n+Math.imul(l,ie)|0)|0)+((8191&(r=(r=r+Math.imul(l,ne)|0)+Math.imul(h,ie)|0))<<13)|0;u=((o=o+Math.imul(h,ne)|0)+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(O,F),r=(r=Math.imul(O,W))+Math.imul(M,F)|0,o=Math.imul(M,W),n=n+Math.imul(C,H)|0,r=(r=r+Math.imul(C,q)|0)+Math.imul(I,H)|0,o=o+Math.imul(I,q)|0,n=n+Math.imul(S,z)|0,r=(r=r+Math.imul(S,Y)|0)+Math.imul(T,z)|0,o=o+Math.imul(T,Y)|0,n=n+Math.imul(b,X)|0,r=(r=r+Math.imul(b,Q)|0)+Math.imul(y,X)|0,o=o+Math.imul(y,Q)|0,n=n+Math.imul(g,$)|0,r=(r=r+Math.imul(g,ee)|0)+Math.imul(v,$)|0,o=o+Math.imul(v,ee)|0,n=n+Math.imul(p,ie)|0,r=(r=r+Math.imul(p,ne)|0)+Math.imul(m,ie)|0,o=o+Math.imul(m,ne)|0;var we=(u+(n=n+Math.imul(l,oe)|0)|0)+((8191&(r=(r=r+Math.imul(l,se)|0)+Math.imul(h,oe)|0))<<13)|0;u=((o=o+Math.imul(h,se)|0)+(r>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,F),r=(r=Math.imul(k,W))+Math.imul(P,F)|0,o=Math.imul(P,W),n=n+Math.imul(O,H)|0,r=(r=r+Math.imul(O,q)|0)+Math.imul(M,H)|0,o=o+Math.imul(M,q)|0,n=n+Math.imul(C,z)|0,r=(r=r+Math.imul(C,Y)|0)+Math.imul(I,z)|0,o=o+Math.imul(I,Y)|0,n=n+Math.imul(S,X)|0,r=(r=r+Math.imul(S,Q)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,Q)|0,n=n+Math.imul(b,$)|0,r=(r=r+Math.imul(b,ee)|0)+Math.imul(y,$)|0,o=o+Math.imul(y,ee)|0,n=n+Math.imul(g,ie)|0,r=(r=r+Math.imul(g,ne)|0)+Math.imul(v,ie)|0,o=o+Math.imul(v,ne)|0,n=n+Math.imul(p,oe)|0,r=(r=r+Math.imul(p,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0;var Se=(u+(n=n+Math.imul(l,ce)|0)|0)+((8191&(r=(r=r+Math.imul(l,ue)|0)+Math.imul(h,ce)|0))<<13)|0;u=((o=o+Math.imul(h,ue)|0)+(r>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(L,F),r=(r=Math.imul(L,W))+Math.imul(x,F)|0,o=Math.imul(x,W),n=n+Math.imul(k,H)|0,r=(r=r+Math.imul(k,q)|0)+Math.imul(P,H)|0,o=o+Math.imul(P,q)|0,n=n+Math.imul(O,z)|0,r=(r=r+Math.imul(O,Y)|0)+Math.imul(M,z)|0,o=o+Math.imul(M,Y)|0,n=n+Math.imul(C,X)|0,r=(r=r+Math.imul(C,Q)|0)+Math.imul(I,X)|0,o=o+Math.imul(I,Q)|0,n=n+Math.imul(S,$)|0,r=(r=r+Math.imul(S,ee)|0)+Math.imul(T,$)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(b,ie)|0,r=(r=r+Math.imul(b,ne)|0)+Math.imul(y,ie)|0,o=o+Math.imul(y,ne)|0,n=n+Math.imul(g,oe)|0,r=(r=r+Math.imul(g,se)|0)+Math.imul(v,oe)|0,o=o+Math.imul(v,se)|0,n=n+Math.imul(p,ce)|0,r=(r=r+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,o=o+Math.imul(m,ue)|0;var Te=(u+(n=n+Math.imul(l,le)|0)|0)+((8191&(r=(r=r+Math.imul(l,he)|0)+Math.imul(h,le)|0))<<13)|0;u=((o=o+Math.imul(h,he)|0)+(r>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(V,F),r=(r=Math.imul(V,W))+Math.imul(B,F)|0,o=Math.imul(B,W),n=n+Math.imul(L,H)|0,r=(r=r+Math.imul(L,q)|0)+Math.imul(x,H)|0,o=o+Math.imul(x,q)|0,n=n+Math.imul(k,z)|0,r=(r=r+Math.imul(k,Y)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,Y)|0,n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,Q)|0)+Math.imul(M,X)|0,o=o+Math.imul(M,Q)|0,n=n+Math.imul(C,$)|0,r=(r=r+Math.imul(C,ee)|0)+Math.imul(I,$)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(S,ie)|0,r=(r=r+Math.imul(S,ne)|0)+Math.imul(T,ie)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(b,oe)|0,r=(r=r+Math.imul(b,se)|0)+Math.imul(y,oe)|0,o=o+Math.imul(y,se)|0,n=n+Math.imul(g,ce)|0,r=(r=r+Math.imul(g,ue)|0)+Math.imul(v,ce)|0,o=o+Math.imul(v,ue)|0,n=n+Math.imul(p,le)|0,r=(r=r+Math.imul(p,he)|0)+Math.imul(m,le)|0,o=o+Math.imul(m,he)|0;var Re=(u+(n=n+Math.imul(l,pe)|0)|0)+((8191&(r=(r=r+Math.imul(l,me)|0)+Math.imul(h,pe)|0))<<13)|0;u=((o=o+Math.imul(h,me)|0)+(r>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(V,H),r=(r=Math.imul(V,q))+Math.imul(B,H)|0,o=Math.imul(B,q),n=n+Math.imul(L,z)|0,r=(r=r+Math.imul(L,Y)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,Y)|0,n=n+Math.imul(k,X)|0,r=(r=r+Math.imul(k,Q)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,Q)|0,n=n+Math.imul(O,$)|0,r=(r=r+Math.imul(O,ee)|0)+Math.imul(M,$)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(C,ie)|0,r=(r=r+Math.imul(C,ne)|0)+Math.imul(I,ie)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(S,oe)|0,r=(r=r+Math.imul(S,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,n=n+Math.imul(b,ce)|0,r=(r=r+Math.imul(b,ue)|0)+Math.imul(y,ce)|0,o=o+Math.imul(y,ue)|0,n=n+Math.imul(g,le)|0,r=(r=r+Math.imul(g,he)|0)+Math.imul(v,le)|0,o=o+Math.imul(v,he)|0;var Ce=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(r=(r=r+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((o=o+Math.imul(m,me)|0)+(r>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(V,z),r=(r=Math.imul(V,Y))+Math.imul(B,z)|0,o=Math.imul(B,Y),n=n+Math.imul(L,X)|0,r=(r=r+Math.imul(L,Q)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,Q)|0,n=n+Math.imul(k,$)|0,r=(r=r+Math.imul(k,ee)|0)+Math.imul(P,$)|0,o=o+Math.imul(P,ee)|0,n=n+Math.imul(O,ie)|0,r=(r=r+Math.imul(O,ne)|0)+Math.imul(M,ie)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(C,oe)|0,r=(r=r+Math.imul(C,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(S,ce)|0,r=(r=r+Math.imul(S,ue)|0)+Math.imul(T,ce)|0,o=o+Math.imul(T,ue)|0,n=n+Math.imul(b,le)|0,r=(r=r+Math.imul(b,he)|0)+Math.imul(y,le)|0,o=o+Math.imul(y,he)|0;var Ie=(u+(n=n+Math.imul(g,pe)|0)|0)+((8191&(r=(r=r+Math.imul(g,me)|0)+Math.imul(v,pe)|0))<<13)|0;u=((o=o+Math.imul(v,me)|0)+(r>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(V,X),r=(r=Math.imul(V,Q))+Math.imul(B,X)|0,o=Math.imul(B,Q),n=n+Math.imul(L,$)|0,r=(r=r+Math.imul(L,ee)|0)+Math.imul(x,$)|0,o=o+Math.imul(x,ee)|0,n=n+Math.imul(k,ie)|0,r=(r=r+Math.imul(k,ne)|0)+Math.imul(P,ie)|0,o=o+Math.imul(P,ne)|0,n=n+Math.imul(O,oe)|0,r=(r=r+Math.imul(O,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(C,ce)|0,r=(r=r+Math.imul(C,ue)|0)+Math.imul(I,ce)|0,o=o+Math.imul(I,ue)|0,n=n+Math.imul(S,le)|0,r=(r=r+Math.imul(S,he)|0)+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0;var Ae=(u+(n=n+Math.imul(b,pe)|0)|0)+((8191&(r=(r=r+Math.imul(b,me)|0)+Math.imul(y,pe)|0))<<13)|0;u=((o=o+Math.imul(y,me)|0)+(r>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(V,$),r=(r=Math.imul(V,ee))+Math.imul(B,$)|0,o=Math.imul(B,ee),n=n+Math.imul(L,ie)|0,r=(r=r+Math.imul(L,ne)|0)+Math.imul(x,ie)|0,o=o+Math.imul(x,ne)|0,n=n+Math.imul(k,oe)|0,r=(r=r+Math.imul(k,se)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,se)|0,n=n+Math.imul(O,ce)|0,r=(r=r+Math.imul(O,ue)|0)+Math.imul(M,ce)|0,o=o+Math.imul(M,ue)|0,n=n+Math.imul(C,le)|0,r=(r=r+Math.imul(C,he)|0)+Math.imul(I,le)|0,o=o+Math.imul(I,he)|0;var Oe=(u+(n=n+Math.imul(S,pe)|0)|0)+((8191&(r=(r=r+Math.imul(S,me)|0)+Math.imul(T,pe)|0))<<13)|0;u=((o=o+Math.imul(T,me)|0)+(r>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(V,ie),r=(r=Math.imul(V,ne))+Math.imul(B,ie)|0,o=Math.imul(B,ne),n=n+Math.imul(L,oe)|0,r=(r=r+Math.imul(L,se)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,se)|0,n=n+Math.imul(k,ce)|0,r=(r=r+Math.imul(k,ue)|0)+Math.imul(P,ce)|0,o=o+Math.imul(P,ue)|0,n=n+Math.imul(O,le)|0,r=(r=r+Math.imul(O,he)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,he)|0;var Me=(u+(n=n+Math.imul(C,pe)|0)|0)+((8191&(r=(r=r+Math.imul(C,me)|0)+Math.imul(I,pe)|0))<<13)|0;u=((o=o+Math.imul(I,me)|0)+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(V,oe),r=(r=Math.imul(V,se))+Math.imul(B,oe)|0,o=Math.imul(B,se),n=n+Math.imul(L,ce)|0,r=(r=r+Math.imul(L,ue)|0)+Math.imul(x,ce)|0,o=o+Math.imul(x,ue)|0,n=n+Math.imul(k,le)|0,r=(r=r+Math.imul(k,he)|0)+Math.imul(P,le)|0,o=o+Math.imul(P,he)|0;var Ne=(u+(n=n+Math.imul(O,pe)|0)|0)+((8191&(r=(r=r+Math.imul(O,me)|0)+Math.imul(M,pe)|0))<<13)|0;u=((o=o+Math.imul(M,me)|0)+(r>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(V,ce),r=(r=Math.imul(V,ue))+Math.imul(B,ce)|0,o=Math.imul(B,ue),n=n+Math.imul(L,le)|0,r=(r=r+Math.imul(L,he)|0)+Math.imul(x,le)|0,o=o+Math.imul(x,he)|0;var ke=(u+(n=n+Math.imul(k,pe)|0)|0)+((8191&(r=(r=r+Math.imul(k,me)|0)+Math.imul(P,pe)|0))<<13)|0;u=((o=o+Math.imul(P,me)|0)+(r>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(V,le),r=(r=Math.imul(V,he))+Math.imul(B,le)|0,o=Math.imul(B,he);var Pe=(u+(n=n+Math.imul(L,pe)|0)|0)+((8191&(r=(r=r+Math.imul(L,me)|0)+Math.imul(x,pe)|0))<<13)|0;u=((o=o+Math.imul(x,me)|0)+(r>>>13)|0)+(Pe>>>26)|0,Pe&=67108863;var De=(u+(n=Math.imul(V,pe))|0)+((8191&(r=(r=Math.imul(V,me))+Math.imul(B,pe)|0))<<13)|0;return u=((o=Math.imul(B,me))+(r>>>13)|0)+(De>>>26)|0,De&=67108863,c[0]=_e,c[1]=ge,c[2]=ve,c[3]=Ee,c[4]=be,c[5]=ye,c[6]=we,c[7]=Se,c[8]=Te,c[9]=Re,c[10]=Ce,c[11]=Ie,c[12]=Ae,c[13]=Oe,c[14]=Me,c[15]=Ne,c[16]=ke,c[17]=Pe,c[18]=De,0!==u&&(c[19]=u,i.length++),i};function m(e,t,i){return(new _).mulp(e,t,i)}function _(e,t){this.x=e,this.y=t}Math.imul||(p=f),o.prototype.mulTo=function(e,t){var i,n=this.length+e.length;return i=10===this.length&&10===e.length?p(this,e,t):n<63?f(this,e,t):n<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var n=0,r=0,o=0;o<i.length-1;o++){var s=r;r=0;for(var a=67108863&n,c=Math.min(o,t.length-1),u=Math.max(0,o-e.length+1);u<=c;u++){var d=o-u,l=(0|e.words[d])*(0|t.words[u]),h=67108863&l;a=67108863&(h=h+a|0),r+=(s=(s=s+(l/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}i.words[o]=a,n=s,s=r}return 0!==n?i.words[o]=n:i.length--,i.strip()}(this,e,t):m(this,e,t),i},_.prototype.makeRBT=function(e){for(var t=new Array(e),i=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,i,e);return t},_.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var n=0,r=0;r<t;r++)n|=(1&e)<<t-r-1,e>>=1;return n},_.prototype.permute=function(e,t,i,n,r,o){for(var s=0;s<o;s++)n[s]=t[e[s]],r[s]=i[e[s]]},_.prototype.transform=function(e,t,i,n,r,o){this.permute(o,e,t,i,n,r);for(var s=1;s<r;s<<=1)for(var a=s<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),d=0;d<r;d+=a)for(var l=c,h=u,f=0;f<s;f++){var p=i[d+f],m=n[d+f],_=i[d+f+s],g=n[d+f+s],v=l*_-h*g;g=l*g+h*_,_=v,i[d+f]=p+_,n[d+f]=m+g,i[d+f+s]=p-_,n[d+f+s]=m-g,f!==a&&(v=c*l-u*h,h=c*h+u*l,l=v)}},_.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),n=1&i,r=0;for(i=i/2|0;i;i>>>=1)r++;return 1<<r+1+n},_.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var n=0;n<i/2;n++){var r=e[n];e[n]=e[i-n-1],e[i-n-1]=r,r=t[n],t[n]=-t[i-n-1],t[i-n-1]=-r}},_.prototype.normalize13b=function(e,t){for(var i=0,n=0;n<t/2;n++){var r=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+i;e[n]=67108863&r,i=r<67108864?0:r/67108864|0}return e},_.prototype.convert13b=function(e,t,i,r){for(var o=0,s=0;s<t;s++)o+=0|e[s],i[2*s]=8191&o,o>>>=13,i[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<r;++s)i[s]=0;n(0===o),n(0===(-8192&o))},_.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},_.prototype.mulp=function(e,t,i){var n=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),d=new Array(n),l=new Array(n),h=i.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,u,n),this.transform(s,o,a,c,n,r),this.transform(u,o,d,l,n,r);for(var f=0;f<n;f++){var p=a[f]*d[f]-c[f]*l[f];c[f]=a[f]*l[f]+c[f]*d[f],a[f]=p}return this.conjugate(a,c,n),this.transform(a,c,h,o,n,r),this.conjugate(h,o,n),this.normalize13b(h,n),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),m(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){n("number"===typeof e),n(e<67108864);for(var t=0,i=0;i<this.length;i++){var r=(0|this.words[i])*e,o=(67108863&r)+(67108863&t);t>>=26,t+=r/67108864|0,t+=o>>>26,this.words[i]=67108863&o}return 0!==t&&(this.words[i]=t,this.length++),this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var n=i/26|0,r=i%26;t[i]=(e.words[n]&1<<r)>>>r}return t}(e);if(0===t.length)return new o(1);for(var i=this,n=0;n<t.length&&0===t[n];n++,i=i.sqr());if(++n<t.length)for(var r=i.sqr();n<t.length;n++,r=r.sqr())0!==t[n]&&(i=i.mul(r));return i},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,i=e%26,r=(e-i)/26,o=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,c=(0|this.words[t])-a<<i;this.words[t]=c|s,s=a>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==r){for(t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(t=0;t<r;t++)this.words[t]=0;this.length+=r}return this.strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,i){var r;n("number"===typeof e&&e>=0),r=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,c=i;if(r-=s,r=Math.max(0,r),c){for(var u=0;u<s;u++)c.words[u]=this.words[u];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,u=0;u<this.length;u++)this.words[u]=this.words[u+s];else this.words[0]=0,this.length=1;var d=0;for(u=this.length-1;u>=0&&(0!==d||u>=r);u--){var l=0|this.words[u];this.words[u]=d<<26-o|l>>>o,d=l&a}return c&&0!==d&&(c.words[c.length++]=d),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(e,t,i){return n(0===this.negative),this.iushrn(e,t,i)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26,r=1<<t;return!(this.length<=i)&&!!(this.words[i]&r)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var r=67108863^67108863>>>t<<t;this.words[this.length-1]&=r}return this.strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,i){var r,o,s=e.length+i;this._expand(s);var a=0;for(r=0;r<e.length;r++){o=(0|this.words[r+i])+a;var c=(0|e.words[r])*t;a=((o-=67108863&c)>>26)-(c/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},o.prototype._wordDiv=function(e,t){var i=(this.length,e.length),n=this.clone(),r=e,s=0|r.words[r.length-1];0!==(i=26-this._countBits(s))&&(r=r.ushln(i),n.iushln(i),s=0|r.words[r.length-1]);var a,c=n.length-r.length;if("mod"!==t){(a=new o(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var d=n.clone()._ishlnsubmul(r,1,c);0===d.negative&&(n=d,a&&(a.words[c]=1));for(var l=c-1;l>=0;l--){var h=67108864*(0|n.words[r.length+l])+(0|n.words[r.length+l-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(r,h,l);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(r,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=h)}return a&&a.strip(),n.strip(),"div"!==t&&0!==i&&n.iushrn(i),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,i){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(r=a.div.neg()),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:r,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(r=a.div.neg()),{div:r,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}:this._wordDiv(e,t);var r,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),r=e.andln(1),o=i.cmp(n);return o<0||1===r&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,i=0,r=this.length-1;r>=0;r--)i=(t*i+(0|this.words[r]))%e;return i},o.prototype.idivn=function(e){n(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var r=(0|this.words[i])+67108864*t;this.words[i]=r/e|0,t=r%e}return this.strip()},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r=new o(1),s=new o(0),a=new o(0),c=new o(1),u=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++u;for(var d=i.clone(),l=t.clone();!t.isZero();){for(var h=0,f=1;0===(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(r.isOdd()||s.isOdd())&&(r.iadd(d),s.isub(l)),r.iushrn(1),s.iushrn(1);for(var p=0,m=1;0===(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(d),c.isub(l)),a.iushrn(1),c.iushrn(1);t.cmp(i)>=0?(t.isub(i),r.isub(a),s.isub(c)):(i.isub(t),a.isub(r),c.isub(s))}return{a:a,b:c,gcd:i.iushln(u)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r,s=new o(1),a=new o(0),c=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,d=1;0===(t.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(t.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var l=0,h=1;0===(i.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(i.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(a)):(i.isub(t),a.isub(s))}return(r=0===t.cmpn(1)?s:a).cmpn(0)<0&&r.iadd(e),r},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var n=0;t.isEven()&&i.isEven();n++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=t.cmp(i);if(r<0){var o=t;t=i,i=o}else if(0===r||0===i.cmpn(1))break;t.isub(i)}return i.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,i=(e-t)/26,r=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var o=r,s=i;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),n(e<=67108863,"Number is too big");var r=0|this.words[0];t=r===e?0:r<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],r=0|e.words[i];if(n!==r){n<r?t=-1:n>r&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new S(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function y(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function T(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},r(E,v),E.prototype.split=function(e,t){for(var i=4194303,n=Math.min(e.length,9),r=0;r<n;r++)t.words[r]=e.words[r];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&i,r=10;r<e.length;r++){var s=0|e.words[r];e.words[r-10]=(s&i)<<4|o>>>22,o=s}o>>>=22,e.words[r-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var n=0|e.words[i];t+=977*n,e.words[i]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(b,v),r(y,v),r(w,v),w.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var n=19*(0|e.words[i])+t,r=67108863&n;n>>>=26,e.words[i]=r,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new b;else if("p192"===e)t=new y;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return g[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},S.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var i=this.m.add(new o(1)).iushrn(2);return this.pow(e,i)}for(var r=this.m.subn(1),s=0;!r.isZero()&&0===r.andln(1);)s++,r.iushrn(1);n(!r.isZero());var a=new o(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new o(2*d*d).toRed(this);0!==this.pow(d,u).cmp(c);)d.redIAdd(c);for(var l=this.pow(d,r),h=this.pow(e,r.addn(1).iushrn(1)),f=this.pow(e,r),p=s;0!==f.cmp(a);){for(var m=f,_=0;0!==m.cmp(a);_++)m=m.redSqr();n(_<p);var g=this.pow(l,new o(1).iushln(p-_-1));h=h.redMul(g),l=g.redSqr(),f=f.redMul(l),p=_}return h},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new o(1).toRed(this),i[1]=e;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],e);var r=i[0],s=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],d=c-1;d>=0;d--){var l=u>>d&1;r!==i[0]&&(r=this.sqr(r)),0!==l||0!==s?(s<<=1,s|=l,(4===++a||0===n&&0===d)&&(r=this.mul(r,i[s]),a=0,s=0)):a=0}c=26}return r},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new T(e)},r(T,S),T.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},T.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},T.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},T.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var i=e.mul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),s=r;return r.cmp(this.m)>=0?s=r.isub(this.m):r.cmpn(0)<0&&(s=r.iadd(this.m)),s._forceRed(this)},T.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(27)(e))},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(0),r="undefined"!==typeof window?n.useLayoutEffect:n.useEffect;function o(e){var t=n.useRef(e);return r((function(){t.current=e})),n.useCallback((function(){return t.current.apply(void 0,arguments)}),[])}},function(e,t,i){"use strict";i.d(t,"AgoraVideoPlayer",(function(){return l})),i.d(t,"createClient",(function(){return c})),i.d(t,"createMicrophoneAndCameraTracks",(function(){return u})),i.d(t,"createScreenVideoTrack",(function(){return d}));var n,r=i(0),o=i.n(r),s=i(13),a=i.n(s);!function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE"}(n||(n={}));var c=function(e){var t;return function(){return t||(t=a.a.createClient(e)),t}};function u(e,t){var i=null;return function(){var n=Object(r.useState)(!1),o=n[0],s=n[1],c=Object(r.useState)(null),u=c[0],d=c[1],l=Object(r.useRef)(i);return Object(r.useEffect)((function(){return null===l.current?function(){try{return Promise.resolve(a.a.createMicrophoneAndCameraTracks(e,t)).then((function(e){return i=e}))}catch(n){return Promise.reject(n)}}().then((function(e){l.current=e,s(!0)}),(function(e){d(e)})):s(!0),function(){i=null}}),[]),{ready:o,tracks:l.current,error:u}}}function d(e,t){var i;return function(){var n=Object(r.useState)(!1),o=n[0],s=n[1],c=Object(r.useState)(null),u=c[0],d=c[1],l=Object(r.useRef)(i);return Object(r.useEffect)((function(){void 0===l.current?function(){try{return Promise.resolve(a.a.createScreenVideoTrack(e,t)).then((function(e){return i=e}))}catch(n){return Promise.reject(n)}}().then((function(e){l.current=e,s(!0)}),(function(e){d(e)})):s(!0)}),[]),{ready:o,tracks:l.current,error:u}}}var l=function(e){var t=Object(r.useRef)(null),i=e.videoTrack,n=e.config,s=function(e,t){if(null==e)return{};var i,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,["videoTrack","config"]);return Object(r.useLayoutEffect)((function(){return null!==t.current&&i.play(t.current,n),function(){i.stop()}}),[i]),o.a.createElement("div",Object.assign({},s,{ref:t}))};a.a},function(e,t,i){var n=i(3).Buffer,r=i(176).Transform,o=i(25).StringDecoder;function s(e){r.call(this),this.hashMode="string"===typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}i(2)(s,r),s.prototype.update=function(e,t,i){"string"===typeof e&&(e=n.from(e,t));var r=this._update(e);return this.hashMode?this:(i&&(r=this._toString(r,i)),r)},s.prototype.setAutoPadding=function(){},s.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},s.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},s.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},s.prototype._transform=function(e,t,i){var n;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(r){n=r}finally{i(n)}},s.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(i){t=i}e(t)},s.prototype._finalOrDigest=function(e){var t=this.__final()||n.alloc(0);return e&&(t=this._toString(t,e,!0)),t},s.prototype._toString=function(e,t,i){if(this._decoder||(this._decoder=new o(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var n=this._decoder.write(e);return i&&(n+=this._decoder.end()),n},e.exports=s},function(e,t,i){"use strict";var n,r="object"===typeof Reflect?Reflect:null,o=r&&"function"===typeof r.apply?r.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};n=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!==e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(i,n){function r(i){e.removeListener(t,o),n(i)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",r),i([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&function(e,t,i){"function"===typeof e.on&&g(e,"error",t,i)}(e,r,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function u(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function d(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function l(e,t,i,n){var r,o,s,a;if(u(i),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),o=e._events),s=o[t]),void 0===s)s=o[t]=i,++e._eventsCount;else if("function"===typeof s?s=o[t]=n?[i,s]:[s,i]:n?s.unshift(i):s.push(i),(r=d(e))>0&&s.length>r&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=h.bind(n);return r.listener=i,n.wrapFn=r,r}function p(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"===typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):_(r,r.length)}function m(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"===typeof i)return 1;if(void 0!==i)return i.length}return 0}function _(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}function g(e,t,i,n){if("function"===typeof e.on)n.once?e.once(t,i):e.on(t,i);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){n.once&&e.removeEventListener(t,r),i(o)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!==typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return d(this)},a.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=r[e];if(void 0===c)return!1;if("function"===typeof c)o(c,this,t);else{var u=c.length,d=_(c,u);for(i=0;i<u;++i)o(d[i],this,t)}return!0},a.prototype.addListener=function(e,t){return l(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return l(this,e,t,!0)},a.prototype.once=function(e,t){return u(t),this.on(e,f(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,f(this,e,t)),this},a.prototype.removeListener=function(e,t){var i,n,r,o,s;if(u(t),void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!==typeof i){for(r=-1,o=i.length-1;o>=0;o--)if(i[o]===t||i[o].listener===t){s=i[o].listener,r=o;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,o=Object.keys(i);for(n=0;n<o.length;++n)"removeListener"!==(r=o[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},a.prototype.listeners=function(e){return p(this,e,!0)},a.prototype.rawListeners=function(e){return p(this,e,!1)},a.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):m.call(e,t)},a.prototype.listenerCount=m,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,i){"use strict";var n=i(3).Buffer,r=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!==typeof t&&(n.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=u,t=4;break;case"utf8":this.fillLast=a,t=4;break;case"base64":this.text=d,this.end=l,t=3;break;default:return this.write=h,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function s(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function a(e){var t=this.lastTotal-this.lastNeed,i=function(e,t,i){if(128!==(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!==(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!==(192&t[2]))return e.lastNeed=2,"\ufffd"}}(this,e);return void 0!==i?i:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2===0){var i=e.toString("utf16le",t);if(i){var n=i.charCodeAt(i.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function u(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,i)}return t}function d(e,t){var i=(e.length-t)%3;return 0===i?e.toString("base64",t):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-i))}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function h(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,i;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<e.length?t?t+this.text(e,i):this.text(e,i):t||""},o.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},o.prototype.text=function(e,t){var i=function(e,t,i){var n=t.length-1;if(n<i)return 0;var r=s(t[n]);if(r>=0)return r>0&&(e.lastNeed=r-1),r;if(--n<i||-2===r)return 0;if(r=s(t[n]),r>=0)return r>0&&(e.lastNeed=r-2),r;if(--n<i||-2===r)return 0;if(r=s(t[n]),r>=0)return r>0&&(2===r?r=0:e.lastNeed=r-3),r;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=i;var n=e.length-(i-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,i){"use strict";var n=i(52),r=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};e.exports=l;var o=Object.create(i(42));o.inherits=i(2);var s=i(96),a=i(69);o.inherits(l,s);for(var c=r(a.prototype),u=0;u<c.length;u++){var d=c[u];l.prototype[d]||(l.prototype[d]=a.prototype[d])}function l(e){if(!(this instanceof l))return new l(e);s.call(this,e),a.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||n.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),l.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,i){var n=i(271).default;function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(r=function(e){return e?i:t})(e)}e.exports=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=n(e)&&"function"!=typeof e)return{default:e};var i=r(t);if(i&&i.has(e))return i.get(e);var o={__proto__:null},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=s?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(o,a,c):o[a]=e[a]}return o.default=e,i&&i.set(e,o),o},e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=i(272)},function(e,t,i){"use strict";(function(t,n){var r=65536,o=4294967295;var s=i(3).Buffer,a=t.crypto||t.msCrypto;a&&a.getRandomValues?e.exports=function(e,t){if(e>o)throw new RangeError("requested too many random bytes");var i=s.allocUnsafe(e);if(e>0)if(e>r)for(var c=0;c<e;c+=r)a.getRandomValues(i.slice(c,c+r));else a.getRandomValues(i);if("function"===typeof t)return n.nextTick((function(){t(null,i)}));return i}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}).call(this,i(9),i(6))},function(e,t,i){"use strict";var n={};function r(e,t,i){i||(i=Error);var r=function(e){var i,n;function r(i,n,r){return e.call(this,function(e,i,n){return"string"===typeof t?t:t(e,i,n)}(i,n,r))||this}return n=e,(i=r).prototype=Object.create(n.prototype),i.prototype.constructor=i,i.__proto__=n,r}(i);r.prototype.name=i.name,r.prototype.code=e,n[e]=r}function o(e,t){if(Array.isArray(e)){var i=e.length;return e=e.map((function(e){return String(e)})),i>2?"one of ".concat(t," ").concat(e.slice(0,i-1).join(", "),", or ")+e[i-1]:2===i?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(e,t,i){var n,r,s,a;if("string"===typeof t&&(r="not ",t.substr(!s||s<0?0:+s,r.length)===r)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,i){return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t}(e," argument"))a="The ".concat(e," ").concat(n," ").concat(o(t,"type"));else{var c=function(e,t,i){return"number"!==typeof i&&(i=0),!(i+t.length>e.length)&&-1!==e.indexOf(t,i)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(c," ").concat(n," ").concat(o(t,"type"))}return a+=". Received type ".concat(typeof i)}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,i){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};e.exports=u;var r=i(88),o=i(92);i(2)(u,r);for(var s=n(o.prototype),a=0;a<s.length;a++){var c=s[a];u.prototype[c]||(u.prototype[c]=o.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);r.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",d)))}function d(){this._writableState.ended||t.nextTick(l,this)}function l(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,i(6))},function(e,t,i){var n=i(3).Buffer;function r(e,t){this._block=n.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}r.prototype.update=function(e,t){"string"===typeof e&&(t=t||"utf8",e=n.from(e,t));for(var i=this._block,r=this._blockSize,o=e.length,s=this._len,a=0;a<o;){for(var c=s%r,u=Math.min(o-a,r-c),d=0;d<u;d++)i[c+d]=e[a+d];a+=u,(s+=u)%r===0&&this._update(i)}return this._len+=o,this},r.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var i=8*this._len;if(i<=4294967295)this._block.writeUInt32BE(i,this._blockSize-4);else{var n=(4294967295&i)>>>0,r=(i-n)/4294967296;this._block.writeUInt32BE(r,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var o=this._hash();return e?o.toString(e):o},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=r},function(e,t,i){"use strict";var n={};function r(e,t,i){i||(i=Error);var r=function(e){var i,n;function r(i,n,r){return e.call(this,function(e,i,n){return"string"===typeof t?t:t(e,i,n)}(i,n,r))||this}return n=e,(i=r).prototype=Object.create(n.prototype),i.prototype.constructor=i,i.__proto__=n,r}(i);r.prototype.name=i.name,r.prototype.code=e,n[e]=r}function o(e,t){if(Array.isArray(e)){var i=e.length;return e=e.map((function(e){return String(e)})),i>2?"one of ".concat(t," ").concat(e.slice(0,i-1).join(", "),", or ")+e[i-1]:2===i?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}r("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),r("ERR_INVALID_ARG_TYPE",(function(e,t,i){var n,r,s,a;if("string"===typeof t&&(r="not ",t.substr(!s||s<0?0:+s,r.length)===r)?(n="must not be",t=t.replace(/^not /,"")):n="must be",function(e,t,i){return(void 0===i||i>e.length)&&(i=e.length),e.substring(i-t.length,i)===t}(e," argument"))a="The ".concat(e," ").concat(n," ").concat(o(t,"type"));else{var c=function(e,t,i){return"number"!==typeof i&&(i=0),!(i+t.length>e.length)&&-1!==e.indexOf(t,i)}(e,".")?"property":"argument";a='The "'.concat(e,'" ').concat(c," ").concat(n," ").concat(o(t,"type"))}return a+=". Received type ".concat(typeof i)}),TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),e.exports.codes=n},function(e,t,i){"use strict";(function(t){var n=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};e.exports=u;var r=i(118),o=i(122);i(2)(u,r);for(var s=n(o.prototype),a=0;a<s.length;a++){var c=s[a];u.prototype[c]||(u.prototype[c]=o.prototype[c])}function u(e){if(!(this instanceof u))return new u(e);r.call(this,e),o.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",d)))}function d(){this._writableState.ended||t.nextTick(l,this)}function l(e){e.end()}Object.defineProperty(u.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(u.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(u.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(u.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}).call(this,i(6))},function(e,t,i){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=i(155)},function(e,t,i){"use strict";function n(e,t){if(null==e)return{};var i,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return o}));var n=i(0),r=i(46);function o(e,t){return n.useMemo((function(){return null==e&&null==t?null:function(i){Object(r.a)(e,i),Object(r.a)(t,i)}}),[e,t])}},function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var n=i(50);var r=i(142),o=i(59);function s(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||Object(r.a)(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,i){"use strict";var n=i(2),r=i(62),o=i(65),s=i(66),a=i(23);function c(e){a.call(this,"digest"),this._hash=e}n(c,a),c.prototype._update=function(e){this._hash.update(e)},c.prototype._final=function(){return this._hash.digest()},e.exports=function(e){return"md5"===(e=e.toLowerCase())?new r:"rmd160"===e||"ripemd160"===e?new o:new c(s(e))}},function(e,t,i){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"===typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"===typeof e},t.isString=function(e){return"string"===typeof e},t.isSymbol=function(e){return"symbol"===typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"===typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"===typeof e},t.isPrimitive=function(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e},t.isBuffer=i(7).Buffer.isBuffer},function(e,t,i){(function(t){e.exports=function(e,i){for(var n=Math.min(e.length,i.length),r=new t(n),o=0;o<n;++o)r[o]=e[o]^i[o];return r}}).call(this,i(7).Buffer)},function(e,t,i){"use strict";var n=i(16),r=i(11);function o(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=o,o.prototype.update=function(e,t){if(e=n.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var i=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-i,e.length),0===this.pending.length&&(this.pending=null),e=n.join32(e,0,e.length-i,this.endian);for(var r=0;r<e.length;r+=this._delta32)this._update(e,r,r+this._delta32)}return this},o.prototype.digest=function(e){return this.update(this._pad()),r(null===this.pending),this._digest(e)},o.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,i=t-(e+this.padLength)%t,n=new Array(i+this.padLength);n[0]=128;for(var r=1;r<i;r++)n[r]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)n[r++]=0;n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=e>>>24&255,n[r++]=e>>>16&255,n[r++]=e>>>8&255,n[r++]=255&e}else for(n[r++]=255&e,n[r++]=e>>>8&255,n[r++]=e>>>16&255,n[r++]=e>>>24&255,n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=0,o=8;o<this.padLength;o++)n[r++]=0;return n}},function(e,t,i){"use strict";const n=i(2),r=i(82).Reporter,o=i(80).Buffer;function s(e,t){r.call(this,t),o.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function a(e,t){if(Array.isArray(e))this.length=0,this.value=e.map((function(e){return a.isEncoderBuffer(e)||(e=new a(e,t)),this.length+=e.length,e}),this);else if("number"===typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"===typeof e)this.value=e,this.length=o.byteLength(e);else{if(!o.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}n(s,r),t.DecoderBuffer=s,s.isDecoderBuffer=function(e){if(e instanceof s)return!0;return"object"===typeof e&&o.isBuffer(e.base)&&"DecoderBuffer"===e.constructor.name&&"number"===typeof e.offset&&"number"===typeof e.length&&"function"===typeof e.save&&"function"===typeof e.restore&&"function"===typeof e.isEmpty&&"function"===typeof e.readUInt8&&"function"===typeof e.skip&&"function"===typeof e.raw},s.prototype.save=function(){return{offset:this.offset,reporter:r.prototype.save.call(this)}},s.prototype.restore=function(e){const t=new s(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,r.prototype.restore.call(this,e.reporter),t},s.prototype.isEmpty=function(){return this.offset===this.length},s.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},s.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");const i=new s(this.base);return i._reporterState=this._reporterState,i.offset=this.offset,i.length=this.offset+e,this.offset+=e,i},s.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},t.EncoderBuffer=a,a.isEncoderBuffer=function(e){if(e instanceof a)return!0;return"object"===typeof e&&"EncoderBuffer"===e.constructor.name&&"number"===typeof e.length&&"function"===typeof e.join},a.prototype.join=function(e,t){return e||(e=o.alloc(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach((function(i){i.join(e,t),t+=i.length})):("number"===typeof this.value?e[t]=this.value:"string"===typeof this.value?e.write(this.value,t):o.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}},function(e,t,i){"use strict";function n(e,t){"function"===typeof e?e(t):e&&(e.current=t)}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=i(0),o=(n=r)&&"object"===typeof n&&"default"in n?n.default:n,s=i(266),a=new s,c=a.getBrowser(),u=a.getCPU(),d=a.getDevice(),l=a.getEngine(),h=a.getOS(),f=a.getUA(),p=function(e){return a.setUA(e)},m=function(e){if(e){var t=new s(e);return{UA:t,browser:t.getBrowser(),cpu:t.getCPU(),device:t.getDevice(),engine:t.getEngine(),os:t.getOS(),ua:t.getUA(),setUserAgent:function(e){return t.setUA(e)}}}console.error("No userAgent string was provided")},_=Object.freeze({ClientUAInstance:a,browser:c,cpu:u,device:d,engine:l,os:h,ua:f,setUa:p,parseUserAgent:m});function g(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function v(e){return v="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function E(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},y.apply(this,arguments)}function w(e){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},w(e)}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function T(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}function R(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==i)return;var n,r,o=[],s=!0,a=!1;try{for(i=i.call(e);!(s=(n=i.next()).done)&&(o.push(n.value),!t||o.length!==t);s=!0);}catch(c){a=!0,r=c}finally{try{s||null==i.return||i.return()}finally{if(a)throw r}}return o}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return I(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}var A="mobile",O="tablet",M="smarttv",N="console",k="wearable",P="embedded",D=void 0,L={Chrome:"Chrome",Firefox:"Firefox",Opera:"Opera",Yandex:"Yandex",Safari:"Safari",InternetExplorer:"Internet Explorer",Edge:"Edge",Chromium:"Chromium",Ie:"IE",MobileSafari:"Mobile Safari",EdgeChromium:"Edge Chromium",MIUI:"MIUI Browser",SamsungBrowser:"Samsung Browser"},x={IOS:"iOS",Android:"Android",WindowsPhone:"Windows Phone",Windows:"Windows",MAC_OS:"Mac OS"},U={isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1},V=function(e){return e||(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none")},B=function(){return!("undefined"===typeof window||!window.navigator&&!navigator)&&(window.navigator||navigator)},j=function(e){var t=B();return t&&t.platform&&(-1!==t.platform.indexOf(e)||"MacIntel"===t.platform&&t.maxTouchPoints>1&&!window.MSStream)},F=function(e,t,i,n){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?g(Object(i),!0).forEach((function(t){b(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):g(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e,{vendor:V(t.vendor),model:V(t.model),os:V(i.name),osVersion:V(i.version),ua:V(n)})};var W=function(e){return e.type===A},G=function(e){return e.type===O},H=function(e){var t=e.type;return t===A||t===O},q=function(e){return e.type===M},K=function(e){return e.type===D},z=function(e){return e.type===k},Y=function(e){return e.type===N},J=function(e){return e.type===P},X=function(e){var t=e.vendor;return V(t)},Q=function(e){var t=e.model;return V(t)},Z=function(e){var t=e.type;return V(t,"browser")},$=function(e){return e.name===x.Android},ee=function(e){return e.name===x.Windows},te=function(e){return e.name===x.MAC_OS},ie=function(e){return e.name===x.WindowsPhone},ne=function(e){return e.name===x.IOS},re=function(e){var t=e.version;return V(t)},oe=function(e){var t=e.name;return V(t)},se=function(e){return e.name===L.Chrome},ae=function(e){return e.name===L.Firefox},ce=function(e){return e.name===L.Chromium},ue=function(e){return e.name===L.Edge},de=function(e){return e.name===L.Yandex},le=function(e){var t=e.name;return t===L.Safari||t===L.MobileSafari},he=function(e){return e.name===L.MobileSafari},fe=function(e){return e.name===L.Opera},pe=function(e){var t=e.name;return t===L.InternetExplorer||t===L.Ie},me=function(e){return e.name===L.MIUI},_e=function(e){return e.name===L.SamsungBrowser},ge=function(e){var t=e.version;return V(t)},ve=function(e){var t=e.major;return V(t)},Ee=function(e){var t=e.name;return V(t)},be=function(e){var t=e.name;return V(t)},ye=function(e){var t=e.version;return V(t)},we=function(){var e=B(),t=e&&e.userAgent&&e.userAgent.toLowerCase();return"string"===typeof t&&/electron/.test(t)},Se=function(e){return"string"===typeof e&&-1!==e.indexOf("Edg/")},Te=function(){var e=B();return e&&(/iPad|iPhone|iPod/.test(e.platform)||"MacIntel"===e.platform&&e.maxTouchPoints>1)&&!window.MSStream},Re=function(){return j("iPad")},Ce=function(){return j("iPhone")},Ie=function(){return j("iPod")},Ae=function(e){return V(e)};function Oe(e){var t=e||_,i=t.device,n=t.browser,r=t.os,o=t.engine,s=t.ua;return{isSmartTV:q(i),isConsole:Y(i),isWearable:z(i),isEmbedded:J(i),isMobileSafari:he(n)||Re(),isChromium:ce(n),isMobile:H(i)||Re(),isMobileOnly:W(i),isTablet:G(i)||Re(),isBrowser:K(i),isDesktop:K(i),isAndroid:$(r),isWinPhone:ie(r),isIOS:ne(r)||Re(),isChrome:se(n),isFirefox:ae(n),isSafari:le(n),isOpera:fe(n),isIE:pe(n),osVersion:re(r),osName:oe(r),fullBrowserVersion:ge(n),browserVersion:ve(n),browserName:Ee(n),mobileVendor:X(i),mobileModel:Q(i),engineName:be(o),engineVersion:ye(o),getUA:Ae(s),isEdge:ue(n)||Se(s),isYandex:de(n),deviceType:Z(i),isIOS13:Te(),isIPad13:Re(),isIPhone13:Ce(),isIPod13:Ie(),isElectron:we(),isEdgeChromium:Se(s),isLegacyEdge:ue(n)&&!Se(s),isWindows:ee(r),isMacOs:te(r),isMIUI:me(n),isSamsungBrowser:_e(n)}}var Me=q(d),Ne=Y(d),ke=z(d),Pe=J(d),De=he(c)||Re(),Le=ce(c),xe=H(d)||Re(),Ue=W(d),Ve=G(d)||Re(),Be=K(d),je=K(d),Fe=$(h),We=ie(h),Ge=ne(h)||Re(),He=se(c),qe=ae(c),Ke=le(c),ze=fe(c),Ye=pe(c),Je=re(h),Xe=oe(h),Qe=ge(c),Ze=ve(c),$e=Ee(c),et=X(d),tt=Q(d),it=be(l),nt=ye(l),rt=Ae(f),ot=ue(c)||Se(f),st=de(c),at=Z(d),ct=Te(),ut=Re(),dt=Ce(),lt=Ie(),ht=we(),ft=Se(f),pt=ue(c)&&!Se(f),mt=ee(h),_t=te(h),gt=me(c),vt=_e(c);function Et(e){var t=e||window.navigator.userAgent;return m(t)}t.AndroidView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return Fe?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.BrowserTypes=L,t.BrowserView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return Be?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.ConsoleView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return Ne?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.CustomView=function(e){var t=e.renderWithFragment,i=e.children,n=(e.viewClassName,e.style,e.condition),s=T(e,["renderWithFragment","children","viewClassName","style","condition"]);return n?t?o.createElement(r.Fragment,null,i):o.createElement("div",s,i):null},t.IEView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return Ye?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.IOSView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return Ge?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.MobileOnlyView=function(e){var t=e.renderWithFragment,i=e.children,n=(e.viewClassName,e.style,T(e,["renderWithFragment","children","viewClassName","style"]));return Ue?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.MobileView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return xe?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.OsTypes=x,t.SmartTVView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return Me?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.TabletView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return Ve?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.WearableView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return ke?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.WinPhoneView=function(e){var t=e.renderWithFragment,i=e.children,n=T(e,["renderWithFragment","children"]);return We?t?o.createElement(r.Fragment,null,i):o.createElement("div",n,i):null},t.browserName=$e,t.browserVersion=Ze,t.deviceDetect=function(e){var t=e?m(e):_,i=t.device,n=t.browser,r=t.engine,o=t.os,s=t.ua,a=function(e){switch(e){case A:return{isMobile:!0};case O:return{isTablet:!0};case M:return{isSmartTV:!0};case N:return{isConsole:!0};case k:return{isWearable:!0};case D:return{isBrowser:!0};case P:return{isEmbedded:!0};default:return U}}(i.type),c=a.isBrowser,u=a.isMobile,d=a.isTablet,l=a.isSmartTV,h=a.isConsole,f=a.isWearable,p=a.isEmbedded;return c?function(e,t,i,n,r){return{isBrowser:e,browserMajorVersion:V(t.major),browserFullVersion:V(t.version),browserName:V(t.name),engineName:V(i.name),engineVersion:V(i.version),osName:V(n.name),osVersion:V(n.version),userAgent:V(r)}}(c,n,r,o,s):l?function(e,t,i,n){return{isSmartTV:e,engineName:V(t.name),engineVersion:V(t.version),osName:V(i.name),osVersion:V(i.version),userAgent:V(n)}}(l,r,o,s):h?function(e,t,i,n){return{isConsole:e,engineName:V(t.name),engineVersion:V(t.version),osName:V(i.name),osVersion:V(i.version),userAgent:V(n)}}(h,r,o,s):u||d?F(a,i,o,s):f?function(e,t,i,n){return{isWearable:e,engineName:V(t.name),engineVersion:V(t.version),osName:V(i.name),osVersion:V(i.version),userAgent:V(n)}}(f,r,o,s):p?function(e,t,i,n,r){return{isEmbedded:e,vendor:V(t.vendor),model:V(t.model),engineName:V(i.name),engineVersion:V(i.version),osName:V(n.name),osVersion:V(n.version),userAgent:V(r)}}(p,i,r,o,s):void 0},t.deviceType=at,t.engineName=it,t.engineVersion=nt,t.fullBrowserVersion=Qe,t.getSelectorsByUserAgent=function(e){if(e&&"string"===typeof e){var t=m(e);return Oe({device:t.device,browser:t.browser,os:t.os,engine:t.engine,ua:t.ua})}console.error("No valid user agent string was provided")},t.getUA=rt,t.isAndroid=Fe,t.isBrowser=Be,t.isChrome=He,t.isChromium=Le,t.isConsole=Ne,t.isDesktop=je,t.isEdge=ot,t.isEdgeChromium=ft,t.isElectron=ht,t.isEmbedded=Pe,t.isFirefox=qe,t.isIE=Ye,t.isIOS=Ge,t.isIOS13=ct,t.isIPad13=ut,t.isIPhone13=dt,t.isIPod13=lt,t.isLegacyEdge=pt,t.isMIUI=gt,t.isMacOs=_t,t.isMobile=xe,t.isMobileOnly=Ue,t.isMobileSafari=De,t.isOpera=ze,t.isSafari=Ke,t.isSamsungBrowser=vt,t.isSmartTV=Me,t.isTablet=Ve,t.isWearable=ke,t.isWinPhone=We,t.isWindows=mt,t.isYandex=st,t.mobileModel=tt,t.mobileVendor=et,t.osName=Xe,t.osVersion=Je,t.parseUserAgent=m,t.setUserAgent=function(e){return p(e)},t.useDeviceData=Et,t.useDeviceSelectors=function(e){var t=Et(e||window.navigator.userAgent);return[Oe(t),t]},t.useMobileOrientation=function(){var e=C(r.useState((function(){var e=window.innerWidth>window.innerHeight?90:0;return{isPortrait:0===e,isLandscape:90===e,orientation:0===e?"portrait":"landscape"}})),2),t=e[0],i=e[1],n=r.useCallback((function(){var e=window.innerWidth>window.innerHeight?90:0,n={isPortrait:0===e,isLandscape:90===e,orientation:0===e?"portrait":"landscape"};t.orientation!==n.orientation&&i(n)}),[t.orientation]);return r.useEffect((function(){return void 0!==("undefined"===typeof window?"undefined":v(window))&&xe&&(n(),window.addEventListener("load",n,!1),window.addEventListener("resize",n,!1)),function(){window.removeEventListener("resize",n,!1),window.removeEventListener("load",n,!1)}}),[n]),t},t.withOrientationChange=function(e){return function(t){function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=function(e,t){if(t&&("object"===typeof t||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return R(e)}(this,w(i).call(this,e))).isEventListenerAdded=!1,t.handleOrientationChange=t.handleOrientationChange.bind(R(t)),t.onOrientationChange=t.onOrientationChange.bind(R(t)),t.onPageLoad=t.onPageLoad.bind(R(t)),t.state={isLandscape:!1,isPortrait:!1},t}var n,r,s;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(i,t),n=i,(r=[{key:"handleOrientationChange",value:function(){this.isEventListenerAdded||(this.isEventListenerAdded=!0);var e=window.innerWidth>window.innerHeight?90:0;this.setState({isPortrait:0===e,isLandscape:90===e})}},{key:"onOrientationChange",value:function(){this.handleOrientationChange()}},{key:"onPageLoad",value:function(){this.handleOrientationChange()}},{key:"componentDidMount",value:function(){void 0!==("undefined"===typeof window?"undefined":v(window))&&xe&&(this.isEventListenerAdded?window.removeEventListener("load",this.onPageLoad,!1):(this.handleOrientationChange(),window.addEventListener("load",this.onPageLoad,!1)),window.addEventListener("resize",this.onOrientationChange,!1))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onOrientationChange,!1)}},{key:"render",value:function(){return o.createElement(e,y({},this.props,{isLandscape:this.state.isLandscape,isPortrait:this.state.isPortrait}))}}])&&E(n.prototype,r),s&&E(n,s),i}(o.Component)}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(141);function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Object(n.a)(e,t)}},function(e,t,i){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}i.d(t,"a",(function(){return n}))},function(e,t,i){(function(t){var n=i(163),r=i(262),o=i(263).UINT32,s="006",a=Math.floor(4294967295*Math.random());e.exports.version=s,e.exports.AccessToken=function(e,i,n,u){let d=this;this.appID=e,this.appCertificate=i,this.channelName=n,this.messages={},this.salt=a,this.ts=Math.floor(new Date/1e3)+86400,this.uid=0===u?"":"".concat(u),this.build=function(){var e=h({salt:d.salt,ts:d.ts,messages:d.messages}).pack(),i=t.concat([t.from(d.appID,"utf8"),t.from(d.channelName,"utf8"),t.from(d.uid,"utf8"),e]),n=c(d.appCertificate,i),a=o(r.str(d.channelName)).and(o(4294967295)).toNumber(),u=o(r.str(d.uid)).and(o(4294967295)).toNumber(),f=l({signature:n,crc_channel:a,crc_uid:u,m:e}).pack();return s+d.appID+f.toString("base64")},this.addPriviledge=function(e,t){d.messages[e]=t},this.fromString=function(e){try{if(originVersion=e.substr(0,3),originVersion!=s)return!1;e.substr(3,35);var i=e.substr(35),n=t.from(i,"base64"),r=f(n);this.signature=r.signature,this.crc_channel_name=r.crc_channel_name,this.crc_uid=r.crc_uid,this.m=r.m;var o=p(this.m);this.salt=o.salt,this.ts=o.ts,this.messages=o.messages}catch(a){return console.log(a),!1}return!0}},e.exports.priviledges={kJoinChannel:1,kPublishAudioStream:2,kPublishVideoStream:3,kPublishDataStream:4,kPublishAudiocdn:5,kPublishVideoCdn:6,kRequestPublishAudioStream:7,kRequestPublishVideoStream:8,kRequestPublishDataStream:9,kInvitePublishAudioStream:10,kInvitePublishVideoStream:11,kInvitePublishDataStream:12,kAdministrateChannel:101,kRtmLogin:1e3};var c=function(e,t){return n.createHmac("sha256",e).update(t).digest()},u=function(){var e={buffer:t.alloc(1024),position:0};return e.buffer.fill(0),e.pack=function(){var i=t.alloc(e.position);return e.buffer.copy(i,0,0,i.length),i},e.putUint16=function(t){return e.buffer.writeUInt16LE(t,e.position),e.position+=2,e},e.putUint32=function(t){return e.buffer.writeUInt32LE(t,e.position),e.position+=4,e},e.putBytes=function(t){return e.putUint16(t.length),t.copy(e.buffer,e.position),e.position+=t.length,e},e.putString=function(i){return e.putBytes(t.from(i))},e.putTreeMap=function(t){if(!t)return e.putUint16(0),e;for(var i in e.putUint16(Object.keys(t).length),t)e.putUint16(i),e.putString(t[i]);return e},e.putTreeMapUInt32=function(t){if(!t)return e.putUint16(0),e;for(var i in e.putUint16(Object.keys(t).length),t)e.putUint16(i),e.putUint32(t[i]);return e},e},d=function(e){var i={buffer:e,position:0,getUint16:function(){var e=i.buffer.readUInt16LE(i.position);return i.position+=2,e},getUint32:function(){var e=i.buffer.readUInt32LE(i.position);return i.position+=4,e},getString:function(){var e=i.getUint16(),n=t.alloc(e);return i.buffer.copy(n,0,i.position,i.position+e),i.position+=e,n},getTreeMapUInt32:function(){for(var e={},t=i.getUint16(),n=0;n<t;n++){var r=i.getUint16(),o=i.getUint32();e[r]=o}return e}};return i},l=function(e){return e.pack=function(){return(new u).putString(e.signature).putUint32(e.crc_channel).putUint32(e.crc_uid).putString(e.m).pack()},e},h=function(e){return e.pack=function(){return(new u).putUint32(e.salt).putUint32(e.ts).putTreeMapUInt32(e.messages).pack()},e},f=function(e){var t=new d(e);return l({signature:t.getString(),crc_channel_name:t.getUint32(),crc_uid:t.getUint32(),m:t.getString()})},p=function(e){var t=new d(e);return h({salt:t.getUint32(),ts:t.getUint32(),messages:t.getTreeMapUInt32()})}}).call(this,i(7).Buffer)},function(e,t,i){"use strict";(function(t){"undefined"===typeof t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,i,n,r){if("function"!==typeof e)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,i)}));case 3:return t.nextTick((function(){e.call(null,i,n)}));case 4:return t.nextTick((function(){e.call(null,i,n,r)}));default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return t.nextTick((function(){e.apply(null,o)}))}}}:e.exports=t}).call(this,i(6))},function(e,t,i){var n=i(3).Buffer;function r(e){n.isBuffer(e)||(e=n.from(e));for(var t=e.length/4|0,i=new Array(t),r=0;r<t;r++)i[r]=e.readUInt32BE(4*r);return i}function o(e){for(;0<e.length;e++)e[0]=0}function s(e,t,i,n,r){for(var o,s,a,c,u=i[0],d=i[1],l=i[2],h=i[3],f=e[0]^t[0],p=e[1]^t[1],m=e[2]^t[2],_=e[3]^t[3],g=4,v=1;v<r;v++)o=u[f>>>24]^d[p>>>16&255]^l[m>>>8&255]^h[255&_]^t[g++],s=u[p>>>24]^d[m>>>16&255]^l[_>>>8&255]^h[255&f]^t[g++],a=u[m>>>24]^d[_>>>16&255]^l[f>>>8&255]^h[255&p]^t[g++],c=u[_>>>24]^d[f>>>16&255]^l[p>>>8&255]^h[255&m]^t[g++],f=o,p=s,m=a,_=c;return o=(n[f>>>24]<<24|n[p>>>16&255]<<16|n[m>>>8&255]<<8|n[255&_])^t[g++],s=(n[p>>>24]<<24|n[m>>>16&255]<<16|n[_>>>8&255]<<8|n[255&f])^t[g++],a=(n[m>>>24]<<24|n[_>>>16&255]<<16|n[f>>>8&255]<<8|n[255&p])^t[g++],c=(n[_>>>24]<<24|n[f>>>16&255]<<16|n[p>>>8&255]<<8|n[255&m])^t[g++],[o>>>=0,s>>>=0,a>>>=0,c>>>=0]}var a=[0,1,2,4,8,16,32,64,128,27,54],c=function(){for(var e=new Array(256),t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var i=[],n=[],r=[[],[],[],[]],o=[[],[],[],[]],s=0,a=0,c=0;c<256;++c){var u=a^a<<1^a<<2^a<<3^a<<4;u=u>>>8^255&u^99,i[s]=u,n[u]=s;var d=e[s],l=e[d],h=e[l],f=257*e[u]^16843008*u;r[0][s]=f<<24|f>>>8,r[1][s]=f<<16|f>>>16,r[2][s]=f<<8|f>>>24,r[3][s]=f,f=16843009*h^65537*l^257*d^16843008*s,o[0][u]=f<<24|f>>>8,o[1][u]=f<<16|f>>>16,o[2][u]=f<<8|f>>>24,o[3][u]=f,0===s?s=a=1:(s=d^e[e[e[h^d]]],a^=e[e[a]])}return{SBOX:i,INV_SBOX:n,SUB_MIX:r,INV_SUB_MIX:o}}();function u(e){this._key=r(e),this._reset()}u.blockSize=16,u.keySize=32,u.prototype.blockSize=u.blockSize,u.prototype.keySize=u.keySize,u.prototype._reset=function(){for(var e=this._key,t=e.length,i=t+6,n=4*(i+1),r=[],o=0;o<t;o++)r[o]=e[o];for(o=t;o<n;o++){var s=r[o-1];o%t===0?(s=s<<8|s>>>24,s=c.SBOX[s>>>24]<<24|c.SBOX[s>>>16&255]<<16|c.SBOX[s>>>8&255]<<8|c.SBOX[255&s],s^=a[o/t|0]<<24):t>6&&o%t===4&&(s=c.SBOX[s>>>24]<<24|c.SBOX[s>>>16&255]<<16|c.SBOX[s>>>8&255]<<8|c.SBOX[255&s]),r[o]=r[o-t]^s}for(var u=[],d=0;d<n;d++){var l=n-d,h=r[l-(d%4?0:4)];u[d]=d<4||l<=4?h:c.INV_SUB_MIX[0][c.SBOX[h>>>24]]^c.INV_SUB_MIX[1][c.SBOX[h>>>16&255]]^c.INV_SUB_MIX[2][c.SBOX[h>>>8&255]]^c.INV_SUB_MIX[3][c.SBOX[255&h]]}this._nRounds=i,this._keySchedule=r,this._invKeySchedule=u},u.prototype.encryptBlockRaw=function(e){return s(e=r(e),this._keySchedule,c.SUB_MIX,c.SBOX,this._nRounds)},u.prototype.encryptBlock=function(e){var t=this.encryptBlockRaw(e),i=n.allocUnsafe(16);return i.writeUInt32BE(t[0],0),i.writeUInt32BE(t[1],4),i.writeUInt32BE(t[2],8),i.writeUInt32BE(t[3],12),i},u.prototype.decryptBlock=function(e){var t=(e=r(e))[1];e[1]=e[3],e[3]=t;var i=s(e,this._invKeySchedule,c.INV_SUB_MIX,c.INV_SBOX,this._nRounds),o=n.allocUnsafe(16);return o.writeUInt32BE(i[0],0),o.writeUInt32BE(i[3],4),o.writeUInt32BE(i[2],8),o.writeUInt32BE(i[1],12),o},u.prototype.scrub=function(){o(this._keySchedule),o(this._invKeySchedule),o(this._key)},e.exports.AES=u},function(e,t,i){var n=i(3).Buffer,r=i(62);e.exports=function(e,t,i,o){if(n.isBuffer(e)||(e=n.from(e,"binary")),t&&(n.isBuffer(t)||(t=n.from(t,"binary")),8!==t.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var s=i/8,a=n.alloc(s),c=n.alloc(o||0),u=n.alloc(0);s>0||o>0;){var d=new r;d.update(u),d.update(e),t&&d.update(t),u=d.digest();var l=0;if(s>0){var h=a.length-s;l=Math.min(s,u.length),u.copy(a,h,0,l),s-=l}if(l<u.length&&o>0){var f=c.length-o,p=Math.min(o,u.length-l);u.copy(c,f,l,l+p),o-=p}}return u.fill(0),{key:a,iv:c}}},function(e,t,i){"use strict";var n=i(20),r=i(12),o=r.getNAF,s=r.getJSF,a=r.assert;function c(e,t){this.type=e,this.p=new n(t.p,16),this.red=t.prime?n.red(t.prime):n.mont(this.p),this.zero=new n(0).toRed(this.red),this.one=new n(1).toRed(this.red),this.two=new n(2).toRed(this.red),this.n=t.n&&new n(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function u(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=c,c.prototype.point=function(){throw new Error("Not implemented")},c.prototype.validate=function(){throw new Error("Not implemented")},c.prototype._fixedNafMul=function(e,t){a(e.precomputed);var i=e._getDoubles(),n=o(t,1,this._bitLength),r=(1<<i.step+1)-(i.step%2===0?2:1);r/=3;var s,c,u=[];for(s=0;s<n.length;s+=i.step){c=0;for(var d=s+i.step-1;d>=s;d--)c=(c<<1)+n[d];u.push(c)}for(var l=this.jpoint(null,null,null),h=this.jpoint(null,null,null),f=r;f>0;f--){for(s=0;s<u.length;s++)(c=u[s])===f?h=h.mixedAdd(i.points[s]):c===-f&&(h=h.mixedAdd(i.points[s].neg()));l=l.add(h)}return l.toP()},c.prototype._wnafMul=function(e,t){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var r=n.points,s=o(t,i,this._bitLength),c=this.jpoint(null,null,null),u=s.length-1;u>=0;u--){for(var d=0;u>=0&&0===s[u];u--)d++;if(u>=0&&d++,c=c.dblp(d),u<0)break;var l=s[u];a(0!==l),c="affine"===e.type?l>0?c.mixedAdd(r[l-1>>1]):c.mixedAdd(r[-l-1>>1].neg()):l>0?c.add(r[l-1>>1]):c.add(r[-l-1>>1].neg())}return"affine"===e.type?c.toP():c},c.prototype._wnafMulAdd=function(e,t,i,n,r){var a,c,u,d=this._wnafT1,l=this._wnafT2,h=this._wnafT3,f=0;for(a=0;a<n;a++){var p=(u=t[a])._getNAFPoints(e);d[a]=p.wnd,l[a]=p.points}for(a=n-1;a>=1;a-=2){var m=a-1,_=a;if(1===d[m]&&1===d[_]){var g=[t[m],null,null,t[_]];0===t[m].y.cmp(t[_].y)?(g[1]=t[m].add(t[_]),g[2]=t[m].toJ().mixedAdd(t[_].neg())):0===t[m].y.cmp(t[_].y.redNeg())?(g[1]=t[m].toJ().mixedAdd(t[_]),g[2]=t[m].add(t[_].neg())):(g[1]=t[m].toJ().mixedAdd(t[_]),g[2]=t[m].toJ().mixedAdd(t[_].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],E=s(i[m],i[_]);for(f=Math.max(E[0].length,f),h[m]=new Array(f),h[_]=new Array(f),c=0;c<f;c++){var b=0|E[0][c],y=0|E[1][c];h[m][c]=v[3*(b+1)+(y+1)],h[_][c]=0,l[m]=g}}else h[m]=o(i[m],d[m],this._bitLength),h[_]=o(i[_],d[_],this._bitLength),f=Math.max(h[m].length,f),f=Math.max(h[_].length,f)}var w=this.jpoint(null,null,null),S=this._wnafT4;for(a=f;a>=0;a--){for(var T=0;a>=0;){var R=!0;for(c=0;c<n;c++)S[c]=0|h[c][a],0!==S[c]&&(R=!1);if(!R)break;T++,a--}if(a>=0&&T++,w=w.dblp(T),a<0)break;for(c=0;c<n;c++){var C=S[c];0!==C&&(C>0?u=l[c][C-1>>1]:C<0&&(u=l[c][-C-1>>1].neg()),w="affine"===u.type?w.mixedAdd(u):w.add(u))}}for(a=0;a<n;a++)l[a]=null;return r?w:w.toP()},c.BasePoint=u,u.prototype.eq=function(){throw new Error("Not implemented")},u.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(e,t){e=r.toArray(e,t);var i=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1===2*i)return 6===e[0]?a(e[e.length-1]%2===0):7===e[0]&&a(e[e.length-1]%2===1),this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));if((2===e[0]||3===e[0])&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),3===e[0]);throw new Error("Unknown point format")},u.prototype.encodeCompressed=function(e){return this.encode(e,!0)},u.prototype._encode=function(e){var t=this.curve.p.byteLength(),i=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",t))},u.prototype.encode=function(e,t){return r.encode(this._encode(t),e)},u.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},u.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},u.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,r=0;r<t;r+=e){for(var o=0;o<e;o++)n=n.dbl();i.push(n)}return{step:e,points:i}},u.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],i=(1<<e)-1,n=1===i?null:this.dbl(),r=1;r<i;r++)t[r]=t[r-1].add(n);return{wnd:e,points:t}},u.prototype._getBeta=function(){return null},u.prototype.dblp=function(e){for(var t=this,i=0;i<e;i++)t=t.dbl();return t}},function(e,t,i){var n=i(243),r=i(251),o=i(252),s=i(71),a=i(103),c=i(3).Buffer;function u(e){var t;"object"!==typeof e||c.isBuffer(e)||(t=e.passphrase,e=e.key),"string"===typeof e&&(e=c.from(e));var i,u,d=o(e,t),l=d.tag,h=d.data;switch(l){case"CERTIFICATE":u=n.certificate.decode(h,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(u||(u=n.PublicKey.decode(h,"der")),i=u.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return n.RSAPublicKey.decode(u.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return u.subjectPrivateKey=u.subjectPublicKey,{type:"ec",data:u};case"1.2.840.10040.4.1":return u.algorithm.params.pub_key=n.DSAparam.decode(u.subjectPublicKey.data,"der"),{type:"dsa",data:u.algorithm.params};default:throw new Error("unknown key id "+i)}case"ENCRYPTED PRIVATE KEY":h=function(e,t){var i=e.algorithm.decrypt.kde.kdeparams.salt,n=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),o=r[e.algorithm.decrypt.cipher.algo.join(".")],u=e.algorithm.decrypt.cipher.iv,d=e.subjectPrivateKey,l=parseInt(o.split("-")[1],10)/8,h=a.pbkdf2Sync(t,i,n,l,"sha1"),f=s.createDecipheriv(o,h,u),p=[];return p.push(f.update(d)),p.push(f.final()),c.concat(p)}(h=n.EncryptedPrivateKey.decode(h,"der"),t);case"PRIVATE KEY":switch(i=(u=n.PrivateKey.decode(h,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return n.RSAPrivateKey.decode(u.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:u.algorithm.curve,privateKey:n.ECPrivateKey.decode(u.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return u.algorithm.params.priv_key=n.DSAparam.decode(u.subjectPrivateKey,"der"),{type:"dsa",params:u.algorithm.params};default:throw new Error("unknown key id "+i)}case"RSA PUBLIC KEY":return n.RSAPublicKey.decode(h,"der");case"RSA PRIVATE KEY":return n.RSAPrivateKey.decode(h,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:n.DSAPrivateKey.decode(h,"der")};case"EC PRIVATE KEY":return{curve:(h=n.ECPrivateKey.decode(h,"der")).parameters.value,privateKey:h.privateKey};default:throw new Error("unknown key type "+l)}}e.exports=u,u.signature=n.signature},function(e,t,i){"use strict";function n(e,t){return function(){return null}}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i(0),r=i(37),o=!0,s=!1,a=null,c={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function u(e){e.metaKey||e.altKey||e.ctrlKey||(o=!0)}function d(){o=!1}function l(){"hidden"===this.visibilityState&&s&&(o=!0)}function h(e){var t=e.target;try{return t.matches(":focus-visible")}catch(i){}return o||function(e){var t=e.type,i=e.tagName;return!("INPUT"!==i||!c[t]||e.readOnly)||"TEXTAREA"===i&&!e.readOnly||!!e.isContentEditable}(t)}function f(){s=!0,window.clearTimeout(a),a=window.setTimeout((function(){s=!1}),100)}function p(){return{isFocusVisible:h,onBlurVisible:f,ref:n.useCallback((function(e){var t,i=r.findDOMNode(e);null!=i&&((t=i.ownerDocument).addEventListener("keydown",u,!0),t.addEventListener("mousedown",d,!0),t.addEventListener("pointerdown",d,!0),t.addEventListener("touchstart",d,!0),t.addEventListener("visibilitychange",l,!0))}),[])}}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(50);function r(e,t){if(e){if("string"===typeof e)return Object(n.a)(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Object(n.a)(e,t):void 0}}},,function(e,t,i){"use strict";var n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(r){return!1}}()?Object.assign:function(e,t){for(var i,s,a=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var u in i=Object(arguments[c]))r.call(i,u)&&(a[u]=i[u]);if(n){s=n(i);for(var d=0;d<s.length;d++)o.call(i,s[d])&&(a[s[d]]=i[s[d]])}}return a}},function(e,t,i){"use strict";var n=i(2),r=i(87),o=i(3).Buffer,s=new Array(16);function a(){r.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function c(e,t){return e<<t|e>>>32-t}function u(e,t,i,n,r,o,s){return c(e+(t&i|~t&n)+r+o|0,s)+t|0}function d(e,t,i,n,r,o,s){return c(e+(t&n|i&~n)+r+o|0,s)+t|0}function l(e,t,i,n,r,o,s){return c(e+(t^i^n)+r+o|0,s)+t|0}function h(e,t,i,n,r,o,s){return c(e+(i^(t|~n))+r+o|0,s)+t|0}n(a,r),a.prototype._update=function(){for(var e=s,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var i=this._a,n=this._b,r=this._c,o=this._d;i=u(i,n,r,o,e[0],3614090360,7),o=u(o,i,n,r,e[1],3905402710,12),r=u(r,o,i,n,e[2],606105819,17),n=u(n,r,o,i,e[3],3250441966,22),i=u(i,n,r,o,e[4],4118548399,7),o=u(o,i,n,r,e[5],1200080426,12),r=u(r,o,i,n,e[6],2821735955,17),n=u(n,r,o,i,e[7],4249261313,22),i=u(i,n,r,o,e[8],1770035416,7),o=u(o,i,n,r,e[9],2336552879,12),r=u(r,o,i,n,e[10],4294925233,17),n=u(n,r,o,i,e[11],2304563134,22),i=u(i,n,r,o,e[12],1804603682,7),o=u(o,i,n,r,e[13],4254626195,12),r=u(r,o,i,n,e[14],2792965006,17),i=d(i,n=u(n,r,o,i,e[15],1236535329,22),r,o,e[1],4129170786,5),o=d(o,i,n,r,e[6],3225465664,9),r=d(r,o,i,n,e[11],643717713,14),n=d(n,r,o,i,e[0],3921069994,20),i=d(i,n,r,o,e[5],3593408605,5),o=d(o,i,n,r,e[10],38016083,9),r=d(r,o,i,n,e[15],3634488961,14),n=d(n,r,o,i,e[4],3889429448,20),i=d(i,n,r,o,e[9],568446438,5),o=d(o,i,n,r,e[14],3275163606,9),r=d(r,o,i,n,e[3],4107603335,14),n=d(n,r,o,i,e[8],1163531501,20),i=d(i,n,r,o,e[13],2850285829,5),o=d(o,i,n,r,e[2],4243563512,9),r=d(r,o,i,n,e[7],1735328473,14),i=l(i,n=d(n,r,o,i,e[12],2368359562,20),r,o,e[5],4294588738,4),o=l(o,i,n,r,e[8],2272392833,11),r=l(r,o,i,n,e[11],1839030562,16),n=l(n,r,o,i,e[14],4259657740,23),i=l(i,n,r,o,e[1],2763975236,4),o=l(o,i,n,r,e[4],1272893353,11),r=l(r,o,i,n,e[7],4139469664,16),n=l(n,r,o,i,e[10],3200236656,23),i=l(i,n,r,o,e[13],681279174,4),o=l(o,i,n,r,e[0],3936430074,11),r=l(r,o,i,n,e[3],3572445317,16),n=l(n,r,o,i,e[6],76029189,23),i=l(i,n,r,o,e[9],3654602809,4),o=l(o,i,n,r,e[12],3873151461,11),r=l(r,o,i,n,e[15],530742520,16),i=h(i,n=l(n,r,o,i,e[2],3299628645,23),r,o,e[0],4096336452,6),o=h(o,i,n,r,e[7],1126891415,10),r=h(r,o,i,n,e[14],2878612391,15),n=h(n,r,o,i,e[5],4237533241,21),i=h(i,n,r,o,e[12],1700485571,6),o=h(o,i,n,r,e[3],2399980690,10),r=h(r,o,i,n,e[10],4293915773,15),n=h(n,r,o,i,e[1],2240044497,21),i=h(i,n,r,o,e[8],1873313359,6),o=h(o,i,n,r,e[15],4264355552,10),r=h(r,o,i,n,e[6],2734768916,15),n=h(n,r,o,i,e[13],1309151649,21),i=h(i,n,r,o,e[4],4149444226,6),o=h(o,i,n,r,e[11],3174756917,10),r=h(r,o,i,n,e[2],718787259,15),n=h(n,r,o,i,e[9],3951481745,21),this._a=this._a+i|0,this._b=this._b+n|0,this._c=this._c+r|0,this._d=this._d+o|0},a.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=o.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},e.exports=a},function(e,t,i){(function(t){function i(e){try{if(!t.localStorage)return!1}catch(n){return!1}var i=t.localStorage[e];return null!=i&&"true"===String(i).toLowerCase()}e.exports=function(e,t){if(i("noDeprecation"))return e;var n=!1;return function(){if(!n){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this,i(9))},function(e,t,i){"use strict";var n=i(32).codes.ERR_STREAM_PREMATURE_CLOSE;function r(){}e.exports=function e(t,i,o){if("function"===typeof i)return e(t,null,i);i||(i={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];e.apply(this,n)}}}(o||r);var s=i.readable||!1!==i.readable&&t.readable,a=i.writable||!1!==i.writable&&t.writable,c=function(){t.writable||d()},u=t._writableState&&t._writableState.finished,d=function(){a=!1,u=!0,s||o.call(t)},l=t._readableState&&t._readableState.endEmitted,h=function(){s=!1,l=!0,a||o.call(t)},f=function(e){o.call(t,e)},p=function(){var e;return s&&!l?(t._readableState&&t._readableState.ended||(e=new n),o.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new n),o.call(t,e)):void 0},m=function(){t.req.on("finish",d)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",d),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",h),t.on("finish",d),!1!==i.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",d),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",d),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",d),t.removeListener("end",h),t.removeListener("error",f),t.removeListener("close",p)}}},function(e,t,i){"use strict";var n=i(7).Buffer,r=i(2),o=i(87),s=new Array(16),a=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],c=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],u=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],d=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],l=[0,1518500249,1859775393,2400959708,2840853838],h=[1352829926,1548603684,1836072691,2053994217,0];function f(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function p(e,t){return e<<t|e>>>32-t}function m(e,t,i,n,r,o,s,a){return p(e+(t^i^n)+o+s|0,a)+r|0}function _(e,t,i,n,r,o,s,a){return p(e+(t&i|~t&n)+o+s|0,a)+r|0}function g(e,t,i,n,r,o,s,a){return p(e+((t|~i)^n)+o+s|0,a)+r|0}function v(e,t,i,n,r,o,s,a){return p(e+(t&n|i&~n)+o+s|0,a)+r|0}function E(e,t,i,n,r,o,s,a){return p(e+(t^(i|~n))+o+s|0,a)+r|0}r(f,o),f.prototype._update=function(){for(var e=s,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);for(var i=0|this._a,n=0|this._b,r=0|this._c,o=0|this._d,f=0|this._e,b=0|this._a,y=0|this._b,w=0|this._c,S=0|this._d,T=0|this._e,R=0;R<80;R+=1){var C,I;R<16?(C=m(i,n,r,o,f,e[a[R]],l[0],u[R]),I=E(b,y,w,S,T,e[c[R]],h[0],d[R])):R<32?(C=_(i,n,r,o,f,e[a[R]],l[1],u[R]),I=v(b,y,w,S,T,e[c[R]],h[1],d[R])):R<48?(C=g(i,n,r,o,f,e[a[R]],l[2],u[R]),I=g(b,y,w,S,T,e[c[R]],h[2],d[R])):R<64?(C=v(i,n,r,o,f,e[a[R]],l[3],u[R]),I=_(b,y,w,S,T,e[c[R]],h[3],d[R])):(C=E(i,n,r,o,f,e[a[R]],l[4],u[R]),I=m(b,y,w,S,T,e[c[R]],h[4],d[R])),i=f,f=o,o=p(r,10),r=n,n=C,b=T,T=S,S=p(w,10),w=y,y=I}var A=this._b+r+S|0;this._b=this._c+o+T|0,this._c=this._d+f+b|0,this._d=this._e+i+y|0,this._e=this._a+n+w|0,this._a=A},f.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=n.alloc?n.alloc(20):new n(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},e.exports=f},function(e,t,i){(t=e.exports=function(e){e=e.toLowerCase();var i=t[e];if(!i)throw new Error(e+" is not supported (we accept pull requests)");return new i}).sha=i(172),t.sha1=i(173),t.sha224=i(174),t.sha256=i(94),t.sha384=i(175),t.sha512=i(95)},function(e,t,i){(t=e.exports=i(96)).Stream=t,t.Readable=t,t.Writable=i(69),t.Duplex=i(26),t.Transform=i(99),t.PassThrough=i(183)},function(e,t,i){var n=i(7),r=n.Buffer;function o(e,t){for(var i in e)t[i]=e[i]}function s(e,t,i){return r(e,t,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=s),o(r,s),s.from=function(e,t,i){if("number"===typeof e)throw new TypeError("Argument must not be a number");return r(e,t,i)},s.alloc=function(e,t,i){if("number"!==typeof e)throw new TypeError("Argument must be a number");var n=r(e);return void 0!==t?"string"===typeof i?n.fill(t,i):n.fill(t):n.fill(0),n},s.allocUnsafe=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return r(e)},s.allocUnsafeSlow=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,i){"use strict";(function(t,n,r){var o=i(52);function s(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var n=e.entry;e.entry=null;for(;n;){var r=n.callback;t.pendingcb--,r(i),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=v;var a,c=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?n:o.nextTick;v.WritableState=g;var u=Object.create(i(42));u.inherits=i(2);var d={deprecate:i(63)},l=i(97),h=i(68).Buffer,f=("undefined"!==typeof r?r:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};var p,m=i(98);function _(){}function g(e,t){a=a||i(26),e=e||{};var n=t instanceof a;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,u=e.writableHighWaterMark,d=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(u||0===u)?u:d,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var l=!1===e.decodeStrings;this.decodeStrings=!l,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,n=i.sync,r=i.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,n,r){--t.pendingcb,i?(o.nextTick(r,n),o.nextTick(T,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(r(n),e._writableState.errorEmitted=!0,e.emit("error",n),T(e,t))}(e,i,n,t,r);else{var s=w(i);s||i.corked||i.bufferProcessing||!i.bufferedRequest||y(e,i),n?c(b,e,i,s,r):b(e,i,s,r)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new s(this)}function v(e){if(a=a||i(26),!p.call(v,this)&&!(this instanceof a))return new v(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),l.call(this)}function E(e,t,i,n,r,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,i?e._writev(r,t.onwrite):e._write(r,o,t.onwrite),t.sync=!1}function b(e,t,i,n){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),T(e,t)}function y(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var n=t.bufferedRequestCount,r=new Array(n),o=t.corkedRequestsFree;o.entry=i;for(var a=0,c=!0;i;)r[a]=i,i.isBuf||(c=!1),i=i.next,a+=1;r.allBuffers=c,E(e,t,!0,t.length,r,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new s(t),t.bufferedRequestCount=0}else{for(;i;){var u=i.chunk,d=i.encoding,l=i.callback;if(E(e,t,!1,t.objectMode?1:u.length,u,d,l),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function w(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function S(e,t){e._final((function(i){t.pendingcb--,i&&e.emit("error",i),t.prefinished=!0,e.emit("prefinish"),T(e,t)}))}function T(e,t){var i=w(t);return i&&(!function(e,t){t.prefinished||t.finalCalled||("function"===typeof e._final?(t.pendingcb++,t.finalCalled=!0,o.nextTick(S,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),i}u.inherits(v,l),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:d.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===v&&(e&&e._writableState instanceof g)}})):p=function(e){return e instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(e,t,i){var n,r=this._writableState,s=!1,a=!r.objectMode&&(n=e,h.isBuffer(n)||n instanceof f);return a&&!h.isBuffer(e)&&(e=function(e){return h.from(e)}(e)),"function"===typeof t&&(i=t,t=null),a?t="buffer":t||(t=r.defaultEncoding),"function"!==typeof i&&(i=_),r.ended?function(e,t){var i=new Error("write after end");e.emit("error",i),o.nextTick(t,i)}(this,i):(a||function(e,t,i,n){var r=!0,s=!1;return null===i?s=new TypeError("May not write null values to stream"):"string"===typeof i||void 0===i||t.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(e.emit("error",s),o.nextTick(n,s),r=!1),r}(this,r,e,i))&&(r.pendingcb++,s=function(e,t,i,n,r,o){if(!i){var s=function(e,t,i){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=h.from(t,i));return t}(t,n,r);n!==s&&(i=!0,r="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:o,next:null},u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else E(e,t,!1,a,n,r,o);return c}(this,r,a,e,t,i)),s},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||y(this,e))},v.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(e,t,i){i(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(e,t,i){var n=this._writableState;"function"===typeof e?(i=e,e=null,t=null):"function"===typeof t&&(i=t,t=null),null!==e&&void 0!==e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||function(e,t,i){t.ending=!0,T(e,t),i&&(t.finished?o.nextTick(i):e.once("finish",i));t.ended=!0,e.writable=!1}(this,n,i)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,i(6),i(181).setImmediate,i(9))},function(e,t,i){"use strict";var n=i(11);function r(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=!1!==e.padding}e.exports=r,r.prototype._init=function(){},r.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},r.prototype._buffer=function(e,t){for(var i=Math.min(this.buffer.length-this.bufferOff,e.length-t),n=0;n<i;n++)this.buffer[this.bufferOff+n]=e[t+n];return this.bufferOff+=i,i},r.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},r.prototype._updateEncrypt=function(e){var t=0,i=0,n=(this.bufferOff+e.length)/this.blockSize|0,r=new Array(n*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(i+=this._flushBuffer(r,i)));for(var o=e.length-(e.length-t)%this.blockSize;t<o;t+=this.blockSize)this._update(e,t,r,i),i+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return r},r.prototype._updateDecrypt=function(e){for(var t=0,i=0,n=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,r=new Array(n*this.blockSize);n>0;n--)t+=this._buffer(e,t),i+=this._flushBuffer(r,i);return t+=this._buffer(e,t),r},r.prototype.final=function(e){var t,i;return e&&(t=this.update(e)),i="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(i):i},r.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},r.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},r.prototype._unpad=function(e){return e},r.prototype._finalDecrypt=function(){n.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}},function(e,t,i){var n=i(196),r=i(204),o=i(112);t.createCipher=t.Cipher=n.createCipher,t.createCipheriv=t.Cipheriv=n.createCipheriv,t.createDecipher=t.Decipher=r.createDecipher,t.createDecipheriv=t.Decipheriv=r.createDecipheriv,t.listCiphers=t.getCiphers=function(){return Object.keys(o)}},function(e,t,i){var n={ECB:i(197),CBC:i(198),CFB:i(199),CFB8:i(200),CFB1:i(201),OFB:i(202),CTR:i(110),GCM:i(110)},r=i(112);for(var o in r)r[o].module=n[r[o].mode];e.exports=r},function(e,t,i){var n;function r(e){this.rand=e}if(e.exports=function(e){return n||(n=new r(null)),n.generate(e)},e.exports.Rand=r,r.prototype.generate=function(e){return this._rand(e)},r.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),i=0;i<t.length;i++)t[i]=this.rand.getByte();return t},"object"===typeof self)self.crypto&&self.crypto.getRandomValues?r.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?r.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"===typeof window&&(r.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var o=i(210);if("function"!==typeof o.randomBytes)throw new Error("Not supported");r.prototype._rand=function(e){return o.randomBytes(e)}}catch(s){}},function(e,t,i){"use strict";var n=i(35).codes.ERR_STREAM_PREMATURE_CLOSE;function r(){}e.exports=function e(t,i,o){if("function"===typeof i)return e(t,null,i);i||(i={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];e.apply(this,n)}}}(o||r);var s=i.readable||!1!==i.readable&&t.readable,a=i.writable||!1!==i.writable&&t.writable,c=function(){t.writable||d()},u=t._writableState&&t._writableState.finished,d=function(){a=!1,u=!0,s||o.call(t)},l=t._readableState&&t._readableState.endEmitted,h=function(){s=!1,l=!0,a||o.call(t)},f=function(e){o.call(t,e)},p=function(){var e;return s&&!l?(t._readableState&&t._readableState.ended||(e=new n),o.call(t,e)):a&&!u?(t._writableState&&t._writableState.ended||(e=new n),o.call(t,e)):void 0},m=function(){t.req.on("finish",d)};return!function(e){return e.setHeader&&"function"===typeof e.abort}(t)?a&&!t._writableState&&(t.on("end",c),t.on("close",c)):(t.on("complete",d),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",h),t.on("finish",d),!1!==i.error&&t.on("error",f),t.on("close",p),function(){t.removeListener("complete",d),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",d),t.removeListener("end",c),t.removeListener("close",c),t.removeListener("finish",d),t.removeListener("end",h),t.removeListener("error",f),t.removeListener("close",p)}}},function(e,t,i){(function(t){var n=i(76),r=i(31);function o(e){var t,i=e.modulus.byteLength();do{t=new n(r(i))}while(t.cmp(e.modulus)>=0||!t.umod(e.prime1)||!t.umod(e.prime2));return t}function s(e,i){var r=function(e){var t=o(e);return{blinder:t.toRed(n.mont(e.modulus)).redPow(new n(e.publicExponent)).fromRed(),unblinder:t.invm(e.modulus)}}(i),s=i.modulus.byteLength(),a=new n(e).mul(r.blinder).umod(i.modulus),c=a.toRed(n.mont(i.prime1)),u=a.toRed(n.mont(i.prime2)),d=i.coefficient,l=i.prime1,h=i.prime2,f=c.redPow(i.exponent1).fromRed(),p=u.redPow(i.exponent2).fromRed(),m=f.isub(p).imul(d).umod(l).imul(h);return p.iadd(m).imul(r.unblinder).umod(i.modulus).toArrayLike(t,"be",s)}s.getr=o,e.exports=s}).call(this,i(7).Buffer)},function(e,t,i){(function(e){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function o(e,t,i){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:i(223).Buffer}catch(A){}function a(e,t){var i=e.charCodeAt(t);return i>=48&&i<=57?i-48:i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:void n(!1,"Invalid character in "+e)}function c(e,t,i){var n=a(e,i);return i-1>=t&&(n|=a(e,i-1)<<4),n}function u(e,t,i,r){for(var o=0,s=0,a=Math.min(e.length,i),c=t;c<a;c++){var u=e.charCodeAt(c)-48;o*=r,s=u>=49?u-49+10:u>=17?u-17+10:u,n(u>=0&&s<r,"Invalid character"),o+=s}return o}function d(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,i){if("number"===typeof e)return this._initNumber(e,t,i);if("object"===typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var r=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(r++,this.negative=1),r<e.length&&(16===t?this._parseHex(e,r,i):(this._parseBase(e,t,r),"le"===i&&this._initArray(this.toArray(),t,i)))},o.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},o.prototype._initArray=function(e,t,i){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var o,s,a=0;if("be"===i)for(r=e.length-1,o=0;r>=0;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===i)for(r=0,o=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this._strip()},o.prototype._parseHex=function(e,t,i){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,o=0,s=0;if("be"===i)for(n=e.length-1;n>=t;n-=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;this._strip()},o.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=t)n++;n--,r=r/t|0;for(var o=e.length-i,s=o%n,a=Math.min(o,o-s)+i,c=0,d=i;d<a;d+=n)c=u(e,d,d+n,t),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var l=1;for(c=u(e,d,e.length,t),d=0;d<s;d++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this._strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype._move=function(e){d(e,this)},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!==typeof Symbol&&"function"===typeof Symbol.for)try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=l}catch(A){o.prototype.inspect=l}else o.prototype.inspect=l;function l(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var r=0,o=0,s=0;s<this.length;s++){var a=this.words[s],c=(16777215&(a<<r|o)).toString(16);o=a>>>24-r&16777215,(r+=2)>=26&&(r-=26,s--),i=0!==o||s!==this.length-1?h[6-c.length]+c+i:c+i}for(0!==o&&(i=o.toString(16)+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=f[e],d=p[e];i="";var l=this.clone();for(l.negative=0;!l.isZero();){var m=l.modrn(d).toString(e);i=(l=l.idivn(d)).isZero()?m+i:h[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16,2)},s&&(o.prototype.toBuffer=function(e,t){return this.toArrayLike(s,e,t)}),o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function m(e,t,i){i.negative=t.negative^e.negative;var n=e.length+t.length|0;i.length=n,n=n-1|0;var r=0|e.words[0],o=0|t.words[0],s=r*o,a=67108863&s,c=s/67108864|0;i.words[0]=a;for(var u=1;u<n;u++){for(var d=c>>>26,l=67108863&c,h=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=h;f++){var p=u-f|0;d+=(s=(r=0|e.words[p])*(o=0|t.words[f])+l)/67108864|0,l=67108863&s}i.words[u]=0|l,c=0|d}return 0!==c?i.words[u]=0|c:i.length--,i._strip()}o.prototype.toArrayLike=function(e,t,i){this._strip();var r=this.byteLength(),o=i||Math.max(1,r);n(r<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0");var s=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,o);return this["_toArrayLike"+("le"===t?"LE":"BE")](s,r),s},o.prototype._toArrayLikeLE=function(e,t){for(var i=0,n=0,r=0,o=0;r<this.length;r++){var s=this.words[r]<<o|n;e[i++]=255&s,i<e.length&&(e[i++]=s>>8&255),i<e.length&&(e[i++]=s>>16&255),6===o?(i<e.length&&(e[i++]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(i<e.length)for(e[i++]=n;i<e.length;)e[i++]=0},o.prototype._toArrayLikeBE=function(e,t){for(var i=e.length-1,n=0,r=0,o=0;r<this.length;r++){var s=this.words[r]<<o|n;e[i--]=255&s,i>=0&&(e[i--]=s>>8&255),i>=0&&(e[i--]=s>>16&255),6===o?(i>=0&&(e[i--]=s>>24&255),n=0,o=0):(n=s>>>24,o+=2)}if(i>=0)for(e[i--]=n;i>=0;)e[i--]=0},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0===(8191&t)&&(i+=13,t>>>=13),0===(127&t)&&(i+=7,t>>>=7),0===(15&t)&&(i+=4,t>>>=4),0===(3&t)&&(i+=2,t>>>=2),0===(1&t)&&i++,i},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this._strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var n=0;n<i.length;n++)this.words[n]=t.words[n]^i.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this._strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var i=e/26|0,r=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<r:this.words[i]&~(1<<r),this._strip()},o.prototype.iadd=function(e){var t,i,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,n=e):(i=e,n=this);for(var r=0,o=0;o<n.length;o++)t=(0|i.words[o])+(0|n.words[o])+r,this.words[o]=67108863&t,r=t>>>26;for(;0!==r&&o<i.length;o++)t=(0|i.words[o])+r,this.words[o]=67108863&t,r=t>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,n,r=this.cmp(e);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(i=this,n=e):(i=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|i.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<i.length;s++)o=(t=(0|i.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var _=function(e,t,i){var n,r,o,s=e.words,a=t.words,c=i.words,u=0,d=0|s[0],l=8191&d,h=d>>>13,f=0|s[1],p=8191&f,m=f>>>13,_=0|s[2],g=8191&_,v=_>>>13,E=0|s[3],b=8191&E,y=E>>>13,w=0|s[4],S=8191&w,T=w>>>13,R=0|s[5],C=8191&R,I=R>>>13,A=0|s[6],O=8191&A,M=A>>>13,N=0|s[7],k=8191&N,P=N>>>13,D=0|s[8],L=8191&D,x=D>>>13,U=0|s[9],V=8191&U,B=U>>>13,j=0|a[0],F=8191&j,W=j>>>13,G=0|a[1],H=8191&G,q=G>>>13,K=0|a[2],z=8191&K,Y=K>>>13,J=0|a[3],X=8191&J,Q=J>>>13,Z=0|a[4],$=8191&Z,ee=Z>>>13,te=0|a[5],ie=8191&te,ne=te>>>13,re=0|a[6],oe=8191&re,se=re>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,de=0|a[8],le=8191&de,he=de>>>13,fe=0|a[9],pe=8191&fe,me=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var _e=(u+(n=Math.imul(l,F))|0)+((8191&(r=(r=Math.imul(l,W))+Math.imul(h,F)|0))<<13)|0;u=((o=Math.imul(h,W))+(r>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(p,F),r=(r=Math.imul(p,W))+Math.imul(m,F)|0,o=Math.imul(m,W);var ge=(u+(n=n+Math.imul(l,H)|0)|0)+((8191&(r=(r=r+Math.imul(l,q)|0)+Math.imul(h,H)|0))<<13)|0;u=((o=o+Math.imul(h,q)|0)+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,F),r=(r=Math.imul(g,W))+Math.imul(v,F)|0,o=Math.imul(v,W),n=n+Math.imul(p,H)|0,r=(r=r+Math.imul(p,q)|0)+Math.imul(m,H)|0,o=o+Math.imul(m,q)|0;var ve=(u+(n=n+Math.imul(l,z)|0)|0)+((8191&(r=(r=r+Math.imul(l,Y)|0)+Math.imul(h,z)|0))<<13)|0;u=((o=o+Math.imul(h,Y)|0)+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,F),r=(r=Math.imul(b,W))+Math.imul(y,F)|0,o=Math.imul(y,W),n=n+Math.imul(g,H)|0,r=(r=r+Math.imul(g,q)|0)+Math.imul(v,H)|0,o=o+Math.imul(v,q)|0,n=n+Math.imul(p,z)|0,r=(r=r+Math.imul(p,Y)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,Y)|0;var Ee=(u+(n=n+Math.imul(l,X)|0)|0)+((8191&(r=(r=r+Math.imul(l,Q)|0)+Math.imul(h,X)|0))<<13)|0;u=((o=o+Math.imul(h,Q)|0)+(r>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(S,F),r=(r=Math.imul(S,W))+Math.imul(T,F)|0,o=Math.imul(T,W),n=n+Math.imul(b,H)|0,r=(r=r+Math.imul(b,q)|0)+Math.imul(y,H)|0,o=o+Math.imul(y,q)|0,n=n+Math.imul(g,z)|0,r=(r=r+Math.imul(g,Y)|0)+Math.imul(v,z)|0,o=o+Math.imul(v,Y)|0,n=n+Math.imul(p,X)|0,r=(r=r+Math.imul(p,Q)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,Q)|0;var be=(u+(n=n+Math.imul(l,$)|0)|0)+((8191&(r=(r=r+Math.imul(l,ee)|0)+Math.imul(h,$)|0))<<13)|0;u=((o=o+Math.imul(h,ee)|0)+(r>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(C,F),r=(r=Math.imul(C,W))+Math.imul(I,F)|0,o=Math.imul(I,W),n=n+Math.imul(S,H)|0,r=(r=r+Math.imul(S,q)|0)+Math.imul(T,H)|0,o=o+Math.imul(T,q)|0,n=n+Math.imul(b,z)|0,r=(r=r+Math.imul(b,Y)|0)+Math.imul(y,z)|0,o=o+Math.imul(y,Y)|0,n=n+Math.imul(g,X)|0,r=(r=r+Math.imul(g,Q)|0)+Math.imul(v,X)|0,o=o+Math.imul(v,Q)|0,n=n+Math.imul(p,$)|0,r=(r=r+Math.imul(p,ee)|0)+Math.imul(m,$)|0,o=o+Math.imul(m,ee)|0;var ye=(u+(n=n+Math.imul(l,ie)|0)|0)+((8191&(r=(r=r+Math.imul(l,ne)|0)+Math.imul(h,ie)|0))<<13)|0;u=((o=o+Math.imul(h,ne)|0)+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(O,F),r=(r=Math.imul(O,W))+Math.imul(M,F)|0,o=Math.imul(M,W),n=n+Math.imul(C,H)|0,r=(r=r+Math.imul(C,q)|0)+Math.imul(I,H)|0,o=o+Math.imul(I,q)|0,n=n+Math.imul(S,z)|0,r=(r=r+Math.imul(S,Y)|0)+Math.imul(T,z)|0,o=o+Math.imul(T,Y)|0,n=n+Math.imul(b,X)|0,r=(r=r+Math.imul(b,Q)|0)+Math.imul(y,X)|0,o=o+Math.imul(y,Q)|0,n=n+Math.imul(g,$)|0,r=(r=r+Math.imul(g,ee)|0)+Math.imul(v,$)|0,o=o+Math.imul(v,ee)|0,n=n+Math.imul(p,ie)|0,r=(r=r+Math.imul(p,ne)|0)+Math.imul(m,ie)|0,o=o+Math.imul(m,ne)|0;var we=(u+(n=n+Math.imul(l,oe)|0)|0)+((8191&(r=(r=r+Math.imul(l,se)|0)+Math.imul(h,oe)|0))<<13)|0;u=((o=o+Math.imul(h,se)|0)+(r>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,F),r=(r=Math.imul(k,W))+Math.imul(P,F)|0,o=Math.imul(P,W),n=n+Math.imul(O,H)|0,r=(r=r+Math.imul(O,q)|0)+Math.imul(M,H)|0,o=o+Math.imul(M,q)|0,n=n+Math.imul(C,z)|0,r=(r=r+Math.imul(C,Y)|0)+Math.imul(I,z)|0,o=o+Math.imul(I,Y)|0,n=n+Math.imul(S,X)|0,r=(r=r+Math.imul(S,Q)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,Q)|0,n=n+Math.imul(b,$)|0,r=(r=r+Math.imul(b,ee)|0)+Math.imul(y,$)|0,o=o+Math.imul(y,ee)|0,n=n+Math.imul(g,ie)|0,r=(r=r+Math.imul(g,ne)|0)+Math.imul(v,ie)|0,o=o+Math.imul(v,ne)|0,n=n+Math.imul(p,oe)|0,r=(r=r+Math.imul(p,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0;var Se=(u+(n=n+Math.imul(l,ce)|0)|0)+((8191&(r=(r=r+Math.imul(l,ue)|0)+Math.imul(h,ce)|0))<<13)|0;u=((o=o+Math.imul(h,ue)|0)+(r>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(L,F),r=(r=Math.imul(L,W))+Math.imul(x,F)|0,o=Math.imul(x,W),n=n+Math.imul(k,H)|0,r=(r=r+Math.imul(k,q)|0)+Math.imul(P,H)|0,o=o+Math.imul(P,q)|0,n=n+Math.imul(O,z)|0,r=(r=r+Math.imul(O,Y)|0)+Math.imul(M,z)|0,o=o+Math.imul(M,Y)|0,n=n+Math.imul(C,X)|0,r=(r=r+Math.imul(C,Q)|0)+Math.imul(I,X)|0,o=o+Math.imul(I,Q)|0,n=n+Math.imul(S,$)|0,r=(r=r+Math.imul(S,ee)|0)+Math.imul(T,$)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(b,ie)|0,r=(r=r+Math.imul(b,ne)|0)+Math.imul(y,ie)|0,o=o+Math.imul(y,ne)|0,n=n+Math.imul(g,oe)|0,r=(r=r+Math.imul(g,se)|0)+Math.imul(v,oe)|0,o=o+Math.imul(v,se)|0,n=n+Math.imul(p,ce)|0,r=(r=r+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,o=o+Math.imul(m,ue)|0;var Te=(u+(n=n+Math.imul(l,le)|0)|0)+((8191&(r=(r=r+Math.imul(l,he)|0)+Math.imul(h,le)|0))<<13)|0;u=((o=o+Math.imul(h,he)|0)+(r>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(V,F),r=(r=Math.imul(V,W))+Math.imul(B,F)|0,o=Math.imul(B,W),n=n+Math.imul(L,H)|0,r=(r=r+Math.imul(L,q)|0)+Math.imul(x,H)|0,o=o+Math.imul(x,q)|0,n=n+Math.imul(k,z)|0,r=(r=r+Math.imul(k,Y)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,Y)|0,n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,Q)|0)+Math.imul(M,X)|0,o=o+Math.imul(M,Q)|0,n=n+Math.imul(C,$)|0,r=(r=r+Math.imul(C,ee)|0)+Math.imul(I,$)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(S,ie)|0,r=(r=r+Math.imul(S,ne)|0)+Math.imul(T,ie)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(b,oe)|0,r=(r=r+Math.imul(b,se)|0)+Math.imul(y,oe)|0,o=o+Math.imul(y,se)|0,n=n+Math.imul(g,ce)|0,r=(r=r+Math.imul(g,ue)|0)+Math.imul(v,ce)|0,o=o+Math.imul(v,ue)|0,n=n+Math.imul(p,le)|0,r=(r=r+Math.imul(p,he)|0)+Math.imul(m,le)|0,o=o+Math.imul(m,he)|0;var Re=(u+(n=n+Math.imul(l,pe)|0)|0)+((8191&(r=(r=r+Math.imul(l,me)|0)+Math.imul(h,pe)|0))<<13)|0;u=((o=o+Math.imul(h,me)|0)+(r>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(V,H),r=(r=Math.imul(V,q))+Math.imul(B,H)|0,o=Math.imul(B,q),n=n+Math.imul(L,z)|0,r=(r=r+Math.imul(L,Y)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,Y)|0,n=n+Math.imul(k,X)|0,r=(r=r+Math.imul(k,Q)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,Q)|0,n=n+Math.imul(O,$)|0,r=(r=r+Math.imul(O,ee)|0)+Math.imul(M,$)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(C,ie)|0,r=(r=r+Math.imul(C,ne)|0)+Math.imul(I,ie)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(S,oe)|0,r=(r=r+Math.imul(S,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,n=n+Math.imul(b,ce)|0,r=(r=r+Math.imul(b,ue)|0)+Math.imul(y,ce)|0,o=o+Math.imul(y,ue)|0,n=n+Math.imul(g,le)|0,r=(r=r+Math.imul(g,he)|0)+Math.imul(v,le)|0,o=o+Math.imul(v,he)|0;var Ce=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(r=(r=r+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((o=o+Math.imul(m,me)|0)+(r>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(V,z),r=(r=Math.imul(V,Y))+Math.imul(B,z)|0,o=Math.imul(B,Y),n=n+Math.imul(L,X)|0,r=(r=r+Math.imul(L,Q)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,Q)|0,n=n+Math.imul(k,$)|0,r=(r=r+Math.imul(k,ee)|0)+Math.imul(P,$)|0,o=o+Math.imul(P,ee)|0,n=n+Math.imul(O,ie)|0,r=(r=r+Math.imul(O,ne)|0)+Math.imul(M,ie)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(C,oe)|0,r=(r=r+Math.imul(C,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(S,ce)|0,r=(r=r+Math.imul(S,ue)|0)+Math.imul(T,ce)|0,o=o+Math.imul(T,ue)|0,n=n+Math.imul(b,le)|0,r=(r=r+Math.imul(b,he)|0)+Math.imul(y,le)|0,o=o+Math.imul(y,he)|0;var Ie=(u+(n=n+Math.imul(g,pe)|0)|0)+((8191&(r=(r=r+Math.imul(g,me)|0)+Math.imul(v,pe)|0))<<13)|0;u=((o=o+Math.imul(v,me)|0)+(r>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(V,X),r=(r=Math.imul(V,Q))+Math.imul(B,X)|0,o=Math.imul(B,Q),n=n+Math.imul(L,$)|0,r=(r=r+Math.imul(L,ee)|0)+Math.imul(x,$)|0,o=o+Math.imul(x,ee)|0,n=n+Math.imul(k,ie)|0,r=(r=r+Math.imul(k,ne)|0)+Math.imul(P,ie)|0,o=o+Math.imul(P,ne)|0,n=n+Math.imul(O,oe)|0,r=(r=r+Math.imul(O,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(C,ce)|0,r=(r=r+Math.imul(C,ue)|0)+Math.imul(I,ce)|0,o=o+Math.imul(I,ue)|0,n=n+Math.imul(S,le)|0,r=(r=r+Math.imul(S,he)|0)+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0;var Ae=(u+(n=n+Math.imul(b,pe)|0)|0)+((8191&(r=(r=r+Math.imul(b,me)|0)+Math.imul(y,pe)|0))<<13)|0;u=((o=o+Math.imul(y,me)|0)+(r>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(V,$),r=(r=Math.imul(V,ee))+Math.imul(B,$)|0,o=Math.imul(B,ee),n=n+Math.imul(L,ie)|0,r=(r=r+Math.imul(L,ne)|0)+Math.imul(x,ie)|0,o=o+Math.imul(x,ne)|0,n=n+Math.imul(k,oe)|0,r=(r=r+Math.imul(k,se)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,se)|0,n=n+Math.imul(O,ce)|0,r=(r=r+Math.imul(O,ue)|0)+Math.imul(M,ce)|0,o=o+Math.imul(M,ue)|0,n=n+Math.imul(C,le)|0,r=(r=r+Math.imul(C,he)|0)+Math.imul(I,le)|0,o=o+Math.imul(I,he)|0;var Oe=(u+(n=n+Math.imul(S,pe)|0)|0)+((8191&(r=(r=r+Math.imul(S,me)|0)+Math.imul(T,pe)|0))<<13)|0;u=((o=o+Math.imul(T,me)|0)+(r>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(V,ie),r=(r=Math.imul(V,ne))+Math.imul(B,ie)|0,o=Math.imul(B,ne),n=n+Math.imul(L,oe)|0,r=(r=r+Math.imul(L,se)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,se)|0,n=n+Math.imul(k,ce)|0,r=(r=r+Math.imul(k,ue)|0)+Math.imul(P,ce)|0,o=o+Math.imul(P,ue)|0,n=n+Math.imul(O,le)|0,r=(r=r+Math.imul(O,he)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,he)|0;var Me=(u+(n=n+Math.imul(C,pe)|0)|0)+((8191&(r=(r=r+Math.imul(C,me)|0)+Math.imul(I,pe)|0))<<13)|0;u=((o=o+Math.imul(I,me)|0)+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(V,oe),r=(r=Math.imul(V,se))+Math.imul(B,oe)|0,o=Math.imul(B,se),n=n+Math.imul(L,ce)|0,r=(r=r+Math.imul(L,ue)|0)+Math.imul(x,ce)|0,o=o+Math.imul(x,ue)|0,n=n+Math.imul(k,le)|0,r=(r=r+Math.imul(k,he)|0)+Math.imul(P,le)|0,o=o+Math.imul(P,he)|0;var Ne=(u+(n=n+Math.imul(O,pe)|0)|0)+((8191&(r=(r=r+Math.imul(O,me)|0)+Math.imul(M,pe)|0))<<13)|0;u=((o=o+Math.imul(M,me)|0)+(r>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(V,ce),r=(r=Math.imul(V,ue))+Math.imul(B,ce)|0,o=Math.imul(B,ue),n=n+Math.imul(L,le)|0,r=(r=r+Math.imul(L,he)|0)+Math.imul(x,le)|0,o=o+Math.imul(x,he)|0;var ke=(u+(n=n+Math.imul(k,pe)|0)|0)+((8191&(r=(r=r+Math.imul(k,me)|0)+Math.imul(P,pe)|0))<<13)|0;u=((o=o+Math.imul(P,me)|0)+(r>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(V,le),r=(r=Math.imul(V,he))+Math.imul(B,le)|0,o=Math.imul(B,he);var Pe=(u+(n=n+Math.imul(L,pe)|0)|0)+((8191&(r=(r=r+Math.imul(L,me)|0)+Math.imul(x,pe)|0))<<13)|0;u=((o=o+Math.imul(x,me)|0)+(r>>>13)|0)+(Pe>>>26)|0,Pe&=67108863;var De=(u+(n=Math.imul(V,pe))|0)+((8191&(r=(r=Math.imul(V,me))+Math.imul(B,pe)|0))<<13)|0;return u=((o=Math.imul(B,me))+(r>>>13)|0)+(De>>>26)|0,De&=67108863,c[0]=_e,c[1]=ge,c[2]=ve,c[3]=Ee,c[4]=be,c[5]=ye,c[6]=we,c[7]=Se,c[8]=Te,c[9]=Re,c[10]=Ce,c[11]=Ie,c[12]=Ae,c[13]=Oe,c[14]=Me,c[15]=Ne,c[16]=ke,c[17]=Pe,c[18]=De,0!==u&&(c[19]=u,i.length++),i};function g(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var n=0,r=0,o=0;o<i.length-1;o++){var s=r;r=0;for(var a=67108863&n,c=Math.min(o,t.length-1),u=Math.max(0,o-e.length+1);u<=c;u++){var d=o-u,l=(0|e.words[d])*(0|t.words[u]),h=67108863&l;a=67108863&(h=h+a|0),r+=(s=(s=s+(l/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}i.words[o]=a,n=s,s=r}return 0!==n?i.words[o]=n:i.length--,i._strip()}function v(e,t,i){return g(e,t,i)}function E(e,t){this.x=e,this.y=t}Math.imul||(_=m),o.prototype.mulTo=function(e,t){var i=this.length+e.length;return 10===this.length&&10===e.length?_(this,e,t):i<63?m(this,e,t):i<1024?g(this,e,t):v(this,e,t)},E.prototype.makeRBT=function(e){for(var t=new Array(e),i=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,i,e);return t},E.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var n=0,r=0;r<t;r++)n|=(1&e)<<t-r-1,e>>=1;return n},E.prototype.permute=function(e,t,i,n,r,o){for(var s=0;s<o;s++)n[s]=t[e[s]],r[s]=i[e[s]]},E.prototype.transform=function(e,t,i,n,r,o){this.permute(o,e,t,i,n,r);for(var s=1;s<r;s<<=1)for(var a=s<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),d=0;d<r;d+=a)for(var l=c,h=u,f=0;f<s;f++){var p=i[d+f],m=n[d+f],_=i[d+f+s],g=n[d+f+s],v=l*_-h*g;g=l*g+h*_,_=v,i[d+f]=p+_,n[d+f]=m+g,i[d+f+s]=p-_,n[d+f+s]=m-g,f!==a&&(v=c*l-u*h,h=c*h+u*l,l=v)}},E.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),n=1&i,r=0;for(i=i/2|0;i;i>>>=1)r++;return 1<<r+1+n},E.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var n=0;n<i/2;n++){var r=e[n];e[n]=e[i-n-1],e[i-n-1]=r,r=t[n],t[n]=-t[i-n-1],t[i-n-1]=-r}},E.prototype.normalize13b=function(e,t){for(var i=0,n=0;n<t/2;n++){var r=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+i;e[n]=67108863&r,i=r<67108864?0:r/67108864|0}return e},E.prototype.convert13b=function(e,t,i,r){for(var o=0,s=0;s<t;s++)o+=0|e[s],i[2*s]=8191&o,o>>>=13,i[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<r;++s)i[s]=0;n(0===o),n(0===(-8192&o))},E.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},E.prototype.mulp=function(e,t,i){var n=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),d=new Array(n),l=new Array(n),h=i.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,u,n),this.transform(s,o,a,c,n,r),this.transform(u,o,d,l,n,r);for(var f=0;f<n;f++){var p=a[f]*d[f]-c[f]*l[f];c[f]=a[f]*l[f]+c[f]*d[f],a[f]=p}return this.conjugate(a,c,n),this.transform(a,c,h,o,n,r),this.conjugate(h,o,n),this.normalize13b(h,n),i.negative=e.negative^t.negative,i.length=e.length+t.length,i._strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),v(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"===typeof e),n(e<67108864);for(var i=0,r=0;r<this.length;r++){var o=(0|this.words[r])*e,s=(67108863&o)+(67108863&i);i>>=26,i+=o/67108864|0,i+=s>>>26,this.words[r]=67108863&s}return 0!==i&&(this.words[r]=i,this.length++),t?this.ineg():this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var n=i/26|0,r=i%26;t[i]=e.words[n]>>>r&1}return t}(e);if(0===t.length)return new o(1);for(var i=this,n=0;n<t.length&&0===t[n];n++,i=i.sqr());if(++n<t.length)for(var r=i.sqr();n<t.length;n++,r=r.sqr())0!==t[n]&&(i=i.mul(r));return i},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,i=e%26,r=(e-i)/26,o=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,c=(0|this.words[t])-a<<i;this.words[t]=c|s,s=a>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==r){for(t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(t=0;t<r;t++)this.words[t]=0;this.length+=r}return this._strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,i){var r;n("number"===typeof e&&e>=0),r=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,c=i;if(r-=s,r=Math.max(0,r),c){for(var u=0;u<s;u++)c.words[u]=this.words[u];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,u=0;u<this.length;u++)this.words[u]=this.words[u+s];else this.words[0]=0,this.length=1;var d=0;for(u=this.length-1;u>=0&&(0!==d||u>=r);u--){var l=0|this.words[u];this.words[u]=d<<26-o|l>>>o,d=l&a}return c&&0!==d&&(c.words[c.length++]=d),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(e,t,i){return n(0===this.negative),this.iushrn(e,t,i)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26,r=1<<t;return!(this.length<=i)&&!!(this.words[i]&r)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var r=67108863^67108863>>>t<<t;this.words[this.length-1]&=r}return this._strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,i){var r,o,s=e.length+i;this._expand(s);var a=0;for(r=0;r<e.length;r++){o=(0|this.words[r+i])+a;var c=(0|e.words[r])*t;a=((o-=67108863&c)>>26)-(c/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this._strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this._strip()},o.prototype._wordDiv=function(e,t){var i=(this.length,e.length),n=this.clone(),r=e,s=0|r.words[r.length-1];0!==(i=26-this._countBits(s))&&(r=r.ushln(i),n.iushln(i),s=0|r.words[r.length-1]);var a,c=n.length-r.length;if("mod"!==t){(a=new o(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var d=n.clone()._ishlnsubmul(r,1,c);0===d.negative&&(n=d,a&&(a.words[c]=1));for(var l=c-1;l>=0;l--){var h=67108864*(0|n.words[r.length+l])+(0|n.words[r.length+l-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(r,h,l);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(r,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=h)}return a&&a._strip(),n._strip(),"div"!==t&&0!==i&&n.iushrn(i),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,i){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(r=a.div.neg()),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:r,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(r=a.div.neg()),{div:r,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modrn(e.words[0]))}:this._wordDiv(e,t);var r,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),r=e.andln(1),o=i.cmp(n);return o<0||1===r&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var i=(1<<26)%e,r=0,o=this.length-1;o>=0;o--)r=(i*r+(0|this.words[o]))%e;return t?-r:r},o.prototype.modn=function(e){return this.modrn(e)},o.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var i=0,r=this.length-1;r>=0;r--){var o=(0|this.words[r])+67108864*i;this.words[r]=o/e|0,i=o%e}return this._strip(),t?this.ineg():this},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r=new o(1),s=new o(0),a=new o(0),c=new o(1),u=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++u;for(var d=i.clone(),l=t.clone();!t.isZero();){for(var h=0,f=1;0===(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(r.isOdd()||s.isOdd())&&(r.iadd(d),s.isub(l)),r.iushrn(1),s.iushrn(1);for(var p=0,m=1;0===(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(d),c.isub(l)),a.iushrn(1),c.iushrn(1);t.cmp(i)>=0?(t.isub(i),r.isub(a),s.isub(c)):(i.isub(t),a.isub(r),c.isub(s))}return{a:a,b:c,gcd:i.iushln(u)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r,s=new o(1),a=new o(0),c=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,d=1;0===(t.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(t.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var l=0,h=1;0===(i.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(i.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(a)):(i.isub(t),a.isub(s))}return(r=0===t.cmpn(1)?s:a).cmpn(0)<0&&r.iadd(e),r},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var n=0;t.isEven()&&i.isEven();n++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=t.cmp(i);if(r<0){var o=t;t=i,i=o}else if(0===r||0===i.cmpn(1))break;t.isub(i)}return i.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,i=(e-t)/26,r=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var o=r,s=i;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this._strip(),this.length>1)t=1;else{i&&(e=-e),n(e<=67108863,"Number is too big");var r=0|this.words[0];t=r===e?0:r<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],r=0|e.words[i];if(n!==r){n<r?t=-1:n>r&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new C(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var b={k256:null,p224:null,p192:null,p25519:null};function y(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function S(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function T(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function R(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function C(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function I(e){C.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},y.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},y.prototype.split=function(e,t){e.iushrn(this.n,0,t)},y.prototype.imulK=function(e){return e.imul(this.k)},r(w,y),w.prototype.split=function(e,t){for(var i=4194303,n=Math.min(e.length,9),r=0;r<n;r++)t.words[r]=e.words[r];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&i,r=10;r<e.length;r++){var s=0|e.words[r];e.words[r-10]=(s&i)<<4|o>>>22,o=s}o>>>=22,e.words[r-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},w.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var n=0|e.words[i];t+=977*n,e.words[i]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(S,y),r(T,y),r(R,y),R.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var n=19*(0|e.words[i])+t,r=67108863&n;n>>>=26,e.words[i]=r,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(b[e])return b[e];var t;if("k256"===e)t=new w;else if("p224"===e)t=new S;else if("p192"===e)t=new T;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new R}return b[e]=t,t},C.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},C.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},C.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(d(e,e.umod(this.m)._forceRed(this)),e)},C.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},C.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},C.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},C.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},C.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},C.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},C.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},C.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},C.prototype.isqr=function(e){return this.imul(e,e.clone())},C.prototype.sqr=function(e){return this.mul(e,e)},C.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var i=this.m.add(new o(1)).iushrn(2);return this.pow(e,i)}for(var r=this.m.subn(1),s=0;!r.isZero()&&0===r.andln(1);)s++,r.iushrn(1);n(!r.isZero());var a=new o(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new o(2*d*d).toRed(this);0!==this.pow(d,u).cmp(c);)d.redIAdd(c);for(var l=this.pow(d,r),h=this.pow(e,r.addn(1).iushrn(1)),f=this.pow(e,r),p=s;0!==f.cmp(a);){for(var m=f,_=0;0!==m.cmp(a);_++)m=m.redSqr();n(_<p);var g=this.pow(l,new o(1).iushln(p-_-1));h=h.redMul(g),l=g.redSqr(),f=f.redMul(l),p=_}return h},C.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},C.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new o(1).toRed(this),i[1]=e;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],e);var r=i[0],s=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],d=c-1;d>=0;d--){var l=u>>d&1;r!==i[0]&&(r=this.sqr(r)),0!==l||0!==s?(s<<=1,s|=l,(4===++a||0===n&&0===d)&&(r=this.mul(r,i[s]),a=0,s=0)):a=0}c=26}return r},C.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},C.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new I(e)},r(I,C),I.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},I.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},I.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},I.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var i=e.mul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),s=r;return r.cmp(this.m)>=0?s=r.isub(this.m):r.cmpn(0)<0&&(s=r.iadd(this.m)),s._forceRed(this)},I.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(27)(e))},function(e,t,i){"use strict";var n=t;n.version=i(224).version,n.utils=i(12),n.rand=i(73),n.curve=i(125),n.curves=i(78),n.ec=i(236),n.eddsa=i(240)},function(e,t,i){"use strict";var n,r=t,o=i(79),s=i(125),a=i(12).assert;function c(e){"short"===e.type?this.curve=new s.short(e):"edwards"===e.type?this.curve=new s.edwards(e):this.curve=new s.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function u(e,t){Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get:function(){var i=new c(t);return Object.defineProperty(r,e,{configurable:!0,enumerable:!0,value:i}),i}})}r.PresetCurve=c,u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:o.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:o.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:o.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:o.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:o.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{n=i(235)}catch(d){n=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:o.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",n]})},function(e,t,i){var n=t;n.utils=i(16),n.common=i(44),n.sha=i(229),n.ripemd=i(233),n.hmac=i(234),n.sha1=n.sha.sha1,n.sha256=n.sha.sha256,n.sha224=n.sha.sha224,n.sha384=n.sha.sha384,n.sha512=n.sha.sha512,n.ripemd160=n.ripemd.ripemd160},function(e,t,i){"use strict";(function(t){var n,r=i(7),o=r.Buffer,s={};for(n in r)r.hasOwnProperty(n)&&"SlowBuffer"!==n&&"Buffer"!==n&&(s[n]=r[n]);var a=s.Buffer={};for(n in o)o.hasOwnProperty(n)&&"allocUnsafe"!==n&&"allocUnsafeSlow"!==n&&(a[n]=o[n]);if(s.Buffer.prototype=o.prototype,a.from&&a.from!==Uint8Array.from||(a.from=function(e,t,i){if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&"undefined"===typeof e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return o(e,t,i)}),a.alloc||(a.alloc=function(e,t,i){if("number"!==typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var n=o(e);return t&&0!==t.length?"string"===typeof i?n.fill(t,i):n.fill(t):n.fill(0),n}),!s.kStringMaxLength)try{s.kStringMaxLength=t.binding("buffer").kStringMaxLength}catch(c){}s.constants||(s.constants={MAX_LENGTH:s.kMaxLength},s.kStringMaxLength&&(s.constants.MAX_STRING_LENGTH=s.kStringMaxLength)),e.exports=s}).call(this,i(6))},function(e,t,i){"use strict";const n=i(82).Reporter,r=i(45).EncoderBuffer,o=i(45).DecoderBuffer,s=i(11),a=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],c=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(a);function u(e,t,i){const n={};this._baseState=n,n.name=i,n.enc=e,n.parent=t||null,n.children=null,n.tag=null,n.args=null,n.reverseArgs=null,n.choice=null,n.optional=!1,n.any=!1,n.obj=!1,n.use=null,n.useDecoder=null,n.key=null,n.default=null,n.explicit=null,n.implicit=null,n.contains=null,n.parent||(n.children=[],this._wrap())}e.exports=u;const d=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];u.prototype.clone=function(){const e=this._baseState,t={};d.forEach((function(i){t[i]=e[i]}));const i=new this.constructor(t.parent);return i._baseState=t,i},u.prototype._wrap=function(){const e=this._baseState;c.forEach((function(t){this[t]=function(){const i=new this.constructor(this);return e.children.push(i),i[t].apply(i,arguments)}}),this)},u.prototype._init=function(e){const t=this._baseState;s(null===t.parent),e.call(this),t.children=t.children.filter((function(e){return e._baseState.parent===this}),this),s.equal(t.children.length,1,"Root node can have only one child")},u.prototype._useArgs=function(e){const t=this._baseState,i=e.filter((function(e){return e instanceof this.constructor}),this);e=e.filter((function(e){return!(e instanceof this.constructor)}),this),0!==i.length&&(s(null===t.children),t.children=i,i.forEach((function(e){e._baseState.parent=this}),this)),0!==e.length&&(s(null===t.args),t.args=e,t.reverseArgs=e.map((function(e){if("object"!==typeof e||e.constructor!==Object)return e;const t={};return Object.keys(e).forEach((function(i){i==(0|i)&&(i|=0);const n=e[i];t[n]=i})),t})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(e){u.prototype[e]=function(){const t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}})),a.forEach((function(e){u.prototype[e]=function(){const t=this._baseState,i=Array.prototype.slice.call(arguments);return s(null===t.tag),t.tag=e,this._useArgs(i),this}})),u.prototype.use=function(e){s(e);const t=this._baseState;return s(null===t.use),t.use=e,this},u.prototype.optional=function(){return this._baseState.optional=!0,this},u.prototype.def=function(e){const t=this._baseState;return s(null===t.default),t.default=e,t.optional=!0,this},u.prototype.explicit=function(e){const t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.explicit=e,this},u.prototype.implicit=function(e){const t=this._baseState;return s(null===t.explicit&&null===t.implicit),t.implicit=e,this},u.prototype.obj=function(){const e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},u.prototype.key=function(e){const t=this._baseState;return s(null===t.key),t.key=e,this},u.prototype.any=function(){return this._baseState.any=!0,this},u.prototype.choice=function(e){const t=this._baseState;return s(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map((function(t){return e[t]}))),this},u.prototype.contains=function(e){const t=this._baseState;return s(null===t.use),t.contains=e,this},u.prototype._decode=function(e,t){const i=this._baseState;if(null===i.parent)return e.wrapResult(i.children[0]._decode(e,t));let n,r=i.default,s=!0,a=null;if(null!==i.key&&(a=e.enterKey(i.key)),i.optional){let n=null;if(null!==i.explicit?n=i.explicit:null!==i.implicit?n=i.implicit:null!==i.tag&&(n=i.tag),null!==n||i.any){if(s=this._peekTag(e,n,i.any),e.isError(s))return s}else{const n=e.save();try{null===i.choice?this._decodeGeneric(i.tag,e,t):this._decodeChoice(e,t),s=!0}catch(c){s=!1}e.restore(n)}}if(i.obj&&s&&(n=e.enterObject()),s){if(null!==i.explicit){const t=this._decodeTag(e,i.explicit);if(e.isError(t))return t;e=t}const n=e.offset;if(null===i.use&&null===i.choice){let t;i.any&&(t=e.save());const n=this._decodeTag(e,null!==i.implicit?i.implicit:i.tag,i.any);if(e.isError(n))return n;i.any?r=e.raw(t):e=n}if(t&&t.track&&null!==i.tag&&t.track(e.path(),n,e.length,"tagged"),t&&t.track&&null!==i.tag&&t.track(e.path(),e.offset,e.length,"content"),i.any||(r=null===i.choice?this._decodeGeneric(i.tag,e,t):this._decodeChoice(e,t)),e.isError(r))return r;if(i.any||null!==i.choice||null===i.children||i.children.forEach((function(i){i._decode(e,t)})),i.contains&&("octstr"===i.tag||"bitstr"===i.tag)){const n=new o(r);r=this._getUse(i.contains,e._reporterState.obj)._decode(n,t)}}return i.obj&&s&&(r=e.leaveObject(n)),null===i.key||null===r&&!0!==s?null!==a&&e.exitKey(a):e.leaveKey(a,i.key,r),r},u.prototype._decodeGeneric=function(e,t,i){const n=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,n.args[0],i):/str$/.test(e)?this._decodeStr(t,e,i):"objid"===e&&n.args?this._decodeObjid(t,n.args[0],n.args[1],i):"objid"===e?this._decodeObjid(t,null,null,i):"gentime"===e||"utctime"===e?this._decodeTime(t,e,i):"null_"===e?this._decodeNull(t,i):"bool"===e?this._decodeBool(t,i):"objDesc"===e?this._decodeStr(t,e,i):"int"===e||"enum"===e?this._decodeInt(t,n.args&&n.args[0],i):null!==n.use?this._getUse(n.use,t._reporterState.obj)._decode(t,i):t.error("unknown tag: "+e)},u.prototype._getUse=function(e,t){const i=this._baseState;return i.useDecoder=this._use(e,t),s(null===i.useDecoder._baseState.parent),i.useDecoder=i.useDecoder._baseState.children[0],i.implicit!==i.useDecoder._baseState.implicit&&(i.useDecoder=i.useDecoder.clone(),i.useDecoder._baseState.implicit=i.implicit),i.useDecoder},u.prototype._decodeChoice=function(e,t){const i=this._baseState;let n=null,r=!1;return Object.keys(i.choice).some((function(o){const s=e.save(),a=i.choice[o];try{const i=a._decode(e,t);if(e.isError(i))return!1;n={type:o,value:i},r=!0}catch(c){return e.restore(s),!1}return!0}),this),r?n:e.error("Choice not matched")},u.prototype._createEncoderBuffer=function(e){return new r(e,this.reporter)},u.prototype._encode=function(e,t,i){const n=this._baseState;if(null!==n.default&&n.default===e)return;const r=this._encodeValue(e,t,i);return void 0===r||this._skipDefault(r,t,i)?void 0:r},u.prototype._encodeValue=function(e,t,i){const r=this._baseState;if(null===r.parent)return r.children[0]._encode(e,t||new n);let o=null;if(this.reporter=t,r.optional&&void 0===e){if(null===r.default)return;e=r.default}let s=null,a=!1;if(r.any)o=this._createEncoderBuffer(e);else if(r.choice)o=this._encodeChoice(e,t);else if(r.contains)s=this._getUse(r.contains,i)._encode(e,t),a=!0;else if(r.children)s=r.children.map((function(i){if("null_"===i._baseState.tag)return i._encode(null,t,e);if(null===i._baseState.key)return t.error("Child should have a key");const n=t.enterKey(i._baseState.key);if("object"!==typeof e)return t.error("Child expected, but input is not object");const r=i._encode(e[i._baseState.key],t,e);return t.leaveKey(n),r}),this).filter((function(e){return e})),s=this._createEncoderBuffer(s);else if("seqof"===r.tag||"setof"===r.tag){if(!r.args||1!==r.args.length)return t.error("Too many args for : "+r.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");const i=this.clone();i._baseState.implicit=null,s=this._createEncoderBuffer(e.map((function(i){const n=this._baseState;return this._getUse(n.args[0],e)._encode(i,t)}),i))}else null!==r.use?o=this._getUse(r.use,i)._encode(e,t):(s=this._encodePrimitive(r.tag,e),a=!0);if(!r.any&&null===r.choice){const e=null!==r.implicit?r.implicit:r.tag,i=null===r.implicit?"universal":"context";null===e?null===r.use&&t.error("Tag could be omitted only for .use()"):null===r.use&&(o=this._encodeComposite(e,a,i,s))}return null!==r.explicit&&(o=this._encodeComposite(r.explicit,!1,"context",o)),o},u.prototype._encodeChoice=function(e,t){const i=this._baseState,n=i.choice[e.type];return n||s(!1,e.type+" not found in "+JSON.stringify(Object.keys(i.choice))),n._encode(e.value,t)},u.prototype._encodePrimitive=function(e,t){const i=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&i.args)return this._encodeObjid(t,i.reverseArgs[0],i.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,i.args&&i.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},u.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},u.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)}},function(e,t,i){"use strict";const n=i(2);function r(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function o(e,t){this.path=e,this.rethrow(t)}t.Reporter=r,r.prototype.isError=function(e){return e instanceof o},r.prototype.save=function(){const e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},r.prototype.restore=function(e){const t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},r.prototype.enterKey=function(e){return this._reporterState.path.push(e)},r.prototype.exitKey=function(e){const t=this._reporterState;t.path=t.path.slice(0,e-1)},r.prototype.leaveKey=function(e,t,i){const n=this._reporterState;this.exitKey(e),null!==n.obj&&(n.obj[t]=i)},r.prototype.path=function(){return this._reporterState.path.join("/")},r.prototype.enterObject=function(){const e=this._reporterState,t=e.obj;return e.obj={},t},r.prototype.leaveObject=function(e){const t=this._reporterState,i=t.obj;return t.obj=e,i},r.prototype.error=function(e){let t;const i=this._reporterState,n=e instanceof o;if(t=n?e:new o(i.path.map((function(e){return"["+JSON.stringify(e)+"]"})).join(""),e.message||e,e.stack),!i.options.partial)throw t;return n||i.errors.push(t),t},r.prototype.wrapResult=function(e){const t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},n(o,Error),o.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,o),!this.stack)try{throw new Error(this.message)}catch(t){this.stack=t.stack}return this}},function(e,t,i){"use strict";function n(e){const t={};return Object.keys(e).forEach((function(i){(0|i)==i&&(i|=0);const n=e[i];t[n]=i})),t}t.tagClass={0:"universal",1:"application",2:"context",3:"private"},t.tagClassByName=n(t.tagClass),t.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},t.tagByName=n(t.tag)},function(e,t,i){(function(e){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function o(e,t,i){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:i(259).Buffer}catch(R){}function a(e,t){var i=e.charCodeAt(t);return i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:i-48&15}function c(e,t,i){var n=a(e,i);return i-1>=t&&(n|=a(e,i-1)<<4),n}function u(e,t,i,n){for(var r=0,o=Math.min(e.length,i),s=t;s<o;s++){var a=e.charCodeAt(s)-48;r*=n,r+=a>=49?a-49+10:a>=17?a-17+10:a}return r}o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,i){if("number"===typeof e)return this._initNumber(e,t,i);if("object"===typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var r=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(r++,this.negative=1),r<e.length&&(16===t?this._parseHex(e,r,i):(this._parseBase(e,t,r),"le"===i&&this._initArray(this.toArray(),t,i)))},o.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},o.prototype._initArray=function(e,t,i){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var o,s,a=0;if("be"===i)for(r=e.length-1,o=0;r>=0;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===i)for(r=0,o=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},o.prototype._parseHex=function(e,t,i){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,o=0,s=0;if("be"===i)for(n=e.length-1;n>=t;n-=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;this.strip()},o.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=t)n++;n--,r=r/t|0;for(var o=e.length-i,s=o%n,a=Math.min(o,o-s)+i,c=0,d=i;d<a;d+=n)c=u(e,d,d+n,t),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var l=1;for(c=u(e,d,e.length,t),d=0;d<s;d++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this.strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(e,t,i){i.negative=t.negative^e.negative;var n=e.length+t.length|0;i.length=n,n=n-1|0;var r=0|e.words[0],o=0|t.words[0],s=r*o,a=67108863&s,c=s/67108864|0;i.words[0]=a;for(var u=1;u<n;u++){for(var d=c>>>26,l=67108863&c,h=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=h;f++){var p=u-f|0;d+=(s=(r=0|e.words[p])*(o=0|t.words[f])+l)/67108864|0,l=67108863&s}i.words[u]=0|l,c=0|d}return 0!==c?i.words[u]=0|c:i.length--,i.strip()}o.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var r=0,o=0,s=0;s<this.length;s++){var a=this.words[s],c=(16777215&(a<<r|o)).toString(16);i=0!==(o=a>>>24-r&16777215)||s!==this.length-1?d[6-c.length]+c+i:c+i,(r+=2)>=26&&(r-=26,s--)}for(0!==o&&(i=o.toString(16)+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=l[e],f=h[e];i="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(f).toString(e);i=(p=p.idivn(f)).isZero()?m+i:d[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(e,t){return n("undefined"!==typeof s),this.toArrayLike(s,e,t)},o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,i){var r=this.byteLength(),o=i||Math.max(1,r);n(r<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,c="le"===t,u=new e(o),d=this.clone();if(c){for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[a]=s;for(;a<o;a++)u[a]=0}else{for(a=0;a<o-r;a++)u[a]=0;for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[o-a-1]=s}return u},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0===(8191&t)&&(i+=13,t>>>=13),0===(127&t)&&(i+=7,t>>>=7),0===(15&t)&&(i+=4,t>>>=4),0===(3&t)&&(i+=2,t>>>=2),0===(1&t)&&i++,i},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var n=0;n<i.length;n++)this.words[n]=t.words[n]^i.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this.strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var i=e/26|0,r=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<r:this.words[i]&~(1<<r),this.strip()},o.prototype.iadd=function(e){var t,i,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,n=e):(i=e,n=this);for(var r=0,o=0;o<n.length;o++)t=(0|i.words[o])+(0|n.words[o])+r,this.words[o]=67108863&t,r=t>>>26;for(;0!==r&&o<i.length;o++)t=(0|i.words[o])+r,this.words[o]=67108863&t,r=t>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,n,r=this.cmp(e);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(i=this,n=e):(i=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|i.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<i.length;s++)o=(t=(0|i.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,i){var n,r,o,s=e.words,a=t.words,c=i.words,u=0,d=0|s[0],l=8191&d,h=d>>>13,f=0|s[1],p=8191&f,m=f>>>13,_=0|s[2],g=8191&_,v=_>>>13,E=0|s[3],b=8191&E,y=E>>>13,w=0|s[4],S=8191&w,T=w>>>13,R=0|s[5],C=8191&R,I=R>>>13,A=0|s[6],O=8191&A,M=A>>>13,N=0|s[7],k=8191&N,P=N>>>13,D=0|s[8],L=8191&D,x=D>>>13,U=0|s[9],V=8191&U,B=U>>>13,j=0|a[0],F=8191&j,W=j>>>13,G=0|a[1],H=8191&G,q=G>>>13,K=0|a[2],z=8191&K,Y=K>>>13,J=0|a[3],X=8191&J,Q=J>>>13,Z=0|a[4],$=8191&Z,ee=Z>>>13,te=0|a[5],ie=8191&te,ne=te>>>13,re=0|a[6],oe=8191&re,se=re>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,de=0|a[8],le=8191&de,he=de>>>13,fe=0|a[9],pe=8191&fe,me=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var _e=(u+(n=Math.imul(l,F))|0)+((8191&(r=(r=Math.imul(l,W))+Math.imul(h,F)|0))<<13)|0;u=((o=Math.imul(h,W))+(r>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(p,F),r=(r=Math.imul(p,W))+Math.imul(m,F)|0,o=Math.imul(m,W);var ge=(u+(n=n+Math.imul(l,H)|0)|0)+((8191&(r=(r=r+Math.imul(l,q)|0)+Math.imul(h,H)|0))<<13)|0;u=((o=o+Math.imul(h,q)|0)+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,F),r=(r=Math.imul(g,W))+Math.imul(v,F)|0,o=Math.imul(v,W),n=n+Math.imul(p,H)|0,r=(r=r+Math.imul(p,q)|0)+Math.imul(m,H)|0,o=o+Math.imul(m,q)|0;var ve=(u+(n=n+Math.imul(l,z)|0)|0)+((8191&(r=(r=r+Math.imul(l,Y)|0)+Math.imul(h,z)|0))<<13)|0;u=((o=o+Math.imul(h,Y)|0)+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,F),r=(r=Math.imul(b,W))+Math.imul(y,F)|0,o=Math.imul(y,W),n=n+Math.imul(g,H)|0,r=(r=r+Math.imul(g,q)|0)+Math.imul(v,H)|0,o=o+Math.imul(v,q)|0,n=n+Math.imul(p,z)|0,r=(r=r+Math.imul(p,Y)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,Y)|0;var Ee=(u+(n=n+Math.imul(l,X)|0)|0)+((8191&(r=(r=r+Math.imul(l,Q)|0)+Math.imul(h,X)|0))<<13)|0;u=((o=o+Math.imul(h,Q)|0)+(r>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(S,F),r=(r=Math.imul(S,W))+Math.imul(T,F)|0,o=Math.imul(T,W),n=n+Math.imul(b,H)|0,r=(r=r+Math.imul(b,q)|0)+Math.imul(y,H)|0,o=o+Math.imul(y,q)|0,n=n+Math.imul(g,z)|0,r=(r=r+Math.imul(g,Y)|0)+Math.imul(v,z)|0,o=o+Math.imul(v,Y)|0,n=n+Math.imul(p,X)|0,r=(r=r+Math.imul(p,Q)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,Q)|0;var be=(u+(n=n+Math.imul(l,$)|0)|0)+((8191&(r=(r=r+Math.imul(l,ee)|0)+Math.imul(h,$)|0))<<13)|0;u=((o=o+Math.imul(h,ee)|0)+(r>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(C,F),r=(r=Math.imul(C,W))+Math.imul(I,F)|0,o=Math.imul(I,W),n=n+Math.imul(S,H)|0,r=(r=r+Math.imul(S,q)|0)+Math.imul(T,H)|0,o=o+Math.imul(T,q)|0,n=n+Math.imul(b,z)|0,r=(r=r+Math.imul(b,Y)|0)+Math.imul(y,z)|0,o=o+Math.imul(y,Y)|0,n=n+Math.imul(g,X)|0,r=(r=r+Math.imul(g,Q)|0)+Math.imul(v,X)|0,o=o+Math.imul(v,Q)|0,n=n+Math.imul(p,$)|0,r=(r=r+Math.imul(p,ee)|0)+Math.imul(m,$)|0,o=o+Math.imul(m,ee)|0;var ye=(u+(n=n+Math.imul(l,ie)|0)|0)+((8191&(r=(r=r+Math.imul(l,ne)|0)+Math.imul(h,ie)|0))<<13)|0;u=((o=o+Math.imul(h,ne)|0)+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(O,F),r=(r=Math.imul(O,W))+Math.imul(M,F)|0,o=Math.imul(M,W),n=n+Math.imul(C,H)|0,r=(r=r+Math.imul(C,q)|0)+Math.imul(I,H)|0,o=o+Math.imul(I,q)|0,n=n+Math.imul(S,z)|0,r=(r=r+Math.imul(S,Y)|0)+Math.imul(T,z)|0,o=o+Math.imul(T,Y)|0,n=n+Math.imul(b,X)|0,r=(r=r+Math.imul(b,Q)|0)+Math.imul(y,X)|0,o=o+Math.imul(y,Q)|0,n=n+Math.imul(g,$)|0,r=(r=r+Math.imul(g,ee)|0)+Math.imul(v,$)|0,o=o+Math.imul(v,ee)|0,n=n+Math.imul(p,ie)|0,r=(r=r+Math.imul(p,ne)|0)+Math.imul(m,ie)|0,o=o+Math.imul(m,ne)|0;var we=(u+(n=n+Math.imul(l,oe)|0)|0)+((8191&(r=(r=r+Math.imul(l,se)|0)+Math.imul(h,oe)|0))<<13)|0;u=((o=o+Math.imul(h,se)|0)+(r>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,F),r=(r=Math.imul(k,W))+Math.imul(P,F)|0,o=Math.imul(P,W),n=n+Math.imul(O,H)|0,r=(r=r+Math.imul(O,q)|0)+Math.imul(M,H)|0,o=o+Math.imul(M,q)|0,n=n+Math.imul(C,z)|0,r=(r=r+Math.imul(C,Y)|0)+Math.imul(I,z)|0,o=o+Math.imul(I,Y)|0,n=n+Math.imul(S,X)|0,r=(r=r+Math.imul(S,Q)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,Q)|0,n=n+Math.imul(b,$)|0,r=(r=r+Math.imul(b,ee)|0)+Math.imul(y,$)|0,o=o+Math.imul(y,ee)|0,n=n+Math.imul(g,ie)|0,r=(r=r+Math.imul(g,ne)|0)+Math.imul(v,ie)|0,o=o+Math.imul(v,ne)|0,n=n+Math.imul(p,oe)|0,r=(r=r+Math.imul(p,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0;var Se=(u+(n=n+Math.imul(l,ce)|0)|0)+((8191&(r=(r=r+Math.imul(l,ue)|0)+Math.imul(h,ce)|0))<<13)|0;u=((o=o+Math.imul(h,ue)|0)+(r>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(L,F),r=(r=Math.imul(L,W))+Math.imul(x,F)|0,o=Math.imul(x,W),n=n+Math.imul(k,H)|0,r=(r=r+Math.imul(k,q)|0)+Math.imul(P,H)|0,o=o+Math.imul(P,q)|0,n=n+Math.imul(O,z)|0,r=(r=r+Math.imul(O,Y)|0)+Math.imul(M,z)|0,o=o+Math.imul(M,Y)|0,n=n+Math.imul(C,X)|0,r=(r=r+Math.imul(C,Q)|0)+Math.imul(I,X)|0,o=o+Math.imul(I,Q)|0,n=n+Math.imul(S,$)|0,r=(r=r+Math.imul(S,ee)|0)+Math.imul(T,$)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(b,ie)|0,r=(r=r+Math.imul(b,ne)|0)+Math.imul(y,ie)|0,o=o+Math.imul(y,ne)|0,n=n+Math.imul(g,oe)|0,r=(r=r+Math.imul(g,se)|0)+Math.imul(v,oe)|0,o=o+Math.imul(v,se)|0,n=n+Math.imul(p,ce)|0,r=(r=r+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,o=o+Math.imul(m,ue)|0;var Te=(u+(n=n+Math.imul(l,le)|0)|0)+((8191&(r=(r=r+Math.imul(l,he)|0)+Math.imul(h,le)|0))<<13)|0;u=((o=o+Math.imul(h,he)|0)+(r>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(V,F),r=(r=Math.imul(V,W))+Math.imul(B,F)|0,o=Math.imul(B,W),n=n+Math.imul(L,H)|0,r=(r=r+Math.imul(L,q)|0)+Math.imul(x,H)|0,o=o+Math.imul(x,q)|0,n=n+Math.imul(k,z)|0,r=(r=r+Math.imul(k,Y)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,Y)|0,n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,Q)|0)+Math.imul(M,X)|0,o=o+Math.imul(M,Q)|0,n=n+Math.imul(C,$)|0,r=(r=r+Math.imul(C,ee)|0)+Math.imul(I,$)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(S,ie)|0,r=(r=r+Math.imul(S,ne)|0)+Math.imul(T,ie)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(b,oe)|0,r=(r=r+Math.imul(b,se)|0)+Math.imul(y,oe)|0,o=o+Math.imul(y,se)|0,n=n+Math.imul(g,ce)|0,r=(r=r+Math.imul(g,ue)|0)+Math.imul(v,ce)|0,o=o+Math.imul(v,ue)|0,n=n+Math.imul(p,le)|0,r=(r=r+Math.imul(p,he)|0)+Math.imul(m,le)|0,o=o+Math.imul(m,he)|0;var Re=(u+(n=n+Math.imul(l,pe)|0)|0)+((8191&(r=(r=r+Math.imul(l,me)|0)+Math.imul(h,pe)|0))<<13)|0;u=((o=o+Math.imul(h,me)|0)+(r>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(V,H),r=(r=Math.imul(V,q))+Math.imul(B,H)|0,o=Math.imul(B,q),n=n+Math.imul(L,z)|0,r=(r=r+Math.imul(L,Y)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,Y)|0,n=n+Math.imul(k,X)|0,r=(r=r+Math.imul(k,Q)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,Q)|0,n=n+Math.imul(O,$)|0,r=(r=r+Math.imul(O,ee)|0)+Math.imul(M,$)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(C,ie)|0,r=(r=r+Math.imul(C,ne)|0)+Math.imul(I,ie)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(S,oe)|0,r=(r=r+Math.imul(S,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,n=n+Math.imul(b,ce)|0,r=(r=r+Math.imul(b,ue)|0)+Math.imul(y,ce)|0,o=o+Math.imul(y,ue)|0,n=n+Math.imul(g,le)|0,r=(r=r+Math.imul(g,he)|0)+Math.imul(v,le)|0,o=o+Math.imul(v,he)|0;var Ce=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(r=(r=r+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((o=o+Math.imul(m,me)|0)+(r>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(V,z),r=(r=Math.imul(V,Y))+Math.imul(B,z)|0,o=Math.imul(B,Y),n=n+Math.imul(L,X)|0,r=(r=r+Math.imul(L,Q)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,Q)|0,n=n+Math.imul(k,$)|0,r=(r=r+Math.imul(k,ee)|0)+Math.imul(P,$)|0,o=o+Math.imul(P,ee)|0,n=n+Math.imul(O,ie)|0,r=(r=r+Math.imul(O,ne)|0)+Math.imul(M,ie)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(C,oe)|0,r=(r=r+Math.imul(C,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(S,ce)|0,r=(r=r+Math.imul(S,ue)|0)+Math.imul(T,ce)|0,o=o+Math.imul(T,ue)|0,n=n+Math.imul(b,le)|0,r=(r=r+Math.imul(b,he)|0)+Math.imul(y,le)|0,o=o+Math.imul(y,he)|0;var Ie=(u+(n=n+Math.imul(g,pe)|0)|0)+((8191&(r=(r=r+Math.imul(g,me)|0)+Math.imul(v,pe)|0))<<13)|0;u=((o=o+Math.imul(v,me)|0)+(r>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(V,X),r=(r=Math.imul(V,Q))+Math.imul(B,X)|0,o=Math.imul(B,Q),n=n+Math.imul(L,$)|0,r=(r=r+Math.imul(L,ee)|0)+Math.imul(x,$)|0,o=o+Math.imul(x,ee)|0,n=n+Math.imul(k,ie)|0,r=(r=r+Math.imul(k,ne)|0)+Math.imul(P,ie)|0,o=o+Math.imul(P,ne)|0,n=n+Math.imul(O,oe)|0,r=(r=r+Math.imul(O,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(C,ce)|0,r=(r=r+Math.imul(C,ue)|0)+Math.imul(I,ce)|0,o=o+Math.imul(I,ue)|0,n=n+Math.imul(S,le)|0,r=(r=r+Math.imul(S,he)|0)+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0;var Ae=(u+(n=n+Math.imul(b,pe)|0)|0)+((8191&(r=(r=r+Math.imul(b,me)|0)+Math.imul(y,pe)|0))<<13)|0;u=((o=o+Math.imul(y,me)|0)+(r>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(V,$),r=(r=Math.imul(V,ee))+Math.imul(B,$)|0,o=Math.imul(B,ee),n=n+Math.imul(L,ie)|0,r=(r=r+Math.imul(L,ne)|0)+Math.imul(x,ie)|0,o=o+Math.imul(x,ne)|0,n=n+Math.imul(k,oe)|0,r=(r=r+Math.imul(k,se)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,se)|0,n=n+Math.imul(O,ce)|0,r=(r=r+Math.imul(O,ue)|0)+Math.imul(M,ce)|0,o=o+Math.imul(M,ue)|0,n=n+Math.imul(C,le)|0,r=(r=r+Math.imul(C,he)|0)+Math.imul(I,le)|0,o=o+Math.imul(I,he)|0;var Oe=(u+(n=n+Math.imul(S,pe)|0)|0)+((8191&(r=(r=r+Math.imul(S,me)|0)+Math.imul(T,pe)|0))<<13)|0;u=((o=o+Math.imul(T,me)|0)+(r>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(V,ie),r=(r=Math.imul(V,ne))+Math.imul(B,ie)|0,o=Math.imul(B,ne),n=n+Math.imul(L,oe)|0,r=(r=r+Math.imul(L,se)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,se)|0,n=n+Math.imul(k,ce)|0,r=(r=r+Math.imul(k,ue)|0)+Math.imul(P,ce)|0,o=o+Math.imul(P,ue)|0,n=n+Math.imul(O,le)|0,r=(r=r+Math.imul(O,he)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,he)|0;var Me=(u+(n=n+Math.imul(C,pe)|0)|0)+((8191&(r=(r=r+Math.imul(C,me)|0)+Math.imul(I,pe)|0))<<13)|0;u=((o=o+Math.imul(I,me)|0)+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(V,oe),r=(r=Math.imul(V,se))+Math.imul(B,oe)|0,o=Math.imul(B,se),n=n+Math.imul(L,ce)|0,r=(r=r+Math.imul(L,ue)|0)+Math.imul(x,ce)|0,o=o+Math.imul(x,ue)|0,n=n+Math.imul(k,le)|0,r=(r=r+Math.imul(k,he)|0)+Math.imul(P,le)|0,o=o+Math.imul(P,he)|0;var Ne=(u+(n=n+Math.imul(O,pe)|0)|0)+((8191&(r=(r=r+Math.imul(O,me)|0)+Math.imul(M,pe)|0))<<13)|0;u=((o=o+Math.imul(M,me)|0)+(r>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(V,ce),r=(r=Math.imul(V,ue))+Math.imul(B,ce)|0,o=Math.imul(B,ue),n=n+Math.imul(L,le)|0,r=(r=r+Math.imul(L,he)|0)+Math.imul(x,le)|0,o=o+Math.imul(x,he)|0;var ke=(u+(n=n+Math.imul(k,pe)|0)|0)+((8191&(r=(r=r+Math.imul(k,me)|0)+Math.imul(P,pe)|0))<<13)|0;u=((o=o+Math.imul(P,me)|0)+(r>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(V,le),r=(r=Math.imul(V,he))+Math.imul(B,le)|0,o=Math.imul(B,he);var Pe=(u+(n=n+Math.imul(L,pe)|0)|0)+((8191&(r=(r=r+Math.imul(L,me)|0)+Math.imul(x,pe)|0))<<13)|0;u=((o=o+Math.imul(x,me)|0)+(r>>>13)|0)+(Pe>>>26)|0,Pe&=67108863;var De=(u+(n=Math.imul(V,pe))|0)+((8191&(r=(r=Math.imul(V,me))+Math.imul(B,pe)|0))<<13)|0;return u=((o=Math.imul(B,me))+(r>>>13)|0)+(De>>>26)|0,De&=67108863,c[0]=_e,c[1]=ge,c[2]=ve,c[3]=Ee,c[4]=be,c[5]=ye,c[6]=we,c[7]=Se,c[8]=Te,c[9]=Re,c[10]=Ce,c[11]=Ie,c[12]=Ae,c[13]=Oe,c[14]=Me,c[15]=Ne,c[16]=ke,c[17]=Pe,c[18]=De,0!==u&&(c[19]=u,i.length++),i};function m(e,t,i){return(new _).mulp(e,t,i)}function _(e,t){this.x=e,this.y=t}Math.imul||(p=f),o.prototype.mulTo=function(e,t){var i,n=this.length+e.length;return i=10===this.length&&10===e.length?p(this,e,t):n<63?f(this,e,t):n<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var n=0,r=0,o=0;o<i.length-1;o++){var s=r;r=0;for(var a=67108863&n,c=Math.min(o,t.length-1),u=Math.max(0,o-e.length+1);u<=c;u++){var d=o-u,l=(0|e.words[d])*(0|t.words[u]),h=67108863&l;a=67108863&(h=h+a|0),r+=(s=(s=s+(l/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}i.words[o]=a,n=s,s=r}return 0!==n?i.words[o]=n:i.length--,i.strip()}(this,e,t):m(this,e,t),i},_.prototype.makeRBT=function(e){for(var t=new Array(e),i=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,i,e);return t},_.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var n=0,r=0;r<t;r++)n|=(1&e)<<t-r-1,e>>=1;return n},_.prototype.permute=function(e,t,i,n,r,o){for(var s=0;s<o;s++)n[s]=t[e[s]],r[s]=i[e[s]]},_.prototype.transform=function(e,t,i,n,r,o){this.permute(o,e,t,i,n,r);for(var s=1;s<r;s<<=1)for(var a=s<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),d=0;d<r;d+=a)for(var l=c,h=u,f=0;f<s;f++){var p=i[d+f],m=n[d+f],_=i[d+f+s],g=n[d+f+s],v=l*_-h*g;g=l*g+h*_,_=v,i[d+f]=p+_,n[d+f]=m+g,i[d+f+s]=p-_,n[d+f+s]=m-g,f!==a&&(v=c*l-u*h,h=c*h+u*l,l=v)}},_.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),n=1&i,r=0;for(i=i/2|0;i;i>>>=1)r++;return 1<<r+1+n},_.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var n=0;n<i/2;n++){var r=e[n];e[n]=e[i-n-1],e[i-n-1]=r,r=t[n],t[n]=-t[i-n-1],t[i-n-1]=-r}},_.prototype.normalize13b=function(e,t){for(var i=0,n=0;n<t/2;n++){var r=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+i;e[n]=67108863&r,i=r<67108864?0:r/67108864|0}return e},_.prototype.convert13b=function(e,t,i,r){for(var o=0,s=0;s<t;s++)o+=0|e[s],i[2*s]=8191&o,o>>>=13,i[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<r;++s)i[s]=0;n(0===o),n(0===(-8192&o))},_.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},_.prototype.mulp=function(e,t,i){var n=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),d=new Array(n),l=new Array(n),h=i.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,u,n),this.transform(s,o,a,c,n,r),this.transform(u,o,d,l,n,r);for(var f=0;f<n;f++){var p=a[f]*d[f]-c[f]*l[f];c[f]=a[f]*l[f]+c[f]*d[f],a[f]=p}return this.conjugate(a,c,n),this.transform(a,c,h,o,n,r),this.conjugate(h,o,n),this.normalize13b(h,n),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),m(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){n("number"===typeof e),n(e<67108864);for(var t=0,i=0;i<this.length;i++){var r=(0|this.words[i])*e,o=(67108863&r)+(67108863&t);t>>=26,t+=r/67108864|0,t+=o>>>26,this.words[i]=67108863&o}return 0!==t&&(this.words[i]=t,this.length++),this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var n=i/26|0,r=i%26;t[i]=(e.words[n]&1<<r)>>>r}return t}(e);if(0===t.length)return new o(1);for(var i=this,n=0;n<t.length&&0===t[n];n++,i=i.sqr());if(++n<t.length)for(var r=i.sqr();n<t.length;n++,r=r.sqr())0!==t[n]&&(i=i.mul(r));return i},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,i=e%26,r=(e-i)/26,o=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,c=(0|this.words[t])-a<<i;this.words[t]=c|s,s=a>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==r){for(t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(t=0;t<r;t++)this.words[t]=0;this.length+=r}return this.strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,i){var r;n("number"===typeof e&&e>=0),r=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,c=i;if(r-=s,r=Math.max(0,r),c){for(var u=0;u<s;u++)c.words[u]=this.words[u];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,u=0;u<this.length;u++)this.words[u]=this.words[u+s];else this.words[0]=0,this.length=1;var d=0;for(u=this.length-1;u>=0&&(0!==d||u>=r);u--){var l=0|this.words[u];this.words[u]=d<<26-o|l>>>o,d=l&a}return c&&0!==d&&(c.words[c.length++]=d),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(e,t,i){return n(0===this.negative),this.iushrn(e,t,i)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26,r=1<<t;return!(this.length<=i)&&!!(this.words[i]&r)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var r=67108863^67108863>>>t<<t;this.words[this.length-1]&=r}return this.strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,i){var r,o,s=e.length+i;this._expand(s);var a=0;for(r=0;r<e.length;r++){o=(0|this.words[r+i])+a;var c=(0|e.words[r])*t;a=((o-=67108863&c)>>26)-(c/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},o.prototype._wordDiv=function(e,t){var i=(this.length,e.length),n=this.clone(),r=e,s=0|r.words[r.length-1];0!==(i=26-this._countBits(s))&&(r=r.ushln(i),n.iushln(i),s=0|r.words[r.length-1]);var a,c=n.length-r.length;if("mod"!==t){(a=new o(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var d=n.clone()._ishlnsubmul(r,1,c);0===d.negative&&(n=d,a&&(a.words[c]=1));for(var l=c-1;l>=0;l--){var h=67108864*(0|n.words[r.length+l])+(0|n.words[r.length+l-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(r,h,l);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(r,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=h)}return a&&a.strip(),n.strip(),"div"!==t&&0!==i&&n.iushrn(i),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,i){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(r=a.div.neg()),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:r,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(r=a.div.neg()),{div:r,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}:this._wordDiv(e,t);var r,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),r=e.andln(1),o=i.cmp(n);return o<0||1===r&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,i=0,r=this.length-1;r>=0;r--)i=(t*i+(0|this.words[r]))%e;return i},o.prototype.idivn=function(e){n(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var r=(0|this.words[i])+67108864*t;this.words[i]=r/e|0,t=r%e}return this.strip()},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r=new o(1),s=new o(0),a=new o(0),c=new o(1),u=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++u;for(var d=i.clone(),l=t.clone();!t.isZero();){for(var h=0,f=1;0===(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(r.isOdd()||s.isOdd())&&(r.iadd(d),s.isub(l)),r.iushrn(1),s.iushrn(1);for(var p=0,m=1;0===(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(d),c.isub(l)),a.iushrn(1),c.iushrn(1);t.cmp(i)>=0?(t.isub(i),r.isub(a),s.isub(c)):(i.isub(t),a.isub(r),c.isub(s))}return{a:a,b:c,gcd:i.iushln(u)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r,s=new o(1),a=new o(0),c=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,d=1;0===(t.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(t.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var l=0,h=1;0===(i.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(i.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(a)):(i.isub(t),a.isub(s))}return(r=0===t.cmpn(1)?s:a).cmpn(0)<0&&r.iadd(e),r},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var n=0;t.isEven()&&i.isEven();n++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=t.cmp(i);if(r<0){var o=t;t=i,i=o}else if(0===r||0===i.cmpn(1))break;t.isub(i)}return i.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,i=(e-t)/26,r=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var o=r,s=i;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),n(e<=67108863,"Number is too big");var r=0|this.words[0];t=r===e?0:r<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],r=0|e.words[i];if(n!==r){n<r?t=-1:n>r&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new S(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function y(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function T(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},r(E,v),E.prototype.split=function(e,t){for(var i=4194303,n=Math.min(e.length,9),r=0;r<n;r++)t.words[r]=e.words[r];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&i,r=10;r<e.length;r++){var s=0|e.words[r];e.words[r-10]=(s&i)<<4|o>>>22,o=s}o>>>=22,e.words[r-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var n=0|e.words[i];t+=977*n,e.words[i]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(b,v),r(y,v),r(w,v),w.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var n=19*(0|e.words[i])+t,r=67108863&n;n>>>=26,e.words[i]=r,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new b;else if("p192"===e)t=new y;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return g[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},S.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var i=this.m.add(new o(1)).iushrn(2);return this.pow(e,i)}for(var r=this.m.subn(1),s=0;!r.isZero()&&0===r.andln(1);)s++,r.iushrn(1);n(!r.isZero());var a=new o(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new o(2*d*d).toRed(this);0!==this.pow(d,u).cmp(c);)d.redIAdd(c);for(var l=this.pow(d,r),h=this.pow(e,r.addn(1).iushrn(1)),f=this.pow(e,r),p=s;0!==f.cmp(a);){for(var m=f,_=0;0!==m.cmp(a);_++)m=m.redSqr();n(_<p);var g=this.pow(l,new o(1).iushln(p-_-1));h=h.redMul(g),l=g.redSqr(),f=f.redMul(l),p=_}return h},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new o(1).toRed(this),i[1]=e;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],e);var r=i[0],s=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],d=c-1;d>=0;d--){var l=u>>d&1;r!==i[0]&&(r=this.sqr(r)),0!==l||0!==s?(s<<=1,s|=l,(4===++a||0===n&&0===d)&&(r=this.mul(r,i[s]),a=0,s=0)):a=0}c=26}return r},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new T(e)},r(T,S),T.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},T.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},T.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},T.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var i=e.mul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),s=r;return r.cmp(this.m)>=0?s=r.isub(this.m):r.cmpn(0)<0&&(s=r.iadd(this.m)),s._forceRed(this)},T.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(27)(e))},function(e,t,i){"use strict";function n(e){return function(){return null}}i.d(t,"a",(function(){return n}))},function(e,t,i){const n=i(51).AccessToken,r=i(51).priviledges,o={ATTENDEE:0,PUBLISHER:1,SUBSCRIBER:2,ADMIN:101};e.exports.RtcTokenBuilder=class{static buildTokenWithUid(e,t,i,n,r,o){return this.buildTokenWithAccount(e,t,i,n,r,o)}static buildTokenWithAccount(e,t,i,s,a,c){return this.key=new n(e,t,i,s),this.key.addPriviledge(r.kJoinChannel,c),a!=o.ATTENDEE&&a!=o.PUBLISHER&&a!=o.ADMIN||(this.key.addPriviledge(r.kPublishAudioStream,c),this.key.addPriviledge(r.kPublishVideoStream,c),this.key.addPriviledge(r.kPublishDataStream,c)),this.key.build()}},e.exports.Role=o},function(e,t,i){"use strict";var n=i(3).Buffer,r=i(164).Transform;function o(e){r.call(this),this._block=n.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}i(2)(o,r),o.prototype._transform=function(e,t,i){var n=null;try{this.update(e,t)}catch(r){n=r}i(n)},o.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(i){t=i}e(t)},o.prototype.update=function(e,t){if(function(e,t){if(!n.isBuffer(e)&&"string"!==typeof e)throw new TypeError(t+" must be a string or a buffer")}(e,"Data"),this._finalized)throw new Error("Digest already called");n.isBuffer(e)||(e=n.from(e,t));for(var i=this._block,r=0;this._blockOffset+e.length-r>=this._blockSize;){for(var o=this._blockOffset;o<this._blockSize;)i[o++]=e[r++];this._update(),this._blockOffset=0}for(;r<e.length;)i[this._blockOffset++]=e[r++];for(var s=0,a=8*e.length;a>0;++s)this._length[s]+=a,(a=this._length[s]/4294967296|0)>0&&(this._length[s]-=4294967296*a);return this},o.prototype._update=function(){throw new Error("_update is not implemented")},o.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var i=0;i<4;++i)this._length[i]=0;return t},o.prototype._digest=function(){throw new Error("_digest is not implemented")},e.exports=o},function(e,t,i){"use strict";(function(t,n){var r;e.exports=R,R.ReadableState=T;i(24).EventEmitter;var o=function(e,t){return e.listeners(t).length},s=i(89),a=i(7).Buffer,c=("undefined"!==typeof t?t:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};var u,d=i(165);u=d&&d.debuglog?d.debuglog("stream"):function(){};var l,h,f,p=i(166),m=i(90),_=i(91).getHighWaterMark,g=i(32).codes,v=g.ERR_INVALID_ARG_TYPE,E=g.ERR_STREAM_PUSH_AFTER_EOF,b=g.ERR_METHOD_NOT_IMPLEMENTED,y=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;i(2)(R,s);var w=m.errorOrDestroy,S=["error","close","destroy","pause","resume"];function T(e,t,n){r=r||i(33),e=e||{},"boolean"!==typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=_(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(l||(l=i(25).StringDecoder),this.decoder=new l(e.encoding),this.encoding=e.encoding)}function R(e){if(r=r||i(33),!(this instanceof R))return new R(e);var t=this instanceof r;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function C(e,t,i,n,r){u("readableAddChunk",t);var o,s=e._readableState;if(null===t)s.reading=!1,function(e,t){if(u("onEofChunk"),t.ended)return;if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,t.sync?M(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,N(e)))}(e,s);else if(r||(o=function(e,t){var i;n=t,a.isBuffer(n)||n instanceof c||"string"===typeof t||void 0===t||e.objectMode||(i=new v("chunk",["string","Buffer","Uint8Array"],t));var n;return i}(s,t)),o)w(e,o);else if(s.objectMode||t&&t.length>0)if("string"===typeof t||s.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),n)s.endEmitted?w(e,new y):I(e,s,t,!0);else if(s.ended)w(e,new E);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!i?(t=s.decoder.write(t),s.objectMode||0!==t.length?I(e,s,t,!1):k(e,s)):I(e,s,t,!1)}else n||(s.reading=!1,k(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function I(e,t,i,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",i)):(t.length+=t.objectMode?1:i.length,n?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&M(e)),k(e,t)}Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),R.prototype.destroy=m.destroy,R.prototype._undestroy=m.undestroy,R.prototype._destroy=function(e,t){t(e)},R.prototype.push=function(e,t){var i,n=this._readableState;return n.objectMode?i=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=a.from(e,t),t=""),i=!0),C(this,e,t,!1,i)},R.prototype.unshift=function(e){return C(this,e,null,!0,!1)},R.prototype.isPaused=function(){return!1===this._readableState.flowing},R.prototype.setEncoding=function(e){l||(l=i(25).StringDecoder);var t=new l(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,r="";null!==n;)r+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var A=1073741824;function O(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function M(e){var t=e._readableState;u("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(u("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(N,e))}function N(e){var t=e._readableState;u("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,U(e)}function k(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(P,e,t))}function P(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var i=t.length;if(u("maybeReadMore read 0"),e.read(0),i===t.length)break}t.readingMore=!1}function D(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function L(e){u("readable nexttick read 0"),e.read(0)}function x(e,t){u("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),U(e),t.flowing&&!t.reading&&e.read(0)}function U(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function V(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):i=t.buffer.consume(e,t.decoder),i);var i}function B(e){var t=e._readableState;u("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(u("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var i=t._writableState;(!i||i.autoDestroy&&i.finished)&&t.destroy()}}function F(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}R.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?B(this):M(this),null;if(0===(e=O(e,t))&&t.ended)return 0===t.length&&B(this),null;var n,r=t.needReadable;return u("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",r=!0),t.ended||t.reading?u("reading or ended",r=!1):r&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=O(i,t))),null===(n=e>0?V(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&B(this)),null!==n&&this.emit("data",n),n},R.prototype._read=function(e){w(this,new b("_read()"))},R.prototype.pipe=function(e,t){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,u("pipe count=%d opts=%j",r.pipesCount,t);var s=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?c:_;function a(t,n){u("onunpipe"),t===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,u("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",d),e.removeListener("error",f),e.removeListener("unpipe",a),i.removeListener("end",c),i.removeListener("end",_),i.removeListener("data",h),l=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function c(){u("onend"),e.end()}r.endEmitted?n.nextTick(s):i.once("end",s),e.on("unpipe",a);var d=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,U(e))}}(i);e.on("drain",d);var l=!1;function h(t){u("ondata");var n=e.write(t);u("dest.write",n),!1===n&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==F(r.pipes,e))&&!l&&(u("false write response, pause",r.awaitDrain),r.awaitDrain++),i.pause())}function f(t){u("onerror",t),_(),e.removeListener("error",f),0===o(e,"error")&&w(e,t)}function p(){e.removeListener("finish",m),_()}function m(){u("onfinish"),e.removeListener("close",p),_()}function _(){u("unpipe"),i.unpipe(e)}return i.on("data",h),function(e,t,i){if("function"===typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(e,"error",f),e.once("close",p),e.once("finish",m),e.emit("pipe",i),r.flowing||(u("pipe resume"),i.resume()),e},R.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=F(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},R.prototype.on=function(e,t){var i=s.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,u("on readable",r.length,r.reading),r.length?M(this):r.reading||n.nextTick(L,this))),i},R.prototype.addListener=R.prototype.on,R.prototype.removeListener=function(e,t){var i=s.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(D,this),i},R.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(D,this),t},R.prototype.resume=function(){var e=this._readableState;return e.flowing||(u("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(x,e,t))}(this,e)),e.paused=!1,this},R.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},R.prototype.wrap=function(e){var t=this,i=this._readableState,n=!1;for(var r in e.on("end",(function(){if(u("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(r){(u("wrapped data"),i.decoder&&(r=i.decoder.write(r)),!i.objectMode||null!==r&&void 0!==r)&&((i.objectMode||r&&r.length)&&(t.push(r)||(n=!0,e.pause())))})),e)void 0===this[r]&&"function"===typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var o=0;o<S.length;o++)e.on(S[o],this.emit.bind(this,S[o]));return this._read=function(t){u("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(R.prototype[Symbol.asyncIterator]=function(){return void 0===h&&(h=i(168)),h(this)}),Object.defineProperty(R.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(R.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(R.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),R._fromList=V,Object.defineProperty(R.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(R.from=function(e,t){return void 0===f&&(f=i(169)),f(R,e,t)})}).call(this,i(9),i(6))},function(e,t,i){e.exports=i(24).EventEmitter},function(e,t,i){"use strict";(function(t){function i(e,t){r(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,o){var s=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(o?o(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(r,this,e)):t.nextTick(r,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!o&&e?s._writableState?s._writableState.errorEmitted?t.nextTick(n,s):(s._writableState.errorEmitted=!0,t.nextTick(i,s,e)):t.nextTick(i,s,e):o?(t.nextTick(n,s),o(e)):t.nextTick(n,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var i=e._readableState,n=e._writableState;i&&i.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,i(6))},function(e,t,i){"use strict";var n=i(32).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,i,r){var o=function(e,t,i){return null!=e.highWaterMark?e.highWaterMark:t?e[i]:null}(t,r,i);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new n(r?i:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},function(e,t,i){"use strict";(function(t,n){function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var n=e.entry;e.entry=null;for(;n;){var r=n.callback;t.pendingcb--,r(i),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var o;e.exports=R,R.WritableState=T;var s={deprecate:i(63)},a=i(89),c=i(7).Buffer,u=("undefined"!==typeof t?t:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};var d,l=i(90),h=i(91).getHighWaterMark,f=i(32).codes,p=f.ERR_INVALID_ARG_TYPE,m=f.ERR_METHOD_NOT_IMPLEMENTED,_=f.ERR_MULTIPLE_CALLBACK,g=f.ERR_STREAM_CANNOT_PIPE,v=f.ERR_STREAM_DESTROYED,E=f.ERR_STREAM_NULL_VALUES,b=f.ERR_STREAM_WRITE_AFTER_END,y=f.ERR_UNKNOWN_ENCODING,w=l.errorOrDestroy;function S(){}function T(e,t,s){o=o||i(33),e=e||{},"boolean"!==typeof s&&(s=t instanceof o),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=h(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,r=i.sync,o=i.writecb;if("function"!==typeof o)throw new _;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,r,o){--t.pendingcb,i?(n.nextTick(o,r),n.nextTick(N,e,t),e._writableState.errorEmitted=!0,w(e,r)):(o(r),e._writableState.errorEmitted=!0,w(e,r),N(e,t))}(e,i,r,t,o);else{var s=O(i)||e.destroyed;s||i.corked||i.bufferProcessing||!i.bufferedRequest||A(e,i),r?n.nextTick(I,e,i,s,o):I(e,i,s,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function R(e){var t=this instanceof(o=o||i(33));if(!t&&!d.call(R,this))return new R(e);this._writableState=new T(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),a.call(this)}function C(e,t,i,n,r,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):i?e._writev(r,t.onwrite):e._write(r,o,t.onwrite),t.sync=!1}function I(e,t,i,n){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),N(e,t)}function A(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var n=t.bufferedRequestCount,o=new Array(n),s=t.corkedRequestsFree;s.entry=i;for(var a=0,c=!0;i;)o[a]=i,i.isBuf||(c=!1),i=i.next,a+=1;o.allBuffers=c,C(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;i;){var u=i.chunk,d=i.encoding,l=i.callback;if(C(e,t,!1,t.objectMode?1:u.length,u,d,l),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function M(e,t){e._final((function(i){t.pendingcb--,i&&w(e,i),t.prefinished=!0,e.emit("prefinish"),N(e,t)}))}function N(e,t){var i=O(t);if(i&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(M,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return i}i(2)(R,a),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(R,Symbol.hasInstance,{value:function(e){return!!d.call(this,e)||this===R&&(e&&e._writableState instanceof T)}})):d=function(e){return e instanceof this},R.prototype.pipe=function(){w(this,new g)},R.prototype.write=function(e,t,i){var r,o=this._writableState,s=!1,a=!o.objectMode&&(r=e,c.isBuffer(r)||r instanceof u);return a&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"===typeof t&&(i=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!==typeof i&&(i=S),o.ending?function(e,t){var i=new b;w(e,i),n.nextTick(t,i)}(this,i):(a||function(e,t,i,r){var o;return null===i?o=new E:"string"===typeof i||t.objectMode||(o=new p("chunk",["string","Buffer"],i)),!o||(w(e,o),n.nextTick(r,o),!1)}(this,o,e,i))&&(o.pendingcb++,s=function(e,t,i,n,r,o){if(!i){var s=function(e,t,i){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=c.from(t,i));return t}(t,n,r);n!==s&&(i=!0,r="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var d=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:o,next:null},d?d.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,a,n,r,o);return u}(this,o,a,e,t,i)),s},R.prototype.cork=function(){this._writableState.corked++},R.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||A(this,e))},R.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new y(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(R.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(R.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),R.prototype._write=function(e,t,i){i(new m("_write()"))},R.prototype._writev=null,R.prototype.end=function(e,t,i){var r=this._writableState;return"function"===typeof e?(i=e,e=null,t=null):"function"===typeof t&&(i=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,i){t.ending=!0,N(e,t),i&&(t.finished?n.nextTick(i):e.once("finish",i));t.ended=!0,e.writable=!1}(this,r,i),this},Object.defineProperty(R.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),R.prototype.destroy=l.destroy,R.prototype._undestroy=l.undestroy,R.prototype._destroy=function(e,t){t(e)}}).call(this,i(9),i(6))},function(e,t,i){"use strict";e.exports=d;var n=i(32).codes,r=n.ERR_METHOD_NOT_IMPLEMENTED,o=n.ERR_MULTIPLE_CALLBACK,s=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,c=i(33);function u(e,t){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(null===n)return this.emit("error",new o);i.writechunk=null,i.writecb=null,null!=t&&this.push(t),n(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function d(e){if(!(this instanceof d))return new d(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",l)}function l(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,i){h(e,t,i)}))}function h(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new a;if(e._transformState.transforming)throw new s;return e.push(null)}i(2)(d,c),d.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},d.prototype._transform=function(e,t,i){i(new r("_transform()"))},d.prototype._write=function(e,t,i){var n=this._transformState;if(n.writecb=i,n.writechunk=e,n.writeencoding=t,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},d.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},d.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,i){var n=i(2),r=i(34),o=i(3).Buffer,s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],a=new Array(64);function c(){this.init(),this._w=a,r.call(this,64,56)}function u(e,t,i){return i^e&(t^i)}function d(e,t,i){return e&t|i&(e|t)}function l(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function h(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function f(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}n(c,r),c.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},c.prototype._update=function(e){for(var t,i=this._w,n=0|this._a,r=0|this._b,o=0|this._c,a=0|this._d,c=0|this._e,p=0|this._f,m=0|this._g,_=0|this._h,g=0;g<16;++g)i[g]=e.readInt32BE(4*g);for(;g<64;++g)i[g]=0|(((t=i[g-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+i[g-7]+f(i[g-15])+i[g-16];for(var v=0;v<64;++v){var E=_+h(c)+u(c,p,m)+s[v]+i[v]|0,b=l(n)+d(n,r,o)|0;_=m,m=p,p=c,c=a+E|0,a=o,o=r,r=n,n=E+b|0}this._a=n+this._a|0,this._b=r+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=c+this._e|0,this._f=p+this._f|0,this._g=m+this._g|0,this._h=_+this._h|0},c.prototype._hash=function(){var e=o.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=c},function(e,t,i){var n=i(2),r=i(34),o=i(3).Buffer,s=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],a=new Array(160);function c(){this.init(),this._w=a,r.call(this,128,112)}function u(e,t,i){return i^e&(t^i)}function d(e,t,i){return e&t|i&(e|t)}function l(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function h(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function f(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function _(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function g(e,t){return e>>>0<t>>>0?1:0}n(c,r),c.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},c.prototype._update=function(e){for(var t=this._w,i=0|this._ah,n=0|this._bh,r=0|this._ch,o=0|this._dh,a=0|this._eh,c=0|this._fh,v=0|this._gh,E=0|this._hh,b=0|this._al,y=0|this._bl,w=0|this._cl,S=0|this._dl,T=0|this._el,R=0|this._fl,C=0|this._gl,I=0|this._hl,A=0;A<32;A+=2)t[A]=e.readInt32BE(4*A),t[A+1]=e.readInt32BE(4*A+4);for(;A<160;A+=2){var O=t[A-30],M=t[A-30+1],N=f(O,M),k=p(M,O),P=m(O=t[A-4],M=t[A-4+1]),D=_(M,O),L=t[A-14],x=t[A-14+1],U=t[A-32],V=t[A-32+1],B=k+x|0,j=N+L+g(B,k)|0;j=(j=j+P+g(B=B+D|0,D)|0)+U+g(B=B+V|0,V)|0,t[A]=j,t[A+1]=B}for(var F=0;F<160;F+=2){j=t[F],B=t[F+1];var W=d(i,n,r),G=d(b,y,w),H=l(i,b),q=l(b,i),K=h(a,T),z=h(T,a),Y=s[F],J=s[F+1],X=u(a,c,v),Q=u(T,R,C),Z=I+z|0,$=E+K+g(Z,I)|0;$=($=($=$+X+g(Z=Z+Q|0,Q)|0)+Y+g(Z=Z+J|0,J)|0)+j+g(Z=Z+B|0,B)|0;var ee=q+G|0,te=H+W+g(ee,q)|0;E=v,I=C,v=c,C=R,c=a,R=T,a=o+$+g(T=S+Z|0,S)|0,o=r,S=w,r=n,w=y,n=i,y=b,i=$+te+g(b=Z+ee|0,Z)|0}this._al=this._al+b|0,this._bl=this._bl+y|0,this._cl=this._cl+w|0,this._dl=this._dl+S|0,this._el=this._el+T|0,this._fl=this._fl+R|0,this._gl=this._gl+C|0,this._hl=this._hl+I|0,this._ah=this._ah+i+g(this._al,b)|0,this._bh=this._bh+n+g(this._bl,y)|0,this._ch=this._ch+r+g(this._cl,w)|0,this._dh=this._dh+o+g(this._dl,S)|0,this._eh=this._eh+a+g(this._el,T)|0,this._fh=this._fh+c+g(this._fl,R)|0,this._gh=this._gh+v+g(this._gl,C)|0,this._hh=this._hh+E+g(this._hl,I)|0},c.prototype._hash=function(){var e=o.allocUnsafe(64);function t(t,i,n){e.writeInt32BE(t,n),e.writeInt32BE(i,n+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=c},function(e,t,i){"use strict";(function(t,n){var r=i(52);e.exports=E;var o,s=i(177);E.ReadableState=v;i(24).EventEmitter;var a=function(e,t){return e.listeners(t).length},c=i(97),u=i(68).Buffer,d=("undefined"!==typeof t?t:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};var l=Object.create(i(42));l.inherits=i(2);var h=i(178),f=void 0;f=h&&h.debuglog?h.debuglog("stream"):function(){};var p,m=i(179),_=i(98);l.inherits(E,c);var g=["error","close","destroy","pause","resume"];function v(e,t){e=e||{};var n=t instanceof(o=o||i(26));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,s=e.readableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(s||0===s)?s:a,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=i(25).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function E(e){if(o=o||i(26),!(this instanceof E))return new E(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),c.call(this)}function b(e,t,i,n,r){var o,s=e._readableState;null===t?(s.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,T(e)}(e,s)):(r||(o=function(e,t){var i;n=t,u.isBuffer(n)||n instanceof d||"string"===typeof t||void 0===t||e.objectMode||(i=new TypeError("Invalid non-string/buffer chunk"));var n;return i}(s,t)),o?e.emit("error",o):s.objectMode||t&&t.length>0?("string"===typeof t||s.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),n?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):y(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!i?(t=s.decoder.write(t),s.objectMode||0!==t.length?y(e,s,t,!1):C(e,s)):y(e,s,t,!1))):n||(s.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(s)}function y(e,t,i,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",i),e.read(0)):(t.length+=t.objectMode?1:i.length,n?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&T(e)),C(e,t)}Object.defineProperty(E.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),E.prototype.destroy=_.destroy,E.prototype._undestroy=_.undestroy,E.prototype._destroy=function(e,t){this.push(null),t(e)},E.prototype.push=function(e,t){var i,n=this._readableState;return n.objectMode?i=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=u.from(e,t),t=""),i=!0),b(this,e,t,!1,i)},E.prototype.unshift=function(e){return b(this,e,null,!0,!1)},E.prototype.isPaused=function(){return!1===this._readableState.flowing},E.prototype.setEncoding=function(e){return p||(p=i(25).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var w=8388608;function S(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=w?e=w:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function T(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?r.nextTick(R,e):R(e))}function R(e){f("emit readable"),e.emit("readable"),M(e)}function C(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(I,e,t))}function I(e,t){for(var i=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),i!==t.length);)i=t.length;t.readingMore=!1}function A(e){f("readable nexttick read 0"),e.read(0)}function O(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),M(e),t.flowing&&!t.reading&&e.read(0)}function M(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function N(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):i=function(e,t,i){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():i?function(e,t){var i=t.head,n=1,r=i.data;e-=r.length;for(;i=i.next;){var o=i.data,s=e>o.length?o.length:e;if(s===o.length?r+=o:r+=o.slice(0,e),0===(e-=s)){s===o.length?(++n,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=o.slice(s));break}++n}return t.length-=n,r}(e,t):function(e,t){var i=u.allocUnsafe(e),n=t.head,r=1;n.data.copy(i),e-=n.data.length;for(;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(i,i.length-e,0,s),0===(e-=s)){s===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++r}return t.length-=r,i}(e,t);return n}(e,t.buffer,t.decoder),i);var i}function k(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,r.nextTick(P,t,e))}function P(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function D(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}E.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?k(this):T(this),null;if(0===(e=S(e,t))&&t.ended)return 0===t.length&&k(this),null;var n,r=t.needReadable;return f("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",r=!0),t.ended||t.reading?f("reading or ended",r=!1):r&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=S(i,t))),null===(n=e>0?N(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&k(this)),null!==n&&this.emit("data",n),n},E.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},E.prototype.pipe=function(e,t){var i=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,f("pipe count=%d opts=%j",o.pipesCount,t);var c=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?d:E;function u(t,n){f("onunpipe"),t===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,f("cleanup"),e.removeListener("close",g),e.removeListener("finish",v),e.removeListener("drain",l),e.removeListener("error",_),e.removeListener("unpipe",u),i.removeListener("end",d),i.removeListener("end",E),i.removeListener("data",m),h=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||l())}function d(){f("onend"),e.end()}o.endEmitted?r.nextTick(c):i.once("end",c),e.on("unpipe",u);var l=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,M(e))}}(i);e.on("drain",l);var h=!1;var p=!1;function m(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==D(o.pipes,e))&&!h&&(f("false write response, pause",o.awaitDrain),o.awaitDrain++,p=!0),i.pause())}function _(t){f("onerror",t),E(),e.removeListener("error",_),0===a(e,"error")&&e.emit("error",t)}function g(){e.removeListener("finish",v),E()}function v(){f("onfinish"),e.removeListener("close",g),E()}function E(){f("unpipe"),i.unpipe(e)}return i.on("data",m),function(e,t,i){if("function"===typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?s(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(e,"error",_),e.once("close",g),e.once("finish",v),e.emit("pipe",i),o.flowing||(f("pipe resume"),i.resume()),e},E.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=D(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},E.prototype.on=function(e,t){var i=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&T(this):r.nextTick(A,this))}return i},E.prototype.addListener=E.prototype.on,E.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(O,e,t))}(this,e)),this},E.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},E.prototype.wrap=function(e){var t=this,i=this._readableState,n=!1;for(var r in e.on("end",(function(){if(f("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(r){(f("wrapped data"),i.decoder&&(r=i.decoder.write(r)),!i.objectMode||null!==r&&void 0!==r)&&((i.objectMode||r&&r.length)&&(t.push(r)||(n=!0,e.pause())))})),e)void 0===this[r]&&"function"===typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var o=0;o<g.length;o++)e.on(g[o],this.emit.bind(this,g[o]));return this._read=function(t){f("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(E.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),E._fromList=N}).call(this,i(9),i(6))},function(e,t,i){e.exports=i(24).EventEmitter},function(e,t,i){"use strict";var n=i(52);function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var i=this,o=this._readableState&&this._readableState.destroyed,s=this._writableState&&this._writableState.destroyed;return o||s?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(r,this,e)):n.nextTick(r,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?i._writableState?i._writableState.errorEmitted||(i._writableState.errorEmitted=!0,n.nextTick(r,i,e)):n.nextTick(r,i,e):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,i){"use strict";e.exports=s;var n=i(26),r=Object.create(i(42));function o(e,t){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,null!=t&&this.push(t),n(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function s(e){if(!(this instanceof s))return new s(e);n.call(this,e),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",a)}function a(){var e=this;"function"===typeof this._flush?this._flush((function(t,i){c(e,t,i)})):c(this,null,null)}function c(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}r.inherits=i(2),r.inherits(s,n),s.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},s.prototype._transform=function(e,t,i){throw new Error("_transform() is not implemented")},s.prototype._write=function(e,t,i){var n=this._transformState;if(n.writecb=i,n.writechunk=e,n.writeencoding=t,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},s.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},s.prototype._destroy=function(e,t){var i=this;n.prototype._destroy.call(this,e,(function(e){t(e),i.emit("close")}))}},function(e,t,i){"use strict";var n=i(2),r=i(188),o=i(23),s=i(3).Buffer,a=i(101),c=i(65),u=i(66),d=s.alloc(128);function l(e,t){o.call(this,"digest"),"string"===typeof t&&(t=s.from(t));var i="sha512"===e||"sha384"===e?128:64;(this._alg=e,this._key=t,t.length>i)?t=("rmd160"===e?new c:u(e)).update(t).digest():t.length<i&&(t=s.concat([t,d],i));for(var n=this._ipad=s.allocUnsafe(i),r=this._opad=s.allocUnsafe(i),a=0;a<i;a++)n[a]=54^t[a],r[a]=92^t[a];this._hash="rmd160"===e?new c:u(e),this._hash.update(n)}n(l,o),l.prototype._update=function(e){this._hash.update(e)},l.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new c:u(this._alg)).update(this._opad).update(e).digest()},e.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new l("rmd160",t):"md5"===e?new r(a,t):new l(e,t)}},function(e,t,i){var n=i(62);e.exports=function(e){return(new n).update(e).digest()}},function(e){e.exports=JSON.parse('{"sha224WithRSAEncryption":{"sign":"rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"RSA-SHA224":{"sign":"ecdsa/rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"sha256WithRSAEncryption":{"sign":"rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"RSA-SHA256":{"sign":"ecdsa/rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"sha384WithRSAEncryption":{"sign":"rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"RSA-SHA384":{"sign":"ecdsa/rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"sha512WithRSAEncryption":{"sign":"rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA512":{"sign":"ecdsa/rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA1":{"sign":"rsa","hash":"sha1","id":"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{"sign":"ecdsa","hash":"sha1","id":""},"sha256":{"sign":"ecdsa","hash":"sha256","id":""},"sha224":{"sign":"ecdsa","hash":"sha224","id":""},"sha384":{"sign":"ecdsa","hash":"sha384","id":""},"sha512":{"sign":"ecdsa","hash":"sha512","id":""},"DSA-SHA":{"sign":"dsa","hash":"sha1","id":""},"DSA-SHA1":{"sign":"dsa","hash":"sha1","id":""},"DSA":{"sign":"dsa","hash":"sha1","id":""},"DSA-WITH-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-WITH-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-WITH-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-WITH-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-RIPEMD160":{"sign":"dsa","hash":"rmd160","id":""},"ripemd160WithRSA":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"RSA-RIPEMD160":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"md5WithRSAEncryption":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"},"RSA-MD5":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"}}')},function(e,t,i){t.pbkdf2=i(190),t.pbkdf2Sync=i(106)},function(e,t){var i=Math.pow(2,30)-1;e.exports=function(e,t){if("number"!==typeof e)throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if("number"!==typeof t)throw new TypeError("Key length not a number");if(t<0||t>i||t!==t)throw new TypeError("Bad key length")}},function(e,t,i){(function(t,i){var n;if(t.process&&t.process.browser)n="utf-8";else if(t.process&&t.process.version){n=parseInt(i.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary"}else n="utf-8";e.exports=n}).call(this,i(9),i(6))},function(e,t,i){var n=i(101),r=i(65),o=i(66),s=i(3).Buffer,a=i(104),c=i(105),u=i(107),d=s.alloc(128),l={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function h(e,t,i){var a=function(e){function t(t){return o(e).update(t).digest()}function i(e){return(new r).update(e).digest()}return"rmd160"===e||"ripemd160"===e?i:"md5"===e?n:t}(e),c="sha512"===e||"sha384"===e?128:64;t.length>c?t=a(t):t.length<c&&(t=s.concat([t,d],c));for(var u=s.allocUnsafe(c+l[e]),h=s.allocUnsafe(c+l[e]),f=0;f<c;f++)u[f]=54^t[f],h[f]=92^t[f];var p=s.allocUnsafe(c+i+4);u.copy(p,0,0,c),this.ipad1=p,this.ipad2=u,this.opad=h,this.alg=e,this.blocksize=c,this.hash=a,this.size=l[e]}h.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},e.exports=function(e,t,i,n,r){a(i,n);var o=new h(r=r||"sha1",e=u(e,c,"Password"),(t=u(t,c,"Salt")).length),d=s.allocUnsafe(n),f=s.allocUnsafe(t.length+4);t.copy(f,0,0,t.length);for(var p=0,m=l[r],_=Math.ceil(n/m),g=1;g<=_;g++){f.writeUInt32BE(g,t.length);for(var v=o.run(f,o.ipad1),E=v,b=1;b<i;b++){E=o.run(E,o.ipad2);for(var y=0;y<m;y++)v[y]^=E[y]}v.copy(d,p),p+=m}return d}},function(e,t,i){var n=i(3).Buffer;e.exports=function(e,t,i){if(n.isBuffer(e))return e;if("string"===typeof e)return n.from(e,t);if(ArrayBuffer.isView(e))return n.from(e.buffer);throw new TypeError(i+" must be a string, a Buffer, a typed array or a DataView")}},function(e,t,i){"use strict";t.readUInt32BE=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},t.writeUInt32BE=function(e,t,i){e[0+i]=t>>>24,e[1+i]=t>>>16&255,e[2+i]=t>>>8&255,e[3+i]=255&t},t.ip=function(e,t,i,n){for(var r=0,o=0,s=6;s>=0;s-=2){for(var a=0;a<=24;a+=8)r<<=1,r|=t>>>a+s&1;for(a=0;a<=24;a+=8)r<<=1,r|=e>>>a+s&1}for(s=6;s>=0;s-=2){for(a=1;a<=25;a+=8)o<<=1,o|=t>>>a+s&1;for(a=1;a<=25;a+=8)o<<=1,o|=e>>>a+s&1}i[n+0]=r>>>0,i[n+1]=o>>>0},t.rip=function(e,t,i,n){for(var r=0,o=0,s=0;s<4;s++)for(var a=24;a>=0;a-=8)r<<=1,r|=t>>>a+s&1,r<<=1,r|=e>>>a+s&1;for(s=4;s<8;s++)for(a=24;a>=0;a-=8)o<<=1,o|=t>>>a+s&1,o<<=1,o|=e>>>a+s&1;i[n+0]=r>>>0,i[n+1]=o>>>0},t.pc1=function(e,t,i,n){for(var r=0,o=0,s=7;s>=5;s--){for(var a=0;a<=24;a+=8)r<<=1,r|=t>>a+s&1;for(a=0;a<=24;a+=8)r<<=1,r|=e>>a+s&1}for(a=0;a<=24;a+=8)r<<=1,r|=t>>a+s&1;for(s=1;s<=3;s++){for(a=0;a<=24;a+=8)o<<=1,o|=t>>a+s&1;for(a=0;a<=24;a+=8)o<<=1,o|=e>>a+s&1}for(a=0;a<=24;a+=8)o<<=1,o|=e>>a+s&1;i[n+0]=r>>>0,i[n+1]=o>>>0},t.r28shl=function(e,t){return e<<t&268435455|e>>>28-t};var n=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];t.pc2=function(e,t,i,r){for(var o=0,s=0,a=n.length>>>1,c=0;c<a;c++)o<<=1,o|=e>>>n[c]&1;for(c=a;c<n.length;c++)s<<=1,s|=t>>>n[c]&1;i[r+0]=o>>>0,i[r+1]=s>>>0},t.expand=function(e,t,i){var n=0,r=0;n=(1&e)<<5|e>>>27;for(var o=23;o>=15;o-=4)n<<=6,n|=e>>>o&63;for(o=11;o>=3;o-=4)r|=e>>>o&63,r<<=6;r|=(31&e)<<1|e>>>31,t[i+0]=n>>>0,t[i+1]=r>>>0};var r=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];t.substitute=function(e,t){for(var i=0,n=0;n<4;n++){i<<=4,i|=r[64*n+(e>>>18-6*n&63)]}for(n=0;n<4;n++){i<<=4,i|=r[256+64*n+(t>>>18-6*n&63)]}return i>>>0};var o=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];t.permute=function(e){for(var t=0,i=0;i<o.length;i++)t<<=1,t|=e>>>o[i]&1;return t>>>0},t.padSplit=function(e,t,i){for(var n=e.toString(2);n.length<t;)n="0"+n;for(var r=[],o=0;o<t;o+=i)r.push(n.slice(o,o+i));return r.join(" ")}},function(e,t,i){"use strict";var n=i(11),r=i(2),o=i(108),s=i(70);function a(){this.tmp=new Array(2),this.keys=null}function c(e){s.call(this,e);var t=new a;this._desState=t,this.deriveKeys(t,e.key)}r(c,s),e.exports=c,c.create=function(e){return new c(e)};var u=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];c.prototype.deriveKeys=function(e,t){e.keys=new Array(32),n.equal(t.length,this.blockSize,"Invalid key length");var i=o.readUInt32BE(t,0),r=o.readUInt32BE(t,4);o.pc1(i,r,e.tmp,0),i=e.tmp[0],r=e.tmp[1];for(var s=0;s<e.keys.length;s+=2){var a=u[s>>>1];i=o.r28shl(i,a),r=o.r28shl(r,a),o.pc2(i,r,e.keys,s)}},c.prototype._update=function(e,t,i,n){var r=this._desState,s=o.readUInt32BE(e,t),a=o.readUInt32BE(e,t+4);o.ip(s,a,r.tmp,0),s=r.tmp[0],a=r.tmp[1],"encrypt"===this.type?this._encrypt(r,s,a,r.tmp,0):this._decrypt(r,s,a,r.tmp,0),s=r.tmp[0],a=r.tmp[1],o.writeUInt32BE(i,s,n),o.writeUInt32BE(i,a,n+4)},c.prototype._pad=function(e,t){if(!1===this.padding)return!1;for(var i=e.length-t,n=t;n<e.length;n++)e[n]=i;return!0},c.prototype._unpad=function(e){if(!1===this.padding)return e;for(var t=e[e.length-1],i=e.length-t;i<e.length;i++)n.equal(e[i],t);return e.slice(0,e.length-t)},c.prototype._encrypt=function(e,t,i,n,r){for(var s=t,a=i,c=0;c<e.keys.length;c+=2){var u=e.keys[c],d=e.keys[c+1];o.expand(a,e.tmp,0),u^=e.tmp[0],d^=e.tmp[1];var l=o.substitute(u,d),h=a;a=(s^o.permute(l))>>>0,s=h}o.rip(a,s,n,r)},c.prototype._decrypt=function(e,t,i,n,r){for(var s=i,a=t,c=e.keys.length-2;c>=0;c-=2){var u=e.keys[c],d=e.keys[c+1];o.expand(s,e.tmp,0),u^=e.tmp[0],d^=e.tmp[1];var l=o.substitute(u,d),h=s;s=(a^o.permute(l))>>>0,a=h}o.rip(s,a,n,r)}},function(e,t,i){var n=i(43),r=i(3).Buffer,o=i(111);function s(e){var t=e._cipher.encryptBlockRaw(e._prev);return o(e._prev),t}t.encrypt=function(e,t){var i=Math.ceil(t.length/16),o=e._cache.length;e._cache=r.concat([e._cache,r.allocUnsafe(16*i)]);for(var a=0;a<i;a++){var c=s(e),u=o+16*a;e._cache.writeUInt32BE(c[0],u+0),e._cache.writeUInt32BE(c[1],u+4),e._cache.writeUInt32BE(c[2],u+8),e._cache.writeUInt32BE(c[3],u+12)}var d=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),n(t,d)}},function(e,t){e.exports=function(e){for(var t,i=e.length;i--;){if(255!==(t=e.readUInt8(i))){t++,e.writeUInt8(t,i);break}e.writeUInt8(0,i)}}},function(e){e.exports=JSON.parse('{"aes-128-ecb":{"cipher":"AES","key":128,"iv":0,"mode":"ECB","type":"block"},"aes-192-ecb":{"cipher":"AES","key":192,"iv":0,"mode":"ECB","type":"block"},"aes-256-ecb":{"cipher":"AES","key":256,"iv":0,"mode":"ECB","type":"block"},"aes-128-cbc":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes-192-cbc":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes-256-cbc":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes128":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes192":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes256":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes-128-cfb":{"cipher":"AES","key":128,"iv":16,"mode":"CFB","type":"stream"},"aes-192-cfb":{"cipher":"AES","key":192,"iv":16,"mode":"CFB","type":"stream"},"aes-256-cfb":{"cipher":"AES","key":256,"iv":16,"mode":"CFB","type":"stream"},"aes-128-cfb8":{"cipher":"AES","key":128,"iv":16,"mode":"CFB8","type":"stream"},"aes-192-cfb8":{"cipher":"AES","key":192,"iv":16,"mode":"CFB8","type":"stream"},"aes-256-cfb8":{"cipher":"AES","key":256,"iv":16,"mode":"CFB8","type":"stream"},"aes-128-cfb1":{"cipher":"AES","key":128,"iv":16,"mode":"CFB1","type":"stream"},"aes-192-cfb1":{"cipher":"AES","key":192,"iv":16,"mode":"CFB1","type":"stream"},"aes-256-cfb1":{"cipher":"AES","key":256,"iv":16,"mode":"CFB1","type":"stream"},"aes-128-ofb":{"cipher":"AES","key":128,"iv":16,"mode":"OFB","type":"stream"},"aes-192-ofb":{"cipher":"AES","key":192,"iv":16,"mode":"OFB","type":"stream"},"aes-256-ofb":{"cipher":"AES","key":256,"iv":16,"mode":"OFB","type":"stream"},"aes-128-ctr":{"cipher":"AES","key":128,"iv":16,"mode":"CTR","type":"stream"},"aes-192-ctr":{"cipher":"AES","key":192,"iv":16,"mode":"CTR","type":"stream"},"aes-256-ctr":{"cipher":"AES","key":256,"iv":16,"mode":"CTR","type":"stream"},"aes-128-gcm":{"cipher":"AES","key":128,"iv":12,"mode":"GCM","type":"auth"},"aes-192-gcm":{"cipher":"AES","key":192,"iv":12,"mode":"GCM","type":"auth"},"aes-256-gcm":{"cipher":"AES","key":256,"iv":12,"mode":"GCM","type":"auth"}}')},function(e,t,i){var n=i(53),r=i(3).Buffer,o=i(23),s=i(2),a=i(203),c=i(43),u=i(111);function d(e,t,i,s){o.call(this);var c=r.alloc(4,0);this._cipher=new n.AES(t);var d=this._cipher.encryptBlock(c);this._ghash=new a(d),i=function(e,t,i){if(12===t.length)return e._finID=r.concat([t,r.from([0,0,0,1])]),r.concat([t,r.from([0,0,0,2])]);var n=new a(i),o=t.length,s=o%16;n.update(t),s&&(s=16-s,n.update(r.alloc(s,0))),n.update(r.alloc(8,0));var c=8*o,d=r.alloc(8);d.writeUIntBE(c,0,8),n.update(d),e._finID=n.state;var l=r.from(e._finID);return u(l),l}(this,i,d),this._prev=r.from(i),this._cache=r.allocUnsafe(0),this._secCache=r.allocUnsafe(0),this._decrypt=s,this._alen=0,this._len=0,this._mode=e,this._authTag=null,this._called=!1}s(d,o),d.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=r.alloc(t,0),this._ghash.update(t))}this._called=!0;var i=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(i),this._len+=e.length,i},d.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=c(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(e,t){var i=0;e.length!==t.length&&i++;for(var n=Math.min(e.length,t.length),r=0;r<n;++r)i+=e[r]^t[r];return i}(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=e,this._cipher.scrub()},d.prototype.getAuthTag=function(){if(this._decrypt||!r.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},d.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},d.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length},e.exports=d},function(e,t,i){var n=i(53),r=i(3).Buffer,o=i(23);function s(e,t,i,s){o.call(this),this._cipher=new n.AES(t),this._prev=r.from(i),this._cache=r.allocUnsafe(0),this._secCache=r.allocUnsafe(0),this._decrypt=s,this._mode=e}i(2)(s,o),s.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},s.prototype._final=function(){this._cipher.scrub()},e.exports=s},function(e,t,i){var n=i(31);e.exports=v,v.simpleSieve=_,v.fermatTest=g;var r=i(116),o=new r(24),s=new(i(117)),a=new r(1),c=new r(2),u=new r(5),d=(new r(16),new r(8),new r(10)),l=new r(3),h=(new r(7),new r(11)),f=new r(4),p=(new r(12),null);function m(){if(null!==p)return p;var e=[];e[0]=2;for(var t=1,i=3;i<1048576;i+=2){for(var n=Math.ceil(Math.sqrt(i)),r=0;r<t&&e[r]<=n&&i%e[r]!==0;r++);t!==r&&e[r]<=n||(e[t++]=i)}return p=e,e}function _(e){for(var t=m(),i=0;i<t.length;i++)if(0===e.modn(t[i]))return 0===e.cmpn(t[i]);return!0}function g(e){var t=r.mont(e);return 0===c.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function v(e,t){if(e<16)return new r(2===t||5===t?[140,123]:[140,39]);var i,p;for(t=new r(t);;){for(i=new r(n(Math.ceil(e/8)));i.bitLength()>e;)i.ishrn(1);if(i.isEven()&&i.iadd(a),i.testn(1)||i.iadd(c),t.cmp(c)){if(!t.cmp(u))for(;i.mod(d).cmp(l);)i.iadd(f)}else for(;i.mod(o).cmp(h);)i.iadd(f);if(_(p=i.shrn(1))&&_(i)&&g(p)&&g(i)&&s.test(p)&&s.test(i))return i}}},function(e,t,i){(function(e){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function o(e,t,i){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:i(207).Buffer}catch(R){}function a(e,t){var i=e.charCodeAt(t);return i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:i-48&15}function c(e,t,i){var n=a(e,i);return i-1>=t&&(n|=a(e,i-1)<<4),n}function u(e,t,i,n){for(var r=0,o=Math.min(e.length,i),s=t;s<o;s++){var a=e.charCodeAt(s)-48;r*=n,r+=a>=49?a-49+10:a>=17?a-17+10:a}return r}o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,i){if("number"===typeof e)return this._initNumber(e,t,i);if("object"===typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var r=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(r++,this.negative=1),r<e.length&&(16===t?this._parseHex(e,r,i):(this._parseBase(e,t,r),"le"===i&&this._initArray(this.toArray(),t,i)))},o.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},o.prototype._initArray=function(e,t,i){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var o,s,a=0;if("be"===i)for(r=e.length-1,o=0;r>=0;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===i)for(r=0,o=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},o.prototype._parseHex=function(e,t,i){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,o=0,s=0;if("be"===i)for(n=e.length-1;n>=t;n-=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;this.strip()},o.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=t)n++;n--,r=r/t|0;for(var o=e.length-i,s=o%n,a=Math.min(o,o-s)+i,c=0,d=i;d<a;d+=n)c=u(e,d,d+n,t),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var l=1;for(c=u(e,d,e.length,t),d=0;d<s;d++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this.strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(e,t,i){i.negative=t.negative^e.negative;var n=e.length+t.length|0;i.length=n,n=n-1|0;var r=0|e.words[0],o=0|t.words[0],s=r*o,a=67108863&s,c=s/67108864|0;i.words[0]=a;for(var u=1;u<n;u++){for(var d=c>>>26,l=67108863&c,h=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=h;f++){var p=u-f|0;d+=(s=(r=0|e.words[p])*(o=0|t.words[f])+l)/67108864|0,l=67108863&s}i.words[u]=0|l,c=0|d}return 0!==c?i.words[u]=0|c:i.length--,i.strip()}o.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var r=0,o=0,s=0;s<this.length;s++){var a=this.words[s],c=(16777215&(a<<r|o)).toString(16);i=0!==(o=a>>>24-r&16777215)||s!==this.length-1?d[6-c.length]+c+i:c+i,(r+=2)>=26&&(r-=26,s--)}for(0!==o&&(i=o.toString(16)+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=l[e],f=h[e];i="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(f).toString(e);i=(p=p.idivn(f)).isZero()?m+i:d[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(e,t){return n("undefined"!==typeof s),this.toArrayLike(s,e,t)},o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,i){var r=this.byteLength(),o=i||Math.max(1,r);n(r<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,c="le"===t,u=new e(o),d=this.clone();if(c){for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[a]=s;for(;a<o;a++)u[a]=0}else{for(a=0;a<o-r;a++)u[a]=0;for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[o-a-1]=s}return u},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0===(8191&t)&&(i+=13,t>>>=13),0===(127&t)&&(i+=7,t>>>=7),0===(15&t)&&(i+=4,t>>>=4),0===(3&t)&&(i+=2,t>>>=2),0===(1&t)&&i++,i},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var n=0;n<i.length;n++)this.words[n]=t.words[n]^i.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this.strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var i=e/26|0,r=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<r:this.words[i]&~(1<<r),this.strip()},o.prototype.iadd=function(e){var t,i,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,n=e):(i=e,n=this);for(var r=0,o=0;o<n.length;o++)t=(0|i.words[o])+(0|n.words[o])+r,this.words[o]=67108863&t,r=t>>>26;for(;0!==r&&o<i.length;o++)t=(0|i.words[o])+r,this.words[o]=67108863&t,r=t>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,n,r=this.cmp(e);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(i=this,n=e):(i=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|i.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<i.length;s++)o=(t=(0|i.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,i){var n,r,o,s=e.words,a=t.words,c=i.words,u=0,d=0|s[0],l=8191&d,h=d>>>13,f=0|s[1],p=8191&f,m=f>>>13,_=0|s[2],g=8191&_,v=_>>>13,E=0|s[3],b=8191&E,y=E>>>13,w=0|s[4],S=8191&w,T=w>>>13,R=0|s[5],C=8191&R,I=R>>>13,A=0|s[6],O=8191&A,M=A>>>13,N=0|s[7],k=8191&N,P=N>>>13,D=0|s[8],L=8191&D,x=D>>>13,U=0|s[9],V=8191&U,B=U>>>13,j=0|a[0],F=8191&j,W=j>>>13,G=0|a[1],H=8191&G,q=G>>>13,K=0|a[2],z=8191&K,Y=K>>>13,J=0|a[3],X=8191&J,Q=J>>>13,Z=0|a[4],$=8191&Z,ee=Z>>>13,te=0|a[5],ie=8191&te,ne=te>>>13,re=0|a[6],oe=8191&re,se=re>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,de=0|a[8],le=8191&de,he=de>>>13,fe=0|a[9],pe=8191&fe,me=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var _e=(u+(n=Math.imul(l,F))|0)+((8191&(r=(r=Math.imul(l,W))+Math.imul(h,F)|0))<<13)|0;u=((o=Math.imul(h,W))+(r>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(p,F),r=(r=Math.imul(p,W))+Math.imul(m,F)|0,o=Math.imul(m,W);var ge=(u+(n=n+Math.imul(l,H)|0)|0)+((8191&(r=(r=r+Math.imul(l,q)|0)+Math.imul(h,H)|0))<<13)|0;u=((o=o+Math.imul(h,q)|0)+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,F),r=(r=Math.imul(g,W))+Math.imul(v,F)|0,o=Math.imul(v,W),n=n+Math.imul(p,H)|0,r=(r=r+Math.imul(p,q)|0)+Math.imul(m,H)|0,o=o+Math.imul(m,q)|0;var ve=(u+(n=n+Math.imul(l,z)|0)|0)+((8191&(r=(r=r+Math.imul(l,Y)|0)+Math.imul(h,z)|0))<<13)|0;u=((o=o+Math.imul(h,Y)|0)+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,F),r=(r=Math.imul(b,W))+Math.imul(y,F)|0,o=Math.imul(y,W),n=n+Math.imul(g,H)|0,r=(r=r+Math.imul(g,q)|0)+Math.imul(v,H)|0,o=o+Math.imul(v,q)|0,n=n+Math.imul(p,z)|0,r=(r=r+Math.imul(p,Y)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,Y)|0;var Ee=(u+(n=n+Math.imul(l,X)|0)|0)+((8191&(r=(r=r+Math.imul(l,Q)|0)+Math.imul(h,X)|0))<<13)|0;u=((o=o+Math.imul(h,Q)|0)+(r>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(S,F),r=(r=Math.imul(S,W))+Math.imul(T,F)|0,o=Math.imul(T,W),n=n+Math.imul(b,H)|0,r=(r=r+Math.imul(b,q)|0)+Math.imul(y,H)|0,o=o+Math.imul(y,q)|0,n=n+Math.imul(g,z)|0,r=(r=r+Math.imul(g,Y)|0)+Math.imul(v,z)|0,o=o+Math.imul(v,Y)|0,n=n+Math.imul(p,X)|0,r=(r=r+Math.imul(p,Q)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,Q)|0;var be=(u+(n=n+Math.imul(l,$)|0)|0)+((8191&(r=(r=r+Math.imul(l,ee)|0)+Math.imul(h,$)|0))<<13)|0;u=((o=o+Math.imul(h,ee)|0)+(r>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(C,F),r=(r=Math.imul(C,W))+Math.imul(I,F)|0,o=Math.imul(I,W),n=n+Math.imul(S,H)|0,r=(r=r+Math.imul(S,q)|0)+Math.imul(T,H)|0,o=o+Math.imul(T,q)|0,n=n+Math.imul(b,z)|0,r=(r=r+Math.imul(b,Y)|0)+Math.imul(y,z)|0,o=o+Math.imul(y,Y)|0,n=n+Math.imul(g,X)|0,r=(r=r+Math.imul(g,Q)|0)+Math.imul(v,X)|0,o=o+Math.imul(v,Q)|0,n=n+Math.imul(p,$)|0,r=(r=r+Math.imul(p,ee)|0)+Math.imul(m,$)|0,o=o+Math.imul(m,ee)|0;var ye=(u+(n=n+Math.imul(l,ie)|0)|0)+((8191&(r=(r=r+Math.imul(l,ne)|0)+Math.imul(h,ie)|0))<<13)|0;u=((o=o+Math.imul(h,ne)|0)+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(O,F),r=(r=Math.imul(O,W))+Math.imul(M,F)|0,o=Math.imul(M,W),n=n+Math.imul(C,H)|0,r=(r=r+Math.imul(C,q)|0)+Math.imul(I,H)|0,o=o+Math.imul(I,q)|0,n=n+Math.imul(S,z)|0,r=(r=r+Math.imul(S,Y)|0)+Math.imul(T,z)|0,o=o+Math.imul(T,Y)|0,n=n+Math.imul(b,X)|0,r=(r=r+Math.imul(b,Q)|0)+Math.imul(y,X)|0,o=o+Math.imul(y,Q)|0,n=n+Math.imul(g,$)|0,r=(r=r+Math.imul(g,ee)|0)+Math.imul(v,$)|0,o=o+Math.imul(v,ee)|0,n=n+Math.imul(p,ie)|0,r=(r=r+Math.imul(p,ne)|0)+Math.imul(m,ie)|0,o=o+Math.imul(m,ne)|0;var we=(u+(n=n+Math.imul(l,oe)|0)|0)+((8191&(r=(r=r+Math.imul(l,se)|0)+Math.imul(h,oe)|0))<<13)|0;u=((o=o+Math.imul(h,se)|0)+(r>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,F),r=(r=Math.imul(k,W))+Math.imul(P,F)|0,o=Math.imul(P,W),n=n+Math.imul(O,H)|0,r=(r=r+Math.imul(O,q)|0)+Math.imul(M,H)|0,o=o+Math.imul(M,q)|0,n=n+Math.imul(C,z)|0,r=(r=r+Math.imul(C,Y)|0)+Math.imul(I,z)|0,o=o+Math.imul(I,Y)|0,n=n+Math.imul(S,X)|0,r=(r=r+Math.imul(S,Q)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,Q)|0,n=n+Math.imul(b,$)|0,r=(r=r+Math.imul(b,ee)|0)+Math.imul(y,$)|0,o=o+Math.imul(y,ee)|0,n=n+Math.imul(g,ie)|0,r=(r=r+Math.imul(g,ne)|0)+Math.imul(v,ie)|0,o=o+Math.imul(v,ne)|0,n=n+Math.imul(p,oe)|0,r=(r=r+Math.imul(p,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0;var Se=(u+(n=n+Math.imul(l,ce)|0)|0)+((8191&(r=(r=r+Math.imul(l,ue)|0)+Math.imul(h,ce)|0))<<13)|0;u=((o=o+Math.imul(h,ue)|0)+(r>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(L,F),r=(r=Math.imul(L,W))+Math.imul(x,F)|0,o=Math.imul(x,W),n=n+Math.imul(k,H)|0,r=(r=r+Math.imul(k,q)|0)+Math.imul(P,H)|0,o=o+Math.imul(P,q)|0,n=n+Math.imul(O,z)|0,r=(r=r+Math.imul(O,Y)|0)+Math.imul(M,z)|0,o=o+Math.imul(M,Y)|0,n=n+Math.imul(C,X)|0,r=(r=r+Math.imul(C,Q)|0)+Math.imul(I,X)|0,o=o+Math.imul(I,Q)|0,n=n+Math.imul(S,$)|0,r=(r=r+Math.imul(S,ee)|0)+Math.imul(T,$)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(b,ie)|0,r=(r=r+Math.imul(b,ne)|0)+Math.imul(y,ie)|0,o=o+Math.imul(y,ne)|0,n=n+Math.imul(g,oe)|0,r=(r=r+Math.imul(g,se)|0)+Math.imul(v,oe)|0,o=o+Math.imul(v,se)|0,n=n+Math.imul(p,ce)|0,r=(r=r+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,o=o+Math.imul(m,ue)|0;var Te=(u+(n=n+Math.imul(l,le)|0)|0)+((8191&(r=(r=r+Math.imul(l,he)|0)+Math.imul(h,le)|0))<<13)|0;u=((o=o+Math.imul(h,he)|0)+(r>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(V,F),r=(r=Math.imul(V,W))+Math.imul(B,F)|0,o=Math.imul(B,W),n=n+Math.imul(L,H)|0,r=(r=r+Math.imul(L,q)|0)+Math.imul(x,H)|0,o=o+Math.imul(x,q)|0,n=n+Math.imul(k,z)|0,r=(r=r+Math.imul(k,Y)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,Y)|0,n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,Q)|0)+Math.imul(M,X)|0,o=o+Math.imul(M,Q)|0,n=n+Math.imul(C,$)|0,r=(r=r+Math.imul(C,ee)|0)+Math.imul(I,$)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(S,ie)|0,r=(r=r+Math.imul(S,ne)|0)+Math.imul(T,ie)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(b,oe)|0,r=(r=r+Math.imul(b,se)|0)+Math.imul(y,oe)|0,o=o+Math.imul(y,se)|0,n=n+Math.imul(g,ce)|0,r=(r=r+Math.imul(g,ue)|0)+Math.imul(v,ce)|0,o=o+Math.imul(v,ue)|0,n=n+Math.imul(p,le)|0,r=(r=r+Math.imul(p,he)|0)+Math.imul(m,le)|0,o=o+Math.imul(m,he)|0;var Re=(u+(n=n+Math.imul(l,pe)|0)|0)+((8191&(r=(r=r+Math.imul(l,me)|0)+Math.imul(h,pe)|0))<<13)|0;u=((o=o+Math.imul(h,me)|0)+(r>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(V,H),r=(r=Math.imul(V,q))+Math.imul(B,H)|0,o=Math.imul(B,q),n=n+Math.imul(L,z)|0,r=(r=r+Math.imul(L,Y)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,Y)|0,n=n+Math.imul(k,X)|0,r=(r=r+Math.imul(k,Q)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,Q)|0,n=n+Math.imul(O,$)|0,r=(r=r+Math.imul(O,ee)|0)+Math.imul(M,$)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(C,ie)|0,r=(r=r+Math.imul(C,ne)|0)+Math.imul(I,ie)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(S,oe)|0,r=(r=r+Math.imul(S,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,n=n+Math.imul(b,ce)|0,r=(r=r+Math.imul(b,ue)|0)+Math.imul(y,ce)|0,o=o+Math.imul(y,ue)|0,n=n+Math.imul(g,le)|0,r=(r=r+Math.imul(g,he)|0)+Math.imul(v,le)|0,o=o+Math.imul(v,he)|0;var Ce=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(r=(r=r+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((o=o+Math.imul(m,me)|0)+(r>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(V,z),r=(r=Math.imul(V,Y))+Math.imul(B,z)|0,o=Math.imul(B,Y),n=n+Math.imul(L,X)|0,r=(r=r+Math.imul(L,Q)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,Q)|0,n=n+Math.imul(k,$)|0,r=(r=r+Math.imul(k,ee)|0)+Math.imul(P,$)|0,o=o+Math.imul(P,ee)|0,n=n+Math.imul(O,ie)|0,r=(r=r+Math.imul(O,ne)|0)+Math.imul(M,ie)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(C,oe)|0,r=(r=r+Math.imul(C,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(S,ce)|0,r=(r=r+Math.imul(S,ue)|0)+Math.imul(T,ce)|0,o=o+Math.imul(T,ue)|0,n=n+Math.imul(b,le)|0,r=(r=r+Math.imul(b,he)|0)+Math.imul(y,le)|0,o=o+Math.imul(y,he)|0;var Ie=(u+(n=n+Math.imul(g,pe)|0)|0)+((8191&(r=(r=r+Math.imul(g,me)|0)+Math.imul(v,pe)|0))<<13)|0;u=((o=o+Math.imul(v,me)|0)+(r>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(V,X),r=(r=Math.imul(V,Q))+Math.imul(B,X)|0,o=Math.imul(B,Q),n=n+Math.imul(L,$)|0,r=(r=r+Math.imul(L,ee)|0)+Math.imul(x,$)|0,o=o+Math.imul(x,ee)|0,n=n+Math.imul(k,ie)|0,r=(r=r+Math.imul(k,ne)|0)+Math.imul(P,ie)|0,o=o+Math.imul(P,ne)|0,n=n+Math.imul(O,oe)|0,r=(r=r+Math.imul(O,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(C,ce)|0,r=(r=r+Math.imul(C,ue)|0)+Math.imul(I,ce)|0,o=o+Math.imul(I,ue)|0,n=n+Math.imul(S,le)|0,r=(r=r+Math.imul(S,he)|0)+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0;var Ae=(u+(n=n+Math.imul(b,pe)|0)|0)+((8191&(r=(r=r+Math.imul(b,me)|0)+Math.imul(y,pe)|0))<<13)|0;u=((o=o+Math.imul(y,me)|0)+(r>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(V,$),r=(r=Math.imul(V,ee))+Math.imul(B,$)|0,o=Math.imul(B,ee),n=n+Math.imul(L,ie)|0,r=(r=r+Math.imul(L,ne)|0)+Math.imul(x,ie)|0,o=o+Math.imul(x,ne)|0,n=n+Math.imul(k,oe)|0,r=(r=r+Math.imul(k,se)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,se)|0,n=n+Math.imul(O,ce)|0,r=(r=r+Math.imul(O,ue)|0)+Math.imul(M,ce)|0,o=o+Math.imul(M,ue)|0,n=n+Math.imul(C,le)|0,r=(r=r+Math.imul(C,he)|0)+Math.imul(I,le)|0,o=o+Math.imul(I,he)|0;var Oe=(u+(n=n+Math.imul(S,pe)|0)|0)+((8191&(r=(r=r+Math.imul(S,me)|0)+Math.imul(T,pe)|0))<<13)|0;u=((o=o+Math.imul(T,me)|0)+(r>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(V,ie),r=(r=Math.imul(V,ne))+Math.imul(B,ie)|0,o=Math.imul(B,ne),n=n+Math.imul(L,oe)|0,r=(r=r+Math.imul(L,se)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,se)|0,n=n+Math.imul(k,ce)|0,r=(r=r+Math.imul(k,ue)|0)+Math.imul(P,ce)|0,o=o+Math.imul(P,ue)|0,n=n+Math.imul(O,le)|0,r=(r=r+Math.imul(O,he)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,he)|0;var Me=(u+(n=n+Math.imul(C,pe)|0)|0)+((8191&(r=(r=r+Math.imul(C,me)|0)+Math.imul(I,pe)|0))<<13)|0;u=((o=o+Math.imul(I,me)|0)+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(V,oe),r=(r=Math.imul(V,se))+Math.imul(B,oe)|0,o=Math.imul(B,se),n=n+Math.imul(L,ce)|0,r=(r=r+Math.imul(L,ue)|0)+Math.imul(x,ce)|0,o=o+Math.imul(x,ue)|0,n=n+Math.imul(k,le)|0,r=(r=r+Math.imul(k,he)|0)+Math.imul(P,le)|0,o=o+Math.imul(P,he)|0;var Ne=(u+(n=n+Math.imul(O,pe)|0)|0)+((8191&(r=(r=r+Math.imul(O,me)|0)+Math.imul(M,pe)|0))<<13)|0;u=((o=o+Math.imul(M,me)|0)+(r>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(V,ce),r=(r=Math.imul(V,ue))+Math.imul(B,ce)|0,o=Math.imul(B,ue),n=n+Math.imul(L,le)|0,r=(r=r+Math.imul(L,he)|0)+Math.imul(x,le)|0,o=o+Math.imul(x,he)|0;var ke=(u+(n=n+Math.imul(k,pe)|0)|0)+((8191&(r=(r=r+Math.imul(k,me)|0)+Math.imul(P,pe)|0))<<13)|0;u=((o=o+Math.imul(P,me)|0)+(r>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(V,le),r=(r=Math.imul(V,he))+Math.imul(B,le)|0,o=Math.imul(B,he);var Pe=(u+(n=n+Math.imul(L,pe)|0)|0)+((8191&(r=(r=r+Math.imul(L,me)|0)+Math.imul(x,pe)|0))<<13)|0;u=((o=o+Math.imul(x,me)|0)+(r>>>13)|0)+(Pe>>>26)|0,Pe&=67108863;var De=(u+(n=Math.imul(V,pe))|0)+((8191&(r=(r=Math.imul(V,me))+Math.imul(B,pe)|0))<<13)|0;return u=((o=Math.imul(B,me))+(r>>>13)|0)+(De>>>26)|0,De&=67108863,c[0]=_e,c[1]=ge,c[2]=ve,c[3]=Ee,c[4]=be,c[5]=ye,c[6]=we,c[7]=Se,c[8]=Te,c[9]=Re,c[10]=Ce,c[11]=Ie,c[12]=Ae,c[13]=Oe,c[14]=Me,c[15]=Ne,c[16]=ke,c[17]=Pe,c[18]=De,0!==u&&(c[19]=u,i.length++),i};function m(e,t,i){return(new _).mulp(e,t,i)}function _(e,t){this.x=e,this.y=t}Math.imul||(p=f),o.prototype.mulTo=function(e,t){var i,n=this.length+e.length;return i=10===this.length&&10===e.length?p(this,e,t):n<63?f(this,e,t):n<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var n=0,r=0,o=0;o<i.length-1;o++){var s=r;r=0;for(var a=67108863&n,c=Math.min(o,t.length-1),u=Math.max(0,o-e.length+1);u<=c;u++){var d=o-u,l=(0|e.words[d])*(0|t.words[u]),h=67108863&l;a=67108863&(h=h+a|0),r+=(s=(s=s+(l/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}i.words[o]=a,n=s,s=r}return 0!==n?i.words[o]=n:i.length--,i.strip()}(this,e,t):m(this,e,t),i},_.prototype.makeRBT=function(e){for(var t=new Array(e),i=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,i,e);return t},_.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var n=0,r=0;r<t;r++)n|=(1&e)<<t-r-1,e>>=1;return n},_.prototype.permute=function(e,t,i,n,r,o){for(var s=0;s<o;s++)n[s]=t[e[s]],r[s]=i[e[s]]},_.prototype.transform=function(e,t,i,n,r,o){this.permute(o,e,t,i,n,r);for(var s=1;s<r;s<<=1)for(var a=s<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),d=0;d<r;d+=a)for(var l=c,h=u,f=0;f<s;f++){var p=i[d+f],m=n[d+f],_=i[d+f+s],g=n[d+f+s],v=l*_-h*g;g=l*g+h*_,_=v,i[d+f]=p+_,n[d+f]=m+g,i[d+f+s]=p-_,n[d+f+s]=m-g,f!==a&&(v=c*l-u*h,h=c*h+u*l,l=v)}},_.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),n=1&i,r=0;for(i=i/2|0;i;i>>>=1)r++;return 1<<r+1+n},_.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var n=0;n<i/2;n++){var r=e[n];e[n]=e[i-n-1],e[i-n-1]=r,r=t[n],t[n]=-t[i-n-1],t[i-n-1]=-r}},_.prototype.normalize13b=function(e,t){for(var i=0,n=0;n<t/2;n++){var r=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+i;e[n]=67108863&r,i=r<67108864?0:r/67108864|0}return e},_.prototype.convert13b=function(e,t,i,r){for(var o=0,s=0;s<t;s++)o+=0|e[s],i[2*s]=8191&o,o>>>=13,i[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<r;++s)i[s]=0;n(0===o),n(0===(-8192&o))},_.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},_.prototype.mulp=function(e,t,i){var n=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),d=new Array(n),l=new Array(n),h=i.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,u,n),this.transform(s,o,a,c,n,r),this.transform(u,o,d,l,n,r);for(var f=0;f<n;f++){var p=a[f]*d[f]-c[f]*l[f];c[f]=a[f]*l[f]+c[f]*d[f],a[f]=p}return this.conjugate(a,c,n),this.transform(a,c,h,o,n,r),this.conjugate(h,o,n),this.normalize13b(h,n),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),m(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){n("number"===typeof e),n(e<67108864);for(var t=0,i=0;i<this.length;i++){var r=(0|this.words[i])*e,o=(67108863&r)+(67108863&t);t>>=26,t+=r/67108864|0,t+=o>>>26,this.words[i]=67108863&o}return 0!==t&&(this.words[i]=t,this.length++),this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var n=i/26|0,r=i%26;t[i]=(e.words[n]&1<<r)>>>r}return t}(e);if(0===t.length)return new o(1);for(var i=this,n=0;n<t.length&&0===t[n];n++,i=i.sqr());if(++n<t.length)for(var r=i.sqr();n<t.length;n++,r=r.sqr())0!==t[n]&&(i=i.mul(r));return i},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,i=e%26,r=(e-i)/26,o=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,c=(0|this.words[t])-a<<i;this.words[t]=c|s,s=a>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==r){for(t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(t=0;t<r;t++)this.words[t]=0;this.length+=r}return this.strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,i){var r;n("number"===typeof e&&e>=0),r=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,c=i;if(r-=s,r=Math.max(0,r),c){for(var u=0;u<s;u++)c.words[u]=this.words[u];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,u=0;u<this.length;u++)this.words[u]=this.words[u+s];else this.words[0]=0,this.length=1;var d=0;for(u=this.length-1;u>=0&&(0!==d||u>=r);u--){var l=0|this.words[u];this.words[u]=d<<26-o|l>>>o,d=l&a}return c&&0!==d&&(c.words[c.length++]=d),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(e,t,i){return n(0===this.negative),this.iushrn(e,t,i)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26,r=1<<t;return!(this.length<=i)&&!!(this.words[i]&r)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var r=67108863^67108863>>>t<<t;this.words[this.length-1]&=r}return this.strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,i){var r,o,s=e.length+i;this._expand(s);var a=0;for(r=0;r<e.length;r++){o=(0|this.words[r+i])+a;var c=(0|e.words[r])*t;a=((o-=67108863&c)>>26)-(c/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},o.prototype._wordDiv=function(e,t){var i=(this.length,e.length),n=this.clone(),r=e,s=0|r.words[r.length-1];0!==(i=26-this._countBits(s))&&(r=r.ushln(i),n.iushln(i),s=0|r.words[r.length-1]);var a,c=n.length-r.length;if("mod"!==t){(a=new o(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var d=n.clone()._ishlnsubmul(r,1,c);0===d.negative&&(n=d,a&&(a.words[c]=1));for(var l=c-1;l>=0;l--){var h=67108864*(0|n.words[r.length+l])+(0|n.words[r.length+l-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(r,h,l);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(r,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=h)}return a&&a.strip(),n.strip(),"div"!==t&&0!==i&&n.iushrn(i),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,i){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(r=a.div.neg()),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:r,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(r=a.div.neg()),{div:r,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}:this._wordDiv(e,t);var r,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),r=e.andln(1),o=i.cmp(n);return o<0||1===r&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,i=0,r=this.length-1;r>=0;r--)i=(t*i+(0|this.words[r]))%e;return i},o.prototype.idivn=function(e){n(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var r=(0|this.words[i])+67108864*t;this.words[i]=r/e|0,t=r%e}return this.strip()},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r=new o(1),s=new o(0),a=new o(0),c=new o(1),u=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++u;for(var d=i.clone(),l=t.clone();!t.isZero();){for(var h=0,f=1;0===(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(r.isOdd()||s.isOdd())&&(r.iadd(d),s.isub(l)),r.iushrn(1),s.iushrn(1);for(var p=0,m=1;0===(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(d),c.isub(l)),a.iushrn(1),c.iushrn(1);t.cmp(i)>=0?(t.isub(i),r.isub(a),s.isub(c)):(i.isub(t),a.isub(r),c.isub(s))}return{a:a,b:c,gcd:i.iushln(u)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r,s=new o(1),a=new o(0),c=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,d=1;0===(t.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(t.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var l=0,h=1;0===(i.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(i.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(a)):(i.isub(t),a.isub(s))}return(r=0===t.cmpn(1)?s:a).cmpn(0)<0&&r.iadd(e),r},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var n=0;t.isEven()&&i.isEven();n++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=t.cmp(i);if(r<0){var o=t;t=i,i=o}else if(0===r||0===i.cmpn(1))break;t.isub(i)}return i.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,i=(e-t)/26,r=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var o=r,s=i;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),n(e<=67108863,"Number is too big");var r=0|this.words[0];t=r===e?0:r<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],r=0|e.words[i];if(n!==r){n<r?t=-1:n>r&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new S(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function y(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function T(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},r(E,v),E.prototype.split=function(e,t){for(var i=4194303,n=Math.min(e.length,9),r=0;r<n;r++)t.words[r]=e.words[r];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&i,r=10;r<e.length;r++){var s=0|e.words[r];e.words[r-10]=(s&i)<<4|o>>>22,o=s}o>>>=22,e.words[r-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var n=0|e.words[i];t+=977*n,e.words[i]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(b,v),r(y,v),r(w,v),w.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var n=19*(0|e.words[i])+t,r=67108863&n;n>>>=26,e.words[i]=r,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new b;else if("p192"===e)t=new y;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return g[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},S.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var i=this.m.add(new o(1)).iushrn(2);return this.pow(e,i)}for(var r=this.m.subn(1),s=0;!r.isZero()&&0===r.andln(1);)s++,r.iushrn(1);n(!r.isZero());var a=new o(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new o(2*d*d).toRed(this);0!==this.pow(d,u).cmp(c);)d.redIAdd(c);for(var l=this.pow(d,r),h=this.pow(e,r.addn(1).iushrn(1)),f=this.pow(e,r),p=s;0!==f.cmp(a);){for(var m=f,_=0;0!==m.cmp(a);_++)m=m.redSqr();n(_<p);var g=this.pow(l,new o(1).iushln(p-_-1));h=h.redMul(g),l=g.redSqr(),f=f.redMul(l),p=_}return h},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new o(1).toRed(this),i[1]=e;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],e);var r=i[0],s=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],d=c-1;d>=0;d--){var l=u>>d&1;r!==i[0]&&(r=this.sqr(r)),0!==l||0!==s?(s<<=1,s|=l,(4===++a||0===n&&0===d)&&(r=this.mul(r,i[s]),a=0,s=0)):a=0}c=26}return r},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new T(e)},r(T,S),T.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},T.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},T.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},T.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var i=e.mul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),s=r;return r.cmp(this.m)>=0?s=r.isub(this.m):r.cmpn(0)<0&&(s=r.iadd(this.m)),s._forceRed(this)},T.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(27)(e))},function(e,t,i){var n=i(208),r=i(73);function o(e){this.rand=e||new r.Rand}e.exports=o,o.create=function(e){return new o(e)},o.prototype._randbelow=function(e){var t=e.bitLength(),i=Math.ceil(t/8);do{var r=new n(this.rand.generate(i))}while(r.cmp(e)>=0);return r},o.prototype._randrange=function(e,t){var i=t.sub(e);return e.add(this._randbelow(i))},o.prototype.test=function(e,t,i){var r=e.bitLength(),o=n.mont(e),s=new n(1).toRed(o);t||(t=Math.max(1,r/48|0));for(var a=e.subn(1),c=0;!a.testn(c);c++);for(var u=e.shrn(c),d=a.toRed(o);t>0;t--){var l=this._randrange(new n(2),a);i&&i(l);var h=l.toRed(o).redPow(u);if(0!==h.cmp(s)&&0!==h.cmp(d)){for(var f=1;f<c;f++){if(0===(h=h.redSqr()).cmp(s))return!1;if(0===h.cmp(d))break}if(f===c)return!1}}return!0},o.prototype.getDivisor=function(e,t){var i=e.bitLength(),r=n.mont(e),o=new n(1).toRed(r);t||(t=Math.max(1,i/48|0));for(var s=e.subn(1),a=0;!s.testn(a);a++);for(var c=e.shrn(a),u=s.toRed(r);t>0;t--){var d=this._randrange(new n(2),s),l=e.gcd(d);if(0!==l.cmpn(1))return l;var h=d.toRed(r).redPow(c);if(0!==h.cmp(o)&&0!==h.cmp(u)){for(var f=1;f<a;f++){if(0===(h=h.redSqr()).cmp(o))return h.fromRed().subn(1).gcd(e);if(0===h.cmp(u))break}if(f===a)return(h=h.redSqr()).fromRed().subn(1).gcd(e)}}return!1}},function(e,t,i){"use strict";(function(t,n){var r;e.exports=R,R.ReadableState=T;i(24).EventEmitter;var o=function(e,t){return e.listeners(t).length},s=i(119),a=i(7).Buffer,c=("undefined"!==typeof t?t:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};var u,d=i(215);u=d&&d.debuglog?d.debuglog("stream"):function(){};var l,h,f,p=i(216),m=i(120),_=i(121).getHighWaterMark,g=i(35).codes,v=g.ERR_INVALID_ARG_TYPE,E=g.ERR_STREAM_PUSH_AFTER_EOF,b=g.ERR_METHOD_NOT_IMPLEMENTED,y=g.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;i(2)(R,s);var w=m.errorOrDestroy,S=["error","close","destroy","pause","resume"];function T(e,t,n){r=r||i(36),e=e||{},"boolean"!==typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=_(this,e,"readableHighWaterMark",n),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(l||(l=i(25).StringDecoder),this.decoder=new l(e.encoding),this.encoding=e.encoding)}function R(e){if(r=r||i(36),!(this instanceof R))return new R(e);var t=this instanceof r;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function C(e,t,i,n,r){u("readableAddChunk",t);var o,s=e._readableState;if(null===t)s.reading=!1,function(e,t){if(u("onEofChunk"),t.ended)return;if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,t.sync?M(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,N(e)))}(e,s);else if(r||(o=function(e,t){var i;n=t,a.isBuffer(n)||n instanceof c||"string"===typeof t||void 0===t||e.objectMode||(i=new v("chunk",["string","Buffer","Uint8Array"],t));var n;return i}(s,t)),o)w(e,o);else if(s.objectMode||t&&t.length>0)if("string"===typeof t||s.objectMode||Object.getPrototypeOf(t)===a.prototype||(t=function(e){return a.from(e)}(t)),n)s.endEmitted?w(e,new y):I(e,s,t,!0);else if(s.ended)w(e,new E);else{if(s.destroyed)return!1;s.reading=!1,s.decoder&&!i?(t=s.decoder.write(t),s.objectMode||0!==t.length?I(e,s,t,!1):k(e,s)):I(e,s,t,!1)}else n||(s.reading=!1,k(e,s));return!s.ended&&(s.length<s.highWaterMark||0===s.length)}function I(e,t,i,n){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",i)):(t.length+=t.objectMode?1:i.length,n?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&M(e)),k(e,t)}Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),R.prototype.destroy=m.destroy,R.prototype._undestroy=m.undestroy,R.prototype._destroy=function(e,t){t(e)},R.prototype.push=function(e,t){var i,n=this._readableState;return n.objectMode?i=!0:"string"===typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=a.from(e,t),t=""),i=!0),C(this,e,t,!1,i)},R.prototype.unshift=function(e){return C(this,e,null,!0,!1)},R.prototype.isPaused=function(){return!1===this._readableState.flowing},R.prototype.setEncoding=function(e){l||(l=i(25).StringDecoder);var t=new l(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,r="";null!==n;)r+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var A=1073741824;function O(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=A?e=A:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function M(e){var t=e._readableState;u("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(u("emitReadable",t.flowing),t.emittedReadable=!0,n.nextTick(N,e))}function N(e){var t=e._readableState;u("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,U(e)}function k(e,t){t.readingMore||(t.readingMore=!0,n.nextTick(P,e,t))}function P(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var i=t.length;if(u("maybeReadMore read 0"),e.read(0),i===t.length)break}t.readingMore=!1}function D(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function L(e){u("readable nexttick read 0"),e.read(0)}function x(e,t){u("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),U(e),t.flowing&&!t.reading&&e.read(0)}function U(e){var t=e._readableState;for(u("flow",t.flowing);t.flowing&&null!==e.read(););}function V(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):i=t.buffer.consume(e,t.decoder),i);var i}function B(e){var t=e._readableState;u("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,n.nextTick(j,t,e))}function j(e,t){if(u("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var i=t._writableState;(!i||i.autoDestroy&&i.finished)&&t.destroy()}}function F(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}R.prototype.read=function(e){u("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return u("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?B(this):M(this),null;if(0===(e=O(e,t))&&t.ended)return 0===t.length&&B(this),null;var n,r=t.needReadable;return u("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&u("length less than watermark",r=!0),t.ended||t.reading?u("reading or ended",r=!1):r&&(u("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=O(i,t))),null===(n=e>0?V(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&B(this)),null!==n&&this.emit("data",n),n},R.prototype._read=function(e){w(this,new b("_read()"))},R.prototype.pipe=function(e,t){var i=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,u("pipe count=%d opts=%j",r.pipesCount,t);var s=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?c:_;function a(t,n){u("onunpipe"),t===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,u("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",d),e.removeListener("error",f),e.removeListener("unpipe",a),i.removeListener("end",c),i.removeListener("end",_),i.removeListener("data",h),l=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function c(){u("onend"),e.end()}r.endEmitted?n.nextTick(s):i.once("end",s),e.on("unpipe",a);var d=function(e){return function(){var t=e._readableState;u("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&o(e,"data")&&(t.flowing=!0,U(e))}}(i);e.on("drain",d);var l=!1;function h(t){u("ondata");var n=e.write(t);u("dest.write",n),!1===n&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==F(r.pipes,e))&&!l&&(u("false write response, pause",r.awaitDrain),r.awaitDrain++),i.pause())}function f(t){u("onerror",t),_(),e.removeListener("error",f),0===o(e,"error")&&w(e,t)}function p(){e.removeListener("finish",m),_()}function m(){u("onfinish"),e.removeListener("close",p),_()}function _(){u("unpipe"),i.unpipe(e)}return i.on("data",h),function(e,t,i){if("function"===typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(e,"error",f),e.once("close",p),e.once("finish",m),e.emit("pipe",i),r.flowing||(u("pipe resume"),i.resume()),e},R.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i)),this;if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<r;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=F(t.pipes,e);return-1===s||(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i)),this},R.prototype.on=function(e,t){var i=s.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,u("on readable",r.length,r.reading),r.length?M(this):r.reading||n.nextTick(L,this))),i},R.prototype.addListener=R.prototype.on,R.prototype.removeListener=function(e,t){var i=s.prototype.removeListener.call(this,e,t);return"readable"===e&&n.nextTick(D,this),i},R.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||n.nextTick(D,this),t},R.prototype.resume=function(){var e=this._readableState;return e.flowing||(u("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,n.nextTick(x,e,t))}(this,e)),e.paused=!1,this},R.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},R.prototype.wrap=function(e){var t=this,i=this._readableState,n=!1;for(var r in e.on("end",(function(){if(u("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(r){(u("wrapped data"),i.decoder&&(r=i.decoder.write(r)),!i.objectMode||null!==r&&void 0!==r)&&((i.objectMode||r&&r.length)&&(t.push(r)||(n=!0,e.pause())))})),e)void 0===this[r]&&"function"===typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var o=0;o<S.length;o++)e.on(S[o],this.emit.bind(this,S[o]));return this._read=function(t){u("wrapped _read",t),n&&(n=!1,e.resume())},this},"function"===typeof Symbol&&(R.prototype[Symbol.asyncIterator]=function(){return void 0===h&&(h=i(218)),h(this)}),Object.defineProperty(R.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(R.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(R.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),R._fromList=V,Object.defineProperty(R.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(R.from=function(e,t){return void 0===f&&(f=i(219)),f(R,e,t)})}).call(this,i(9),i(6))},function(e,t,i){e.exports=i(24).EventEmitter},function(e,t,i){"use strict";(function(t){function i(e,t){r(e,t),n(e)}function n(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,o){var s=this,a=this._readableState&&this._readableState.destroyed,c=this._writableState&&this._writableState.destroyed;return a||c?(o?o(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,t.nextTick(r,this,e)):t.nextTick(r,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!o&&e?s._writableState?s._writableState.errorEmitted?t.nextTick(n,s):(s._writableState.errorEmitted=!0,t.nextTick(i,s,e)):t.nextTick(i,s,e):o?(t.nextTick(n,s),o(e)):t.nextTick(n,s)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var i=e._readableState,n=e._writableState;i&&i.autoDestroy||n&&n.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this,i(6))},function(e,t,i){"use strict";var n=i(35).codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,i,r){var o=function(e,t,i){return null!=e.highWaterMark?e.highWaterMark:t?e[i]:null}(t,r,i);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new n(r?i:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}},function(e,t,i){"use strict";(function(t,n){function r(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var n=e.entry;e.entry=null;for(;n;){var r=n.callback;t.pendingcb--,r(i),n=n.next}t.corkedRequestsFree.next=e}(t,e)}}var o;e.exports=R,R.WritableState=T;var s={deprecate:i(63)},a=i(119),c=i(7).Buffer,u=("undefined"!==typeof t?t:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};var d,l=i(120),h=i(121).getHighWaterMark,f=i(35).codes,p=f.ERR_INVALID_ARG_TYPE,m=f.ERR_METHOD_NOT_IMPLEMENTED,_=f.ERR_MULTIPLE_CALLBACK,g=f.ERR_STREAM_CANNOT_PIPE,v=f.ERR_STREAM_DESTROYED,E=f.ERR_STREAM_NULL_VALUES,b=f.ERR_STREAM_WRITE_AFTER_END,y=f.ERR_UNKNOWN_ENCODING,w=l.errorOrDestroy;function S(){}function T(e,t,s){o=o||i(36),e=e||{},"boolean"!==typeof s&&(s=t instanceof o),this.objectMode=!!e.objectMode,s&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=h(this,e,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,r=i.sync,o=i.writecb;if("function"!==typeof o)throw new _;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,r,o){--t.pendingcb,i?(n.nextTick(o,r),n.nextTick(N,e,t),e._writableState.errorEmitted=!0,w(e,r)):(o(r),e._writableState.errorEmitted=!0,w(e,r),N(e,t))}(e,i,r,t,o);else{var s=O(i)||e.destroyed;s||i.corked||i.bufferProcessing||!i.bufferedRequest||A(e,i),r?n.nextTick(I,e,i,s,o):I(e,i,s,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}function R(e){var t=this instanceof(o=o||i(36));if(!t&&!d.call(R,this))return new R(e);this._writableState=new T(e,this,t),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),a.call(this)}function C(e,t,i,n,r,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):i?e._writev(r,t.onwrite):e._write(r,o,t.onwrite),t.sync=!1}function I(e,t,i,n){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),N(e,t)}function A(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var n=t.bufferedRequestCount,o=new Array(n),s=t.corkedRequestsFree;s.entry=i;for(var a=0,c=!0;i;)o[a]=i,i.isBuf||(c=!1),i=i.next,a+=1;o.allBuffers=c,C(e,t,!0,t.length,o,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new r(t),t.bufferedRequestCount=0}else{for(;i;){var u=i.chunk,d=i.encoding,l=i.callback;if(C(e,t,!1,t.objectMode?1:u.length,u,d,l),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function M(e,t){e._final((function(i){t.pendingcb--,i&&w(e,i),t.prefinished=!0,e.emit("prefinish"),N(e,t)}))}function N(e,t){var i=O(t);if(i&&(function(e,t){t.prefinished||t.finalCalled||("function"!==typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,n.nextTick(M,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return i}i(2)(R,a),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(R,Symbol.hasInstance,{value:function(e){return!!d.call(this,e)||this===R&&(e&&e._writableState instanceof T)}})):d=function(e){return e instanceof this},R.prototype.pipe=function(){w(this,new g)},R.prototype.write=function(e,t,i){var r,o=this._writableState,s=!1,a=!o.objectMode&&(r=e,c.isBuffer(r)||r instanceof u);return a&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"===typeof t&&(i=t,t=null),a?t="buffer":t||(t=o.defaultEncoding),"function"!==typeof i&&(i=S),o.ending?function(e,t){var i=new b;w(e,i),n.nextTick(t,i)}(this,i):(a||function(e,t,i,r){var o;return null===i?o=new E:"string"===typeof i||t.objectMode||(o=new p("chunk",["string","Buffer"],i)),!o||(w(e,o),n.nextTick(r,o),!1)}(this,o,e,i))&&(o.pendingcb++,s=function(e,t,i,n,r,o){if(!i){var s=function(e,t,i){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=c.from(t,i));return t}(t,n,r);n!==s&&(i=!0,r="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var d=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:o,next:null},d?d.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else C(e,t,!1,a,n,r,o);return u}(this,o,a,e,t,i)),s},R.prototype.cork=function(){this._writableState.corked++},R.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||A(this,e))},R.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new y(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(R.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(R.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),R.prototype._write=function(e,t,i){i(new m("_write()"))},R.prototype._writev=null,R.prototype.end=function(e,t,i){var r=this._writableState;return"function"===typeof e?(i=e,e=null,t=null):"function"===typeof t&&(i=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,i){t.ending=!0,N(e,t),i&&(t.finished?n.nextTick(i):e.once("finish",i));t.ended=!0,e.writable=!1}(this,r,i),this},Object.defineProperty(R.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(R.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),R.prototype.destroy=l.destroy,R.prototype._undestroy=l.undestroy,R.prototype._destroy=function(e,t){t(e)}}).call(this,i(9),i(6))},function(e,t,i){"use strict";e.exports=d;var n=i(35).codes,r=n.ERR_METHOD_NOT_IMPLEMENTED,o=n.ERR_MULTIPLE_CALLBACK,s=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=n.ERR_TRANSFORM_WITH_LENGTH_0,c=i(36);function u(e,t){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(null===n)return this.emit("error",new o);i.writechunk=null,i.writecb=null,null!=t&&this.push(t),n(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function d(e){if(!(this instanceof d))return new d(e);c.call(this,e),this._transformState={afterTransform:u.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",l)}function l(){var e=this;"function"!==typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,i){h(e,t,i)}))}function h(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new a;if(e._transformState.transforming)throw new s;return e.push(null)}i(2)(d,c),d.prototype.push=function(e,t){return this._transformState.needTransform=!1,c.prototype.push.call(this,e,t)},d.prototype._transform=function(e,t,i){i(new r("_transform()"))},d.prototype._write=function(e,t,i){var n=this._transformState;if(n.writecb=i,n.writechunk=e,n.writeencoding=t,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},d.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},d.prototype._destroy=function(e,t){c.prototype._destroy.call(this,e,(function(e){t(e)}))}},function(e,t,i){"use strict";var n=t;function r(e){return 1===e.length?"0"+e:e}function o(e){for(var t="",i=0;i<e.length;i++)t+=r(e[i].toString(16));return t}n.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var i=[];if("string"!==typeof e){for(var n=0;n<e.length;n++)i[n]=0|e[n];return i}if("hex"===t){(e=e.replace(/[^a-z0-9]+/gi,"")).length%2!==0&&(e="0"+e);for(n=0;n<e.length;n+=2)i.push(parseInt(e[n]+e[n+1],16))}else for(n=0;n<e.length;n++){var r=e.charCodeAt(n),o=r>>8,s=255&r;o?i.push(o,s):i.push(s)}return i},n.zero2=r,n.toHex=o,n.encode=function(e,t){return"hex"===t?o(e):e}},function(e,t,i){"use strict";var n=t;n.base=i(55),n.short=i(226),n.mont=i(227),n.edwards=i(228)},function(e,t,i){"use strict";var n=i(16).rotr32;function r(e,t,i){return e&t^~e&i}function o(e,t,i){return e&t^e&i^t&i}function s(e,t,i){return e^t^i}t.ft_1=function(e,t,i,n){return 0===e?r(t,i,n):1===e||3===e?s(t,i,n):2===e?o(t,i,n):void 0},t.ch32=r,t.maj32=o,t.p32=s,t.s0_256=function(e){return n(e,2)^n(e,13)^n(e,22)},t.s1_256=function(e){return n(e,6)^n(e,11)^n(e,25)},t.g0_256=function(e){return n(e,7)^n(e,18)^e>>>3},t.g1_256=function(e){return n(e,17)^n(e,19)^e>>>10}},function(e,t,i){"use strict";var n=i(16),r=i(44),o=i(126),s=i(11),a=n.sum32,c=n.sum32_4,u=n.sum32_5,d=o.ch32,l=o.maj32,h=o.s0_256,f=o.s1_256,p=o.g0_256,m=o.g1_256,_=r.BlockHash,g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function v(){if(!(this instanceof v))return new v;_.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=g,this.W=new Array(64)}n.inherits(v,_),e.exports=v,v.blockSize=512,v.outSize=256,v.hmacStrength=192,v.padLength=64,v.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=c(m(i[n-2]),i[n-7],p(i[n-15]),i[n-16]);var r=this.h[0],o=this.h[1],_=this.h[2],g=this.h[3],v=this.h[4],E=this.h[5],b=this.h[6],y=this.h[7];for(s(this.k.length===i.length),n=0;n<i.length;n++){var w=u(y,f(v),d(v,E,b),this.k[n],i[n]),S=a(h(r),l(r,o,_));y=b,b=E,E=v,v=a(g,w),g=_,_=o,o=r,r=a(w,S)}this.h[0]=a(this.h[0],r),this.h[1]=a(this.h[1],o),this.h[2]=a(this.h[2],_),this.h[3]=a(this.h[3],g),this.h[4]=a(this.h[4],v),this.h[5]=a(this.h[5],E),this.h[6]=a(this.h[6],b),this.h[7]=a(this.h[7],y)},v.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},function(e,t,i){"use strict";var n=i(16),r=i(44),o=i(11),s=n.rotr64_hi,a=n.rotr64_lo,c=n.shr64_hi,u=n.shr64_lo,d=n.sum64,l=n.sum64_hi,h=n.sum64_lo,f=n.sum64_4_hi,p=n.sum64_4_lo,m=n.sum64_5_hi,_=n.sum64_5_lo,g=r.BlockHash,v=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function E(){if(!(this instanceof E))return new E;g.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=v,this.W=new Array(160)}function b(e,t,i,n,r){var o=e&i^~e&r;return o<0&&(o+=4294967296),o}function y(e,t,i,n,r,o){var s=t&n^~t&o;return s<0&&(s+=4294967296),s}function w(e,t,i,n,r){var o=e&i^e&r^i&r;return o<0&&(o+=4294967296),o}function S(e,t,i,n,r,o){var s=t&n^t&o^n&o;return s<0&&(s+=4294967296),s}function T(e,t){var i=s(e,t,28)^s(t,e,2)^s(t,e,7);return i<0&&(i+=4294967296),i}function R(e,t){var i=a(e,t,28)^a(t,e,2)^a(t,e,7);return i<0&&(i+=4294967296),i}function C(e,t){var i=s(e,t,14)^s(e,t,18)^s(t,e,9);return i<0&&(i+=4294967296),i}function I(e,t){var i=a(e,t,14)^a(e,t,18)^a(t,e,9);return i<0&&(i+=4294967296),i}function A(e,t){var i=s(e,t,1)^s(e,t,8)^c(e,t,7);return i<0&&(i+=4294967296),i}function O(e,t){var i=a(e,t,1)^a(e,t,8)^u(e,t,7);return i<0&&(i+=4294967296),i}function M(e,t){var i=s(e,t,19)^s(t,e,29)^c(e,t,6);return i<0&&(i+=4294967296),i}function N(e,t){var i=a(e,t,19)^a(t,e,29)^u(e,t,6);return i<0&&(i+=4294967296),i}n.inherits(E,g),e.exports=E,E.blockSize=1024,E.outSize=512,E.hmacStrength=192,E.padLength=128,E.prototype._prepareBlock=function(e,t){for(var i=this.W,n=0;n<32;n++)i[n]=e[t+n];for(;n<i.length;n+=2){var r=M(i[n-4],i[n-3]),o=N(i[n-4],i[n-3]),s=i[n-14],a=i[n-13],c=A(i[n-30],i[n-29]),u=O(i[n-30],i[n-29]),d=i[n-32],l=i[n-31];i[n]=f(r,o,s,a,c,u,d,l),i[n+1]=p(r,o,s,a,c,u,d,l)}},E.prototype._update=function(e,t){this._prepareBlock(e,t);var i=this.W,n=this.h[0],r=this.h[1],s=this.h[2],a=this.h[3],c=this.h[4],u=this.h[5],f=this.h[6],p=this.h[7],g=this.h[8],v=this.h[9],E=this.h[10],A=this.h[11],O=this.h[12],M=this.h[13],N=this.h[14],k=this.h[15];o(this.k.length===i.length);for(var P=0;P<i.length;P+=2){var D=N,L=k,x=C(g,v),U=I(g,v),V=b(g,v,E,A,O),B=y(g,v,E,A,O,M),j=this.k[P],F=this.k[P+1],W=i[P],G=i[P+1],H=m(D,L,x,U,V,B,j,F,W,G),q=_(D,L,x,U,V,B,j,F,W,G);D=T(n,r),L=R(n,r),x=w(n,r,s,a,c),U=S(n,r,s,a,c,u);var K=l(D,L,x,U),z=h(D,L,x,U);N=O,k=M,O=E,M=A,E=g,A=v,g=l(f,p,H,q),v=h(p,p,H,q),f=c,p=u,c=s,u=a,s=n,a=r,n=l(H,q,K,z),r=h(H,q,K,z)}d(this.h,0,n,r),d(this.h,2,s,a),d(this.h,4,c,u),d(this.h,6,f,p),d(this.h,8,g,v),d(this.h,10,E,A),d(this.h,12,O,M),d(this.h,14,N,k)},E.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},function(e,t,i){"use strict";const n=t;n.bignum=i(130),n.define=i(245).define,n.base=i(248),n.constants=i(249),n.decoders=i(133),n.encoders=i(131)},function(e,t,i){(function(e){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function o(e,t,i){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:i(244).Buffer}catch(R){}function a(e,t){var i=e.charCodeAt(t);return i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:i-48&15}function c(e,t,i){var n=a(e,i);return i-1>=t&&(n|=a(e,i-1)<<4),n}function u(e,t,i,n){for(var r=0,o=Math.min(e.length,i),s=t;s<o;s++){var a=e.charCodeAt(s)-48;r*=n,r+=a>=49?a-49+10:a>=17?a-17+10:a}return r}o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,i){if("number"===typeof e)return this._initNumber(e,t,i);if("object"===typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var r=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(r++,this.negative=1),r<e.length&&(16===t?this._parseHex(e,r,i):(this._parseBase(e,t,r),"le"===i&&this._initArray(this.toArray(),t,i)))},o.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},o.prototype._initArray=function(e,t,i){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var o,s,a=0;if("be"===i)for(r=e.length-1,o=0;r>=0;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===i)for(r=0,o=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},o.prototype._parseHex=function(e,t,i){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,o=0,s=0;if("be"===i)for(n=e.length-1;n>=t;n-=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;this.strip()},o.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=t)n++;n--,r=r/t|0;for(var o=e.length-i,s=o%n,a=Math.min(o,o-s)+i,c=0,d=i;d<a;d+=n)c=u(e,d,d+n,t),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var l=1;for(c=u(e,d,e.length,t),d=0;d<s;d++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this.strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(e,t,i){i.negative=t.negative^e.negative;var n=e.length+t.length|0;i.length=n,n=n-1|0;var r=0|e.words[0],o=0|t.words[0],s=r*o,a=67108863&s,c=s/67108864|0;i.words[0]=a;for(var u=1;u<n;u++){for(var d=c>>>26,l=67108863&c,h=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=h;f++){var p=u-f|0;d+=(s=(r=0|e.words[p])*(o=0|t.words[f])+l)/67108864|0,l=67108863&s}i.words[u]=0|l,c=0|d}return 0!==c?i.words[u]=0|c:i.length--,i.strip()}o.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var r=0,o=0,s=0;s<this.length;s++){var a=this.words[s],c=(16777215&(a<<r|o)).toString(16);i=0!==(o=a>>>24-r&16777215)||s!==this.length-1?d[6-c.length]+c+i:c+i,(r+=2)>=26&&(r-=26,s--)}for(0!==o&&(i=o.toString(16)+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=l[e],f=h[e];i="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(f).toString(e);i=(p=p.idivn(f)).isZero()?m+i:d[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(e,t){return n("undefined"!==typeof s),this.toArrayLike(s,e,t)},o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,i){var r=this.byteLength(),o=i||Math.max(1,r);n(r<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,c="le"===t,u=new e(o),d=this.clone();if(c){for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[a]=s;for(;a<o;a++)u[a]=0}else{for(a=0;a<o-r;a++)u[a]=0;for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[o-a-1]=s}return u},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0===(8191&t)&&(i+=13,t>>>=13),0===(127&t)&&(i+=7,t>>>=7),0===(15&t)&&(i+=4,t>>>=4),0===(3&t)&&(i+=2,t>>>=2),0===(1&t)&&i++,i},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var n=0;n<i.length;n++)this.words[n]=t.words[n]^i.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this.strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var i=e/26|0,r=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<r:this.words[i]&~(1<<r),this.strip()},o.prototype.iadd=function(e){var t,i,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,n=e):(i=e,n=this);for(var r=0,o=0;o<n.length;o++)t=(0|i.words[o])+(0|n.words[o])+r,this.words[o]=67108863&t,r=t>>>26;for(;0!==r&&o<i.length;o++)t=(0|i.words[o])+r,this.words[o]=67108863&t,r=t>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,n,r=this.cmp(e);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(i=this,n=e):(i=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|i.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<i.length;s++)o=(t=(0|i.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,i){var n,r,o,s=e.words,a=t.words,c=i.words,u=0,d=0|s[0],l=8191&d,h=d>>>13,f=0|s[1],p=8191&f,m=f>>>13,_=0|s[2],g=8191&_,v=_>>>13,E=0|s[3],b=8191&E,y=E>>>13,w=0|s[4],S=8191&w,T=w>>>13,R=0|s[5],C=8191&R,I=R>>>13,A=0|s[6],O=8191&A,M=A>>>13,N=0|s[7],k=8191&N,P=N>>>13,D=0|s[8],L=8191&D,x=D>>>13,U=0|s[9],V=8191&U,B=U>>>13,j=0|a[0],F=8191&j,W=j>>>13,G=0|a[1],H=8191&G,q=G>>>13,K=0|a[2],z=8191&K,Y=K>>>13,J=0|a[3],X=8191&J,Q=J>>>13,Z=0|a[4],$=8191&Z,ee=Z>>>13,te=0|a[5],ie=8191&te,ne=te>>>13,re=0|a[6],oe=8191&re,se=re>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,de=0|a[8],le=8191&de,he=de>>>13,fe=0|a[9],pe=8191&fe,me=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var _e=(u+(n=Math.imul(l,F))|0)+((8191&(r=(r=Math.imul(l,W))+Math.imul(h,F)|0))<<13)|0;u=((o=Math.imul(h,W))+(r>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(p,F),r=(r=Math.imul(p,W))+Math.imul(m,F)|0,o=Math.imul(m,W);var ge=(u+(n=n+Math.imul(l,H)|0)|0)+((8191&(r=(r=r+Math.imul(l,q)|0)+Math.imul(h,H)|0))<<13)|0;u=((o=o+Math.imul(h,q)|0)+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,F),r=(r=Math.imul(g,W))+Math.imul(v,F)|0,o=Math.imul(v,W),n=n+Math.imul(p,H)|0,r=(r=r+Math.imul(p,q)|0)+Math.imul(m,H)|0,o=o+Math.imul(m,q)|0;var ve=(u+(n=n+Math.imul(l,z)|0)|0)+((8191&(r=(r=r+Math.imul(l,Y)|0)+Math.imul(h,z)|0))<<13)|0;u=((o=o+Math.imul(h,Y)|0)+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,F),r=(r=Math.imul(b,W))+Math.imul(y,F)|0,o=Math.imul(y,W),n=n+Math.imul(g,H)|0,r=(r=r+Math.imul(g,q)|0)+Math.imul(v,H)|0,o=o+Math.imul(v,q)|0,n=n+Math.imul(p,z)|0,r=(r=r+Math.imul(p,Y)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,Y)|0;var Ee=(u+(n=n+Math.imul(l,X)|0)|0)+((8191&(r=(r=r+Math.imul(l,Q)|0)+Math.imul(h,X)|0))<<13)|0;u=((o=o+Math.imul(h,Q)|0)+(r>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(S,F),r=(r=Math.imul(S,W))+Math.imul(T,F)|0,o=Math.imul(T,W),n=n+Math.imul(b,H)|0,r=(r=r+Math.imul(b,q)|0)+Math.imul(y,H)|0,o=o+Math.imul(y,q)|0,n=n+Math.imul(g,z)|0,r=(r=r+Math.imul(g,Y)|0)+Math.imul(v,z)|0,o=o+Math.imul(v,Y)|0,n=n+Math.imul(p,X)|0,r=(r=r+Math.imul(p,Q)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,Q)|0;var be=(u+(n=n+Math.imul(l,$)|0)|0)+((8191&(r=(r=r+Math.imul(l,ee)|0)+Math.imul(h,$)|0))<<13)|0;u=((o=o+Math.imul(h,ee)|0)+(r>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(C,F),r=(r=Math.imul(C,W))+Math.imul(I,F)|0,o=Math.imul(I,W),n=n+Math.imul(S,H)|0,r=(r=r+Math.imul(S,q)|0)+Math.imul(T,H)|0,o=o+Math.imul(T,q)|0,n=n+Math.imul(b,z)|0,r=(r=r+Math.imul(b,Y)|0)+Math.imul(y,z)|0,o=o+Math.imul(y,Y)|0,n=n+Math.imul(g,X)|0,r=(r=r+Math.imul(g,Q)|0)+Math.imul(v,X)|0,o=o+Math.imul(v,Q)|0,n=n+Math.imul(p,$)|0,r=(r=r+Math.imul(p,ee)|0)+Math.imul(m,$)|0,o=o+Math.imul(m,ee)|0;var ye=(u+(n=n+Math.imul(l,ie)|0)|0)+((8191&(r=(r=r+Math.imul(l,ne)|0)+Math.imul(h,ie)|0))<<13)|0;u=((o=o+Math.imul(h,ne)|0)+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(O,F),r=(r=Math.imul(O,W))+Math.imul(M,F)|0,o=Math.imul(M,W),n=n+Math.imul(C,H)|0,r=(r=r+Math.imul(C,q)|0)+Math.imul(I,H)|0,o=o+Math.imul(I,q)|0,n=n+Math.imul(S,z)|0,r=(r=r+Math.imul(S,Y)|0)+Math.imul(T,z)|0,o=o+Math.imul(T,Y)|0,n=n+Math.imul(b,X)|0,r=(r=r+Math.imul(b,Q)|0)+Math.imul(y,X)|0,o=o+Math.imul(y,Q)|0,n=n+Math.imul(g,$)|0,r=(r=r+Math.imul(g,ee)|0)+Math.imul(v,$)|0,o=o+Math.imul(v,ee)|0,n=n+Math.imul(p,ie)|0,r=(r=r+Math.imul(p,ne)|0)+Math.imul(m,ie)|0,o=o+Math.imul(m,ne)|0;var we=(u+(n=n+Math.imul(l,oe)|0)|0)+((8191&(r=(r=r+Math.imul(l,se)|0)+Math.imul(h,oe)|0))<<13)|0;u=((o=o+Math.imul(h,se)|0)+(r>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,F),r=(r=Math.imul(k,W))+Math.imul(P,F)|0,o=Math.imul(P,W),n=n+Math.imul(O,H)|0,r=(r=r+Math.imul(O,q)|0)+Math.imul(M,H)|0,o=o+Math.imul(M,q)|0,n=n+Math.imul(C,z)|0,r=(r=r+Math.imul(C,Y)|0)+Math.imul(I,z)|0,o=o+Math.imul(I,Y)|0,n=n+Math.imul(S,X)|0,r=(r=r+Math.imul(S,Q)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,Q)|0,n=n+Math.imul(b,$)|0,r=(r=r+Math.imul(b,ee)|0)+Math.imul(y,$)|0,o=o+Math.imul(y,ee)|0,n=n+Math.imul(g,ie)|0,r=(r=r+Math.imul(g,ne)|0)+Math.imul(v,ie)|0,o=o+Math.imul(v,ne)|0,n=n+Math.imul(p,oe)|0,r=(r=r+Math.imul(p,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0;var Se=(u+(n=n+Math.imul(l,ce)|0)|0)+((8191&(r=(r=r+Math.imul(l,ue)|0)+Math.imul(h,ce)|0))<<13)|0;u=((o=o+Math.imul(h,ue)|0)+(r>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(L,F),r=(r=Math.imul(L,W))+Math.imul(x,F)|0,o=Math.imul(x,W),n=n+Math.imul(k,H)|0,r=(r=r+Math.imul(k,q)|0)+Math.imul(P,H)|0,o=o+Math.imul(P,q)|0,n=n+Math.imul(O,z)|0,r=(r=r+Math.imul(O,Y)|0)+Math.imul(M,z)|0,o=o+Math.imul(M,Y)|0,n=n+Math.imul(C,X)|0,r=(r=r+Math.imul(C,Q)|0)+Math.imul(I,X)|0,o=o+Math.imul(I,Q)|0,n=n+Math.imul(S,$)|0,r=(r=r+Math.imul(S,ee)|0)+Math.imul(T,$)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(b,ie)|0,r=(r=r+Math.imul(b,ne)|0)+Math.imul(y,ie)|0,o=o+Math.imul(y,ne)|0,n=n+Math.imul(g,oe)|0,r=(r=r+Math.imul(g,se)|0)+Math.imul(v,oe)|0,o=o+Math.imul(v,se)|0,n=n+Math.imul(p,ce)|0,r=(r=r+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,o=o+Math.imul(m,ue)|0;var Te=(u+(n=n+Math.imul(l,le)|0)|0)+((8191&(r=(r=r+Math.imul(l,he)|0)+Math.imul(h,le)|0))<<13)|0;u=((o=o+Math.imul(h,he)|0)+(r>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(V,F),r=(r=Math.imul(V,W))+Math.imul(B,F)|0,o=Math.imul(B,W),n=n+Math.imul(L,H)|0,r=(r=r+Math.imul(L,q)|0)+Math.imul(x,H)|0,o=o+Math.imul(x,q)|0,n=n+Math.imul(k,z)|0,r=(r=r+Math.imul(k,Y)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,Y)|0,n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,Q)|0)+Math.imul(M,X)|0,o=o+Math.imul(M,Q)|0,n=n+Math.imul(C,$)|0,r=(r=r+Math.imul(C,ee)|0)+Math.imul(I,$)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(S,ie)|0,r=(r=r+Math.imul(S,ne)|0)+Math.imul(T,ie)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(b,oe)|0,r=(r=r+Math.imul(b,se)|0)+Math.imul(y,oe)|0,o=o+Math.imul(y,se)|0,n=n+Math.imul(g,ce)|0,r=(r=r+Math.imul(g,ue)|0)+Math.imul(v,ce)|0,o=o+Math.imul(v,ue)|0,n=n+Math.imul(p,le)|0,r=(r=r+Math.imul(p,he)|0)+Math.imul(m,le)|0,o=o+Math.imul(m,he)|0;var Re=(u+(n=n+Math.imul(l,pe)|0)|0)+((8191&(r=(r=r+Math.imul(l,me)|0)+Math.imul(h,pe)|0))<<13)|0;u=((o=o+Math.imul(h,me)|0)+(r>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(V,H),r=(r=Math.imul(V,q))+Math.imul(B,H)|0,o=Math.imul(B,q),n=n+Math.imul(L,z)|0,r=(r=r+Math.imul(L,Y)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,Y)|0,n=n+Math.imul(k,X)|0,r=(r=r+Math.imul(k,Q)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,Q)|0,n=n+Math.imul(O,$)|0,r=(r=r+Math.imul(O,ee)|0)+Math.imul(M,$)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(C,ie)|0,r=(r=r+Math.imul(C,ne)|0)+Math.imul(I,ie)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(S,oe)|0,r=(r=r+Math.imul(S,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,n=n+Math.imul(b,ce)|0,r=(r=r+Math.imul(b,ue)|0)+Math.imul(y,ce)|0,o=o+Math.imul(y,ue)|0,n=n+Math.imul(g,le)|0,r=(r=r+Math.imul(g,he)|0)+Math.imul(v,le)|0,o=o+Math.imul(v,he)|0;var Ce=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(r=(r=r+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((o=o+Math.imul(m,me)|0)+(r>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(V,z),r=(r=Math.imul(V,Y))+Math.imul(B,z)|0,o=Math.imul(B,Y),n=n+Math.imul(L,X)|0,r=(r=r+Math.imul(L,Q)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,Q)|0,n=n+Math.imul(k,$)|0,r=(r=r+Math.imul(k,ee)|0)+Math.imul(P,$)|0,o=o+Math.imul(P,ee)|0,n=n+Math.imul(O,ie)|0,r=(r=r+Math.imul(O,ne)|0)+Math.imul(M,ie)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(C,oe)|0,r=(r=r+Math.imul(C,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(S,ce)|0,r=(r=r+Math.imul(S,ue)|0)+Math.imul(T,ce)|0,o=o+Math.imul(T,ue)|0,n=n+Math.imul(b,le)|0,r=(r=r+Math.imul(b,he)|0)+Math.imul(y,le)|0,o=o+Math.imul(y,he)|0;var Ie=(u+(n=n+Math.imul(g,pe)|0)|0)+((8191&(r=(r=r+Math.imul(g,me)|0)+Math.imul(v,pe)|0))<<13)|0;u=((o=o+Math.imul(v,me)|0)+(r>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(V,X),r=(r=Math.imul(V,Q))+Math.imul(B,X)|0,o=Math.imul(B,Q),n=n+Math.imul(L,$)|0,r=(r=r+Math.imul(L,ee)|0)+Math.imul(x,$)|0,o=o+Math.imul(x,ee)|0,n=n+Math.imul(k,ie)|0,r=(r=r+Math.imul(k,ne)|0)+Math.imul(P,ie)|0,o=o+Math.imul(P,ne)|0,n=n+Math.imul(O,oe)|0,r=(r=r+Math.imul(O,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(C,ce)|0,r=(r=r+Math.imul(C,ue)|0)+Math.imul(I,ce)|0,o=o+Math.imul(I,ue)|0,n=n+Math.imul(S,le)|0,r=(r=r+Math.imul(S,he)|0)+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0;var Ae=(u+(n=n+Math.imul(b,pe)|0)|0)+((8191&(r=(r=r+Math.imul(b,me)|0)+Math.imul(y,pe)|0))<<13)|0;u=((o=o+Math.imul(y,me)|0)+(r>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(V,$),r=(r=Math.imul(V,ee))+Math.imul(B,$)|0,o=Math.imul(B,ee),n=n+Math.imul(L,ie)|0,r=(r=r+Math.imul(L,ne)|0)+Math.imul(x,ie)|0,o=o+Math.imul(x,ne)|0,n=n+Math.imul(k,oe)|0,r=(r=r+Math.imul(k,se)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,se)|0,n=n+Math.imul(O,ce)|0,r=(r=r+Math.imul(O,ue)|0)+Math.imul(M,ce)|0,o=o+Math.imul(M,ue)|0,n=n+Math.imul(C,le)|0,r=(r=r+Math.imul(C,he)|0)+Math.imul(I,le)|0,o=o+Math.imul(I,he)|0;var Oe=(u+(n=n+Math.imul(S,pe)|0)|0)+((8191&(r=(r=r+Math.imul(S,me)|0)+Math.imul(T,pe)|0))<<13)|0;u=((o=o+Math.imul(T,me)|0)+(r>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(V,ie),r=(r=Math.imul(V,ne))+Math.imul(B,ie)|0,o=Math.imul(B,ne),n=n+Math.imul(L,oe)|0,r=(r=r+Math.imul(L,se)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,se)|0,n=n+Math.imul(k,ce)|0,r=(r=r+Math.imul(k,ue)|0)+Math.imul(P,ce)|0,o=o+Math.imul(P,ue)|0,n=n+Math.imul(O,le)|0,r=(r=r+Math.imul(O,he)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,he)|0;var Me=(u+(n=n+Math.imul(C,pe)|0)|0)+((8191&(r=(r=r+Math.imul(C,me)|0)+Math.imul(I,pe)|0))<<13)|0;u=((o=o+Math.imul(I,me)|0)+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(V,oe),r=(r=Math.imul(V,se))+Math.imul(B,oe)|0,o=Math.imul(B,se),n=n+Math.imul(L,ce)|0,r=(r=r+Math.imul(L,ue)|0)+Math.imul(x,ce)|0,o=o+Math.imul(x,ue)|0,n=n+Math.imul(k,le)|0,r=(r=r+Math.imul(k,he)|0)+Math.imul(P,le)|0,o=o+Math.imul(P,he)|0;var Ne=(u+(n=n+Math.imul(O,pe)|0)|0)+((8191&(r=(r=r+Math.imul(O,me)|0)+Math.imul(M,pe)|0))<<13)|0;u=((o=o+Math.imul(M,me)|0)+(r>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(V,ce),r=(r=Math.imul(V,ue))+Math.imul(B,ce)|0,o=Math.imul(B,ue),n=n+Math.imul(L,le)|0,r=(r=r+Math.imul(L,he)|0)+Math.imul(x,le)|0,o=o+Math.imul(x,he)|0;var ke=(u+(n=n+Math.imul(k,pe)|0)|0)+((8191&(r=(r=r+Math.imul(k,me)|0)+Math.imul(P,pe)|0))<<13)|0;u=((o=o+Math.imul(P,me)|0)+(r>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(V,le),r=(r=Math.imul(V,he))+Math.imul(B,le)|0,o=Math.imul(B,he);var Pe=(u+(n=n+Math.imul(L,pe)|0)|0)+((8191&(r=(r=r+Math.imul(L,me)|0)+Math.imul(x,pe)|0))<<13)|0;u=((o=o+Math.imul(x,me)|0)+(r>>>13)|0)+(Pe>>>26)|0,Pe&=67108863;var De=(u+(n=Math.imul(V,pe))|0)+((8191&(r=(r=Math.imul(V,me))+Math.imul(B,pe)|0))<<13)|0;return u=((o=Math.imul(B,me))+(r>>>13)|0)+(De>>>26)|0,De&=67108863,c[0]=_e,c[1]=ge,c[2]=ve,c[3]=Ee,c[4]=be,c[5]=ye,c[6]=we,c[7]=Se,c[8]=Te,c[9]=Re,c[10]=Ce,c[11]=Ie,c[12]=Ae,c[13]=Oe,c[14]=Me,c[15]=Ne,c[16]=ke,c[17]=Pe,c[18]=De,0!==u&&(c[19]=u,i.length++),i};function m(e,t,i){return(new _).mulp(e,t,i)}function _(e,t){this.x=e,this.y=t}Math.imul||(p=f),o.prototype.mulTo=function(e,t){var i,n=this.length+e.length;return i=10===this.length&&10===e.length?p(this,e,t):n<63?f(this,e,t):n<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var n=0,r=0,o=0;o<i.length-1;o++){var s=r;r=0;for(var a=67108863&n,c=Math.min(o,t.length-1),u=Math.max(0,o-e.length+1);u<=c;u++){var d=o-u,l=(0|e.words[d])*(0|t.words[u]),h=67108863&l;a=67108863&(h=h+a|0),r+=(s=(s=s+(l/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}i.words[o]=a,n=s,s=r}return 0!==n?i.words[o]=n:i.length--,i.strip()}(this,e,t):m(this,e,t),i},_.prototype.makeRBT=function(e){for(var t=new Array(e),i=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,i,e);return t},_.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var n=0,r=0;r<t;r++)n|=(1&e)<<t-r-1,e>>=1;return n},_.prototype.permute=function(e,t,i,n,r,o){for(var s=0;s<o;s++)n[s]=t[e[s]],r[s]=i[e[s]]},_.prototype.transform=function(e,t,i,n,r,o){this.permute(o,e,t,i,n,r);for(var s=1;s<r;s<<=1)for(var a=s<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),d=0;d<r;d+=a)for(var l=c,h=u,f=0;f<s;f++){var p=i[d+f],m=n[d+f],_=i[d+f+s],g=n[d+f+s],v=l*_-h*g;g=l*g+h*_,_=v,i[d+f]=p+_,n[d+f]=m+g,i[d+f+s]=p-_,n[d+f+s]=m-g,f!==a&&(v=c*l-u*h,h=c*h+u*l,l=v)}},_.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),n=1&i,r=0;for(i=i/2|0;i;i>>>=1)r++;return 1<<r+1+n},_.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var n=0;n<i/2;n++){var r=e[n];e[n]=e[i-n-1],e[i-n-1]=r,r=t[n],t[n]=-t[i-n-1],t[i-n-1]=-r}},_.prototype.normalize13b=function(e,t){for(var i=0,n=0;n<t/2;n++){var r=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+i;e[n]=67108863&r,i=r<67108864?0:r/67108864|0}return e},_.prototype.convert13b=function(e,t,i,r){for(var o=0,s=0;s<t;s++)o+=0|e[s],i[2*s]=8191&o,o>>>=13,i[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<r;++s)i[s]=0;n(0===o),n(0===(-8192&o))},_.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},_.prototype.mulp=function(e,t,i){var n=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),d=new Array(n),l=new Array(n),h=i.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,u,n),this.transform(s,o,a,c,n,r),this.transform(u,o,d,l,n,r);for(var f=0;f<n;f++){var p=a[f]*d[f]-c[f]*l[f];c[f]=a[f]*l[f]+c[f]*d[f],a[f]=p}return this.conjugate(a,c,n),this.transform(a,c,h,o,n,r),this.conjugate(h,o,n),this.normalize13b(h,n),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),m(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){n("number"===typeof e),n(e<67108864);for(var t=0,i=0;i<this.length;i++){var r=(0|this.words[i])*e,o=(67108863&r)+(67108863&t);t>>=26,t+=r/67108864|0,t+=o>>>26,this.words[i]=67108863&o}return 0!==t&&(this.words[i]=t,this.length++),this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var n=i/26|0,r=i%26;t[i]=(e.words[n]&1<<r)>>>r}return t}(e);if(0===t.length)return new o(1);for(var i=this,n=0;n<t.length&&0===t[n];n++,i=i.sqr());if(++n<t.length)for(var r=i.sqr();n<t.length;n++,r=r.sqr())0!==t[n]&&(i=i.mul(r));return i},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,i=e%26,r=(e-i)/26,o=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,c=(0|this.words[t])-a<<i;this.words[t]=c|s,s=a>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==r){for(t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(t=0;t<r;t++)this.words[t]=0;this.length+=r}return this.strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,i){var r;n("number"===typeof e&&e>=0),r=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,c=i;if(r-=s,r=Math.max(0,r),c){for(var u=0;u<s;u++)c.words[u]=this.words[u];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,u=0;u<this.length;u++)this.words[u]=this.words[u+s];else this.words[0]=0,this.length=1;var d=0;for(u=this.length-1;u>=0&&(0!==d||u>=r);u--){var l=0|this.words[u];this.words[u]=d<<26-o|l>>>o,d=l&a}return c&&0!==d&&(c.words[c.length++]=d),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(e,t,i){return n(0===this.negative),this.iushrn(e,t,i)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26,r=1<<t;return!(this.length<=i)&&!!(this.words[i]&r)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var r=67108863^67108863>>>t<<t;this.words[this.length-1]&=r}return this.strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,i){var r,o,s=e.length+i;this._expand(s);var a=0;for(r=0;r<e.length;r++){o=(0|this.words[r+i])+a;var c=(0|e.words[r])*t;a=((o-=67108863&c)>>26)-(c/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},o.prototype._wordDiv=function(e,t){var i=(this.length,e.length),n=this.clone(),r=e,s=0|r.words[r.length-1];0!==(i=26-this._countBits(s))&&(r=r.ushln(i),n.iushln(i),s=0|r.words[r.length-1]);var a,c=n.length-r.length;if("mod"!==t){(a=new o(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var d=n.clone()._ishlnsubmul(r,1,c);0===d.negative&&(n=d,a&&(a.words[c]=1));for(var l=c-1;l>=0;l--){var h=67108864*(0|n.words[r.length+l])+(0|n.words[r.length+l-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(r,h,l);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(r,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=h)}return a&&a.strip(),n.strip(),"div"!==t&&0!==i&&n.iushrn(i),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,i){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(r=a.div.neg()),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:r,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(r=a.div.neg()),{div:r,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}:this._wordDiv(e,t);var r,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),r=e.andln(1),o=i.cmp(n);return o<0||1===r&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,i=0,r=this.length-1;r>=0;r--)i=(t*i+(0|this.words[r]))%e;return i},o.prototype.idivn=function(e){n(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var r=(0|this.words[i])+67108864*t;this.words[i]=r/e|0,t=r%e}return this.strip()},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r=new o(1),s=new o(0),a=new o(0),c=new o(1),u=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++u;for(var d=i.clone(),l=t.clone();!t.isZero();){for(var h=0,f=1;0===(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(r.isOdd()||s.isOdd())&&(r.iadd(d),s.isub(l)),r.iushrn(1),s.iushrn(1);for(var p=0,m=1;0===(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(d),c.isub(l)),a.iushrn(1),c.iushrn(1);t.cmp(i)>=0?(t.isub(i),r.isub(a),s.isub(c)):(i.isub(t),a.isub(r),c.isub(s))}return{a:a,b:c,gcd:i.iushln(u)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r,s=new o(1),a=new o(0),c=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,d=1;0===(t.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(t.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var l=0,h=1;0===(i.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(i.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(a)):(i.isub(t),a.isub(s))}return(r=0===t.cmpn(1)?s:a).cmpn(0)<0&&r.iadd(e),r},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var n=0;t.isEven()&&i.isEven();n++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=t.cmp(i);if(r<0){var o=t;t=i,i=o}else if(0===r||0===i.cmpn(1))break;t.isub(i)}return i.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,i=(e-t)/26,r=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var o=r,s=i;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),n(e<=67108863,"Number is too big");var r=0|this.words[0];t=r===e?0:r<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],r=0|e.words[i];if(n!==r){n<r?t=-1:n>r&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new S(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function y(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function T(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},r(E,v),E.prototype.split=function(e,t){for(var i=4194303,n=Math.min(e.length,9),r=0;r<n;r++)t.words[r]=e.words[r];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&i,r=10;r<e.length;r++){var s=0|e.words[r];e.words[r-10]=(s&i)<<4|o>>>22,o=s}o>>>=22,e.words[r-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var n=0|e.words[i];t+=977*n,e.words[i]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(b,v),r(y,v),r(w,v),w.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var n=19*(0|e.words[i])+t,r=67108863&n;n>>>=26,e.words[i]=r,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new b;else if("p192"===e)t=new y;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return g[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},S.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var i=this.m.add(new o(1)).iushrn(2);return this.pow(e,i)}for(var r=this.m.subn(1),s=0;!r.isZero()&&0===r.andln(1);)s++,r.iushrn(1);n(!r.isZero());var a=new o(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new o(2*d*d).toRed(this);0!==this.pow(d,u).cmp(c);)d.redIAdd(c);for(var l=this.pow(d,r),h=this.pow(e,r.addn(1).iushrn(1)),f=this.pow(e,r),p=s;0!==f.cmp(a);){for(var m=f,_=0;0!==m.cmp(a);_++)m=m.redSqr();n(_<p);var g=this.pow(l,new o(1).iushln(p-_-1));h=h.redMul(g),l=g.redSqr(),f=f.redMul(l),p=_}return h},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new o(1).toRed(this),i[1]=e;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],e);var r=i[0],s=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],d=c-1;d>=0;d--){var l=u>>d&1;r!==i[0]&&(r=this.sqr(r)),0!==l||0!==s?(s<<=1,s|=l,(4===++a||0===n&&0===d)&&(r=this.mul(r,i[s]),a=0,s=0)):a=0}c=26}return r},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new T(e)},r(T,S),T.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},T.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},T.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},T.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var i=e.mul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),s=r;return r.cmp(this.m)>=0?s=r.isub(this.m):r.cmpn(0)<0&&(s=r.iadd(this.m)),s._forceRed(this)},T.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(27)(e))},function(e,t,i){"use strict";const n=t;n.der=i(132),n.pem=i(246)},function(e,t,i){"use strict";const n=i(2),r=i(80).Buffer,o=i(81),s=i(83);function a(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new c,this.tree._init(e.body)}function c(e){o.call(this,"der",e)}function u(e){return e<10?"0"+e:e}e.exports=a,a.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},n(c,o),c.prototype._encodeComposite=function(e,t,i,n){const o=function(e,t,i,n){let r;"seqof"===e?e="seq":"setof"===e&&(e="set");if(s.tagByName.hasOwnProperty(e))r=s.tagByName[e];else{if("number"!==typeof e||(0|e)!==e)return n.error("Unknown tag: "+e);r=e}if(r>=31)return n.error("Multi-octet tag encoding unsupported");t||(r|=32);return r|=s.tagClassByName[i||"universal"]<<6,r}(e,t,i,this.reporter);if(n.length<128){const e=r.alloc(2);return e[0]=o,e[1]=n.length,this._createEncoderBuffer([e,n])}let a=1;for(let r=n.length;r>=256;r>>=8)a++;const c=r.alloc(2+a);c[0]=o,c[1]=128|a;for(let r=1+a,s=n.length;s>0;r--,s>>=8)c[r]=255&s;return this._createEncoderBuffer([c,n])},c.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){const t=r.alloc(2*e.length);for(let i=0;i<e.length;i++)t.writeUInt16BE(e.charCodeAt(i),2*i);return this._createEncoderBuffer(t)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},c.prototype._encodeObjid=function(e,t,i){if("string"===typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s.]+/g);for(let t=0;t<e.length;t++)e[t]|=0}else if(Array.isArray(e)){e=e.slice();for(let t=0;t<e.length;t++)e[t]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!i){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}let n=0;for(let r=0;r<e.length;r++){let t=e[r];for(n++;t>=128;t>>=7)n++}const o=r.alloc(n);let s=o.length-1;for(let r=e.length-1;r>=0;r--){let t=e[r];for(o[s--]=127&t;(t>>=7)>0;)o[s--]=128|127&t}return this._createEncoderBuffer(o)},c.prototype._encodeTime=function(e,t){let i;const n=new Date(e);return"gentime"===t?i=[u(n.getUTCFullYear()),u(n.getUTCMonth()+1),u(n.getUTCDate()),u(n.getUTCHours()),u(n.getUTCMinutes()),u(n.getUTCSeconds()),"Z"].join(""):"utctime"===t?i=[u(n.getUTCFullYear()%100),u(n.getUTCMonth()+1),u(n.getUTCDate()),u(n.getUTCHours()),u(n.getUTCMinutes()),u(n.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(i,"octstr")},c.prototype._encodeNull=function(){return this._createEncoderBuffer("")},c.prototype._encodeInt=function(e,t){if("string"===typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!==typeof e&&!r.isBuffer(e)){const t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=r.from(t)}if(r.isBuffer(e)){let t=e.length;0===e.length&&t++;const i=r.alloc(t);return e.copy(i),0===e.length&&(i[0]=0),this._createEncoderBuffer(i)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);let i=1;for(let r=e;r>=256;r>>=8)i++;const n=new Array(i);for(let r=n.length-1;r>=0;r--)n[r]=255&e,e>>=8;return 128&n[0]&&n.unshift(0),this._createEncoderBuffer(r.from(n))},c.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},c.prototype._use=function(e,t){return"function"===typeof e&&(e=e(t)),e._getEncoder("der").tree},c.prototype._skipDefault=function(e,t,i){const n=this._baseState;let r;if(null===n.default)return!1;const o=e.join();if(void 0===n.defaultBuffer&&(n.defaultBuffer=this._encodeValue(n.default,t,i).join()),o.length!==n.defaultBuffer.length)return!1;for(r=0;r<o.length;r++)if(o[r]!==n.defaultBuffer[r])return!1;return!0}},function(e,t,i){"use strict";const n=t;n.der=i(134),n.pem=i(247)},function(e,t,i){"use strict";const n=i(2),r=i(130),o=i(45).DecoderBuffer,s=i(81),a=i(83);function c(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new u,this.tree._init(e.body)}function u(e){s.call(this,"der",e)}function d(e,t){let i=e.readUInt8(t);if(e.isError(i))return i;const n=a.tagClass[i>>6],r=0===(32&i);if(31===(31&i)){let n=i;for(i=0;128===(128&n);){if(n=e.readUInt8(t),e.isError(n))return n;i<<=7,i|=127&n}}else i&=31;return{cls:n,primitive:r,tag:i,tagStr:a.tag[i]}}function l(e,t,i){let n=e.readUInt8(i);if(e.isError(n))return n;if(!t&&128===n)return null;if(0===(128&n))return n;const r=127&n;if(r>4)return e.error("length octect is too long");n=0;for(let o=0;o<r;o++){n<<=8;const t=e.readUInt8(i);if(e.isError(t))return t;n|=t}return n}e.exports=c,c.prototype.decode=function(e,t){return o.isDecoderBuffer(e)||(e=new o(e,t)),this.tree._decode(e,t)},n(u,s),u.prototype._peekTag=function(e,t,i){if(e.isEmpty())return!1;const n=e.save(),r=d(e,'Failed to peek tag: "'+t+'"');return e.isError(r)?r:(e.restore(n),r.tag===t||r.tagStr===t||r.tagStr+"of"===t||i)},u.prototype._decodeTag=function(e,t,i){const n=d(e,'Failed to decode tag of "'+t+'"');if(e.isError(n))return n;let r=l(e,n.primitive,'Failed to get length of "'+t+'"');if(e.isError(r))return r;if(!i&&n.tag!==t&&n.tagStr!==t&&n.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(n.primitive||null!==r)return e.skip(r,'Failed to match body of: "'+t+'"');const o=e.save(),s=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(s)?s:(r=e.offset-o.offset,e.restore(o),e.skip(r,'Failed to match body of: "'+t+'"'))},u.prototype._skipUntilEnd=function(e,t){for(;;){const i=d(e,t);if(e.isError(i))return i;const n=l(e,i.primitive,t);if(e.isError(n))return n;let r;if(r=i.primitive||null!==n?e.skip(n):this._skipUntilEnd(e,t),e.isError(r))return r;if("end"===i.tagStr)break}},u.prototype._decodeList=function(e,t,i,n){const r=[];for(;!e.isEmpty();){const t=this._peekTag(e,"end");if(e.isError(t))return t;const o=i.decode(e,"der",n);if(e.isError(o)&&t)break;r.push(o)}return r},u.prototype._decodeStr=function(e,t){if("bitstr"===t){const t=e.readUInt8();return e.isError(t)?t:{unused:t,data:e.raw()}}if("bmpstr"===t){const t=e.raw();if(t.length%2===1)return e.error("Decoding of string type: bmpstr length mismatch");let i="";for(let e=0;e<t.length/2;e++)i+=String.fromCharCode(t.readUInt16BE(2*e));return i}if("numstr"===t){const t=e.raw().toString("ascii");return this._isNumstr(t)?t:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){const t=e.raw().toString("ascii");return this._isPrintstr(t)?t:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},u.prototype._decodeObjid=function(e,t,i){let n;const r=[];let o=0,s=0;for(;!e.isEmpty();)s=e.readUInt8(),o<<=7,o|=127&s,0===(128&s)&&(r.push(o),o=0);128&s&&r.push(o);const a=r[0]/40|0,c=r[0]%40;if(n=i?r:[a,c].concat(r.slice(1)),t){let e=t[n.join(" ")];void 0===e&&(e=t[n.join(".")]),void 0!==e&&(n=e)}return n},u.prototype._decodeTime=function(e,t){const i=e.raw().toString();let n,r,o,s,a,c;if("gentime"===t)n=0|i.slice(0,4),r=0|i.slice(4,6),o=0|i.slice(6,8),s=0|i.slice(8,10),a=0|i.slice(10,12),c=0|i.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");n=0|i.slice(0,2),r=0|i.slice(2,4),o=0|i.slice(4,6),s=0|i.slice(6,8),a=0|i.slice(8,10),c=0|i.slice(10,12),n=n<70?2e3+n:1900+n}return Date.UTC(n,r-1,o,s,a,c,0)},u.prototype._decodeNull=function(){return null},u.prototype._decodeBool=function(e){const t=e.readUInt8();return e.isError(t)?t:0!==t},u.prototype._decodeInt=function(e,t){const i=e.raw();let n=new r(i);return t&&(n=t[n.toString(10)]||n),n},u.prototype._use=function(e,t){return"function"===typeof e&&(e=e(t)),e._getDecoder("der").tree}},function(e){e.exports=JSON.parse('{"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}')},function(e,t,i){var n=i(41),r=i(3).Buffer;function o(e){var t=r.allocUnsafe(4);return t.writeUInt32BE(e,0),t}e.exports=function(e,t){for(var i,s=r.alloc(0),a=0;s.length<t;)i=o(a++),s=r.concat([s,n("sha1").update(e).update(i).digest()]);return s.slice(0,t)}},function(e,t){e.exports=function(e,t){for(var i=e.length,n=-1;++n<i;)e[n]^=t[n];return e}},function(e,t,i){var n=i(84),r=i(3).Buffer;e.exports=function(e,t){return r.from(e.toRed(n.mont(t.modulus)).redPow(new n(t.publicExponent)).fromRed().toArray())}},function(e,t,i){const n=i(51).AccessToken,r=i(51).priviledges;e.exports.RtmTokenBuilder=class{static buildToken(e,t,i,o,s){const a=new n(e,t,i,"");return a.addPriviledge(r.kRtmLogin,s),a.build()}},e.exports.Role={Rtm_User:1}},function(e,t,i){"use strict";var n=i(269),r={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},s={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},a={};function c(e){return n.isMemo(e)?s:a[e.$$typeof]||r}a[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},a[n.Memo]=s;var u=Object.defineProperty,d=Object.getOwnPropertyNames,l=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,i,n){if("string"!==typeof i){if(p){var r=f(i);r&&r!==p&&e(t,r,n)}var s=d(i);l&&(s=s.concat(l(i)));for(var a=c(t),m=c(i),_=0;_<s.length;++_){var g=s[_];if(!o[g]&&(!n||!n[g])&&(!m||!m[g])&&(!a||!a[g])){var v=h(i,g);try{u(t,g,v)}catch(E){}}}}return t}},function(e,t,i){"use strict";function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";function n(e){if(Array.isArray(e))return e}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}i.d(t,"a",(function(){return n}))},function(e,t,i){"use strict";var n=i(28),r=i(29);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(0)),s=(0,n(i(30)).default)(o.createElement("path",{d:"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"}),"Mic");t.default=s},function(e,t,i){"use strict";var n=i(28),r=i(29);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(0)),s=(0,n(i(30)).default)(o.createElement("path",{d:"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z"}),"MicOff");t.default=s},function(e,t,i){"use strict";var n=i(28),r=i(29);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(0)),s=(0,n(i(30)).default)(o.createElement("path",{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"}),"Videocam");t.default=s},function(e,t,i){"use strict";var n=i(28),r=i(29);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(0)),s=(0,n(i(30)).default)(o.createElement("path",{d:"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z"}),"VideocamOff");t.default=s},function(e,t,i){"use strict";var n=i(28),r=i(29);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(0)),s=(0,n(i(30)).default)(o.createElement("path",{d:"M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.11-.9-2-2-2H4c-1.11 0-2 .89-2 2v10c0 1.1.89 2 2 2H0v2h24v-2h-4zm-7-3.53v-2.19c-2.78 0-4.61.85-6 2.72.56-2.67 2.11-5.33 6-5.87V7l4 3.73-4 3.74z"}),"ScreenShare");t.default=s},function(e,t,i){"use strict";var n=i(28),r=i(29);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(0)),s=(0,n(i(30)).default)(o.createElement("path",{d:"M21.22 18.02l2 2H24v-2h-2.78zm.77-2l.01-10c0-1.11-.9-2-2-2H7.22l5.23 5.23c.18-.04.36-.07.55-.1V7.02l4 3.73-1.58 1.47 5.54 5.54c.61-.33 1.03-.99 1.03-1.74zM2.39 1.73L1.11 3l1.54 1.54c-.4.36-.65.89-.65 1.48v10c0 1.1.89 2 2 2H0v2h18.13l2.71 2.71 1.27-1.27L2.39 1.73zM7 15.02c.31-1.48.92-2.95 2.07-4.06l1.59 1.59c-1.54.38-2.7 1.18-3.66 2.47z"}),"StopScreenShare");t.default=s},function(e,t,i){"use strict";var n=i(28),r=i(29);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(i(0)),s=(0,n(i(30)).default)(o.createElement("path",{d:"M10.09 15.59L11.5 17l5-5-5-5-1.41 1.41L12.67 11H3v2h9.67l-2.58 2.59zM19 3H5c-1.11 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"ExitToApp");t.default=s},function(e,t,i){"use strict";function n(e){for(var t="https://mui.com/production-error/?code="+e,i=1;i<arguments.length;i+=1)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified Material-UI error #"+e+"; visit "+t+" for the full message."}i.d(t,"a",(function(){return n}))},,function(e,t,i){"use strict";var n=i(61),r=60103,o=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var s=60109,a=60110,c=60112;t.Suspense=60113;var u=60115,d=60116;if("function"===typeof Symbol&&Symbol.for){var l=Symbol.for;r=l("react.element"),o=l("react.portal"),t.Fragment=l("react.fragment"),t.StrictMode=l("react.strict_mode"),t.Profiler=l("react.profiler"),s=l("react.provider"),a=l("react.context"),c=l("react.forward_ref"),t.Suspense=l("react.suspense"),u=l("react.memo"),d=l("react.lazy")}var h="function"===typeof Symbol&&Symbol.iterator;function f(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function _(e,t,i){this.props=e,this.context=t,this.refs=m,this.updater=i||p}function g(){}function v(e,t,i){this.props=e,this.context=t,this.refs=m,this.updater=i||p}_.prototype.isReactComponent={},_.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(f(85));this.updater.enqueueSetState(this,e,t,"setState")},_.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=_.prototype;var E=v.prototype=new g;E.constructor=v,n(E,_.prototype),E.isPureReactComponent=!0;var b={current:null},y=Object.prototype.hasOwnProperty,w={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,i){var n,o={},s=null,a=null;if(null!=t)for(n in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(s=""+t.key),t)y.call(t,n)&&!w.hasOwnProperty(n)&&(o[n]=t[n]);var c=arguments.length-2;if(1===c)o.children=i;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];o.children=u}if(e&&e.defaultProps)for(n in c=e.defaultProps)void 0===o[n]&&(o[n]=c[n]);return{$$typeof:r,type:e,key:s,ref:a,props:o,_owner:b.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var R=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,i,n,s){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var c=!1;if(null===e)c=!0;else switch(a){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case r:case o:c=!0}}if(c)return s=s(c=e),e=""===n?"."+C(c,0):n,Array.isArray(s)?(i="",null!=e&&(i=e.replace(R,"$&/")+"/"),I(s,t,i,"",(function(e){return e}))):null!=s&&(T(s)&&(s=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(s,i+(!s.key||c&&c.key===s.key?"":(""+s.key).replace(R,"$&/")+"/")+e)),t.push(s)),1;if(c=0,n=""===n?".":n+":",Array.isArray(e))for(var u=0;u<e.length;u++){var d=n+C(a=e[u],u);c+=I(a,t,i,d,s)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),u=0;!(a=e.next()).done;)c+=I(a=a.value,t,i,d=n+C(a,u++),s);else if("object"===a)throw t=""+e,Error(f(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return c}function A(e,t,i){if(null==e)return e;var n=[],r=0;return I(e,n,"","",(function(e){return t.call(i,e,r++)})),n}function O(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var M={current:null};function N(){var e=M.current;if(null===e)throw Error(f(321));return e}var k={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:n};t.Children={map:A,forEach:function(e,t,i){A(e,(function(){t.apply(this,arguments)}),i)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error(f(143));return e}},t.Component=_,t.PureComponent=v,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,t.cloneElement=function(e,t,i){if(null===e||void 0===e)throw Error(f(267,e));var o=n({},e.props),s=e.key,a=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,c=b.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(d in t)y.call(t,d)&&!w.hasOwnProperty(d)&&(o[d]=void 0===t[d]&&void 0!==u?u[d]:t[d])}var d=arguments.length-2;if(1===d)o.children=i;else if(1<d){u=Array(d);for(var l=0;l<d;l++)u[l]=arguments[l+2];o.children=u}return{$$typeof:r,type:e.type,key:s,ref:a,props:o,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:a,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return N().useCallback(e,t)},t.useContext=function(e,t){return N().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return N().useEffect(e,t)},t.useImperativeHandle=function(e,t,i){return N().useImperativeHandle(e,t,i)},t.useLayoutEffect=function(e,t){return N().useLayoutEffect(e,t)},t.useMemo=function(e,t){return N().useMemo(e,t)},t.useReducer=function(e,t,i){return N().useReducer(e,t,i)},t.useRef=function(e){return N().useRef(e)},t.useState=function(e){return N().useState(e)},t.version="17.0.2"},function(e,t,i){"use strict";var n=i(0),r=i(61),o=i(156);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!n)throw Error(s(227));var a=new Set,c={};function u(e,t){d(e,t),d(e+"Capture",t)}function d(e,t){for(c[e]=t,e=0;e<t.length;e++)a.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f=Object.prototype.hasOwnProperty,p={},m={};function _(e,t,i,n,r,o,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=s}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new _(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new _(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new _(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new _(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new _(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new _(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new _(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new _(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new _(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function E(e){return e[1].toUpperCase()}function b(e,t,i,n){var r=g.hasOwnProperty(t)?g[t]:null;(null!==r?0===r.type:!n&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,i,n){if(null===t||"undefined"===typeof t||function(e,t,i,n){if(null!==i&&0===i.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,i,n))return!0;if(n)return!1;if(null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,i,r,n)&&(i=null),n||null===r?function(e){return!!f.call(m,e)||!f.call(p,e)&&(h.test(e)?m[e]=!0:(p[e]=!0,!1))}(t)&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=null===i?3!==r.type&&"":i:(t=r.attributeName,n=r.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,E);g[t]=new _(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,E);g[t]=new _(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,E);g[t]=new _(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new _(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new _(e,1,!1,e.toLowerCase(),null,!0,!0)}));var y=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=60103,S=60106,T=60107,R=60108,C=60114,I=60109,A=60110,O=60112,M=60113,N=60120,k=60115,P=60116,D=60121,L=60128,x=60129,U=60130,V=60131;if("function"===typeof Symbol&&Symbol.for){var B=Symbol.for;w=B("react.element"),S=B("react.portal"),T=B("react.fragment"),R=B("react.strict_mode"),C=B("react.profiler"),I=B("react.provider"),A=B("react.context"),O=B("react.forward_ref"),M=B("react.suspense"),N=B("react.suspense_list"),k=B("react.memo"),P=B("react.lazy"),D=B("react.block"),B("react.scope"),L=B("react.opaque.id"),x=B("react.debug_trace_mode"),U=B("react.offscreen"),V=B("react.legacy_hidden")}var j,F="function"===typeof Symbol&&Symbol.iterator;function W(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=F&&e[F]||e["@@iterator"])?e:null}function G(e){if(void 0===j)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var H=!1;function q(e,t){if(!e||H)return"";H=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var r=c.stack.split("\n"),o=n.stack.split("\n"),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==o[a])return"\n"+r[s].replace(" at new "," at ")}while(1<=s&&0<=a);break}}}finally{H=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?G(e):""}function K(e){switch(e.tag){case 5:return G(e.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return e=q(e.type,!1);case 11:return e=q(e.type.render,!1);case 22:return e=q(e.type._render,!1);case 1:return e=q(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case T:return"Fragment";case S:return"Portal";case C:return"Profiler";case R:return"StrictMode";case M:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case A:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case O:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case k:return z(e.type);case D:return z(e._render);case P:t=e._payload,e=e._init;try{return z(e(t))}catch(i){}}return null}function Y(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function J(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function X(e){e._valueTracker||(e._valueTracker=function(e){var t=J(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,o=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=J(e)?e.checked?"true":"false":e.value),(e=n)!==i&&(t.setValue(e),!0)}function Z(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var i=t.checked;return r({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function ee(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;i=Y(null!=t.value?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function ie(e,t){te(e,t);var i=Y(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?re(e,t.type,i):t.hasOwnProperty("defaultValue")&&re(e,t.type,Y(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function ne(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function re(e,t,i){"number"===t&&Z(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}function oe(e,t){return e=r({children:void 0},t),(t=function(e){var t="";return n.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function se(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+Y(i),t=null,r=0;r<e.length;r++){if(e[r].value===i)return e[r].selected=!0,void(n&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return r({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ce(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(s(92));if(Array.isArray(i)){if(!(1>=i.length))throw Error(s(93));i=i[0]}t=i}null==t&&(t=""),i=t}e._wrapperState={initialValue:Y(i)}}function ue(e,t){var i=Y(t.value),n=Y(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue&&e.defaultValue!==i&&(e.defaultValue=i)),null!=n&&(e.defaultValue=""+n)}function de(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var le={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function he(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?he(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var pe,me,_e=(me=function(e,t){if(e.namespaceURI!==le.svg||"innerHTML"in e)e.innerHTML=t;else{for((pe=pe||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=pe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction((function(){return me(e,t)}))}:me);function ge(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var ve={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ee=["Webkit","ms","Moz","O"];function be(e,t,i){return null==t||"boolean"===typeof t||""===t?"":i||"number"!==typeof t||0===t||ve.hasOwnProperty(e)&&ve[e]?(""+t).trim():t+"px"}function ye(e,t){for(var i in e=e.style,t)if(t.hasOwnProperty(i)){var n=0===i.indexOf("--"),r=be(i,t[i],n);"float"===i&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}Object.keys(ve).forEach((function(e){Ee.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ve[t]=ve[e]}))}));var we=r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Se(e,t){if(t){if(we[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function Te(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Re(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ce=null,Ie=null,Ae=null;function Oe(e){if(e=ir(e)){if("function"!==typeof Ce)throw Error(s(280));var t=e.stateNode;t&&(t=rr(t),Ce(e.stateNode,e.type,t))}}function Me(e){Ie?Ae?Ae.push(e):Ae=[e]:Ie=e}function Ne(){if(Ie){var e=Ie,t=Ae;if(Ae=Ie=null,Oe(e),t)for(e=0;e<t.length;e++)Oe(t[e])}}function ke(e,t){return e(t)}function Pe(e,t,i,n,r){return e(t,i,n,r)}function De(){}var Le=ke,xe=!1,Ue=!1;function Ve(){null===Ie&&null===Ae||(De(),Ne())}function Be(e,t){var i=e.stateNode;if(null===i)return null;var n=rr(i);if(null===n)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(i&&"function"!==typeof i)throw Error(s(231,t,typeof i));return i}var je=!1;if(l)try{var Fe={};Object.defineProperty(Fe,"passive",{get:function(){je=!0}}),window.addEventListener("test",Fe,Fe),window.removeEventListener("test",Fe,Fe)}catch(me){je=!1}function We(e,t,i,n,r,o,s,a,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(i,u)}catch(d){this.onError(d)}}var Ge=!1,He=null,qe=!1,Ke=null,ze={onError:function(e){Ge=!0,He=e}};function Ye(e,t,i,n,r,o,s,a,c){Ge=!1,He=null,We.apply(ze,arguments)}function Je(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(i=t.return),e=t.return}while(e)}return 3===t.tag?i:null}function Xe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Qe(e){if(Je(e)!==e)throw Error(s(188))}function Ze(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Je(e)))throw Error(s(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(n=r.return)){i=n;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===i)return Qe(r),e;if(o===n)return Qe(r),t;o=o.sibling}throw Error(s(188))}if(i.return!==n.return)i=r,n=o;else{for(var a=!1,c=r.child;c;){if(c===i){a=!0,i=r,n=o;break}if(c===n){a=!0,n=r,i=o;break}c=c.sibling}if(!a){for(c=o.child;c;){if(c===i){a=!0,i=o,n=r;break}if(c===n){a=!0,n=o,i=r;break}c=c.sibling}if(!a)throw Error(s(189))}}if(i.alternate!==n)throw Error(s(190))}if(3!==i.tag)throw Error(s(188));return i.stateNode.current===i?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function $e(e,t){for(var i=e.alternate;null!==t;){if(t===e||t===i)return!0;t=t.return}return!1}var et,tt,it,nt,rt=!1,ot=[],st=null,at=null,ct=null,ut=new Map,dt=new Map,lt=[],ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ft(e,t,i,n,r){return{blockedOn:e,domEventName:t,eventSystemFlags:16|i,nativeEvent:r,targetContainers:[n]}}function pt(e,t){switch(e){case"focusin":case"focusout":st=null;break;case"dragenter":case"dragleave":at=null;break;case"mouseover":case"mouseout":ct=null;break;case"pointerover":case"pointerout":ut.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dt.delete(t.pointerId)}}function mt(e,t,i,n,r,o){return null===e||e.nativeEvent!==o?(e=ft(t,i,n,r,o),null!==t&&(null!==(t=ir(t))&&tt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function _t(e){var t=tr(e.target);if(null!==t){var i=Je(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=Xe(i)))return e.blockedOn=t,void nt(e.lanePriority,(function(){o.unstable_runWithPriority(e.priority,(function(){it(i)}))}))}else if(3===t&&i.stateNode.hydrate)return void(e.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}e.blockedOn=null}function gt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var i=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=ir(i))&&tt(t),e.blockedOn=i,!1;t.shift()}return!0}function vt(e,t,i){gt(e)&&i.delete(t)}function Et(){for(rt=!1;0<ot.length;){var e=ot[0];if(null!==e.blockedOn){null!==(e=ir(e.blockedOn))&&et(e);break}for(var t=e.targetContainers;0<t.length;){var i=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i){e.blockedOn=i;break}t.shift()}null===e.blockedOn&&ot.shift()}null!==st&&gt(st)&&(st=null),null!==at&&gt(at)&&(at=null),null!==ct&&gt(ct)&&(ct=null),ut.forEach(vt),dt.forEach(vt)}function bt(e,t){e.blockedOn===t&&(e.blockedOn=null,rt||(rt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Et)))}function yt(e){function t(t){return bt(t,e)}if(0<ot.length){bt(ot[0],e);for(var i=1;i<ot.length;i++){var n=ot[i];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==st&&bt(st,e),null!==at&&bt(at,e),null!==ct&&bt(ct,e),ut.forEach(t),dt.forEach(t),i=0;i<lt.length;i++)(n=lt[i]).blockedOn===e&&(n.blockedOn=null);for(;0<lt.length&&null===(i=lt[0]).blockedOn;)_t(i),null===i.blockedOn&&lt.shift()}function wt(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var St={animationend:wt("Animation","AnimationEnd"),animationiteration:wt("Animation","AnimationIteration"),animationstart:wt("Animation","AnimationStart"),transitionend:wt("Transition","TransitionEnd")},Tt={},Rt={};function Ct(e){if(Tt[e])return Tt[e];if(!St[e])return e;var t,i=St[e];for(t in i)if(i.hasOwnProperty(t)&&t in Rt)return Tt[e]=i[t];return e}l&&(Rt=document.createElement("div").style,"AnimationEvent"in window||(delete St.animationend.animation,delete St.animationiteration.animation,delete St.animationstart.animation),"TransitionEvent"in window||delete St.transitionend.transition);var It=Ct("animationend"),At=Ct("animationiteration"),Ot=Ct("animationstart"),Mt=Ct("transitionend"),Nt=new Map,kt=new Map,Pt=["abort","abort",It,"animationEnd",At,"animationIteration",Ot,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Mt,"transitionEnd","waiting","waiting"];function Dt(e,t){for(var i=0;i<e.length;i+=2){var n=e[i],r=e[i+1];r="on"+(r[0].toUpperCase()+r.slice(1)),kt.set(n,t),Nt.set(n,r),u(r,[n])}}(0,o.unstable_now)();var Lt=8;function xt(e){if(0!==(1&e))return Lt=15,1;if(0!==(2&e))return Lt=14,2;if(0!==(4&e))return Lt=13,4;var t=24&e;return 0!==t?(Lt=12,t):0!==(32&e)?(Lt=11,32):0!==(t=192&e)?(Lt=10,t):0!==(256&e)?(Lt=9,256):0!==(t=3584&e)?(Lt=8,t):0!==(4096&e)?(Lt=7,4096):0!==(t=4186112&e)?(Lt=6,t):0!==(t=62914560&e)?(Lt=5,t):67108864&e?(Lt=4,67108864):0!==(134217728&e)?(Lt=3,134217728):0!==(t=805306368&e)?(Lt=2,t):0!==(1073741824&e)?(Lt=1,1073741824):(Lt=8,e)}function Ut(e,t){var i=e.pendingLanes;if(0===i)return Lt=0;var n=0,r=0,o=e.expiredLanes,s=e.suspendedLanes,a=e.pingedLanes;if(0!==o)n=o,r=Lt=15;else if(0!==(o=134217727&i)){var c=o&~s;0!==c?(n=xt(c),r=Lt):0!==(a&=o)&&(n=xt(a),r=Lt)}else 0!==(o=i&~s)?(n=xt(o),r=Lt):0!==a&&(n=xt(a),r=Lt);if(0===n)return 0;if(n=i&((0>(n=31-Gt(n))?0:1<<n)<<1)-1,0!==t&&t!==n&&0===(t&s)){if(xt(t),r<=Lt)return t;Lt=r}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)r=1<<(i=31-Gt(t)),n|=e[i],t&=~r;return n}function Vt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Bt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=jt(24&~t))?Bt(10,t):e;case 10:return 0===(e=jt(192&~t))?Bt(8,t):e;case 8:return 0===(e=jt(3584&~t))&&(0===(e=jt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=jt(805306368&~t))&&(t=268435456),t}throw Error(s(358,e))}function jt(e){return e&-e}function Ft(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function Wt(e,t,i){e.pendingLanes|=t;var n=t-1;e.suspendedLanes&=n,e.pingedLanes&=n,(e=e.eventTimes)[t=31-Gt(t)]=i}var Gt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Ht(e)/qt|0)|0},Ht=Math.log,qt=Math.LN2;var Kt=o.unstable_UserBlockingPriority,zt=o.unstable_runWithPriority,Yt=!0;function Jt(e,t,i,n){xe||De();var r=Qt,o=xe;xe=!0;try{Pe(r,e,t,i,n)}finally{(xe=o)||Ve()}}function Xt(e,t,i,n){zt(Kt,Qt.bind(null,e,t,i,n))}function Qt(e,t,i,n){var r;if(Yt)if((r=0===(4&t))&&0<ot.length&&-1<ht.indexOf(e))e=ft(null,e,t,i,n),ot.push(e);else{var o=Zt(e,t,i,n);if(null===o)r&&pt(e,n);else{if(r){if(-1<ht.indexOf(e))return e=ft(o,e,t,i,n),void ot.push(e);if(function(e,t,i,n,r){switch(t){case"focusin":return st=mt(st,e,t,i,n,r),!0;case"dragenter":return at=mt(at,e,t,i,n,r),!0;case"mouseover":return ct=mt(ct,e,t,i,n,r),!0;case"pointerover":var o=r.pointerId;return ut.set(o,mt(ut.get(o)||null,e,t,i,n,r)),!0;case"gotpointercapture":return o=r.pointerId,dt.set(o,mt(dt.get(o)||null,e,t,i,n,r)),!0}return!1}(o,e,t,i,n))return;pt(e,n)}Dn(e,t,n,null,i)}}}function Zt(e,t,i,n){var r=Re(n);if(null!==(r=tr(r))){var o=Je(r);if(null===o)r=null;else{var s=o.tag;if(13===s){if(null!==(r=Xe(o)))return r;r=null}else if(3===s){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return Dn(e,t,n,r,i),null}var $t=null,ei=null,ti=null;function ii(){if(ti)return ti;var e,t,i=ei,n=i.length,r="value"in $t?$t.value:$t.textContent,o=r.length;for(e=0;e<n&&i[e]===r[e];e++);var s=n-e;for(t=1;t<=s&&i[n-t]===r[o-t];t++);return ti=r.slice(e,1<t?1-t:void 0)}function ni(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ri(){return!0}function oi(){return!1}function si(e){function t(t,i,n,r,o){for(var s in this._reactName=t,this._targetInst=n,this.type=i,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?ri:oi,this.isPropagationStopped=oi,this}return r(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ri)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ri)},persist:function(){},isPersistent:ri}),t}var ai,ci,ui,di={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},li=si(di),hi=r({},di,{view:0,detail:0}),fi=si(hi),pi=r({},hi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ci,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ui&&(ui&&"mousemove"===e.type?(ai=e.screenX-ui.screenX,ci=e.screenY-ui.screenY):ci=ai=0,ui=e),ai)},movementY:function(e){return"movementY"in e?e.movementY:ci}}),mi=si(pi),_i=si(r({},pi,{dataTransfer:0})),gi=si(r({},hi,{relatedTarget:0})),vi=si(r({},di,{animationName:0,elapsedTime:0,pseudoElement:0})),Ei=r({},di,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bi=si(Ei),yi=si(r({},di,{data:0})),wi={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Si={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ti={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ri(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Ti[e])&&!!t[e]}function Ci(){return Ri}var Ii=r({},hi,{key:function(e){if(e.key){var t=wi[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ni(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Si[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ci,charCode:function(e){return"keypress"===e.type?ni(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ni(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Ai=si(Ii),Oi=si(r({},pi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mi=si(r({},hi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ci})),Ni=si(r({},di,{propertyName:0,elapsedTime:0,pseudoElement:0})),ki=r({},pi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pi=si(ki),Di=[9,13,27,32],Li=l&&"CompositionEvent"in window,xi=null;l&&"documentMode"in document&&(xi=document.documentMode);var Ui=l&&"TextEvent"in window&&!xi,Vi=l&&(!Li||xi&&8<xi&&11>=xi),Bi=String.fromCharCode(32),ji=!1;function Fi(e,t){switch(e){case"keyup":return-1!==Di.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wi(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Gi=!1;var Hi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qi(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hi[e.type]:"textarea"===t}function Ki(e,t,i,n){Me(n),0<(t=xn(t,"onChange")).length&&(i=new li("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var zi=null,Yi=null;function Ji(e){An(e,0)}function Xi(e){if(Q(nr(e)))return e}function Qi(e,t){if("change"===e)return t}var Zi=!1;if(l){var $i;if(l){var en="oninput"in document;if(!en){var tn=document.createElement("div");tn.setAttribute("oninput","return;"),en="function"===typeof tn.oninput}$i=en}else $i=!1;Zi=$i&&(!document.documentMode||9<document.documentMode)}function nn(){zi&&(zi.detachEvent("onpropertychange",rn),Yi=zi=null)}function rn(e){if("value"===e.propertyName&&Xi(Yi)){var t=[];if(Ki(t,Yi,e,Re(e)),e=Ji,xe)e(t);else{xe=!0;try{ke(e,t)}finally{xe=!1,Ve()}}}}function on(e,t,i){"focusin"===e?(nn(),Yi=i,(zi=t).attachEvent("onpropertychange",rn)):"focusout"===e&&nn()}function sn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xi(Yi)}function an(e,t){if("click"===e)return Xi(t)}function cn(e,t){if("input"===e||"change"===e)return Xi(t)}var un="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},dn=Object.prototype.hasOwnProperty;function ln(e,t){if(un(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++)if(!dn.call(t,i[n])||!un(e[i[n]],t[i[n]]))return!1;return!0}function hn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fn(e,t){var i,n=hn(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&i>=t)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=hn(n)}}function pn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function mn(){for(var e=window,t=Z();t instanceof e.HTMLIFrameElement;){try{var i="string"===typeof t.contentWindow.location.href}catch(n){i=!1}if(!i)break;t=Z((e=t.contentWindow).document)}return t}function _n(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var gn=l&&"documentMode"in document&&11>=document.documentMode,vn=null,En=null,bn=null,yn=!1;function wn(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;yn||null==vn||vn!==Z(n)||("selectionStart"in(n=vn)&&_n(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},bn&&ln(bn,n)||(bn=n,0<(n=xn(En,"onSelect")).length&&(t=new li("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=vn)))}Dt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Dt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Dt(Pt,2);for(var Sn="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Tn=0;Tn<Sn.length;Tn++)kt.set(Sn[Tn],0);d("onMouseEnter",["mouseout","mouseover"]),d("onMouseLeave",["mouseout","mouseover"]),d("onPointerEnter",["pointerout","pointerover"]),d("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rn));function In(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(e,t,i,n,r,o,a,c,u){if(Ye.apply(this,arguments),Ge){if(!Ge)throw Error(s(198));var d=He;Ge=!1,He=null,qe||(qe=!0,Ke=d)}}(n,t,void 0,e),e.currentTarget=null}function An(e,t){t=0!==(4&t);for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var s=n.length-1;0<=s;s--){var a=n[s],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==o&&r.isPropagationStopped())break e;In(r,a,u),o=c}else for(s=0;s<n.length;s++){if(c=(a=n[s]).instance,u=a.currentTarget,a=a.listener,c!==o&&r.isPropagationStopped())break e;In(r,a,u),o=c}}}if(qe)throw e=Ke,qe=!1,Ke=null,e}function On(e,t){var i=or(t),n=e+"__bubble";i.has(n)||(Pn(t,e,2,!1),i.add(n))}var Mn="_reactListening"+Math.random().toString(36).slice(2);function Nn(e){e[Mn]||(e[Mn]=!0,a.forEach((function(t){Cn.has(t)||kn(t,!1,e,null),kn(t,!0,e,null)})))}function kn(e,t,i,n){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=i;if("selectionchange"===e&&9!==i.nodeType&&(o=i.ownerDocument),null!==n&&!t&&Cn.has(e)){if("scroll"!==e)return;r|=2,o=n}var s=or(o),a=e+"__"+(t?"capture":"bubble");s.has(a)||(t&&(r|=4),Pn(o,e,r,t),s.add(a))}function Pn(e,t,i,n){var r=kt.get(t);switch(void 0===r?2:r){case 0:r=Jt;break;case 1:r=Xt;break;default:r=Qt}i=r.bind(null,t,i,e),r=void 0,!je||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),n?void 0!==r?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):void 0!==r?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function Dn(e,t,i,n,r){var o=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var a=n.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=n.return;null!==s;){var c=s.tag;if((3===c||4===c)&&((c=s.stateNode.containerInfo)===r||8===c.nodeType&&c.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=tr(a)))return;if(5===(c=s.tag)||6===c){n=o=s;continue e}a=a.parentNode}}n=n.return}!function(e,t,i){if(Ue)return e(t,i);Ue=!0;try{return Le(e,t,i)}finally{Ue=!1,Ve()}}((function(){var n=o,r=Re(i),s=[];e:{var a=Nt.get(e);if(void 0!==a){var c=li,u=e;switch(e){case"keypress":if(0===ni(i))break e;case"keydown":case"keyup":c=Ai;break;case"focusin":u="focus",c=gi;break;case"focusout":u="blur",c=gi;break;case"beforeblur":case"afterblur":c=gi;break;case"click":if(2===i.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=mi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=_i;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Mi;break;case It:case At:case Ot:c=vi;break;case Mt:c=Ni;break;case"scroll":c=fi;break;case"wheel":c=Pi;break;case"copy":case"cut":case"paste":c=bi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Oi}var d=0!==(4&t),l=!d&&"scroll"===e,h=d?null!==a?a+"Capture":null:a;d=[];for(var f,p=n;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=Be(p,h))&&d.push(Ln(p,m,f)))),l)break;p=p.return}0<d.length&&(a=new c(a,u,null,i,r),s.push({event:a,listeners:d}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(u=i.relatedTarget||i.fromElement)||!tr(u)&&!u[$n])&&(c||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,c?(c=n,null!==(u=(u=i.relatedTarget||i.toElement)?tr(u):null)&&(u!==(l=Je(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(c=null,u=n),c!==u)){if(d=mi,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(d=Oi,m="onPointerLeave",h="onPointerEnter",p="pointer"),l=null==c?a:nr(c),f=null==u?a:nr(u),(a=new d(m,p+"leave",c,i,r)).target=l,a.relatedTarget=f,m=null,tr(r)===n&&((d=new d(h,p+"enter",u,i,r)).target=f,d.relatedTarget=l,m=d),l=m,c&&u)e:{for(h=u,p=0,f=d=c;f;f=Un(f))p++;for(f=0,m=h;m;m=Un(m))f++;for(;0<p-f;)d=Un(d),p--;for(;0<f-p;)h=Un(h),f--;for(;p--;){if(d===h||null!==h&&d===h.alternate)break e;d=Un(d),h=Un(h)}d=null}else d=null;null!==c&&Vn(s,a,c,d,!1),null!==u&&null!==l&&Vn(s,l,u,d,!0)}if("select"===(c=(a=n?nr(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===c&&"file"===a.type)var _=Qi;else if(qi(a))if(Zi)_=cn;else{_=sn;var g=on}else(c=a.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(_=an);switch(_&&(_=_(e,n))?Ki(s,_,i,r):(g&&g(e,a,n),"focusout"===e&&(g=a._wrapperState)&&g.controlled&&"number"===a.type&&re(a,"number",a.value)),g=n?nr(n):window,e){case"focusin":(qi(g)||"true"===g.contentEditable)&&(vn=g,En=n,bn=null);break;case"focusout":bn=En=vn=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,wn(s,i,r);break;case"selectionchange":if(gn)break;case"keydown":case"keyup":wn(s,i,r)}var v;if(Li)e:{switch(e){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Gi?Fi(e,i)&&(E="onCompositionEnd"):"keydown"===e&&229===i.keyCode&&(E="onCompositionStart");E&&(Vi&&"ko"!==i.locale&&(Gi||"onCompositionStart"!==E?"onCompositionEnd"===E&&Gi&&(v=ii()):(ei="value"in($t=r)?$t.value:$t.textContent,Gi=!0)),0<(g=xn(n,E)).length&&(E=new yi(E,e,null,i,r),s.push({event:E,listeners:g}),v?E.data=v:null!==(v=Wi(i))&&(E.data=v))),(v=Ui?function(e,t){switch(e){case"compositionend":return Wi(t);case"keypress":return 32!==t.which?null:(ji=!0,Bi);case"textInput":return(e=t.data)===Bi&&ji?null:e;default:return null}}(e,i):function(e,t){if(Gi)return"compositionend"===e||!Li&&Fi(e,t)?(e=ii(),ti=ei=$t=null,Gi=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Vi&&"ko"!==t.locale?null:t.data}}(e,i))&&(0<(n=xn(n,"onBeforeInput")).length&&(r=new yi("onBeforeInput","beforeinput",null,i,r),s.push({event:r,listeners:n}),r.data=v))}An(s,t)}))}function Ln(e,t,i){return{instance:e,listener:t,currentTarget:i}}function xn(e,t){for(var i=t+"Capture",n=[];null!==e;){var r=e,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Be(e,i))&&n.unshift(Ln(e,o,r)),null!=(o=Be(e,t))&&n.push(Ln(e,o,r))),e=e.return}return n}function Un(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Vn(e,t,i,n,r){for(var o=t._reactName,s=[];null!==i&&i!==n;){var a=i,c=a.alternate,u=a.stateNode;if(null!==c&&c===n)break;5===a.tag&&null!==u&&(a=u,r?null!=(c=Be(i,o))&&s.unshift(Ln(i,c,a)):r||null!=(c=Be(i,o))&&s.push(Ln(i,c,a))),i=i.return}0!==s.length&&e.push({event:t,listeners:s})}function Bn(){}var jn=null,Fn=null;function Wn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Gn(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Hn="function"===typeof setTimeout?setTimeout:void 0,qn="function"===typeof clearTimeout?clearTimeout:void 0;function Kn(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function zn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Yn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var Jn=0;var Xn=Math.random().toString(36).slice(2),Qn="__reactFiber$"+Xn,Zn="__reactProps$"+Xn,$n="__reactContainer$"+Xn,er="__reactEvents$"+Xn;function tr(e){var t=e[Qn];if(t)return t;for(var i=e.parentNode;i;){if(t=i[$n]||i[Qn]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=Yn(e);null!==e;){if(i=e[Qn])return i;e=Yn(e)}return t}i=(e=i).parentNode}return null}function ir(e){return!(e=e[Qn]||e[$n])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function nr(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function rr(e){return e[Zn]||null}function or(e){var t=e[er];return void 0===t&&(t=e[er]=new Set),t}var sr=[],ar=-1;function cr(e){return{current:e}}function ur(e){0>ar||(e.current=sr[ar],sr[ar]=null,ar--)}function dr(e,t){ar++,sr[ar]=e.current,e.current=t}var lr={},hr=cr(lr),fr=cr(!1),pr=lr;function mr(e,t){var i=e.type.contextTypes;if(!i)return lr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in i)o[r]=t[r];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function _r(e){return null!==(e=e.childContextTypes)&&void 0!==e}function gr(){ur(fr),ur(hr)}function vr(e,t,i){if(hr.current!==lr)throw Error(s(168));dr(hr,t),dr(fr,i)}function Er(e,t,i){var n=e.stateNode;if(e=t.childContextTypes,"function"!==typeof n.getChildContext)return i;for(var o in n=n.getChildContext())if(!(o in e))throw Error(s(108,z(t)||"Unknown",o));return r({},i,n)}function br(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||lr,pr=hr.current,dr(hr,e),dr(fr,fr.current),!0}function yr(e,t,i){var n=e.stateNode;if(!n)throw Error(s(169));i?(e=Er(e,t,pr),n.__reactInternalMemoizedMergedChildContext=e,ur(fr),ur(hr),dr(hr,e)):ur(fr),dr(fr,i)}var wr=null,Sr=null,Tr=o.unstable_runWithPriority,Rr=o.unstable_scheduleCallback,Cr=o.unstable_cancelCallback,Ir=o.unstable_shouldYield,Ar=o.unstable_requestPaint,Or=o.unstable_now,Mr=o.unstable_getCurrentPriorityLevel,Nr=o.unstable_ImmediatePriority,kr=o.unstable_UserBlockingPriority,Pr=o.unstable_NormalPriority,Dr=o.unstable_LowPriority,Lr=o.unstable_IdlePriority,xr={},Ur=void 0!==Ar?Ar:function(){},Vr=null,Br=null,jr=!1,Fr=Or(),Wr=1e4>Fr?Or:function(){return Or()-Fr};function Gr(){switch(Mr()){case Nr:return 99;case kr:return 98;case Pr:return 97;case Dr:return 96;case Lr:return 95;default:throw Error(s(332))}}function Hr(e){switch(e){case 99:return Nr;case 98:return kr;case 97:return Pr;case 96:return Dr;case 95:return Lr;default:throw Error(s(332))}}function qr(e,t){return e=Hr(e),Tr(e,t)}function Kr(e,t,i){return e=Hr(e),Rr(e,t,i)}function zr(){if(null!==Br){var e=Br;Br=null,Cr(e)}Yr()}function Yr(){if(!jr&&null!==Vr){jr=!0;var e=0;try{var t=Vr;qr(99,(function(){for(;e<t.length;e++){var i=t[e];do{i=i(!0)}while(null!==i)}})),Vr=null}catch(i){throw null!==Vr&&(Vr=Vr.slice(e+1)),Rr(Nr,zr),i}finally{jr=!1}}}var Jr=y.ReactCurrentBatchConfig;function Xr(e,t){if(e&&e.defaultProps){for(var i in t=r({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}return t}var Qr=cr(null),Zr=null,$r=null,eo=null;function to(){eo=$r=Zr=null}function io(e){var t=Qr.current;ur(Qr),e.type._context._currentValue=t}function no(e,t){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)===t){if(null===i||(i.childLanes&t)===t)break;i.childLanes|=t}else e.childLanes|=t,null!==i&&(i.childLanes|=t);e=e.return}}function ro(e,t){Zr=e,eo=$r=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function oo(e,t){if(eo!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(eo=e,t=1073741823),t={context:e,observedBits:t,next:null},null===$r){if(null===Zr)throw Error(s(308));$r=t,Zr.dependencies={lanes:0,firstContext:t,responders:null}}else $r=$r.next=t;return e._currentValue}var so=!1;function ao(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function co(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function uo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function lo(e,t){if(null!==(e=e.updateQueue)){var i=(e=e.shared).pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}}function ho(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var r=null,o=null;if(null!==(i=i.firstBaseUpdate)){do{var s={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===o?r=o=s:o=o.next=s,i=i.next}while(null!==i);null===o?r=o=t:o=o.next=t}else r=o=t;return i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function fo(e,t,i,n){var o=e.updateQueue;so=!1;var s=o.firstBaseUpdate,a=o.lastBaseUpdate,c=o.shared.pending;if(null!==c){o.shared.pending=null;var u=c,d=u.next;u.next=null,null===a?s=d:a.next=d,a=u;var l=e.alternate;if(null!==l){var h=(l=l.updateQueue).lastBaseUpdate;h!==a&&(null===h?l.firstBaseUpdate=d:h.next=d,l.lastBaseUpdate=u)}}if(null!==s){for(h=o.baseState,a=0,l=d=u=null;;){c=s.lane;var f=s.eventTime;if((n&c)===c){null!==l&&(l=l.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(c=t,f=i,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,c);break e}h=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(c="function"===typeof(p=m.payload)?p.call(f,h,c):p)||void 0===c)break e;h=r({},h,c);break e;case 2:so=!0}}null!==s.callback&&(e.flags|=32,null===(c=o.effects)?o.effects=[s]:c.push(s))}else f={eventTime:f,lane:c,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(d=l=f,u=h):l=l.next=f,a|=c;if(null===(s=s.next)){if(null===(c=o.shared.pending))break;s=c.next,c.next=null,o.lastBaseUpdate=c,o.shared.pending=null}}null===l&&(u=h),o.baseState=u,o.firstBaseUpdate=d,o.lastBaseUpdate=l,Fa|=a,e.lanes=a,e.memoizedState=h}}function po(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(null!==r){if(n.callback=null,n=i,"function"!==typeof r)throw Error(s(191,r));r.call(n)}}}var mo=(new n.Component).refs;function _o(e,t,i,n){i=null===(i=i(n,t=e.memoizedState))||void 0===i?t:r({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var go={isMounted:function(e){return!!(e=e._reactInternals)&&Je(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=hc(),r=fc(e),o=uo(n,r);o.payload=t,void 0!==i&&null!==i&&(o.callback=i),lo(e,o),pc(e,r,n)},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=hc(),r=fc(e),o=uo(n,r);o.tag=1,o.payload=t,void 0!==i&&null!==i&&(o.callback=i),lo(e,o),pc(e,r,n)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=hc(),n=fc(e),r=uo(i,n);r.tag=2,void 0!==t&&null!==t&&(r.callback=t),lo(e,r),pc(e,n,i)}};function vo(e,t,i,n,r,o,s){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,o,s):!t.prototype||!t.prototype.isPureReactComponent||(!ln(i,n)||!ln(r,o))}function Eo(e,t,i){var n=!1,r=lr,o=t.contextType;return"object"===typeof o&&null!==o?o=oo(o):(r=_r(t)?pr:hr.current,o=(n=null!==(n=t.contextTypes)&&void 0!==n)?mr(e,r):lr),t=new t(i,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=go,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=o),t}function bo(e,t,i,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&go.enqueueReplaceState(t,t.state,null)}function yo(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs=mo,ao(e);var o=t.contextType;"object"===typeof o&&null!==o?r.context=oo(o):(o=_r(t)?pr:hr.current,r.context=mr(e,o)),fo(e,i,r,n),r.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(_o(e,t,o,i),r.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof r.getSnapshotBeforeUpdate||"function"!==typeof r.UNSAFE_componentWillMount&&"function"!==typeof r.componentWillMount||(t=r.state,"function"===typeof r.componentWillMount&&r.componentWillMount(),"function"===typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),t!==r.state&&go.enqueueReplaceState(r,r.state,null),fo(e,i,r,n),r.state=e.memoizedState),"function"===typeof r.componentDidMount&&(e.flags|=4)}var wo=Array.isArray;function So(e,t,i){if(null!==(e=i.ref)&&"function"!==typeof e&&"object"!==typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(s(309));var n=i.stateNode}if(!n)throw Error(s(147,e));var r=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===r?t.ref:(t=function(e){var t=n.refs;t===mo&&(t=n.refs={}),null===e?delete t[r]:t[r]=e},t._stringRef=r,t)}if("string"!==typeof e)throw Error(s(284));if(!i._owner)throw Error(s(290,e))}return e}function To(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Ro(e){function t(t,i){if(e){var n=t.lastEffect;null!==n?(n.nextEffect=i,t.lastEffect=i):t.firstEffect=t.lastEffect=i,i.nextEffect=null,i.flags=8}}function i(i,n){if(!e)return null;for(;null!==n;)t(i,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function r(e,t){return(e=Kc(e,t)).index=0,e.sibling=null,e}function o(t,i,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<i?(t.flags=2,i):n:(t.flags=2,i):i}function a(t){return e&&null===t.alternate&&(t.flags=2),t}function c(e,t,i,n){return null===t||6!==t.tag?((t=Xc(i,e.mode,n)).return=e,t):((t=r(t,i)).return=e,t)}function u(e,t,i,n){return null!==t&&t.elementType===i.type?((n=r(t,i.props)).ref=So(e,t,i),n.return=e,n):((n=zc(i.type,i.key,i.props,null,e.mode,n)).ref=So(e,t,i),n.return=e,n)}function d(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((t=Qc(i,e.mode,n)).return=e,t):((t=r(t,i.children||[])).return=e,t)}function l(e,t,i,n,o){return null===t||7!==t.tag?((t=Yc(i,e.mode,n,o)).return=e,t):((t=r(t,i)).return=e,t)}function h(e,t,i){if("string"===typeof t||"number"===typeof t)return(t=Xc(""+t,e.mode,i)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(i=zc(t.type,t.key,t.props,null,e.mode,i)).ref=So(e,null,t),i.return=e,i;case S:return(t=Qc(t,e.mode,i)).return=e,t}if(wo(t)||W(t))return(t=Yc(t,e.mode,i,null)).return=e,t;To(e,t)}return null}function f(e,t,i,n){var r=null!==t?t.key:null;if("string"===typeof i||"number"===typeof i)return null!==r?null:c(e,t,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case w:return i.key===r?i.type===T?l(e,t,i.props.children,n,r):u(e,t,i,n):null;case S:return i.key===r?d(e,t,i,n):null}if(wo(i)||W(i))return null!==r?null:l(e,t,i,n,null);To(e,i)}return null}function p(e,t,i,n,r){if("string"===typeof n||"number"===typeof n)return c(t,e=e.get(i)||null,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return e=e.get(null===n.key?i:n.key)||null,n.type===T?l(t,e,n.props.children,r,n.key):u(t,e,n,r);case S:return d(t,e=e.get(null===n.key?i:n.key)||null,n,r)}if(wo(n)||W(n))return l(t,e=e.get(i)||null,n,r,null);To(t,n)}return null}function m(r,s,a,c){for(var u=null,d=null,l=s,m=s=0,_=null;null!==l&&m<a.length;m++){l.index>m?(_=l,l=null):_=l.sibling;var g=f(r,l,a[m],c);if(null===g){null===l&&(l=_);break}e&&l&&null===g.alternate&&t(r,l),s=o(g,s,m),null===d?u=g:d.sibling=g,d=g,l=_}if(m===a.length)return i(r,l),u;if(null===l){for(;m<a.length;m++)null!==(l=h(r,a[m],c))&&(s=o(l,s,m),null===d?u=l:d.sibling=l,d=l);return u}for(l=n(r,l);m<a.length;m++)null!==(_=p(l,r,m,a[m],c))&&(e&&null!==_.alternate&&l.delete(null===_.key?m:_.key),s=o(_,s,m),null===d?u=_:d.sibling=_,d=_);return e&&l.forEach((function(e){return t(r,e)})),u}function _(r,a,c,u){var d=W(c);if("function"!==typeof d)throw Error(s(150));if(null==(c=d.call(c)))throw Error(s(151));for(var l=d=null,m=a,_=a=0,g=null,v=c.next();null!==m&&!v.done;_++,v=c.next()){m.index>_?(g=m,m=null):g=m.sibling;var E=f(r,m,v.value,u);if(null===E){null===m&&(m=g);break}e&&m&&null===E.alternate&&t(r,m),a=o(E,a,_),null===l?d=E:l.sibling=E,l=E,m=g}if(v.done)return i(r,m),d;if(null===m){for(;!v.done;_++,v=c.next())null!==(v=h(r,v.value,u))&&(a=o(v,a,_),null===l?d=v:l.sibling=v,l=v);return d}for(m=n(r,m);!v.done;_++,v=c.next())null!==(v=p(m,r,_,v.value,u))&&(e&&null!==v.alternate&&m.delete(null===v.key?_:v.key),a=o(v,a,_),null===l?d=v:l.sibling=v,l=v);return e&&m.forEach((function(e){return t(r,e)})),d}return function(e,n,o,c){var u="object"===typeof o&&null!==o&&o.type===T&&null===o.key;u&&(o=o.props.children);var d="object"===typeof o&&null!==o;if(d)switch(o.$$typeof){case w:e:{for(d=o.key,u=n;null!==u;){if(u.key===d){if(7===u.tag){if(o.type===T){i(e,u.sibling),(n=r(u,o.props.children)).return=e,e=n;break e}}else if(u.elementType===o.type){i(e,u.sibling),(n=r(u,o.props)).ref=So(e,u,o),n.return=e,e=n;break e}i(e,u);break}t(e,u),u=u.sibling}o.type===T?((n=Yc(o.props.children,e.mode,c,o.key)).return=e,e=n):((c=zc(o.type,o.key,o.props,null,e.mode,c)).ref=So(e,n,o),c.return=e,e=c)}return a(e);case S:e:{for(u=o.key;null!==n;){if(n.key===u){if(4===n.tag&&n.stateNode.containerInfo===o.containerInfo&&n.stateNode.implementation===o.implementation){i(e,n.sibling),(n=r(n,o.children||[])).return=e,e=n;break e}i(e,n);break}t(e,n),n=n.sibling}(n=Qc(o,e.mode,c)).return=e,e=n}return a(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==n&&6===n.tag?(i(e,n.sibling),(n=r(n,o)).return=e,e=n):(i(e,n),(n=Xc(o,e.mode,c)).return=e,e=n),a(e);if(wo(o))return m(e,n,o,c);if(W(o))return _(e,n,o,c);if(d&&To(e,o),"undefined"===typeof o&&!u)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,z(e.type)||"Component"))}return i(e,n)}}var Co=Ro(!0),Io=Ro(!1),Ao={},Oo=cr(Ao),Mo=cr(Ao),No=cr(Ao);function ko(e){if(e===Ao)throw Error(s(174));return e}function Po(e,t){switch(dr(No,t),dr(Mo,e),dr(Oo,Ao),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:fe(null,"");break;default:t=fe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ur(Oo),dr(Oo,t)}function Do(){ur(Oo),ur(Mo),ur(No)}function Lo(e){ko(No.current);var t=ko(Oo.current),i=fe(t,e.type);t!==i&&(dr(Mo,e),dr(Oo,i))}function xo(e){Mo.current===e&&(ur(Oo),ur(Mo))}var Uo=cr(0);function Vo(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Bo=null,jo=null,Fo=!1;function Wo(e,t){var i=Hc(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=t,i.return=e,i.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i}function Go(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Ho(e){if(Fo){var t=jo;if(t){var i=t;if(!Go(e,t)){if(!(t=zn(i.nextSibling))||!Go(e,t))return e.flags=-1025&e.flags|2,Fo=!1,void(Bo=e);Wo(Bo,i)}Bo=e,jo=zn(t.firstChild)}else e.flags=-1025&e.flags|2,Fo=!1,Bo=e}}function qo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Bo=e}function Ko(e){if(e!==Bo)return!1;if(!Fo)return qo(e),Fo=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Gn(t,e.memoizedProps))for(t=jo;t;)Wo(e,t),t=zn(t.nextSibling);if(qo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){jo=zn(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}jo=null}}else jo=Bo?zn(e.stateNode.nextSibling):null;return!0}function zo(){jo=Bo=null,Fo=!1}var Yo=[];function Jo(){for(var e=0;e<Yo.length;e++)Yo[e]._workInProgressVersionPrimary=null;Yo.length=0}var Xo=y.ReactCurrentDispatcher,Qo=y.ReactCurrentBatchConfig,Zo=0,$o=null,es=null,ts=null,is=!1,ns=!1;function rs(){throw Error(s(321))}function os(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!un(e[i],t[i]))return!1;return!0}function ss(e,t,i,n,r,o){if(Zo=o,$o=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Xo.current=null===e||null===e.memoizedState?ks:Ps,e=i(n,r),ns){o=0;do{if(ns=!1,!(25>o))throw Error(s(301));o+=1,ts=es=null,t.updateQueue=null,Xo.current=Ds,e=i(n,r)}while(ns)}if(Xo.current=Ns,t=null!==es&&null!==es.next,Zo=0,ts=es=$o=null,is=!1,t)throw Error(s(300));return e}function as(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ts?$o.memoizedState=ts=e:ts=ts.next=e,ts}function cs(){if(null===es){var e=$o.alternate;e=null!==e?e.memoizedState:null}else e=es.next;var t=null===ts?$o.memoizedState:ts.next;if(null!==t)ts=t,es=e;else{if(null===e)throw Error(s(310));e={memoizedState:(es=e).memoizedState,baseState:es.baseState,baseQueue:es.baseQueue,queue:es.queue,next:null},null===ts?$o.memoizedState=ts=e:ts=ts.next=e}return ts}function us(e,t){return"function"===typeof t?t(e):t}function ds(e){var t=cs(),i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=e;var n=es,r=n.baseQueue,o=i.pending;if(null!==o){if(null!==r){var a=r.next;r.next=o.next,o.next=a}n.baseQueue=r=o,i.pending=null}if(null!==r){r=r.next,n=n.baseState;var c=a=o=null,u=r;do{var d=u.lane;if((Zo&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),n=u.eagerReducer===e?u.eagerState:e(n,u.action);else{var l={lane:d,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===c?(a=c=l,o=n):c=c.next=l,$o.lanes|=d,Fa|=d}u=u.next}while(null!==u&&u!==r);null===c?o=n:c.next=a,un(n,t.memoizedState)||(xs=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,i.lastRenderedState=n}return[t.memoizedState,i.dispatch]}function ls(e){var t=cs(),i=t.queue;if(null===i)throw Error(s(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,o=t.memoizedState;if(null!==r){i.pending=null;var a=r=r.next;do{o=e(o,a.action),a=a.next}while(a!==r);un(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),i.lastRenderedState=o}return[o,n]}function hs(e,t,i){var n=t._getVersion;n=n(t._source);var r=t._workInProgressVersionPrimary;if(null!==r?e=r===n:(e=e.mutableReadLanes,(e=(Zo&e)===e)&&(t._workInProgressVersionPrimary=n,Yo.push(t))),e)return i(t._source);throw Yo.push(t),Error(s(350))}function fs(e,t,i,n){var r=Pa;if(null===r)throw Error(s(349));var o=t._getVersion,a=o(t._source),c=Xo.current,u=c.useState((function(){return hs(r,t,i)})),d=u[1],l=u[0];u=ts;var h=e.memoizedState,f=h.refs,p=f.getSnapshot,m=h.source;h=h.subscribe;var _=$o;return e.memoizedState={refs:f,source:t,subscribe:n},c.useEffect((function(){f.getSnapshot=i,f.setSnapshot=d;var e=o(t._source);if(!un(a,e)){e=i(t._source),un(l,e)||(d(e),e=fc(_),r.mutableReadLanes|=e&r.pendingLanes),e=r.mutableReadLanes,r.entangledLanes|=e;for(var n=r.entanglements,s=e;0<s;){var c=31-Gt(s),u=1<<c;n[c]|=e,s&=~u}}}),[i,t,n]),c.useEffect((function(){return n(t._source,(function(){var e=f.getSnapshot,i=f.setSnapshot;try{i(e(t._source));var n=fc(_);r.mutableReadLanes|=n&r.pendingLanes}catch(o){i((function(){throw o}))}}))}),[t,n]),un(p,i)&&un(m,t)&&un(h,n)||((e={pending:null,dispatch:null,lastRenderedReducer:us,lastRenderedState:l}).dispatch=d=Ms.bind(null,$o,e),u.queue=e,u.baseQueue=null,l=hs(r,t,i),u.memoizedState=u.baseState=l),l}function ps(e,t,i){return fs(cs(),e,t,i)}function ms(e){var t=as();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:us,lastRenderedState:e}).dispatch=Ms.bind(null,$o,e),[t.memoizedState,e]}function _s(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=$o.updateQueue)?(t={lastEffect:null},$o.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e),e}function gs(e){return e={current:e},as().memoizedState=e}function vs(){return cs().memoizedState}function Es(e,t,i,n){var r=as();$o.flags|=e,r.memoizedState=_s(1|t,i,void 0,void 0===n?null:n)}function bs(e,t,i,n){var r=cs();n=void 0===n?null:n;var o=void 0;if(null!==es){var s=es.memoizedState;if(o=s.destroy,null!==n&&os(n,s.deps))return void _s(t,i,o,n)}$o.flags|=e,r.memoizedState=_s(1|t,i,o,n)}function ys(e,t){return Es(516,4,e,t)}function ws(e,t){return bs(516,4,e,t)}function Ss(e,t){return bs(4,2,e,t)}function Ts(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Rs(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,bs(4,2,Ts.bind(null,t,e),i)}function Cs(){}function Is(e,t){var i=cs();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&os(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function As(e,t){var i=cs();t=void 0===t?null:t;var n=i.memoizedState;return null!==n&&null!==t&&os(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function Os(e,t){var i=Gr();qr(98>i?98:i,(function(){e(!0)})),qr(97<i?97:i,(function(){var i=Qo.transition;Qo.transition=1;try{e(!1),t()}finally{Qo.transition=i}}))}function Ms(e,t,i){var n=hc(),r=fc(e),o={lane:r,action:i,eagerReducer:null,eagerState:null,next:null},s=t.pending;if(null===s?o.next=o:(o.next=s.next,s.next=o),t.pending=o,s=e.alternate,e===$o||null!==s&&s===$o)ns=is=!0;else{if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,c=s(a,i);if(o.eagerReducer=s,o.eagerState=c,un(c,a))return}catch(u){}pc(e,r,n)}}var Ns={readContext:oo,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useLayoutEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useMutableSource:rs,useOpaqueIdentifier:rs,unstable_isNewReconciler:!1},ks={readContext:oo,useCallback:function(e,t){return as().memoizedState=[e,void 0===t?null:t],e},useContext:oo,useEffect:ys,useImperativeHandle:function(e,t,i){return i=null!==i&&void 0!==i?i.concat([e]):null,Es(4,2,Ts.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Es(4,2,e,t)},useMemo:function(e,t){var i=as();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=as();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e=(e=n.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Ms.bind(null,$o,e),[n.memoizedState,e]},useRef:gs,useState:ms,useDebugValue:Cs,useDeferredValue:function(e){var t=ms(e),i=t[0],n=t[1];return ys((function(){var t=Qo.transition;Qo.transition=1;try{n(e)}finally{Qo.transition=t}}),[e]),i},useTransition:function(){var e=ms(!1),t=e[0];return gs(e=Os.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,i){var n=as();return n.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:i},fs(n,e,t,i)},useOpaqueIdentifier:function(){if(Fo){var e=!1,t=function(e){return{$$typeof:L,toString:e,valueOf:e}}((function(){throw e||(e=!0,i("r:"+(Jn++).toString(36))),Error(s(355))})),i=ms(t)[1];return 0===(2&$o.mode)&&($o.flags|=516,_s(5,(function(){i("r:"+(Jn++).toString(36))}),void 0,null)),t}return ms(t="r:"+(Jn++).toString(36)),t},unstable_isNewReconciler:!1},Ps={readContext:oo,useCallback:Is,useContext:oo,useEffect:ws,useImperativeHandle:Rs,useLayoutEffect:Ss,useMemo:As,useReducer:ds,useRef:vs,useState:function(){return ds(us)},useDebugValue:Cs,useDeferredValue:function(e){var t=ds(us),i=t[0],n=t[1];return ws((function(){var t=Qo.transition;Qo.transition=1;try{n(e)}finally{Qo.transition=t}}),[e]),i},useTransition:function(){var e=ds(us)[0];return[vs().current,e]},useMutableSource:ps,useOpaqueIdentifier:function(){return ds(us)[0]},unstable_isNewReconciler:!1},Ds={readContext:oo,useCallback:Is,useContext:oo,useEffect:ws,useImperativeHandle:Rs,useLayoutEffect:Ss,useMemo:As,useReducer:ls,useRef:vs,useState:function(){return ls(us)},useDebugValue:Cs,useDeferredValue:function(e){var t=ls(us),i=t[0],n=t[1];return ws((function(){var t=Qo.transition;Qo.transition=1;try{n(e)}finally{Qo.transition=t}}),[e]),i},useTransition:function(){var e=ls(us)[0];return[vs().current,e]},useMutableSource:ps,useOpaqueIdentifier:function(){return ls(us)[0]},unstable_isNewReconciler:!1},Ls=y.ReactCurrentOwner,xs=!1;function Us(e,t,i,n){t.child=null===e?Io(t,null,i,n):Co(t,e.child,i,n)}function Vs(e,t,i,n,r){i=i.render;var o=t.ref;return ro(t,r),n=ss(e,t,i,n,o,r),null===e||xs?(t.flags|=1,Us(e,t,n,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~r,oa(e,t,r))}function Bs(e,t,i,n,r,o){if(null===e){var s=i.type;return"function"!==typeof s||qc(s)||void 0!==s.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=zc(i.type,null,n,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,js(e,t,s,n,r,o))}return s=e.child,0===(r&o)&&(r=s.memoizedProps,(i=null!==(i=i.compare)?i:ln)(r,n)&&e.ref===t.ref)?oa(e,t,o):(t.flags|=1,(e=Kc(s,n)).ref=t.ref,e.return=t,t.child=e)}function js(e,t,i,n,r,o){if(null!==e&&ln(e.memoizedProps,n)&&e.ref===t.ref){if(xs=!1,0===(o&r))return t.lanes=e.lanes,oa(e,t,o);0!==(16384&e.flags)&&(xs=!0)}return Gs(e,t,i,n,o)}function Fs(e,t,i){var n=t.pendingProps,r=n.children,o=null!==e?e.memoizedState:null;if("hidden"===n.mode||"unstable-defer-without-hiding"===n.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},wc(t,i);else{if(0===(1073741824&i))return e=null!==o?o.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},wc(t,e),null;t.memoizedState={baseLanes:0},wc(t,null!==o?o.baseLanes:i)}else null!==o?(n=o.baseLanes|i,t.memoizedState=null):n=i,wc(t,n);return Us(e,t,r,i),t.child}function Ws(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=128)}function Gs(e,t,i,n,r){var o=_r(i)?pr:hr.current;return o=mr(t,o),ro(t,r),i=ss(e,t,i,n,o,r),null===e||xs?(t.flags|=1,Us(e,t,i,r),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~r,oa(e,t,r))}function Hs(e,t,i,n,r){if(_r(i)){var o=!0;br(t)}else o=!1;if(ro(t,r),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),Eo(t,i,n),yo(t,i,n,r),n=!0;else if(null===e){var s=t.stateNode,a=t.memoizedProps;s.props=a;var c=s.context,u=i.contextType;"object"===typeof u&&null!==u?u=oo(u):u=mr(t,u=_r(i)?pr:hr.current);var d=i.getDerivedStateFromProps,l="function"===typeof d||"function"===typeof s.getSnapshotBeforeUpdate;l||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==n||c!==u)&&bo(t,s,n,u),so=!1;var h=t.memoizedState;s.state=h,fo(t,n,s,r),c=t.memoizedState,a!==n||h!==c||fr.current||so?("function"===typeof d&&(_o(t,i,d,n),c=t.memoizedState),(a=so||vo(t,i,a,n,h,c,u))?(l||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||("function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"===typeof s.componentDidMount&&(t.flags|=4)):("function"===typeof s.componentDidMount&&(t.flags|=4),t.memoizedProps=n,t.memoizedState=c),s.props=n,s.state=c,s.context=u,n=a):("function"===typeof s.componentDidMount&&(t.flags|=4),n=!1)}else{s=t.stateNode,co(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:Xr(t.type,a),s.props=u,l=t.pendingProps,h=s.context,"object"===typeof(c=i.contextType)&&null!==c?c=oo(c):c=mr(t,c=_r(i)?pr:hr.current);var f=i.getDerivedStateFromProps;(d="function"===typeof f||"function"===typeof s.getSnapshotBeforeUpdate)||"function"!==typeof s.UNSAFE_componentWillReceiveProps&&"function"!==typeof s.componentWillReceiveProps||(a!==l||h!==c)&&bo(t,s,n,c),so=!1,h=t.memoizedState,s.state=h,fo(t,n,s,r);var p=t.memoizedState;a!==l||h!==p||fr.current||so?("function"===typeof f&&(_o(t,i,f,n),p=t.memoizedState),(u=so||vo(t,i,u,n,h,p,c))?(d||"function"!==typeof s.UNSAFE_componentWillUpdate&&"function"!==typeof s.componentWillUpdate||("function"===typeof s.componentWillUpdate&&s.componentWillUpdate(n,p,c),"function"===typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,p,c)),"function"===typeof s.componentDidUpdate&&(t.flags|=4),"function"===typeof s.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),t.memoizedProps=n,t.memoizedState=p),s.props=n,s.state=p,s.context=c,n=u):("function"!==typeof s.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),n=!1)}return qs(e,t,i,n,o,r)}function qs(e,t,i,n,r,o){Ws(e,t);var s=0!==(64&t.flags);if(!n&&!s)return r&&yr(t,i,!1),oa(e,t,o);n=t.stateNode,Ls.current=t;var a=s&&"function"!==typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=Co(t,e.child,null,o),t.child=Co(t,null,a,o)):Us(e,t,a,o),t.memoizedState=n.state,r&&yr(t,i,!0),t.child}function Ks(e){var t=e.stateNode;t.pendingContext?vr(0,t.pendingContext,t.pendingContext!==t.context):t.context&&vr(0,t.context,!1),Po(e,t.containerInfo)}var zs,Ys,Js,Xs,Qs={dehydrated:null,retryLane:0};function Zs(e,t,i){var n,r=t.pendingProps,o=Uo.current,s=!1;return(n=0!==(64&t.flags))||(n=(null===e||null!==e.memoizedState)&&0!==(2&o)),n?(s=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===r.fallback||!0===r.unstable_avoidThisFallback||(o|=1),dr(Uo,1&o),null===e?(void 0!==r.fallback&&Ho(t),e=r.children,o=r.fallback,s?(e=$s(t,e,o,i),t.child.memoizedState={baseLanes:i},t.memoizedState=Qs,e):"number"===typeof r.unstable_expectedLoadTime?(e=$s(t,e,o,i),t.child.memoizedState={baseLanes:i},t.memoizedState=Qs,t.lanes=33554432,e):((i=Jc({mode:"visible",children:e},t.mode,i,null)).return=t,t.child=i)):(e.memoizedState,s?(r=ta(e,t,r.children,r.fallback,i),s=t.child,o=e.child.memoizedState,s.memoizedState=null===o?{baseLanes:i}:{baseLanes:o.baseLanes|i},s.childLanes=e.childLanes&~i,t.memoizedState=Qs,r):(i=ea(e,t,r.children,i),t.memoizedState=null,i))}function $s(e,t,i,n){var r=e.mode,o=e.child;return t={mode:"hidden",children:t},0===(2&r)&&null!==o?(o.childLanes=0,o.pendingProps=t):o=Jc(t,r,0,null),i=Yc(i,r,n,null),o.return=e,i.return=e,o.sibling=i,e.child=o,i}function ea(e,t,i,n){var r=e.child;return e=r.sibling,i=Kc(r,{mode:"visible",children:i}),0===(2&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=i}function ta(e,t,i,n,r){var o=t.mode,s=e.child;e=s.sibling;var a={mode:"hidden",children:i};return 0===(2&o)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=a,null!==(s=i.lastEffect)?(t.firstEffect=i.firstEffect,t.lastEffect=s,s.nextEffect=null):t.firstEffect=t.lastEffect=null):i=Kc(s,a),null!==e?n=Kc(e,n):(n=Yc(n,o,r,null)).flags|=2,n.return=t,i.return=t,i.sibling=n,t.child=i,n}function ia(e,t){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),no(e.return,t)}function na(e,t,i,n,r,o){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r,lastEffect:o}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=r,s.lastEffect=o)}function ra(e,t,i){var n=t.pendingProps,r=n.revealOrder,o=n.tail;if(Us(e,t,n.children,i),0!==(2&(n=Uo.current)))n=1&n|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ia(e,i);else if(19===e.tag)ia(e,i);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(dr(Uo,n),0===(2&t.mode))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;null!==i;)null!==(e=i.alternate)&&null===Vo(e)&&(r=i),i=i.sibling;null===(i=r)?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),na(t,!1,r,i,o,t.lastEffect);break;case"backwards":for(i=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===Vo(e)){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}na(t,!0,i,null,o,t.lastEffect);break;case"together":na(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function oa(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Fa|=t.lanes,0!==(i&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(i=Kc(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=Kc(e,e.pendingProps)).return=t;i.sibling=null}return t.child}return null}function sa(e,t){if(!Fo)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function aa(e,t,i){var n=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return _r(t.type)&&gr(),null;case 3:return Do(),ur(fr),ur(hr),Jo(),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(Ko(t)?t.flags|=4:n.hydrate||(t.flags|=256)),Ys(t),null;case 5:xo(t);var o=ko(No.current);if(i=t.type,null!==e&&null!=t.stateNode)Js(e,t,i,n,o),e.ref!==t.ref&&(t.flags|=128);else{if(!n){if(null===t.stateNode)throw Error(s(166));return null}if(e=ko(Oo.current),Ko(t)){n=t.stateNode,i=t.type;var a=t.memoizedProps;switch(n[Qn]=t,n[Zn]=a,i){case"dialog":On("cancel",n),On("close",n);break;case"iframe":case"object":case"embed":On("load",n);break;case"video":case"audio":for(e=0;e<Rn.length;e++)On(Rn[e],n);break;case"source":On("error",n);break;case"img":case"image":case"link":On("error",n),On("load",n);break;case"details":On("toggle",n);break;case"input":ee(n,a),On("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},On("invalid",n);break;case"textarea":ce(n,a),On("invalid",n)}for(var u in Se(i,a),e=null,a)a.hasOwnProperty(u)&&(o=a[u],"children"===u?"string"===typeof o?n.textContent!==o&&(e=["children",o]):"number"===typeof o&&n.textContent!==""+o&&(e=["children",""+o]):c.hasOwnProperty(u)&&null!=o&&"onScroll"===u&&On("scroll",n));switch(i){case"input":X(n),ne(n,a,!0);break;case"textarea":X(n),de(n);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(n.onclick=Bn)}n=e,t.updateQueue=n,null!==n&&(t.flags|=4)}else{switch(u=9===o.nodeType?o:o.ownerDocument,e===le.html&&(e=he(i)),e===le.html?"script"===i?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=u.createElement(i,{is:n.is}):(e=u.createElement(i),"select"===i&&(u=e,n.multiple?u.multiple=!0:n.size&&(u.size=n.size))):e=u.createElementNS(e,i),e[Qn]=t,e[Zn]=n,zs(e,t,!1,!1),t.stateNode=e,u=Te(i,n),i){case"dialog":On("cancel",e),On("close",e),o=n;break;case"iframe":case"object":case"embed":On("load",e),o=n;break;case"video":case"audio":for(o=0;o<Rn.length;o++)On(Rn[o],e);o=n;break;case"source":On("error",e),o=n;break;case"img":case"image":case"link":On("error",e),On("load",e),o=n;break;case"details":On("toggle",e),o=n;break;case"input":ee(e,n),o=$(e,n),On("invalid",e);break;case"option":o=oe(e,n);break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=r({},n,{value:void 0}),On("invalid",e);break;case"textarea":ce(e,n),o=ae(e,n),On("invalid",e);break;default:o=n}Se(i,o);var d=o;for(a in d)if(d.hasOwnProperty(a)){var l=d[a];"style"===a?ye(e,l):"dangerouslySetInnerHTML"===a?null!=(l=l?l.__html:void 0)&&_e(e,l):"children"===a?"string"===typeof l?("textarea"!==i||""!==l)&&ge(e,l):"number"===typeof l&&ge(e,""+l):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(c.hasOwnProperty(a)?null!=l&&"onScroll"===a&&On("scroll",e):null!=l&&b(e,a,l,u))}switch(i){case"input":X(e),ne(e,n,!1);break;case"textarea":X(e),de(e);break;case"option":null!=n.value&&e.setAttribute("value",""+Y(n.value));break;case"select":e.multiple=!!n.multiple,null!=(a=n.value)?se(e,!!n.multiple,a,!1):null!=n.defaultValue&&se(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Bn)}Wn(i,n)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Xs(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(s(166));i=ko(No.current),ko(Oo.current),Ko(t)?(n=t.stateNode,i=t.memoizedProps,n[Qn]=t,n.nodeValue!==i&&(t.flags|=4)):((n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[Qn]=t,t.stateNode=n)}return null;case 13:return ur(Uo),n=t.memoizedState,0!==(64&t.flags)?(t.lanes=i,t):(n=null!==n,i=!1,null===e?void 0!==t.memoizedProps.fallback&&Ko(t):i=null!==e.memoizedState,n&&!i&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Uo.current)?0===Va&&(Va=3):(0!==Va&&3!==Va||(Va=4),null===Pa||0===(134217727&Fa)&&0===(134217727&Wa)||vc(Pa,La))),(n||i)&&(t.flags|=4),null);case 4:return Do(),Ys(t),null===e&&Nn(t.stateNode.containerInfo),null;case 10:return io(t),null;case 19:if(ur(Uo),null===(n=t.memoizedState))return null;if(a=0!==(64&t.flags),null===(u=n.rendering))if(a)sa(n,!1);else{if(0!==Va||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(u=Vo(e))){for(t.flags|=64,sa(n,!1),null!==(a=u.updateQueue)&&(t.updateQueue=a,t.flags|=4),null===n.lastEffect&&(t.firstEffect=null),t.lastEffect=n.lastEffect,n=i,i=t.child;null!==i;)e=n,(a=i).flags&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(u=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,e=u.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return dr(Uo,1&Uo.current|2),t.child}e=e.sibling}null!==n.tail&&Wr()>Ka&&(t.flags|=64,a=!0,sa(n,!1),t.lanes=33554432)}else{if(!a)if(null!==(e=Vo(u))){if(t.flags|=64,a=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),sa(n,!0),null===n.tail&&"hidden"===n.tailMode&&!u.alternate&&!Fo)return null!==(t=t.lastEffect=n.lastEffect)&&(t.nextEffect=null),null}else 2*Wr()-n.renderingStartTime>Ka&&1073741824!==i&&(t.flags|=64,a=!0,sa(n,!1),t.lanes=33554432);n.isBackwards?(u.sibling=t.child,t.child=u):(null!==(i=n.last)?i.sibling=u:t.child=u,n.last=u)}return null!==n.tail?(i=n.tail,n.rendering=i,n.tail=i.sibling,n.lastEffect=t.lastEffect,n.renderingStartTime=Wr(),i.sibling=null,t=Uo.current,dr(Uo,a?1&t|2:1&t),i):null;case 23:case 24:return Sc(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==n.mode&&(t.flags|=4),null}throw Error(s(156,t.tag))}function ca(e){switch(e.tag){case 1:_r(e.type)&&gr();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Do(),ur(fr),ur(hr),Jo(),0!==(64&(t=e.flags)))throw Error(s(285));return e.flags=-4097&t|64,e;case 5:return xo(e),null;case 13:return ur(Uo),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return ur(Uo),null;case 4:return Do(),null;case 10:return io(e),null;case 23:case 24:return Sc(),null;default:return null}}function ua(e,t){try{var i="",n=t;do{i+=K(n),n=n.return}while(n);var r=i}catch(o){r="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:r}}function da(e,t){try{console.error(t.value)}catch(i){setTimeout((function(){throw i}))}}zs=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Ys=function(){},Js=function(e,t,i,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,ko(Oo.current);var s,a=null;switch(i){case"input":o=$(e,o),n=$(e,n),a=[];break;case"option":o=oe(e,o),n=oe(e,n),a=[];break;case"select":o=r({},o,{value:void 0}),n=r({},n,{value:void 0}),a=[];break;case"textarea":o=ae(e,o),n=ae(e,n),a=[];break;default:"function"!==typeof o.onClick&&"function"===typeof n.onClick&&(e.onclick=Bn)}for(l in Se(i,n),i=null,o)if(!n.hasOwnProperty(l)&&o.hasOwnProperty(l)&&null!=o[l])if("style"===l){var u=o[l];for(s in u)u.hasOwnProperty(s)&&(i||(i={}),i[s]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(c.hasOwnProperty(l)?a||(a=[]):(a=a||[]).push(l,null));for(l in n){var d=n[l];if(u=null!=o?o[l]:void 0,n.hasOwnProperty(l)&&d!==u&&(null!=d||null!=u))if("style"===l)if(u){for(s in u)!u.hasOwnProperty(s)||d&&d.hasOwnProperty(s)||(i||(i={}),i[s]="");for(s in d)d.hasOwnProperty(s)&&u[s]!==d[s]&&(i||(i={}),i[s]=d[s])}else i||(a||(a=[]),a.push(l,i)),i=d;else"dangerouslySetInnerHTML"===l?(d=d?d.__html:void 0,u=u?u.__html:void 0,null!=d&&u!==d&&(a=a||[]).push(l,d)):"children"===l?"string"!==typeof d&&"number"!==typeof d||(a=a||[]).push(l,""+d):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(c.hasOwnProperty(l)?(null!=d&&"onScroll"===l&&On("scroll",e),a||u===d||(a=[])):"object"===typeof d&&null!==d&&d.$$typeof===L?d.toString():(a=a||[]).push(l,d))}i&&(a=a||[]).push("style",i);var l=a;(t.updateQueue=l)&&(t.flags|=4)}},Xs=function(e,t,i,n){i!==n&&(t.flags|=4)};var la="function"===typeof WeakMap?WeakMap:Map;function ha(e,t,i){(i=uo(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){Xa||(Xa=!0,Qa=n),da(0,t)},i}function fa(e,t,i){(i=uo(-1,i)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var r=t.value;i.payload=function(){return da(0,t),n(r)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(i.callback=function(){"function"!==typeof n&&(null===Za?Za=new Set([this]):Za.add(this),da(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}var pa="function"===typeof WeakSet?WeakSet:Set;function ma(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(i){jc(e,i)}else t.current=null}function _a(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var i=e.memoizedProps,n=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?i:Xr(t.type,i),n),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Kn(t.stateNode.containerInfo))}throw Error(s(163))}function ga(e,t,i){switch(i.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=i.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var n=e.create;e.destroy=n()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=i.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var r=e;n=r.next,0!==(4&(r=r.tag))&&0!==(1&r)&&(Uc(i,e),xc(i,e)),e=n}while(e!==t)}return;case 1:return e=i.stateNode,4&i.flags&&(null===t?e.componentDidMount():(n=i.elementType===i.type?t.memoizedProps:Xr(i.type,t.memoizedProps),e.componentDidUpdate(n,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=i.updateQueue)&&po(i,t,e));case 3:if(null!==(t=i.updateQueue)){if(e=null,null!==i.child)switch(i.child.tag){case 5:case 1:e=i.child.stateNode}po(i,t,e)}return;case 5:return e=i.stateNode,void(null===t&&4&i.flags&&Wn(i.type,i.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===i.memoizedState&&(i=i.alternate,null!==i&&(i=i.memoizedState,null!==i&&(i=i.dehydrated,null!==i&&yt(i)))))}throw Error(s(163))}function va(e,t){for(var i=e;;){if(5===i.tag){var n=i.stateNode;if(t)"function"===typeof(n=n.style).setProperty?n.setProperty("display","none","important"):n.display="none";else{n=i.stateNode;var r=i.memoizedProps.style;r=void 0!==r&&null!==r&&r.hasOwnProperty("display")?r.display:null,n.style.display=be("display",r)}}else if(6===i.tag)i.stateNode.nodeValue=t?"":i.memoizedProps;else if((23!==i.tag&&24!==i.tag||null===i.memoizedState||i===e)&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function Ea(e,t){if(Sr&&"function"===typeof Sr.onCommitFiberUnmount)try{Sr.onCommitFiberUnmount(wr,t)}catch(o){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var i=e=e.next;do{var n=i,r=n.destroy;if(n=n.tag,void 0!==r)if(0!==(4&n))Uc(t,i);else{n=t;try{r()}catch(o){jc(n,o)}}i=i.next}while(i!==e)}break;case 1:if(ma(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(o){jc(t,o)}break;case 5:ma(t);break;case 4:Ra(e,t)}}function ba(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function ya(e){return 5===e.tag||3===e.tag||4===e.tag}function wa(e){e:{for(var t=e.return;null!==t;){if(ya(t))break e;t=t.return}throw Error(s(160))}var i=t;switch(t=i.stateNode,i.tag){case 5:var n=!1;break;case 3:case 4:t=t.containerInfo,n=!0;break;default:throw Error(s(161))}16&i.flags&&(ge(t,""),i.flags&=-17);e:t:for(i=e;;){for(;null===i.sibling;){if(null===i.return||ya(i.return)){i=null;break e}i=i.return}for(i.sibling.return=i.return,i=i.sibling;5!==i.tag&&6!==i.tag&&18!==i.tag;){if(2&i.flags)continue t;if(null===i.child||4===i.tag)continue t;i.child.return=i,i=i.child}if(!(2&i.flags)){i=i.stateNode;break e}}n?Sa(e,i,t):Ta(e,i,t)}function Sa(e,t,i){var n=e.tag,r=5===n||6===n;if(r)e=r?e.stateNode:e.stateNode.instance,t?8===i.nodeType?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(8===i.nodeType?(t=i.parentNode).insertBefore(e,i):(t=i).appendChild(e),null!==(i=i._reactRootContainer)&&void 0!==i||null!==t.onclick||(t.onclick=Bn));else if(4!==n&&null!==(e=e.child))for(Sa(e,t,i),e=e.sibling;null!==e;)Sa(e,t,i),e=e.sibling}function Ta(e,t,i){var n=e.tag,r=5===n||6===n;if(r)e=r?e.stateNode:e.stateNode.instance,t?i.insertBefore(e,t):i.appendChild(e);else if(4!==n&&null!==(e=e.child))for(Ta(e,t,i),e=e.sibling;null!==e;)Ta(e,t,i),e=e.sibling}function Ra(e,t){for(var i,n,r=t,o=!1;;){if(!o){o=r.return;e:for(;;){if(null===o)throw Error(s(160));switch(i=o.stateNode,o.tag){case 5:n=!1;break e;case 3:case 4:i=i.containerInfo,n=!0;break e}o=o.return}o=!0}if(5===r.tag||6===r.tag){e:for(var a=e,c=r,u=c;;)if(Ea(a,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===c)break e;for(;null===u.sibling;){if(null===u.return||u.return===c)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}n?(a=i,c=r.stateNode,8===a.nodeType?a.parentNode.removeChild(c):a.removeChild(c)):i.removeChild(r.stateNode)}else if(4===r.tag){if(null!==r.child){i=r.stateNode.containerInfo,n=!0,r.child.return=r,r=r.child;continue}}else if(Ea(e,r),null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;4===(r=r.return).tag&&(o=!1)}r.sibling.return=r.return,r=r.sibling}}function Ca(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var n=i=i.next;do{3===(3&n.tag)&&(e=n.destroy,n.destroy=void 0,void 0!==e&&e()),n=n.next}while(n!==i)}return;case 1:case 12:case 17:return;case 5:if(null!=(i=t.stateNode)){n=t.memoizedProps;var r=null!==e?e.memoizedProps:n;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(i[Zn]=n,"input"===e&&"radio"===n.type&&null!=n.name&&te(i,n),Te(e,r),t=Te(e,n),r=0;r<o.length;r+=2){var a=o[r],c=o[r+1];"style"===a?ye(i,c):"dangerouslySetInnerHTML"===a?_e(i,c):"children"===a?ge(i,c):b(i,a,c,t)}switch(e){case"input":ie(i,n);break;case"textarea":ue(i,n);break;case"select":e=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!n.multiple,null!=(o=n.value)?se(i,!!n.multiple,o,!1):e!==!!n.multiple&&(null!=n.defaultValue?se(i,!!n.multiple,n.defaultValue,!0):se(i,!!n.multiple,n.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(s(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((i=t.stateNode).hydrate&&(i.hydrate=!1,yt(i.containerInfo)));case 13:return null!==t.memoizedState&&(qa=Wr(),va(t.child,!0)),void Ia(t);case 19:return void Ia(t);case 23:case 24:return void va(t,null!==t.memoizedState)}throw Error(s(163))}function Ia(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new pa),t.forEach((function(t){var n=Wc.bind(null,e,t);i.has(t)||(i.add(t),t.then(n,n))}))}}function Aa(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Oa=Math.ceil,Ma=y.ReactCurrentDispatcher,Na=y.ReactCurrentOwner,ka=0,Pa=null,Da=null,La=0,xa=0,Ua=cr(0),Va=0,Ba=null,ja=0,Fa=0,Wa=0,Ga=0,Ha=null,qa=0,Ka=1/0;function za(){Ka=Wr()+500}var Ya,Ja=null,Xa=!1,Qa=null,Za=null,$a=!1,ec=null,tc=90,ic=[],nc=[],rc=null,oc=0,sc=null,ac=-1,cc=0,uc=0,dc=null,lc=!1;function hc(){return 0!==(48&ka)?Wr():-1!==ac?ac:ac=Wr()}function fc(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Gr()?1:2;if(0===cc&&(cc=ja),0!==Jr.transition){0!==uc&&(uc=null!==Ha?Ha.pendingLanes:0),e=cc;var t=4186112&~uc;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Gr(),0!==(4&ka)&&98===e?e=Bt(12,cc):e=Bt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),cc),e}function pc(e,t,i){if(50<oc)throw oc=0,sc=null,Error(s(185));if(null===(e=mc(e,t)))return null;Wt(e,t,i),e===Pa&&(Wa|=t,4===Va&&vc(e,La));var n=Gr();1===t?0!==(8&ka)&&0===(48&ka)?Ec(e):(_c(e,i),0===ka&&(za(),zr())):(0===(4&ka)||98!==n&&99!==n||(null===rc?rc=new Set([e]):rc.add(e)),_c(e,i)),Ha=e}function mc(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}function _c(e,t){for(var i=e.callbackNode,n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var c=31-Gt(a),u=1<<c,d=o[c];if(-1===d){if(0===(u&n)||0!==(u&r)){d=t,xt(u);var l=Lt;o[c]=10<=l?d+250:6<=l?d+5e3:-1}}else d<=t&&(e.expiredLanes|=u);a&=~u}if(n=Ut(e,e===Pa?La:0),t=Lt,0===n)null!==i&&(i!==xr&&Cr(i),e.callbackNode=null,e.callbackPriority=0);else{if(null!==i){if(e.callbackPriority===t)return;i!==xr&&Cr(i)}15===t?(i=Ec.bind(null,e),null===Vr?(Vr=[i],Br=Rr(Nr,Yr)):Vr.push(i),i=xr):14===t?i=Kr(99,Ec.bind(null,e)):(i=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,e))}}(t),i=Kr(i,gc.bind(null,e))),e.callbackPriority=t,e.callbackNode=i}}function gc(e){if(ac=-1,uc=cc=0,0!==(48&ka))throw Error(s(327));var t=e.callbackNode;if(Lc()&&e.callbackNode!==t)return null;var i=Ut(e,e===Pa?La:0);if(0===i)return null;var n=i,r=ka;ka|=16;var o=Cc();for(Pa===e&&La===n||(za(),Tc(e,n));;)try{Oc();break}catch(c){Rc(e,c)}if(to(),Ma.current=o,ka=r,null!==Da?n=0:(Pa=null,La=0,n=Va),0!==(ja&Wa))Tc(e,0);else if(0!==n){if(2===n&&(ka|=64,e.hydrate&&(e.hydrate=!1,Kn(e.containerInfo)),0!==(i=Vt(e))&&(n=Ic(e,i))),1===n)throw t=Ba,Tc(e,0),vc(e,i),_c(e,Wr()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=i,n){case 0:case 1:throw Error(s(345));case 2:case 5:kc(e);break;case 3:if(vc(e,i),(62914560&i)===i&&10<(n=qa+500-Wr())){if(0!==Ut(e,0))break;if(((r=e.suspendedLanes)&i)!==i){hc(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=Hn(kc.bind(null,e),n);break}kc(e);break;case 4:if(vc(e,i),(4186112&i)===i)break;for(n=e.eventTimes,r=-1;0<i;){var a=31-Gt(i);o=1<<a,(a=n[a])>r&&(r=a),i&=~o}if(i=r,10<(i=(120>(i=Wr()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Oa(i/1960))-i)){e.timeoutHandle=Hn(kc.bind(null,e),i);break}kc(e);break;default:throw Error(s(329))}}return _c(e,Wr()),e.callbackNode===t?gc.bind(null,e):null}function vc(e,t){for(t&=~Ga,t&=~Wa,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-Gt(t),n=1<<i;e[i]=-1,t&=~n}}function Ec(e){if(0!==(48&ka))throw Error(s(327));if(Lc(),e===Pa&&0!==(e.expiredLanes&La)){var t=La,i=Ic(e,t);0!==(ja&Wa)&&(i=Ic(e,t=Ut(e,t)))}else i=Ic(e,t=Ut(e,0));if(0!==e.tag&&2===i&&(ka|=64,e.hydrate&&(e.hydrate=!1,Kn(e.containerInfo)),0!==(t=Vt(e))&&(i=Ic(e,t))),1===i)throw i=Ba,Tc(e,0),vc(e,t),_c(e,Wr()),i;return e.finishedWork=e.current.alternate,e.finishedLanes=t,kc(e),_c(e,Wr()),null}function bc(e,t){var i=ka;ka|=1;try{return e(t)}finally{0===(ka=i)&&(za(),zr())}}function yc(e,t){var i=ka;ka&=-2,ka|=8;try{return e(t)}finally{0===(ka=i)&&(za(),zr())}}function wc(e,t){dr(Ua,xa),xa|=t,ja|=t}function Sc(){xa=Ua.current,ur(Ua)}function Tc(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,qn(i)),null!==Da)for(i=Da.return;null!==i;){var n=i;switch(n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&gr();break;case 3:Do(),ur(fr),ur(hr),Jo();break;case 5:xo(n);break;case 4:Do();break;case 13:case 19:ur(Uo);break;case 10:io(n);break;case 23:case 24:Sc()}i=i.return}Pa=e,Da=Kc(e.current,null),La=xa=ja=t,Va=0,Ba=null,Ga=Wa=Fa=0}function Rc(e,t){for(;;){var i=Da;try{if(to(),Xo.current=Ns,is){for(var n=$o.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}is=!1}if(Zo=0,ts=es=$o=null,ns=!1,Na.current=null,null===i||null===i.return){Va=1,Ba=t,Da=null;break}e:{var o=e,s=i.return,a=i,c=t;if(t=La,a.flags|=2048,a.firstEffect=a.lastEffect=null,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c;if(0===(2&a.mode)){var d=a.alternate;d?(a.updateQueue=d.updateQueue,a.memoizedState=d.memoizedState,a.lanes=d.lanes):(a.updateQueue=null,a.memoizedState=null)}var l=0!==(1&Uo.current),h=s;do{var f;if(f=13===h.tag){var p=h.memoizedState;if(null!==p)f=null!==p.dehydrated;else{var m=h.memoizedProps;f=void 0!==m.fallback&&(!0!==m.unstable_avoidThisFallback||!l)}}if(f){var _=h.updateQueue;if(null===_){var g=new Set;g.add(u),h.updateQueue=g}else _.add(u);if(0===(2&h.mode)){if(h.flags|=64,a.flags|=16384,a.flags&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var v=uo(-1,1);v.tag=2,lo(a,v)}a.lanes|=1;break e}c=void 0,a=t;var E=o.pingCache;if(null===E?(E=o.pingCache=new la,c=new Set,E.set(u,c)):void 0===(c=E.get(u))&&(c=new Set,E.set(u,c)),!c.has(a)){c.add(a);var b=Fc.bind(null,o,u,a);u.then(b,b)}h.flags|=4096,h.lanes=t;break e}h=h.return}while(null!==h);c=Error((z(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Va&&(Va=2),c=ua(c,a),h=s;do{switch(h.tag){case 3:o=c,h.flags|=4096,t&=-t,h.lanes|=t,ho(h,ha(0,o,t));break e;case 1:o=c;var y=h.type,w=h.stateNode;if(0===(64&h.flags)&&("function"===typeof y.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Za||!Za.has(w)))){h.flags|=4096,t&=-t,h.lanes|=t,ho(h,fa(h,o,t));break e}}h=h.return}while(null!==h)}Nc(i)}catch(S){t=S,Da===i&&null!==i&&(Da=i=i.return);continue}break}}function Cc(){var e=Ma.current;return Ma.current=Ns,null===e?Ns:e}function Ic(e,t){var i=ka;ka|=16;var n=Cc();for(Pa===e&&La===t||Tc(e,t);;)try{Ac();break}catch(r){Rc(e,r)}if(to(),ka=i,Ma.current=n,null!==Da)throw Error(s(261));return Pa=null,La=0,Va}function Ac(){for(;null!==Da;)Mc(Da)}function Oc(){for(;null!==Da&&!Ir();)Mc(Da)}function Mc(e){var t=Ya(e.alternate,e,xa);e.memoizedProps=e.pendingProps,null===t?Nc(e):Da=t,Na.current=null}function Nc(e){var t=e;do{var i=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(i=aa(i,t,xa)))return void(Da=i);if(24!==(i=t).tag&&23!==i.tag||null===i.memoizedState||0!==(1073741824&xa)||0===(4&i.mode)){for(var n=0,r=i.child;null!==r;)n|=r.lanes|r.childLanes,r=r.sibling;i.childLanes=n}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(i=ca(t)))return i.flags&=2047,void(Da=i);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Da=t);Da=t=e}while(null!==t);0===Va&&(Va=5)}function kc(e){var t=Gr();return qr(99,Pc.bind(null,e,t)),null}function Pc(e,t){do{Lc()}while(null!==ec);if(0!==(48&ka))throw Error(s(327));var i=e.finishedWork;if(null===i)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(s(177));e.callbackNode=null;var n=i.lanes|i.childLanes,r=n,o=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;for(var a=e.eventTimes,c=e.expirationTimes;0<o;){var u=31-Gt(o),d=1<<u;r[u]=0,a[u]=-1,c[u]=-1,o&=~d}if(null!==rc&&0===(24&n)&&rc.has(e)&&rc.delete(e),e===Pa&&(Da=Pa=null,La=0),1<i.flags?null!==i.lastEffect?(i.lastEffect.nextEffect=i,n=i.firstEffect):n=i:n=i.firstEffect,null!==n){if(r=ka,ka|=32,Na.current=null,jn=Yt,_n(a=mn())){if("selectionStart"in a)c={start:a.selectionStart,end:a.selectionEnd};else e:if(c=(c=a.ownerDocument)&&c.defaultView||window,(d=c.getSelection&&c.getSelection())&&0!==d.rangeCount){c=d.anchorNode,o=d.anchorOffset,u=d.focusNode,d=d.focusOffset;try{c.nodeType,u.nodeType}catch(C){c=null;break e}var l=0,h=-1,f=-1,p=0,m=0,_=a,g=null;t:for(;;){for(var v;_!==c||0!==o&&3!==_.nodeType||(h=l+o),_!==u||0!==d&&3!==_.nodeType||(f=l+d),3===_.nodeType&&(l+=_.nodeValue.length),null!==(v=_.firstChild);)g=_,_=v;for(;;){if(_===a)break t;if(g===c&&++p===o&&(h=l),g===u&&++m===d&&(f=l),null!==(v=_.nextSibling))break;g=(_=g).parentNode}_=v}c=-1===h||-1===f?null:{start:h,end:f}}else c=null;c=c||{start:0,end:0}}else c=null;Fn={focusedElem:a,selectionRange:c},Yt=!1,dc=null,lc=!1,Ja=n;do{try{Dc()}catch(C){if(null===Ja)throw Error(s(330));jc(Ja,C),Ja=Ja.nextEffect}}while(null!==Ja);dc=null,Ja=n;do{try{for(a=e;null!==Ja;){var E=Ja.flags;if(16&E&&ge(Ja.stateNode,""),128&E){var b=Ja.alternate;if(null!==b){var y=b.ref;null!==y&&("function"===typeof y?y(null):y.current=null)}}switch(1038&E){case 2:wa(Ja),Ja.flags&=-3;break;case 6:wa(Ja),Ja.flags&=-3,Ca(Ja.alternate,Ja);break;case 1024:Ja.flags&=-1025;break;case 1028:Ja.flags&=-1025,Ca(Ja.alternate,Ja);break;case 4:Ca(Ja.alternate,Ja);break;case 8:Ra(a,c=Ja);var w=c.alternate;ba(c),null!==w&&ba(w)}Ja=Ja.nextEffect}}catch(C){if(null===Ja)throw Error(s(330));jc(Ja,C),Ja=Ja.nextEffect}}while(null!==Ja);if(y=Fn,b=mn(),E=y.focusedElem,a=y.selectionRange,b!==E&&E&&E.ownerDocument&&pn(E.ownerDocument.documentElement,E)){null!==a&&_n(E)&&(b=a.start,void 0===(y=a.end)&&(y=b),"selectionStart"in E?(E.selectionStart=b,E.selectionEnd=Math.min(y,E.value.length)):(y=(b=E.ownerDocument||document)&&b.defaultView||window).getSelection&&(y=y.getSelection(),c=E.textContent.length,w=Math.min(a.start,c),a=void 0===a.end?w:Math.min(a.end,c),!y.extend&&w>a&&(c=a,a=w,w=c),c=fn(E,w),o=fn(E,a),c&&o&&(1!==y.rangeCount||y.anchorNode!==c.node||y.anchorOffset!==c.offset||y.focusNode!==o.node||y.focusOffset!==o.offset)&&((b=b.createRange()).setStart(c.node,c.offset),y.removeAllRanges(),w>a?(y.addRange(b),y.extend(o.node,o.offset)):(b.setEnd(o.node,o.offset),y.addRange(b))))),b=[];for(y=E;y=y.parentNode;)1===y.nodeType&&b.push({element:y,left:y.scrollLeft,top:y.scrollTop});for("function"===typeof E.focus&&E.focus(),E=0;E<b.length;E++)(y=b[E]).element.scrollLeft=y.left,y.element.scrollTop=y.top}Yt=!!jn,Fn=jn=null,e.current=i,Ja=n;do{try{for(E=e;null!==Ja;){var S=Ja.flags;if(36&S&&ga(E,Ja.alternate,Ja),128&S){b=void 0;var T=Ja.ref;if(null!==T){var R=Ja.stateNode;Ja.tag,b=R,"function"===typeof T?T(b):T.current=b}}Ja=Ja.nextEffect}}catch(C){if(null===Ja)throw Error(s(330));jc(Ja,C),Ja=Ja.nextEffect}}while(null!==Ja);Ja=null,Ur(),ka=r}else e.current=i;if($a)$a=!1,ec=e,tc=t;else for(Ja=n;null!==Ja;)t=Ja.nextEffect,Ja.nextEffect=null,8&Ja.flags&&((S=Ja).sibling=null,S.stateNode=null),Ja=t;if(0===(n=e.pendingLanes)&&(Za=null),1===n?e===sc?oc++:(oc=0,sc=e):oc=0,i=i.stateNode,Sr&&"function"===typeof Sr.onCommitFiberRoot)try{Sr.onCommitFiberRoot(wr,i,void 0,64===(64&i.current.flags))}catch(C){}if(_c(e,Wr()),Xa)throw Xa=!1,e=Qa,Qa=null,e;return 0!==(8&ka)||zr(),null}function Dc(){for(;null!==Ja;){var e=Ja.alternate;lc||null===dc||(0!==(8&Ja.flags)?$e(Ja,dc)&&(lc=!0):13===Ja.tag&&Aa(e,Ja)&&$e(Ja,dc)&&(lc=!0));var t=Ja.flags;0!==(256&t)&&_a(e,Ja),0===(512&t)||$a||($a=!0,Kr(97,(function(){return Lc(),null}))),Ja=Ja.nextEffect}}function Lc(){if(90!==tc){var e=97<tc?97:tc;return tc=90,qr(e,Vc)}return!1}function xc(e,t){ic.push(t,e),$a||($a=!0,Kr(97,(function(){return Lc(),null})))}function Uc(e,t){nc.push(t,e),$a||($a=!0,Kr(97,(function(){return Lc(),null})))}function Vc(){if(null===ec)return!1;var e=ec;if(ec=null,0!==(48&ka))throw Error(s(331));var t=ka;ka|=32;var i=nc;nc=[];for(var n=0;n<i.length;n+=2){var r=i[n],o=i[n+1],a=r.destroy;if(r.destroy=void 0,"function"===typeof a)try{a()}catch(u){if(null===o)throw Error(s(330));jc(o,u)}}for(i=ic,ic=[],n=0;n<i.length;n+=2){r=i[n],o=i[n+1];try{var c=r.create;r.destroy=c()}catch(u){if(null===o)throw Error(s(330));jc(o,u)}}for(c=e.current.firstEffect;null!==c;)e=c.nextEffect,c.nextEffect=null,8&c.flags&&(c.sibling=null,c.stateNode=null),c=e;return ka=t,zr(),!0}function Bc(e,t,i){lo(e,t=ha(0,t=ua(i,t),1)),t=hc(),null!==(e=mc(e,1))&&(Wt(e,1,t),_c(e,t))}function jc(e,t){if(3===e.tag)Bc(e,e,t);else for(var i=e.return;null!==i;){if(3===i.tag){Bc(i,e,t);break}if(1===i.tag){var n=i.stateNode;if("function"===typeof i.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Za||!Za.has(n))){var r=fa(i,e=ua(t,e),1);if(lo(i,r),r=hc(),null!==(i=mc(i,1)))Wt(i,1,r),_c(i,r);else if("function"===typeof n.componentDidCatch&&(null===Za||!Za.has(n)))try{n.componentDidCatch(t,e)}catch(o){}break}}i=i.return}}function Fc(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=hc(),e.pingedLanes|=e.suspendedLanes&i,Pa===e&&(La&i)===i&&(4===Va||3===Va&&(62914560&La)===La&&500>Wr()-qa?Tc(e,0):Ga|=i),_c(e,t)}function Wc(e,t){var i=e.stateNode;null!==i&&i.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Gr()?1:2:(0===cc&&(cc=ja),0===(t=jt(62914560&~cc))&&(t=4194304))),i=hc(),null!==(e=mc(e,t))&&(Wt(e,t,i),_c(e,i))}function Gc(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Hc(e,t,i,n){return new Gc(e,t,i,n)}function qc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Kc(e,t){var i=e.alternate;return null===i?((i=Hc(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function zc(e,t,i,n,r,o){var a=2;if(n=e,"function"===typeof e)qc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case T:return Yc(i.children,r,o,t);case x:a=8,r|=16;break;case R:a=8,r|=1;break;case C:return(e=Hc(12,i,t,8|r)).elementType=C,e.type=C,e.lanes=o,e;case M:return(e=Hc(13,i,t,r)).type=M,e.elementType=M,e.lanes=o,e;case N:return(e=Hc(19,i,t,r)).elementType=N,e.lanes=o,e;case U:return Jc(i,r,o,t);case V:return(e=Hc(24,i,t,r)).elementType=V,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:a=10;break e;case A:a=9;break e;case O:a=11;break e;case k:a=14;break e;case P:a=16,n=null;break e;case D:a=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Hc(a,i,t,r)).elementType=e,t.type=n,t.lanes=o,t}function Yc(e,t,i,n){return(e=Hc(7,e,n,t)).lanes=i,e}function Jc(e,t,i,n){return(e=Hc(23,e,n,t)).elementType=U,e.lanes=i,e}function Xc(e,t,i){return(e=Hc(6,e,null,t)).lanes=i,e}function Qc(e,t,i){return(t=Hc(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Zc(e,t,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Ft(0),this.expirationTimes=Ft(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ft(0),this.mutableSourceEagerHydrationData=null}function $c(e,t,i,n){var r=t.current,o=hc(),a=fc(r);e:if(i){t:{if(Je(i=i._reactInternals)!==i||1!==i.tag)throw Error(s(170));var c=i;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(_r(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(null!==c);throw Error(s(171))}if(1===i.tag){var u=i.type;if(_r(u)){i=Er(i,u,c);break e}}i=c}else i=lr;return null===t.context?t.context=i:t.pendingContext=i,(t=uo(o,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),lo(r,t),pc(r,a,o),a}function eu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function tu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function iu(e,t){tu(e,t),(e=e.alternate)&&tu(e,t)}function nu(e,t,i){var n=null!=i&&null!=i.hydrationOptions&&i.hydrationOptions.mutableSources||null;if(i=new Zc(e,t,null!=i&&!0===i.hydrate),t=Hc(3,null,null,2===t?7:1===t?3:0),i.current=t,t.stateNode=i,ao(t),e[$n]=i.current,Nn(8===e.nodeType?e.parentNode:e),n)for(e=0;e<n.length;e++){var r=(t=n[e])._getVersion;r=r(t._source),null==i.mutableSourceEagerHydrationData?i.mutableSourceEagerHydrationData=[t,r]:i.mutableSourceEagerHydrationData.push(t,r)}this._internalRoot=i}function ru(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ou(e,t,i,n,r){var o=i._reactRootContainer;if(o){var s=o._internalRoot;if("function"===typeof r){var a=r;r=function(){var e=eu(s);a.call(e)}}$c(t,s,e,r)}else{if(o=i._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var i;i=e.lastChild;)e.removeChild(i);return new nu(e,0,t?{hydrate:!0}:void 0)}(i,n),s=o._internalRoot,"function"===typeof r){var c=r;r=function(){var e=eu(s);c.call(e)}}yc((function(){$c(t,s,e,r)}))}return eu(s)}function su(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ru(t))throw Error(s(200));return function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:S,key:null==n?null:""+n,children:e,containerInfo:t,implementation:i}}(e,t,null,i)}Ya=function(e,t,i){var n=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||fr.current)xs=!0;else{if(0===(i&n)){switch(xs=!1,t.tag){case 3:Ks(t),zo();break;case 5:Lo(t);break;case 1:_r(t.type)&&br(t);break;case 4:Po(t,t.stateNode.containerInfo);break;case 10:n=t.memoizedProps.value;var r=t.type._context;dr(Qr,r._currentValue),r._currentValue=n;break;case 13:if(null!==t.memoizedState)return 0!==(i&t.child.childLanes)?Zs(e,t,i):(dr(Uo,1&Uo.current),null!==(t=oa(e,t,i))?t.sibling:null);dr(Uo,1&Uo.current);break;case 19:if(n=0!==(i&t.childLanes),0!==(64&e.flags)){if(n)return ra(e,t,i);t.flags|=64}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),dr(Uo,Uo.current),n)break;return null;case 23:case 24:return t.lanes=0,Fs(e,t,i)}return oa(e,t,i)}xs=0!==(16384&e.flags)}else xs=!1;switch(t.lanes=0,t.tag){case 2:if(n=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=mr(t,hr.current),ro(t,i),r=ss(null,t,n,e,r,i),t.flags|=1,"object"===typeof r&&null!==r&&"function"===typeof r.render&&void 0===r.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,_r(n)){var o=!0;br(t)}else o=!1;t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,ao(t);var a=n.getDerivedStateFromProps;"function"===typeof a&&_o(t,n,a,e),r.updater=go,t.stateNode=r,r._reactInternals=t,yo(t,n,e,i),t=qs(null,t,n,!0,o,i)}else t.tag=0,Us(null,t,r,i),t=t.child;return t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(o=r._init)(r._payload),t.type=r,o=t.tag=function(e){if("function"===typeof e)return qc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===O)return 11;if(e===k)return 14}return 2}(r),e=Xr(r,e),o){case 0:t=Gs(null,t,r,e,i);break e;case 1:t=Hs(null,t,r,e,i);break e;case 11:t=Vs(null,t,r,e,i);break e;case 14:t=Bs(null,t,r,Xr(r.type,e),n,i);break e}throw Error(s(306,r,""))}return t;case 0:return n=t.type,r=t.pendingProps,Gs(e,t,n,r=t.elementType===n?r:Xr(n,r),i);case 1:return n=t.type,r=t.pendingProps,Hs(e,t,n,r=t.elementType===n?r:Xr(n,r),i);case 3:if(Ks(t),n=t.updateQueue,null===e||null===n)throw Error(s(282));if(n=t.pendingProps,r=null!==(r=t.memoizedState)?r.element:null,co(e,t),fo(t,n,null,i),(n=t.memoizedState.element)===r)zo(),t=oa(e,t,i);else{if((o=(r=t.stateNode).hydrate)&&(jo=zn(t.stateNode.containerInfo.firstChild),Bo=t,o=Fo=!0),o){if(null!=(e=r.mutableSourceEagerHydrationData))for(r=0;r<e.length;r+=2)(o=e[r])._workInProgressVersionPrimary=e[r+1],Yo.push(o);for(i=Io(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|1024,i=i.sibling}else Us(e,t,n,i),zo();t=t.child}return t;case 5:return Lo(t),null===e&&Ho(t),n=t.type,r=t.pendingProps,o=null!==e?e.memoizedProps:null,a=r.children,Gn(n,r)?a=null:null!==o&&Gn(n,o)&&(t.flags|=16),Ws(e,t),Us(e,t,a,i),t.child;case 6:return null===e&&Ho(t),null;case 13:return Zs(e,t,i);case 4:return Po(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Co(t,null,n,i):Us(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,Vs(e,t,n,r=t.elementType===n?r:Xr(n,r),i);case 7:return Us(e,t,t.pendingProps,i),t.child;case 8:case 12:return Us(e,t,t.pendingProps.children,i),t.child;case 10:e:{n=t.type._context,r=t.pendingProps,a=t.memoizedProps,o=r.value;var c=t.type._context;if(dr(Qr,c._currentValue),c._currentValue=o,null!==a)if(c=a.value,0===(o=un(c,o)?0:0|("function"===typeof n._calculateChangedBits?n._calculateChangedBits(c,o):1073741823))){if(a.children===r.children&&!fr.current){t=oa(e,t,i);break e}}else for(null!==(c=t.child)&&(c.return=t);null!==c;){var u=c.dependencies;if(null!==u){a=c.child;for(var d=u.firstContext;null!==d;){if(d.context===n&&0!==(d.observedBits&o)){1===c.tag&&((d=uo(-1,i&-i)).tag=2,lo(c,d)),c.lanes|=i,null!==(d=c.alternate)&&(d.lanes|=i),no(c.return,i),u.lanes|=i;break}d=d.next}}else a=10===c.tag&&c.type===t.type?null:c.child;if(null!==a)a.return=c;else for(a=c;null!==a;){if(a===t){a=null;break}if(null!==(c=a.sibling)){c.return=a.return,a=c;break}a=a.return}c=a}Us(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=(o=t.pendingProps).children,ro(t,i),n=n(r=oo(r,o.unstable_observedBits)),t.flags|=1,Us(e,t,n,i),t.child;case 14:return o=Xr(r=t.type,t.pendingProps),Bs(e,t,r,o=Xr(r.type,o),n,i);case 15:return js(e,t,t.type,t.pendingProps,n,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:Xr(n,r),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,_r(n)?(e=!0,br(t)):e=!1,ro(t,i),Eo(t,n,r),yo(t,n,r,i),qs(null,t,n,!0,e,i);case 19:return ra(e,t,i);case 23:case 24:return Fs(e,t,i)}throw Error(s(156,t.tag))},nu.prototype.render=function(e){$c(e,this._internalRoot,null,null)},nu.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;$c(null,e,null,(function(){t[$n]=null}))},et=function(e){13===e.tag&&(pc(e,4,hc()),iu(e,4))},tt=function(e){13===e.tag&&(pc(e,67108864,hc()),iu(e,67108864))},it=function(e){if(13===e.tag){var t=hc(),i=fc(e);pc(e,i,t),iu(e,i)}},nt=function(e,t){return t()},Ce=function(e,t,i){switch(t){case"input":if(ie(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=rr(n);if(!r)throw Error(s(90));Q(n),ie(n,r)}}}break;case"textarea":ue(e,i);break;case"select":null!=(t=i.value)&&se(e,!!i.multiple,t,!1)}},ke=bc,Pe=function(e,t,i,n,r){var o=ka;ka|=4;try{return qr(98,e.bind(null,t,i,n,r))}finally{0===(ka=o)&&(za(),zr())}},De=function(){0===(49&ka)&&(function(){if(null!==rc){var e=rc;rc=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,_c(e,Wr())}))}zr()}(),Lc())},Le=function(e,t){var i=ka;ka|=2;try{return e(t)}finally{0===(ka=i)&&(za(),zr())}};var au={Events:[ir,nr,rr,Me,Ne,Lc,{current:!1}]},cu={findFiberByHostInstance:tr,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},uu={bundleType:cu.bundleType,version:cu.version,rendererPackageName:cu.rendererPackageName,rendererConfig:cu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:y.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:cu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var du=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!du.isDisabled&&du.supportsFiber)try{wr=du.inject(uu),Sr=du}catch(me){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=au,t.createPortal=su,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e,t){var i=ka;if(0!==(48&i))return e(t);ka|=1;try{if(e)return qr(99,e.bind(null,t))}finally{ka=i,zr()}},t.hydrate=function(e,t,i){if(!ru(t))throw Error(s(200));return ou(null,e,t,!0,i)},t.render=function(e,t,i){if(!ru(t))throw Error(s(200));return ou(null,e,t,!1,i)},t.unmountComponentAtNode=function(e){if(!ru(e))throw Error(s(40));return!!e._reactRootContainer&&(yc((function(){ou(null,null,e,!1,(function(){e._reactRootContainer=null,e[$n]=null}))})),!0)},t.unstable_batchedUpdates=bc,t.unstable_createPortal=function(e,t){return su(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!ru(i))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return ou(e,t,i,!1,n)},t.version="17.0.2"},function(e,t,i){"use strict";e.exports=i(157)},function(e,t,i){"use strict";var n,r,o,s;if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var d=null,l=null,h=function(){if(null!==d)try{var e=t.unstable_now();d(!0,e),d=null}catch(i){throw setTimeout(h,0),i}};n=function(e){null!==d?setTimeout(n,0,e):(d=e,setTimeout(h,0))},r=function(e,t){l=setTimeout(e,t)},o=function(){clearTimeout(l)},t.unstable_shouldYield=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var f=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var m=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof m&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var _=!1,g=null,v=-1,E=5,b=0;t.unstable_shouldYield=function(){return t.unstable_now()>=b},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5};var y=new MessageChannel,w=y.port2;y.port1.onmessage=function(){if(null!==g){var e=t.unstable_now();b=e+E;try{g(!0,e)?w.postMessage(null):(_=!1,g=null)}catch(i){throw w.postMessage(null),i}}else _=!1},n=function(e){g=e,_||(_=!0,w.postMessage(null))},r=function(e,i){v=f((function(){e(t.unstable_now())}),i)},o=function(){p(v),v=-1}}function S(e,t){var i=e.length;e.push(t);e:for(;;){var n=i-1>>>1,r=e[n];if(!(void 0!==r&&0<C(r,t)))break e;e[n]=t,e[i]=r,i=n}}function T(e){return void 0===(e=e[0])?null:e}function R(e){var t=e[0];if(void 0!==t){var i=e.pop();if(i!==t){e[0]=i;e:for(var n=0,r=e.length;n<r;){var o=2*(n+1)-1,s=e[o],a=o+1,c=e[a];if(void 0!==s&&0>C(s,i))void 0!==c&&0>C(c,s)?(e[n]=c,e[a]=i,n=a):(e[n]=s,e[o]=i,n=o);else{if(!(void 0!==c&&0>C(c,i)))break e;e[n]=c,e[a]=i,n=a}}}return t}return null}function C(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}var I=[],A=[],O=1,M=null,N=3,k=!1,P=!1,D=!1;function L(e){for(var t=T(A);null!==t;){if(null===t.callback)R(A);else{if(!(t.startTime<=e))break;R(A),t.sortIndex=t.expirationTime,S(I,t)}t=T(A)}}function x(e){if(D=!1,L(e),!P)if(null!==T(I))P=!0,n(U);else{var t=T(A);null!==t&&r(x,t.startTime-e)}}function U(e,i){P=!1,D&&(D=!1,o()),k=!0;var n=N;try{for(L(i),M=T(I);null!==M&&(!(M.expirationTime>i)||e&&!t.unstable_shouldYield());){var s=M.callback;if("function"===typeof s){M.callback=null,N=M.priorityLevel;var a=s(M.expirationTime<=i);i=t.unstable_now(),"function"===typeof a?M.callback=a:M===T(I)&&R(I),L(i)}else R(I);M=T(I)}if(null!==M)var c=!0;else{var u=T(A);null!==u&&r(x,u.startTime-i),c=!1}return c}finally{M=null,N=n,k=!1}}var V=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){P||k||(P=!0,n(U))},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_getFirstCallbackNode=function(){return T(I)},t.unstable_next=function(e){switch(N){case 1:case 2:case 3:var t=3;break;default:t=N}var i=N;N=t;try{return e()}finally{N=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=V,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=N;N=e;try{return t()}finally{N=i}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:O++,callback:i,priorityLevel:e,startTime:s,expirationTime:c=s+c,sortIndex:-1},s>a?(e.sortIndex=s,S(A,e),null===T(I)&&e===T(A)&&(D?o():D=!0,r(x,s-a))):(e.sortIndex=c,S(I,e),P||k||(P=!0,n(U))),e},t.unstable_wrapCallback=function(e){var t=N;return function(){var i=N;N=t;try{return e.apply(this,arguments)}finally{N=i}}}},,function(e,t,i){"use strict";t.byteLength=function(e){var t=c(e),i=t[0],n=t[1];return 3*(i+n)/4-n},t.toByteArray=function(e){var t,i,n=c(e),s=n[0],a=n[1],u=new o(function(e,t,i){return 3*(t+i)/4-i}(0,s,a)),d=0,l=a>0?s-4:s;for(i=0;i<l;i+=4)t=r[e.charCodeAt(i)]<<18|r[e.charCodeAt(i+1)]<<12|r[e.charCodeAt(i+2)]<<6|r[e.charCodeAt(i+3)],u[d++]=t>>16&255,u[d++]=t>>8&255,u[d++]=255&t;2===a&&(t=r[e.charCodeAt(i)]<<2|r[e.charCodeAt(i+1)]>>4,u[d++]=255&t);1===a&&(t=r[e.charCodeAt(i)]<<10|r[e.charCodeAt(i+1)]<<4|r[e.charCodeAt(i+2)]>>2,u[d++]=t>>8&255,u[d++]=255&t);return u},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,o=[],s=16383,a=0,c=i-r;a<c;a+=s)o.push(u(e,a,a+s>c?c:a+s));1===r?(t=e[i-1],o.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],o.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return o.join("")};for(var n=[],r=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=s[a],r[s.charCodeAt(a)]=a;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function u(e,t,i){for(var r,o,s=[],a=t;a<i;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(n[(o=r)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,i,n,r){var o,s,a=8*r-n-1,c=(1<<a)-1,u=c>>1,d=-7,l=i?r-1:0,h=i?-1:1,f=e[t+l];for(l+=h,o=f&(1<<-d)-1,f>>=-d,d+=a;d>0;o=256*o+e[t+l],l+=h,d-=8);for(s=o&(1<<-d)-1,o>>=-d,d+=n;d>0;s=256*s+e[t+l],l+=h,d-=8);if(0===o)o=1-u;else{if(o===c)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=u}return(f?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,i,n,r,o){var s,a,c,u=8*o-r-1,d=(1<<u)-1,l=d>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=d):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),(t+=s+l>=1?h/c:h*Math.pow(2,1-l))*c>=2&&(s++,c/=2),s+l>=d?(a=0,s=d):s+l>=1?(a=(t*c-1)*Math.pow(2,r),s+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,r),s=0));r>=8;e[i+f]=255&a,f+=p,a/=256,r-=8);for(s=s<<r|a,u+=r;u>0;e[i+f]=255&s,f+=p,s/=256,u-=8);e[i+f-p]|=128*m}},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},function(e,t,i){e.exports={RtcTokenBuilder:i(86).RtcTokenBuilder,RtcRole:i(86).Role,RtmTokenBuilder:i(139).RtmTokenBuilder,RtmRole:i(139).Role}},function(e,t,i){"use strict";t.randomBytes=t.rng=t.pseudoRandomBytes=t.prng=i(31),t.createHash=t.Hash=i(41),t.createHmac=t.Hmac=i(100);var n=i(189),r=Object.keys(n),o=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(r);t.getHashes=function(){return o};var s=i(103);t.pbkdf2=s.pbkdf2,t.pbkdf2Sync=s.pbkdf2Sync;var a=i(191);t.Cipher=a.Cipher,t.createCipher=a.createCipher,t.Cipheriv=a.Cipheriv,t.createCipheriv=a.createCipheriv,t.Decipher=a.Decipher,t.createDecipher=a.createDecipher,t.Decipheriv=a.Decipheriv,t.createDecipheriv=a.createDecipheriv,t.getCiphers=a.getCiphers,t.listCiphers=a.listCiphers;var c=i(206);t.DiffieHellmanGroup=c.DiffieHellmanGroup,t.createDiffieHellmanGroup=c.createDiffieHellmanGroup,t.getDiffieHellman=c.getDiffieHellman,t.createDiffieHellman=c.createDiffieHellman,t.DiffieHellman=c.DiffieHellman;var u=i(213);t.createSign=u.createSign,t.Sign=u.Sign,t.createVerify=u.createVerify,t.Verify=u.Verify,t.createECDH=i(254);var d=i(257);t.publicEncrypt=d.publicEncrypt,t.privateEncrypt=d.privateEncrypt,t.publicDecrypt=d.publicDecrypt,t.privateDecrypt=d.privateDecrypt;var l=i(261);t.randomFill=l.randomFill,t.randomFillSync=l.randomFillSync,t.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join("\n"))},t.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},function(e,t,i){(t=e.exports=i(88)).Stream=t,t.Readable=t,t.Writable=i(92),t.Duplex=i(33),t.Transform=i(93),t.PassThrough=i(170),t.finished=i(64),t.pipeline=i(171)},,function(e,t,i){"use strict";function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t,i){return(t=a(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var c=i(7).Buffer,u=i(167).inspect,d=u&&u.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,i,n;return t=e,(i=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i}},{key:"concat",value:function(e){if(0===this.length)return c.alloc(0);for(var t,i,n,r=c.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,i=r,n=s,c.prototype.copy.call(t,i,n),s+=o.data.length,o=o.next;return r}},{key:"consume",value:function(e,t){var i;return e<this.head.data.length?(i=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):i=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,i=1,n=t.data;for(e-=n.length;t=t.next;){var r=t.data,o=e>r.length?r.length:e;if(o===r.length?n+=r:n+=r.slice(0,e),0===(e-=o)){o===r.length?(++i,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=r.slice(o));break}++i}return this.length-=i,n}},{key:"_getBuffer",value:function(e){var t=c.allocUnsafe(e),i=this.head,n=1;for(i.data.copy(t),e-=i.data.length;i=i.next;){var r=i.data,o=e>r.length?r.length:e;if(r.copy(t,t.length-e,0,o),0===(e-=o)){o===r.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=r.slice(o));break}++n}return this.length-=n,t}},{key:d,value:function(e,t){return u(this,r(r({},t),{},{depth:0,customInspect:!1}))}}])&&s(t.prototype,i),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},,function(e,t,i){"use strict";(function(t){var n;function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o=i(64),s=Symbol("lastResolve"),a=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),d=Symbol("lastPromise"),l=Symbol("handlePromise"),h=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[s];if(null!==t){var i=e[h].read();null!==i&&(e[d]=null,e[s]=null,e[a]=null,t(f(i,!1)))}}function m(e){t.nextTick(p,e)}var _=Object.getPrototypeOf((function(){})),g=Object.setPrototypeOf((r(n={get stream(){return this[h]},next:function(){var e=this,i=this[c];if(null!==i)return Promise.reject(i);if(this[u])return Promise.resolve(f(void 0,!0));if(this[h].destroyed)return new Promise((function(i,n){t.nextTick((function(){e[c]?n(e[c]):i(f(void 0,!0))}))}));var n,r=this[d];if(r)n=new Promise(function(e,t){return function(i,n){e.then((function(){t[u]?i(f(void 0,!0)):t[l](i,n)}),n)}}(r,this));else{var o=this[h].read();if(null!==o)return Promise.resolve(f(o,!1));n=new Promise(this[l])}return this[d]=n,n}},Symbol.asyncIterator,(function(){return this})),r(n,"return",(function(){var e=this;return new Promise((function(t,i){e[h].destroy(null,(function(e){e?i(e):t(f(void 0,!0))}))}))})),n),_);e.exports=function(e){var t,i=Object.create(g,(r(t={},h,{value:e,writable:!0}),r(t,s,{value:null,writable:!0}),r(t,a,{value:null,writable:!0}),r(t,c,{value:null,writable:!0}),r(t,u,{value:e._readableState.endEmitted,writable:!0}),r(t,l,{value:function(e,t){var n=i[h].read();n?(i[d]=null,i[s]=null,i[a]=null,e(f(n,!1))):(i[s]=e,i[a]=t)},writable:!0}),t));return i[d]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=i[a];return null!==t&&(i[d]=null,i[s]=null,i[a]=null,t(e)),void(i[c]=e)}var n=i[s];null!==n&&(i[d]=null,i[s]=null,i[a]=null,n(f(void 0,!0))),i[u]=!0})),e.on("readable",m.bind(null,i)),i}}).call(this,i(6))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,i){"use strict";e.exports=r;var n=i(93);function r(e){if(!(this instanceof r))return new r(e);n.call(this,e)}i(2)(r,n),r.prototype._transform=function(e,t,i){i(null,e)}},function(e,t,i){"use strict";var n;var r=i(32).codes,o=r.ERR_MISSING_ARGS,s=r.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(e){e()}function u(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var d,l=function(e){return e.length?"function"!==typeof e[e.length-1]?a:e.pop():a}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var h=t.map((function(e,r){var o=r<t.length-1;return function(e,t,r,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;e.on("close",(function(){a=!0})),void 0===n&&(n=i(64)),n(e,{readable:t,writable:r},(function(e){if(e)return o(e);a=!0,o()}));var c=!1;return function(t){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void o(t||new s("pipe"))}}(e,o,r>0,(function(e){d||(d=e),e&&h.forEach(c),o||(h.forEach(c),l(d))}))}));return t.reduce(u)}},function(e,t,i){var n=i(2),r=i(34),o=i(3).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function c(){this.init(),this._w=a,r.call(this,64,56)}function u(e){return e<<30|e>>>2}function d(e,t,i,n){return 0===e?t&i|~t&n:2===e?t&i|t&n|i&n:t^i^n}n(c,r),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,i=this._w,n=0|this._a,r=0|this._b,o=0|this._c,a=0|this._d,c=0|this._e,l=0;l<16;++l)i[l]=e.readInt32BE(4*l);for(;l<80;++l)i[l]=i[l-3]^i[l-8]^i[l-14]^i[l-16];for(var h=0;h<80;++h){var f=~~(h/20),p=0|((t=n)<<5|t>>>27)+d(f,r,o,a)+c+i[h]+s[f];c=a,a=o,o=u(r),r=n,n=p}this._a=n+this._a|0,this._b=r+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=o.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=c},function(e,t,i){var n=i(2),r=i(34),o=i(3).Buffer,s=[1518500249,1859775393,-1894007588,-899497514],a=new Array(80);function c(){this.init(),this._w=a,r.call(this,64,56)}function u(e){return e<<5|e>>>27}function d(e){return e<<30|e>>>2}function l(e,t,i,n){return 0===e?t&i|~t&n:2===e?t&i|t&n|i&n:t^i^n}n(c,r),c.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},c.prototype._update=function(e){for(var t,i=this._w,n=0|this._a,r=0|this._b,o=0|this._c,a=0|this._d,c=0|this._e,h=0;h<16;++h)i[h]=e.readInt32BE(4*h);for(;h<80;++h)i[h]=(t=i[h-3]^i[h-8]^i[h-14]^i[h-16])<<1|t>>>31;for(var f=0;f<80;++f){var p=~~(f/20),m=u(n)+l(p,r,o,a)+c+i[f]+s[p]|0;c=a,a=o,o=d(r),r=n,n=m}this._a=n+this._a|0,this._b=r+this._b|0,this._c=o+this._c|0,this._d=a+this._d|0,this._e=c+this._e|0},c.prototype._hash=function(){var e=o.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=c},function(e,t,i){var n=i(2),r=i(94),o=i(34),s=i(3).Buffer,a=new Array(64);function c(){this.init(),this._w=a,o.call(this,64,56)}n(c,r),c.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},c.prototype._hash=function(){var e=s.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=c},function(e,t,i){var n=i(2),r=i(95),o=i(34),s=i(3).Buffer,a=new Array(160);function c(){this.init(),this._w=a,o.call(this,128,112)}n(c,r),c.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},c.prototype._hash=function(){var e=s.allocUnsafe(48);function t(t,i,n){e.writeInt32BE(t,n),e.writeInt32BE(i,n+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=c},function(e,t,i){e.exports=r;var n=i(24).EventEmitter;function r(){n.call(this)}i(2)(r,n),r.Readable=i(67),r.Writable=i(184),r.Duplex=i(185),r.Transform=i(186),r.PassThrough=i(187),r.Stream=r,r.prototype.pipe=function(e,t){var i=this;function r(t){e.writable&&!1===e.write(t)&&i.pause&&i.pause()}function o(){i.readable&&i.resume&&i.resume()}i.on("data",r),e.on("drain",o),e._isStdio||t&&!1===t.end||(i.on("end",a),i.on("close",c));var s=!1;function a(){s||(s=!0,e.end())}function c(){s||(s=!0,"function"===typeof e.destroy&&e.destroy())}function u(e){if(d(),0===n.listenerCount(this,"error"))throw e}function d(){i.removeListener("data",r),e.removeListener("drain",o),i.removeListener("end",a),i.removeListener("close",c),i.removeListener("error",u),e.removeListener("error",u),i.removeListener("end",d),i.removeListener("close",d),e.removeListener("close",d)}return i.on("error",u),e.on("error",u),i.on("end",d),i.on("close",d),e.on("close",d),e.emit("pipe",i),e}},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},,function(e,t,i){"use strict";var n=i(68).Buffer,r=i(180);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);for(var t,i,r,o=n.allocUnsafe(e>>>0),s=this.head,a=0;s;)t=s.data,i=o,r=a,t.copy(i,r),a+=s.data.length,s=s.next;return o},e}(),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})},,function(e,t,i){(function(e){var n="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,r=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(r.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new o(r.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},i(182),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,i(9))},function(e,t,i){(function(e,t){!function(e,i){"use strict";if(!e.setImmediate){var n,r=1,o={},s=!1,a=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){d(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?function(){var t="setImmediate$"+Math.random()+"$",i=function(i){i.source===e&&"string"===typeof i.data&&0===i.data.indexOf(t)&&d(+i.data.slice(t.length))};e.addEventListener?e.addEventListener("message",i,!1):e.attachEvent("onmessage",i),n=function(i){e.postMessage(t+i,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){d(e.data)},n=function(t){e.port2.postMessage(t)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var e=a.documentElement;n=function(t){var i=a.createElement("script");i.onreadystatechange=function(){d(t),i.onreadystatechange=null,e.removeChild(i),i=null},e.appendChild(i)}}():n=function(e){setTimeout(d,0,e)},c.setImmediate=function(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var s={callback:e,args:t};return o[r]=s,n(r),r++},c.clearImmediate=u}function u(e){delete o[e]}function d(e){if(s)setTimeout(d,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(i,n)}}(t)}finally{u(e),s=!1}}}}}("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,i(9),i(6))},function(e,t,i){"use strict";e.exports=o;var n=i(99),r=Object.create(i(42));function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}r.inherits=i(2),r.inherits(o,n),o.prototype._transform=function(e,t,i){i(null,e)}},function(e,t,i){e.exports=i(69)},function(e,t,i){e.exports=i(26)},function(e,t,i){e.exports=i(67).Transform},function(e,t,i){e.exports=i(67).PassThrough},function(e,t,i){"use strict";var n=i(2),r=i(3).Buffer,o=i(23),s=r.alloc(128),a=64;function c(e,t){o.call(this,"digest"),"string"===typeof t&&(t=r.from(t)),this._alg=e,this._key=t,t.length>a?t=e(t):t.length<a&&(t=r.concat([t,s],a));for(var i=this._ipad=r.allocUnsafe(a),n=this._opad=r.allocUnsafe(a),c=0;c<a;c++)i[c]=54^t[c],n[c]=92^t[c];this._hash=[i]}n(c,o),c.prototype._update=function(e){this._hash.push(e)},c.prototype._final=function(){var e=this._alg(r.concat(this._hash));return this._alg(r.concat([this._opad,e]))},e.exports=c},function(e,t,i){"use strict";e.exports=i(102)},function(e,t,i){(function(t){var n,r,o=i(3).Buffer,s=i(104),a=i(105),c=i(106),u=i(107),d=t.crypto&&t.crypto.subtle,l={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},h=[];function f(){return r||(r=t.process&&t.process.nextTick?t.process.nextTick:t.queueMicrotask?t.queueMicrotask:t.setImmediate?t.setImmediate:t.setTimeout)}function p(e,t,i,n,r){return d.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then((function(e){return d.deriveBits({name:"PBKDF2",salt:t,iterations:i,hash:{name:r}},e,n<<3)})).then((function(e){return o.from(e)}))}e.exports=function(e,i,r,m,_,g){"function"===typeof _&&(g=_,_=void 0);var v=l[(_=_||"sha1").toLowerCase()];if(v&&"function"===typeof t.Promise){if(s(r,m),e=u(e,a,"Password"),i=u(i,a,"Salt"),"function"!==typeof g)throw new Error("No callback provided to pbkdf2");!function(e,t){e.then((function(e){f()((function(){t(null,e)}))}),(function(e){f()((function(){t(e)}))}))}(function(e){if(t.process&&!t.process.browser)return Promise.resolve(!1);if(!d||!d.importKey||!d.deriveBits)return Promise.resolve(!1);if(void 0!==h[e])return h[e];var i=p(n=n||o.alloc(8),n,10,128,e).then((function(){return!0})).catch((function(){return!1}));return h[e]=i,i}(v).then((function(t){return t?p(e,i,r,m,v):c(e,i,r,m,_)})),g)}else f()((function(){var t;try{t=c(e,i,r,m,_)}catch(n){return g(n)}g(null,t)}))}}).call(this,i(9))},function(e,t,i){var n=i(192),r=i(71),o=i(72),s=i(205),a=i(54);function c(e,t,i){if(e=e.toLowerCase(),o[e])return r.createCipheriv(e,t,i);if(s[e])return new n({key:t,iv:i,mode:e});throw new TypeError("invalid suite type")}function u(e,t,i){if(e=e.toLowerCase(),o[e])return r.createDecipheriv(e,t,i);if(s[e])return new n({key:t,iv:i,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}t.createCipher=t.Cipher=function(e,t){var i,n;if(e=e.toLowerCase(),o[e])i=o[e].key,n=o[e].iv;else{if(!s[e])throw new TypeError("invalid suite type");i=8*s[e].key,n=s[e].iv}var r=a(t,!1,i,n);return c(e,r.key,r.iv)},t.createCipheriv=t.Cipheriv=c,t.createDecipher=t.Decipher=function(e,t){var i,n;if(e=e.toLowerCase(),o[e])i=o[e].key,n=o[e].iv;else{if(!s[e])throw new TypeError("invalid suite type");i=8*s[e].key,n=s[e].iv}var r=a(t,!1,i,n);return u(e,r.key,r.iv)},t.createDecipheriv=t.Decipheriv=u,t.listCiphers=t.getCiphers=function(){return Object.keys(s).concat(r.getCiphers())}},function(e,t,i){var n=i(23),r=i(193),o=i(2),s=i(3).Buffer,a={"des-ede3-cbc":r.CBC.instantiate(r.EDE),"des-ede3":r.EDE,"des-ede-cbc":r.CBC.instantiate(r.EDE),"des-ede":r.EDE,"des-cbc":r.CBC.instantiate(r.DES),"des-ecb":r.DES};function c(e){n.call(this);var t,i=e.mode.toLowerCase(),r=a[i];t=e.decrypt?"decrypt":"encrypt";var o=e.key;s.isBuffer(o)||(o=s.from(o)),"des-ede"!==i&&"des-ede-cbc"!==i||(o=s.concat([o,o.slice(0,8)]));var c=e.iv;s.isBuffer(c)||(c=s.from(c)),this._des=r.create({key:o,iv:c,type:t})}a.des=a["des-cbc"],a.des3=a["des-ede3-cbc"],e.exports=c,o(c,n),c.prototype._update=function(e){return s.from(this._des.update(e))},c.prototype._final=function(){return s.from(this._des.final())}},function(e,t,i){"use strict";t.utils=i(108),t.Cipher=i(70),t.DES=i(109),t.CBC=i(194),t.EDE=i(195)},function(e,t,i){"use strict";var n=i(11),r=i(2),o={};function s(e){n.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}t.instantiate=function(e){function t(t){e.call(this,t),this._cbcInit()}r(t,e);for(var i=Object.keys(o),n=0;n<i.length;n++){var s=i[n];t.prototype[s]=o[s]}return t.create=function(e){return new t(e)},t},o._cbcInit=function(){var e=new s(this.options.iv);this._cbcState=e},o._update=function(e,t,i,n){var r=this._cbcState,o=this.constructor.super_.prototype,s=r.iv;if("encrypt"===this.type){for(var a=0;a<this.blockSize;a++)s[a]^=e[t+a];o._update.call(this,s,0,i,n);for(a=0;a<this.blockSize;a++)s[a]=i[n+a]}else{o._update.call(this,e,t,i,n);for(a=0;a<this.blockSize;a++)i[n+a]^=s[a];for(a=0;a<this.blockSize;a++)s[a]=e[t+a]}}},function(e,t,i){"use strict";var n=i(11),r=i(2),o=i(70),s=i(109);function a(e,t){n.equal(t.length,24,"Invalid key length");var i=t.slice(0,8),r=t.slice(8,16),o=t.slice(16,24);this.ciphers="encrypt"===e?[s.create({type:"encrypt",key:i}),s.create({type:"decrypt",key:r}),s.create({type:"encrypt",key:o})]:[s.create({type:"decrypt",key:o}),s.create({type:"encrypt",key:r}),s.create({type:"decrypt",key:i})]}function c(e){o.call(this,e);var t=new a(this.type,this.options.key);this._edeState=t}r(c,o),e.exports=c,c.create=function(e){return new c(e)},c.prototype._update=function(e,t,i,n){var r=this._edeState;r.ciphers[0]._update(e,t,i,n),r.ciphers[1]._update(i,n,i,n),r.ciphers[2]._update(i,n,i,n)},c.prototype._pad=s.prototype._pad,c.prototype._unpad=s.prototype._unpad},function(e,t,i){var n=i(72),r=i(113),o=i(3).Buffer,s=i(114),a=i(23),c=i(53),u=i(54);function d(e,t,i){a.call(this),this._cache=new h,this._cipher=new c.AES(t),this._prev=o.from(i),this._mode=e,this._autopadding=!0}i(2)(d,a),d.prototype._update=function(e){var t,i;this._cache.add(e);for(var n=[];t=this._cache.get();)i=this._mode.encrypt(this,t),n.push(i);return o.concat(n)};var l=o.alloc(16,16);function h(){this.cache=o.allocUnsafe(0)}function f(e,t,i){var a=n[e.toLowerCase()];if(!a)throw new TypeError("invalid suite type");if("string"===typeof t&&(t=o.from(t)),t.length!==a.key/8)throw new TypeError("invalid key length "+t.length);if("string"===typeof i&&(i=o.from(i)),"GCM"!==a.mode&&i.length!==a.iv)throw new TypeError("invalid iv length "+i.length);return"stream"===a.type?new s(a.module,t,i):"auth"===a.type?new r(a.module,t,i):new d(a.module,t,i)}d.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if(!e.equals(l))throw this._cipher.scrub(),new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},h.prototype.add=function(e){this.cache=o.concat([this.cache,e])},h.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},h.prototype.flush=function(){for(var e=16-this.cache.length,t=o.allocUnsafe(e),i=-1;++i<e;)t.writeUInt8(e,i);return o.concat([this.cache,t])},t.createCipheriv=f,t.createCipher=function(e,t){var i=n[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");var r=u(t,!1,i.key,i.iv);return f(e,r.key,r.iv)}},function(e,t){t.encrypt=function(e,t){return e._cipher.encryptBlock(t)},t.decrypt=function(e,t){return e._cipher.decryptBlock(t)}},function(e,t,i){var n=i(43);t.encrypt=function(e,t){var i=n(t,e._prev);return e._prev=e._cipher.encryptBlock(i),e._prev},t.decrypt=function(e,t){var i=e._prev;e._prev=t;var r=e._cipher.decryptBlock(t);return n(r,i)}},function(e,t,i){var n=i(3).Buffer,r=i(43);function o(e,t,i){var o=t.length,s=r(t,e._cache);return e._cache=e._cache.slice(o),e._prev=n.concat([e._prev,i?t:s]),s}t.encrypt=function(e,t,i){for(var r,s=n.allocUnsafe(0);t.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=n.allocUnsafe(0)),!(e._cache.length<=t.length)){s=n.concat([s,o(e,t,i)]);break}r=e._cache.length,s=n.concat([s,o(e,t.slice(0,r),i)]),t=t.slice(r)}return s}},function(e,t,i){var n=i(3).Buffer;function r(e,t,i){var r=e._cipher.encryptBlock(e._prev)[0]^t;return e._prev=n.concat([e._prev.slice(1),n.from([i?t:r])]),r}t.encrypt=function(e,t,i){for(var o=t.length,s=n.allocUnsafe(o),a=-1;++a<o;)s[a]=r(e,t[a],i);return s}},function(e,t,i){var n=i(3).Buffer;function r(e,t,i){for(var n,r,s=-1,a=0;++s<8;)n=t&1<<7-s?128:0,a+=(128&(r=e._cipher.encryptBlock(e._prev)[0]^n))>>s%8,e._prev=o(e._prev,i?n:r);return a}function o(e,t){var i=e.length,r=-1,o=n.allocUnsafe(e.length);for(e=n.concat([e,n.from([t])]);++r<i;)o[r]=e[r]<<1|e[r+1]>>7;return o}t.encrypt=function(e,t,i){for(var o=t.length,s=n.allocUnsafe(o),a=-1;++a<o;)s[a]=r(e,t[a],i);return s}},function(e,t,i){(function(e){var n=i(43);function r(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}t.encrypt=function(t,i){for(;t._cache.length<i.length;)t._cache=e.concat([t._cache,r(t)]);var o=t._cache.slice(0,i.length);return t._cache=t._cache.slice(i.length),n(i,o)}}).call(this,i(7).Buffer)},function(e,t,i){var n=i(3).Buffer,r=n.alloc(16,0);function o(e){var t=n.allocUnsafe(16);return t.writeUInt32BE(e[0]>>>0,0),t.writeUInt32BE(e[1]>>>0,4),t.writeUInt32BE(e[2]>>>0,8),t.writeUInt32BE(e[3]>>>0,12),t}function s(e){this.h=e,this.state=n.alloc(16,0),this.cache=n.allocUnsafe(0)}s.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},s.prototype._multiply=function(){for(var e,t,i,n=[(e=this.h).readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)],r=[0,0,0,0],s=-1;++s<128;){for(0!==(this.state[~~(s/8)]&1<<7-s%8)&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),i=0!==(1&n[3]),t=3;t>0;t--)n[t]=n[t]>>>1|(1&n[t-1])<<31;n[0]=n[0]>>>1,i&&(n[0]=n[0]^225<<24)}this.state=o(r)},s.prototype.update=function(e){var t;for(this.cache=n.concat([this.cache,e]);this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},s.prototype.final=function(e,t){return this.cache.length&&this.ghash(n.concat([this.cache,r],16)),this.ghash(o([0,e,0,t])),this.state},e.exports=s},function(e,t,i){var n=i(113),r=i(3).Buffer,o=i(72),s=i(114),a=i(23),c=i(53),u=i(54);function d(e,t,i){a.call(this),this._cache=new l,this._last=void 0,this._cipher=new c.AES(t),this._prev=r.from(i),this._mode=e,this._autopadding=!0}function l(){this.cache=r.allocUnsafe(0)}function h(e,t,i){var a=o[e.toLowerCase()];if(!a)throw new TypeError("invalid suite type");if("string"===typeof i&&(i=r.from(i)),"GCM"!==a.mode&&i.length!==a.iv)throw new TypeError("invalid iv length "+i.length);if("string"===typeof t&&(t=r.from(t)),t.length!==a.key/8)throw new TypeError("invalid key length "+t.length);return"stream"===a.type?new s(a.module,t,i,!0):"auth"===a.type?new n(a.module,t,i,!0):new d(a.module,t,i)}i(2)(d,a),d.prototype._update=function(e){var t,i;this._cache.add(e);for(var n=[];t=this._cache.get(this._autopadding);)i=this._mode.decrypt(this,t),n.push(i);return r.concat(n)},d.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return function(e){var t=e[15];if(t<1||t>16)throw new Error("unable to decrypt data");var i=-1;for(;++i<t;)if(e[i+(16-t)]!==t)throw new Error("unable to decrypt data");if(16===t)return;return e.slice(0,16-t)}(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},l.prototype.add=function(e){this.cache=r.concat([this.cache,e])},l.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},l.prototype.flush=function(){if(this.cache.length)return this.cache},t.createDecipher=function(e,t){var i=o[e.toLowerCase()];if(!i)throw new TypeError("invalid suite type");var n=u(t,!1,i.key,i.iv);return h(e,n.key,n.iv)},t.createDecipheriv=h},function(e,t){t["des-ecb"]={key:8,iv:0},t["des-cbc"]=t.des={key:8,iv:8},t["des-ede3-cbc"]=t.des3={key:24,iv:8},t["des-ede3"]={key:24,iv:0},t["des-ede-cbc"]={key:16,iv:8},t["des-ede"]={key:16,iv:0}},function(e,t,i){(function(e){var n=i(115),r=i(211),o=i(212);var s={binary:!0,hex:!0,base64:!0};t.DiffieHellmanGroup=t.createDiffieHellmanGroup=t.getDiffieHellman=function(t){var i=new e(r[t].prime,"hex"),n=new e(r[t].gen,"hex");return new o(i,n)},t.createDiffieHellman=t.DiffieHellman=function t(i,r,a,c){return e.isBuffer(r)||void 0===s[r]?t(i,"binary",r,a):(r=r||"binary",c=c||"binary",a=a||new e([2]),e.isBuffer(a)||(a=new e(a,c)),"number"===typeof i?new o(n(i,a),a,!0):(e.isBuffer(i)||(i=new e(i,r)),new o(i,a,!0)))}}).call(this,i(7).Buffer)},,function(e,t,i){(function(e){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function o(e,t,i){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:i(209).Buffer}catch(R){}function a(e,t){var i=e.charCodeAt(t);return i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:i-48&15}function c(e,t,i){var n=a(e,i);return i-1>=t&&(n|=a(e,i-1)<<4),n}function u(e,t,i,n){for(var r=0,o=Math.min(e.length,i),s=t;s<o;s++){var a=e.charCodeAt(s)-48;r*=n,r+=a>=49?a-49+10:a>=17?a-17+10:a}return r}o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,i){if("number"===typeof e)return this._initNumber(e,t,i);if("object"===typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var r=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(r++,this.negative=1),r<e.length&&(16===t?this._parseHex(e,r,i):(this._parseBase(e,t,r),"le"===i&&this._initArray(this.toArray(),t,i)))},o.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},o.prototype._initArray=function(e,t,i){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var o,s,a=0;if("be"===i)for(r=e.length-1,o=0;r>=0;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===i)for(r=0,o=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},o.prototype._parseHex=function(e,t,i){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,o=0,s=0;if("be"===i)for(n=e.length-1;n>=t;n-=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;this.strip()},o.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=t)n++;n--,r=r/t|0;for(var o=e.length-i,s=o%n,a=Math.min(o,o-s)+i,c=0,d=i;d<a;d+=n)c=u(e,d,d+n,t),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var l=1;for(c=u(e,d,e.length,t),d=0;d<s;d++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this.strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(e,t,i){i.negative=t.negative^e.negative;var n=e.length+t.length|0;i.length=n,n=n-1|0;var r=0|e.words[0],o=0|t.words[0],s=r*o,a=67108863&s,c=s/67108864|0;i.words[0]=a;for(var u=1;u<n;u++){for(var d=c>>>26,l=67108863&c,h=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=h;f++){var p=u-f|0;d+=(s=(r=0|e.words[p])*(o=0|t.words[f])+l)/67108864|0,l=67108863&s}i.words[u]=0|l,c=0|d}return 0!==c?i.words[u]=0|c:i.length--,i.strip()}o.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var r=0,o=0,s=0;s<this.length;s++){var a=this.words[s],c=(16777215&(a<<r|o)).toString(16);i=0!==(o=a>>>24-r&16777215)||s!==this.length-1?d[6-c.length]+c+i:c+i,(r+=2)>=26&&(r-=26,s--)}for(0!==o&&(i=o.toString(16)+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=l[e],f=h[e];i="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(f).toString(e);i=(p=p.idivn(f)).isZero()?m+i:d[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(e,t){return n("undefined"!==typeof s),this.toArrayLike(s,e,t)},o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,i){var r=this.byteLength(),o=i||Math.max(1,r);n(r<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,c="le"===t,u=new e(o),d=this.clone();if(c){for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[a]=s;for(;a<o;a++)u[a]=0}else{for(a=0;a<o-r;a++)u[a]=0;for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[o-a-1]=s}return u},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0===(8191&t)&&(i+=13,t>>>=13),0===(127&t)&&(i+=7,t>>>=7),0===(15&t)&&(i+=4,t>>>=4),0===(3&t)&&(i+=2,t>>>=2),0===(1&t)&&i++,i},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var n=0;n<i.length;n++)this.words[n]=t.words[n]^i.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this.strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var i=e/26|0,r=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<r:this.words[i]&~(1<<r),this.strip()},o.prototype.iadd=function(e){var t,i,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,n=e):(i=e,n=this);for(var r=0,o=0;o<n.length;o++)t=(0|i.words[o])+(0|n.words[o])+r,this.words[o]=67108863&t,r=t>>>26;for(;0!==r&&o<i.length;o++)t=(0|i.words[o])+r,this.words[o]=67108863&t,r=t>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,n,r=this.cmp(e);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(i=this,n=e):(i=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|i.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<i.length;s++)o=(t=(0|i.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,i){var n,r,o,s=e.words,a=t.words,c=i.words,u=0,d=0|s[0],l=8191&d,h=d>>>13,f=0|s[1],p=8191&f,m=f>>>13,_=0|s[2],g=8191&_,v=_>>>13,E=0|s[3],b=8191&E,y=E>>>13,w=0|s[4],S=8191&w,T=w>>>13,R=0|s[5],C=8191&R,I=R>>>13,A=0|s[6],O=8191&A,M=A>>>13,N=0|s[7],k=8191&N,P=N>>>13,D=0|s[8],L=8191&D,x=D>>>13,U=0|s[9],V=8191&U,B=U>>>13,j=0|a[0],F=8191&j,W=j>>>13,G=0|a[1],H=8191&G,q=G>>>13,K=0|a[2],z=8191&K,Y=K>>>13,J=0|a[3],X=8191&J,Q=J>>>13,Z=0|a[4],$=8191&Z,ee=Z>>>13,te=0|a[5],ie=8191&te,ne=te>>>13,re=0|a[6],oe=8191&re,se=re>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,de=0|a[8],le=8191&de,he=de>>>13,fe=0|a[9],pe=8191&fe,me=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var _e=(u+(n=Math.imul(l,F))|0)+((8191&(r=(r=Math.imul(l,W))+Math.imul(h,F)|0))<<13)|0;u=((o=Math.imul(h,W))+(r>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(p,F),r=(r=Math.imul(p,W))+Math.imul(m,F)|0,o=Math.imul(m,W);var ge=(u+(n=n+Math.imul(l,H)|0)|0)+((8191&(r=(r=r+Math.imul(l,q)|0)+Math.imul(h,H)|0))<<13)|0;u=((o=o+Math.imul(h,q)|0)+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,F),r=(r=Math.imul(g,W))+Math.imul(v,F)|0,o=Math.imul(v,W),n=n+Math.imul(p,H)|0,r=(r=r+Math.imul(p,q)|0)+Math.imul(m,H)|0,o=o+Math.imul(m,q)|0;var ve=(u+(n=n+Math.imul(l,z)|0)|0)+((8191&(r=(r=r+Math.imul(l,Y)|0)+Math.imul(h,z)|0))<<13)|0;u=((o=o+Math.imul(h,Y)|0)+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,F),r=(r=Math.imul(b,W))+Math.imul(y,F)|0,o=Math.imul(y,W),n=n+Math.imul(g,H)|0,r=(r=r+Math.imul(g,q)|0)+Math.imul(v,H)|0,o=o+Math.imul(v,q)|0,n=n+Math.imul(p,z)|0,r=(r=r+Math.imul(p,Y)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,Y)|0;var Ee=(u+(n=n+Math.imul(l,X)|0)|0)+((8191&(r=(r=r+Math.imul(l,Q)|0)+Math.imul(h,X)|0))<<13)|0;u=((o=o+Math.imul(h,Q)|0)+(r>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(S,F),r=(r=Math.imul(S,W))+Math.imul(T,F)|0,o=Math.imul(T,W),n=n+Math.imul(b,H)|0,r=(r=r+Math.imul(b,q)|0)+Math.imul(y,H)|0,o=o+Math.imul(y,q)|0,n=n+Math.imul(g,z)|0,r=(r=r+Math.imul(g,Y)|0)+Math.imul(v,z)|0,o=o+Math.imul(v,Y)|0,n=n+Math.imul(p,X)|0,r=(r=r+Math.imul(p,Q)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,Q)|0;var be=(u+(n=n+Math.imul(l,$)|0)|0)+((8191&(r=(r=r+Math.imul(l,ee)|0)+Math.imul(h,$)|0))<<13)|0;u=((o=o+Math.imul(h,ee)|0)+(r>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(C,F),r=(r=Math.imul(C,W))+Math.imul(I,F)|0,o=Math.imul(I,W),n=n+Math.imul(S,H)|0,r=(r=r+Math.imul(S,q)|0)+Math.imul(T,H)|0,o=o+Math.imul(T,q)|0,n=n+Math.imul(b,z)|0,r=(r=r+Math.imul(b,Y)|0)+Math.imul(y,z)|0,o=o+Math.imul(y,Y)|0,n=n+Math.imul(g,X)|0,r=(r=r+Math.imul(g,Q)|0)+Math.imul(v,X)|0,o=o+Math.imul(v,Q)|0,n=n+Math.imul(p,$)|0,r=(r=r+Math.imul(p,ee)|0)+Math.imul(m,$)|0,o=o+Math.imul(m,ee)|0;var ye=(u+(n=n+Math.imul(l,ie)|0)|0)+((8191&(r=(r=r+Math.imul(l,ne)|0)+Math.imul(h,ie)|0))<<13)|0;u=((o=o+Math.imul(h,ne)|0)+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(O,F),r=(r=Math.imul(O,W))+Math.imul(M,F)|0,o=Math.imul(M,W),n=n+Math.imul(C,H)|0,r=(r=r+Math.imul(C,q)|0)+Math.imul(I,H)|0,o=o+Math.imul(I,q)|0,n=n+Math.imul(S,z)|0,r=(r=r+Math.imul(S,Y)|0)+Math.imul(T,z)|0,o=o+Math.imul(T,Y)|0,n=n+Math.imul(b,X)|0,r=(r=r+Math.imul(b,Q)|0)+Math.imul(y,X)|0,o=o+Math.imul(y,Q)|0,n=n+Math.imul(g,$)|0,r=(r=r+Math.imul(g,ee)|0)+Math.imul(v,$)|0,o=o+Math.imul(v,ee)|0,n=n+Math.imul(p,ie)|0,r=(r=r+Math.imul(p,ne)|0)+Math.imul(m,ie)|0,o=o+Math.imul(m,ne)|0;var we=(u+(n=n+Math.imul(l,oe)|0)|0)+((8191&(r=(r=r+Math.imul(l,se)|0)+Math.imul(h,oe)|0))<<13)|0;u=((o=o+Math.imul(h,se)|0)+(r>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,F),r=(r=Math.imul(k,W))+Math.imul(P,F)|0,o=Math.imul(P,W),n=n+Math.imul(O,H)|0,r=(r=r+Math.imul(O,q)|0)+Math.imul(M,H)|0,o=o+Math.imul(M,q)|0,n=n+Math.imul(C,z)|0,r=(r=r+Math.imul(C,Y)|0)+Math.imul(I,z)|0,o=o+Math.imul(I,Y)|0,n=n+Math.imul(S,X)|0,r=(r=r+Math.imul(S,Q)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,Q)|0,n=n+Math.imul(b,$)|0,r=(r=r+Math.imul(b,ee)|0)+Math.imul(y,$)|0,o=o+Math.imul(y,ee)|0,n=n+Math.imul(g,ie)|0,r=(r=r+Math.imul(g,ne)|0)+Math.imul(v,ie)|0,o=o+Math.imul(v,ne)|0,n=n+Math.imul(p,oe)|0,r=(r=r+Math.imul(p,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0;var Se=(u+(n=n+Math.imul(l,ce)|0)|0)+((8191&(r=(r=r+Math.imul(l,ue)|0)+Math.imul(h,ce)|0))<<13)|0;u=((o=o+Math.imul(h,ue)|0)+(r>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(L,F),r=(r=Math.imul(L,W))+Math.imul(x,F)|0,o=Math.imul(x,W),n=n+Math.imul(k,H)|0,r=(r=r+Math.imul(k,q)|0)+Math.imul(P,H)|0,o=o+Math.imul(P,q)|0,n=n+Math.imul(O,z)|0,r=(r=r+Math.imul(O,Y)|0)+Math.imul(M,z)|0,o=o+Math.imul(M,Y)|0,n=n+Math.imul(C,X)|0,r=(r=r+Math.imul(C,Q)|0)+Math.imul(I,X)|0,o=o+Math.imul(I,Q)|0,n=n+Math.imul(S,$)|0,r=(r=r+Math.imul(S,ee)|0)+Math.imul(T,$)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(b,ie)|0,r=(r=r+Math.imul(b,ne)|0)+Math.imul(y,ie)|0,o=o+Math.imul(y,ne)|0,n=n+Math.imul(g,oe)|0,r=(r=r+Math.imul(g,se)|0)+Math.imul(v,oe)|0,o=o+Math.imul(v,se)|0,n=n+Math.imul(p,ce)|0,r=(r=r+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,o=o+Math.imul(m,ue)|0;var Te=(u+(n=n+Math.imul(l,le)|0)|0)+((8191&(r=(r=r+Math.imul(l,he)|0)+Math.imul(h,le)|0))<<13)|0;u=((o=o+Math.imul(h,he)|0)+(r>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(V,F),r=(r=Math.imul(V,W))+Math.imul(B,F)|0,o=Math.imul(B,W),n=n+Math.imul(L,H)|0,r=(r=r+Math.imul(L,q)|0)+Math.imul(x,H)|0,o=o+Math.imul(x,q)|0,n=n+Math.imul(k,z)|0,r=(r=r+Math.imul(k,Y)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,Y)|0,n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,Q)|0)+Math.imul(M,X)|0,o=o+Math.imul(M,Q)|0,n=n+Math.imul(C,$)|0,r=(r=r+Math.imul(C,ee)|0)+Math.imul(I,$)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(S,ie)|0,r=(r=r+Math.imul(S,ne)|0)+Math.imul(T,ie)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(b,oe)|0,r=(r=r+Math.imul(b,se)|0)+Math.imul(y,oe)|0,o=o+Math.imul(y,se)|0,n=n+Math.imul(g,ce)|0,r=(r=r+Math.imul(g,ue)|0)+Math.imul(v,ce)|0,o=o+Math.imul(v,ue)|0,n=n+Math.imul(p,le)|0,r=(r=r+Math.imul(p,he)|0)+Math.imul(m,le)|0,o=o+Math.imul(m,he)|0;var Re=(u+(n=n+Math.imul(l,pe)|0)|0)+((8191&(r=(r=r+Math.imul(l,me)|0)+Math.imul(h,pe)|0))<<13)|0;u=((o=o+Math.imul(h,me)|0)+(r>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(V,H),r=(r=Math.imul(V,q))+Math.imul(B,H)|0,o=Math.imul(B,q),n=n+Math.imul(L,z)|0,r=(r=r+Math.imul(L,Y)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,Y)|0,n=n+Math.imul(k,X)|0,r=(r=r+Math.imul(k,Q)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,Q)|0,n=n+Math.imul(O,$)|0,r=(r=r+Math.imul(O,ee)|0)+Math.imul(M,$)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(C,ie)|0,r=(r=r+Math.imul(C,ne)|0)+Math.imul(I,ie)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(S,oe)|0,r=(r=r+Math.imul(S,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,n=n+Math.imul(b,ce)|0,r=(r=r+Math.imul(b,ue)|0)+Math.imul(y,ce)|0,o=o+Math.imul(y,ue)|0,n=n+Math.imul(g,le)|0,r=(r=r+Math.imul(g,he)|0)+Math.imul(v,le)|0,o=o+Math.imul(v,he)|0;var Ce=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(r=(r=r+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((o=o+Math.imul(m,me)|0)+(r>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(V,z),r=(r=Math.imul(V,Y))+Math.imul(B,z)|0,o=Math.imul(B,Y),n=n+Math.imul(L,X)|0,r=(r=r+Math.imul(L,Q)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,Q)|0,n=n+Math.imul(k,$)|0,r=(r=r+Math.imul(k,ee)|0)+Math.imul(P,$)|0,o=o+Math.imul(P,ee)|0,n=n+Math.imul(O,ie)|0,r=(r=r+Math.imul(O,ne)|0)+Math.imul(M,ie)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(C,oe)|0,r=(r=r+Math.imul(C,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(S,ce)|0,r=(r=r+Math.imul(S,ue)|0)+Math.imul(T,ce)|0,o=o+Math.imul(T,ue)|0,n=n+Math.imul(b,le)|0,r=(r=r+Math.imul(b,he)|0)+Math.imul(y,le)|0,o=o+Math.imul(y,he)|0;var Ie=(u+(n=n+Math.imul(g,pe)|0)|0)+((8191&(r=(r=r+Math.imul(g,me)|0)+Math.imul(v,pe)|0))<<13)|0;u=((o=o+Math.imul(v,me)|0)+(r>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(V,X),r=(r=Math.imul(V,Q))+Math.imul(B,X)|0,o=Math.imul(B,Q),n=n+Math.imul(L,$)|0,r=(r=r+Math.imul(L,ee)|0)+Math.imul(x,$)|0,o=o+Math.imul(x,ee)|0,n=n+Math.imul(k,ie)|0,r=(r=r+Math.imul(k,ne)|0)+Math.imul(P,ie)|0,o=o+Math.imul(P,ne)|0,n=n+Math.imul(O,oe)|0,r=(r=r+Math.imul(O,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(C,ce)|0,r=(r=r+Math.imul(C,ue)|0)+Math.imul(I,ce)|0,o=o+Math.imul(I,ue)|0,n=n+Math.imul(S,le)|0,r=(r=r+Math.imul(S,he)|0)+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0;var Ae=(u+(n=n+Math.imul(b,pe)|0)|0)+((8191&(r=(r=r+Math.imul(b,me)|0)+Math.imul(y,pe)|0))<<13)|0;u=((o=o+Math.imul(y,me)|0)+(r>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(V,$),r=(r=Math.imul(V,ee))+Math.imul(B,$)|0,o=Math.imul(B,ee),n=n+Math.imul(L,ie)|0,r=(r=r+Math.imul(L,ne)|0)+Math.imul(x,ie)|0,o=o+Math.imul(x,ne)|0,n=n+Math.imul(k,oe)|0,r=(r=r+Math.imul(k,se)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,se)|0,n=n+Math.imul(O,ce)|0,r=(r=r+Math.imul(O,ue)|0)+Math.imul(M,ce)|0,o=o+Math.imul(M,ue)|0,n=n+Math.imul(C,le)|0,r=(r=r+Math.imul(C,he)|0)+Math.imul(I,le)|0,o=o+Math.imul(I,he)|0;var Oe=(u+(n=n+Math.imul(S,pe)|0)|0)+((8191&(r=(r=r+Math.imul(S,me)|0)+Math.imul(T,pe)|0))<<13)|0;u=((o=o+Math.imul(T,me)|0)+(r>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(V,ie),r=(r=Math.imul(V,ne))+Math.imul(B,ie)|0,o=Math.imul(B,ne),n=n+Math.imul(L,oe)|0,r=(r=r+Math.imul(L,se)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,se)|0,n=n+Math.imul(k,ce)|0,r=(r=r+Math.imul(k,ue)|0)+Math.imul(P,ce)|0,o=o+Math.imul(P,ue)|0,n=n+Math.imul(O,le)|0,r=(r=r+Math.imul(O,he)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,he)|0;var Me=(u+(n=n+Math.imul(C,pe)|0)|0)+((8191&(r=(r=r+Math.imul(C,me)|0)+Math.imul(I,pe)|0))<<13)|0;u=((o=o+Math.imul(I,me)|0)+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(V,oe),r=(r=Math.imul(V,se))+Math.imul(B,oe)|0,o=Math.imul(B,se),n=n+Math.imul(L,ce)|0,r=(r=r+Math.imul(L,ue)|0)+Math.imul(x,ce)|0,o=o+Math.imul(x,ue)|0,n=n+Math.imul(k,le)|0,r=(r=r+Math.imul(k,he)|0)+Math.imul(P,le)|0,o=o+Math.imul(P,he)|0;var Ne=(u+(n=n+Math.imul(O,pe)|0)|0)+((8191&(r=(r=r+Math.imul(O,me)|0)+Math.imul(M,pe)|0))<<13)|0;u=((o=o+Math.imul(M,me)|0)+(r>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(V,ce),r=(r=Math.imul(V,ue))+Math.imul(B,ce)|0,o=Math.imul(B,ue),n=n+Math.imul(L,le)|0,r=(r=r+Math.imul(L,he)|0)+Math.imul(x,le)|0,o=o+Math.imul(x,he)|0;var ke=(u+(n=n+Math.imul(k,pe)|0)|0)+((8191&(r=(r=r+Math.imul(k,me)|0)+Math.imul(P,pe)|0))<<13)|0;u=((o=o+Math.imul(P,me)|0)+(r>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(V,le),r=(r=Math.imul(V,he))+Math.imul(B,le)|0,o=Math.imul(B,he);var Pe=(u+(n=n+Math.imul(L,pe)|0)|0)+((8191&(r=(r=r+Math.imul(L,me)|0)+Math.imul(x,pe)|0))<<13)|0;u=((o=o+Math.imul(x,me)|0)+(r>>>13)|0)+(Pe>>>26)|0,Pe&=67108863;var De=(u+(n=Math.imul(V,pe))|0)+((8191&(r=(r=Math.imul(V,me))+Math.imul(B,pe)|0))<<13)|0;return u=((o=Math.imul(B,me))+(r>>>13)|0)+(De>>>26)|0,De&=67108863,c[0]=_e,c[1]=ge,c[2]=ve,c[3]=Ee,c[4]=be,c[5]=ye,c[6]=we,c[7]=Se,c[8]=Te,c[9]=Re,c[10]=Ce,c[11]=Ie,c[12]=Ae,c[13]=Oe,c[14]=Me,c[15]=Ne,c[16]=ke,c[17]=Pe,c[18]=De,0!==u&&(c[19]=u,i.length++),i};function m(e,t,i){return(new _).mulp(e,t,i)}function _(e,t){this.x=e,this.y=t}Math.imul||(p=f),o.prototype.mulTo=function(e,t){var i,n=this.length+e.length;return i=10===this.length&&10===e.length?p(this,e,t):n<63?f(this,e,t):n<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var n=0,r=0,o=0;o<i.length-1;o++){var s=r;r=0;for(var a=67108863&n,c=Math.min(o,t.length-1),u=Math.max(0,o-e.length+1);u<=c;u++){var d=o-u,l=(0|e.words[d])*(0|t.words[u]),h=67108863&l;a=67108863&(h=h+a|0),r+=(s=(s=s+(l/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}i.words[o]=a,n=s,s=r}return 0!==n?i.words[o]=n:i.length--,i.strip()}(this,e,t):m(this,e,t),i},_.prototype.makeRBT=function(e){for(var t=new Array(e),i=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,i,e);return t},_.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var n=0,r=0;r<t;r++)n|=(1&e)<<t-r-1,e>>=1;return n},_.prototype.permute=function(e,t,i,n,r,o){for(var s=0;s<o;s++)n[s]=t[e[s]],r[s]=i[e[s]]},_.prototype.transform=function(e,t,i,n,r,o){this.permute(o,e,t,i,n,r);for(var s=1;s<r;s<<=1)for(var a=s<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),d=0;d<r;d+=a)for(var l=c,h=u,f=0;f<s;f++){var p=i[d+f],m=n[d+f],_=i[d+f+s],g=n[d+f+s],v=l*_-h*g;g=l*g+h*_,_=v,i[d+f]=p+_,n[d+f]=m+g,i[d+f+s]=p-_,n[d+f+s]=m-g,f!==a&&(v=c*l-u*h,h=c*h+u*l,l=v)}},_.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),n=1&i,r=0;for(i=i/2|0;i;i>>>=1)r++;return 1<<r+1+n},_.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var n=0;n<i/2;n++){var r=e[n];e[n]=e[i-n-1],e[i-n-1]=r,r=t[n],t[n]=-t[i-n-1],t[i-n-1]=-r}},_.prototype.normalize13b=function(e,t){for(var i=0,n=0;n<t/2;n++){var r=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+i;e[n]=67108863&r,i=r<67108864?0:r/67108864|0}return e},_.prototype.convert13b=function(e,t,i,r){for(var o=0,s=0;s<t;s++)o+=0|e[s],i[2*s]=8191&o,o>>>=13,i[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<r;++s)i[s]=0;n(0===o),n(0===(-8192&o))},_.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},_.prototype.mulp=function(e,t,i){var n=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),d=new Array(n),l=new Array(n),h=i.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,u,n),this.transform(s,o,a,c,n,r),this.transform(u,o,d,l,n,r);for(var f=0;f<n;f++){var p=a[f]*d[f]-c[f]*l[f];c[f]=a[f]*l[f]+c[f]*d[f],a[f]=p}return this.conjugate(a,c,n),this.transform(a,c,h,o,n,r),this.conjugate(h,o,n),this.normalize13b(h,n),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),m(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){n("number"===typeof e),n(e<67108864);for(var t=0,i=0;i<this.length;i++){var r=(0|this.words[i])*e,o=(67108863&r)+(67108863&t);t>>=26,t+=r/67108864|0,t+=o>>>26,this.words[i]=67108863&o}return 0!==t&&(this.words[i]=t,this.length++),this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var n=i/26|0,r=i%26;t[i]=(e.words[n]&1<<r)>>>r}return t}(e);if(0===t.length)return new o(1);for(var i=this,n=0;n<t.length&&0===t[n];n++,i=i.sqr());if(++n<t.length)for(var r=i.sqr();n<t.length;n++,r=r.sqr())0!==t[n]&&(i=i.mul(r));return i},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,i=e%26,r=(e-i)/26,o=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,c=(0|this.words[t])-a<<i;this.words[t]=c|s,s=a>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==r){for(t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(t=0;t<r;t++)this.words[t]=0;this.length+=r}return this.strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,i){var r;n("number"===typeof e&&e>=0),r=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,c=i;if(r-=s,r=Math.max(0,r),c){for(var u=0;u<s;u++)c.words[u]=this.words[u];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,u=0;u<this.length;u++)this.words[u]=this.words[u+s];else this.words[0]=0,this.length=1;var d=0;for(u=this.length-1;u>=0&&(0!==d||u>=r);u--){var l=0|this.words[u];this.words[u]=d<<26-o|l>>>o,d=l&a}return c&&0!==d&&(c.words[c.length++]=d),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(e,t,i){return n(0===this.negative),this.iushrn(e,t,i)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26,r=1<<t;return!(this.length<=i)&&!!(this.words[i]&r)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var r=67108863^67108863>>>t<<t;this.words[this.length-1]&=r}return this.strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,i){var r,o,s=e.length+i;this._expand(s);var a=0;for(r=0;r<e.length;r++){o=(0|this.words[r+i])+a;var c=(0|e.words[r])*t;a=((o-=67108863&c)>>26)-(c/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},o.prototype._wordDiv=function(e,t){var i=(this.length,e.length),n=this.clone(),r=e,s=0|r.words[r.length-1];0!==(i=26-this._countBits(s))&&(r=r.ushln(i),n.iushln(i),s=0|r.words[r.length-1]);var a,c=n.length-r.length;if("mod"!==t){(a=new o(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var d=n.clone()._ishlnsubmul(r,1,c);0===d.negative&&(n=d,a&&(a.words[c]=1));for(var l=c-1;l>=0;l--){var h=67108864*(0|n.words[r.length+l])+(0|n.words[r.length+l-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(r,h,l);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(r,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=h)}return a&&a.strip(),n.strip(),"div"!==t&&0!==i&&n.iushrn(i),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,i){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(r=a.div.neg()),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:r,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(r=a.div.neg()),{div:r,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}:this._wordDiv(e,t);var r,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),r=e.andln(1),o=i.cmp(n);return o<0||1===r&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,i=0,r=this.length-1;r>=0;r--)i=(t*i+(0|this.words[r]))%e;return i},o.prototype.idivn=function(e){n(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var r=(0|this.words[i])+67108864*t;this.words[i]=r/e|0,t=r%e}return this.strip()},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r=new o(1),s=new o(0),a=new o(0),c=new o(1),u=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++u;for(var d=i.clone(),l=t.clone();!t.isZero();){for(var h=0,f=1;0===(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(r.isOdd()||s.isOdd())&&(r.iadd(d),s.isub(l)),r.iushrn(1),s.iushrn(1);for(var p=0,m=1;0===(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(d),c.isub(l)),a.iushrn(1),c.iushrn(1);t.cmp(i)>=0?(t.isub(i),r.isub(a),s.isub(c)):(i.isub(t),a.isub(r),c.isub(s))}return{a:a,b:c,gcd:i.iushln(u)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r,s=new o(1),a=new o(0),c=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,d=1;0===(t.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(t.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var l=0,h=1;0===(i.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(i.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(a)):(i.isub(t),a.isub(s))}return(r=0===t.cmpn(1)?s:a).cmpn(0)<0&&r.iadd(e),r},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var n=0;t.isEven()&&i.isEven();n++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=t.cmp(i);if(r<0){var o=t;t=i,i=o}else if(0===r||0===i.cmpn(1))break;t.isub(i)}return i.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,i=(e-t)/26,r=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var o=r,s=i;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),n(e<=67108863,"Number is too big");var r=0|this.words[0];t=r===e?0:r<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],r=0|e.words[i];if(n!==r){n<r?t=-1:n>r&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new S(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function y(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function T(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},r(E,v),E.prototype.split=function(e,t){for(var i=4194303,n=Math.min(e.length,9),r=0;r<n;r++)t.words[r]=e.words[r];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&i,r=10;r<e.length;r++){var s=0|e.words[r];e.words[r-10]=(s&i)<<4|o>>>22,o=s}o>>>=22,e.words[r-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var n=0|e.words[i];t+=977*n,e.words[i]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(b,v),r(y,v),r(w,v),w.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var n=19*(0|e.words[i])+t,r=67108863&n;n>>>=26,e.words[i]=r,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new b;else if("p192"===e)t=new y;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return g[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},S.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var i=this.m.add(new o(1)).iushrn(2);return this.pow(e,i)}for(var r=this.m.subn(1),s=0;!r.isZero()&&0===r.andln(1);)s++,r.iushrn(1);n(!r.isZero());var a=new o(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new o(2*d*d).toRed(this);0!==this.pow(d,u).cmp(c);)d.redIAdd(c);for(var l=this.pow(d,r),h=this.pow(e,r.addn(1).iushrn(1)),f=this.pow(e,r),p=s;0!==f.cmp(a);){for(var m=f,_=0;0!==m.cmp(a);_++)m=m.redSqr();n(_<p);var g=this.pow(l,new o(1).iushln(p-_-1));h=h.redMul(g),l=g.redSqr(),f=f.redMul(l),p=_}return h},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new o(1).toRed(this),i[1]=e;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],e);var r=i[0],s=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],d=c-1;d>=0;d--){var l=u>>d&1;r!==i[0]&&(r=this.sqr(r)),0!==l||0!==s?(s<<=1,s|=l,(4===++a||0===n&&0===d)&&(r=this.mul(r,i[s]),a=0,s=0)):a=0}c=26}return r},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new T(e)},r(T,S),T.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},T.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},T.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},T.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var i=e.mul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),s=r;return r.cmp(this.m)>=0?s=r.isub(this.m):r.cmpn(0)<0&&(s=r.iadd(this.m)),s._forceRed(this)},T.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(27)(e))},,,function(e){e.exports=JSON.parse('{"modp1":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},"modp2":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},"modp5":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},"modp14":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},"modp15":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},"modp16":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},"modp17":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},"modp18":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}')},function(e,t,i){(function(t){var n=i(116),r=new(i(117)),o=new n(24),s=new n(11),a=new n(10),c=new n(3),u=new n(7),d=i(115),l=i(31);function h(e,i){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),this._pub=new n(e),this}function f(e,i){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),this._priv=new n(e),this}e.exports=m;var p={};function m(e,t,i){this.setGenerator(t),this.__prime=new n(e),this._prime=n.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,i?(this.setPublicKey=h,this.setPrivateKey=f):this._primeCode=8}function _(e,i){var n=new t(e.toArray());return i?n.toString(i):n}Object.defineProperty(m.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!==typeof this._primeCode&&(this._primeCode=function(e,t){var i=t.toString("hex"),n=[i,e.toString(16)].join("_");if(n in p)return p[n];var l,h=0;if(e.isEven()||!d.simpleSieve||!d.fermatTest(e)||!r.test(e))return h+=1,h+="02"===i||"05"===i?8:4,p[n]=h,h;switch(r.test(e.shrn(1))||(h+=2),i){case"02":e.mod(o).cmp(s)&&(h+=8);break;case"05":(l=e.mod(a)).cmp(c)&&l.cmp(u)&&(h+=8);break;default:h+=4}return p[n]=h,h}(this.__prime,this.__gen)),this._primeCode}}),m.prototype.generateKeys=function(){return this._priv||(this._priv=new n(l(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},m.prototype.computeSecret=function(e){var i=(e=(e=new n(e)).toRed(this._prime)).redPow(this._priv).fromRed(),r=new t(i.toArray()),o=this.getPrime();if(r.length<o.length){var s=new t(o.length-r.length);s.fill(0),r=t.concat([s,r])}return r},m.prototype.getPublicKey=function(e){return _(this._pub,e)},m.prototype.getPrivateKey=function(e){return _(this._priv,e)},m.prototype.getPrime=function(e){return _(this.__prime,e)},m.prototype.getGenerator=function(e){return _(this._gen,e)},m.prototype.setGenerator=function(e,i){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),this.__gen=e,this._gen=new n(e),this}}).call(this,i(7).Buffer)},function(e,t,i){"use strict";var n=i(3).Buffer,r=i(41),o=i(214),s=i(2),a=i(222),c=i(253),u=i(102);function d(e){o.Writable.call(this);var t=u[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=r(t.hash),this._tag=t.id,this._signType=t.sign}function l(e){o.Writable.call(this);var t=u[e];if(!t)throw new Error("Unknown message digest");this._hash=r(t.hash),this._tag=t.id,this._signType=t.sign}function h(e){return new d(e)}function f(e){return new l(e)}Object.keys(u).forEach((function(e){u[e].id=n.from(u[e].id,"hex"),u[e.toLowerCase()]=u[e]})),s(d,o.Writable),d.prototype._write=function(e,t,i){this._hash.update(e),i()},d.prototype.update=function(e,t){return this._hash.update("string"===typeof e?n.from(e,t):e),this},d.prototype.sign=function(e,t){this.end();var i=this._hash.digest(),n=a(i,e,this._hashType,this._signType,this._tag);return t?n.toString(t):n},s(l,o.Writable),l.prototype._write=function(e,t,i){this._hash.update(e),i()},l.prototype.update=function(e,t){return this._hash.update("string"===typeof e?n.from(e,t):e),this},l.prototype.verify=function(e,t,i){var r="string"===typeof t?n.from(t,i):t;this.end();var o=this._hash.digest();return c(r,o,e,this._signType,this._tag)},e.exports={Sign:h,Verify:f,createSign:h,createVerify:f}},function(e,t,i){(t=e.exports=i(118)).Stream=t,t.Readable=t,t.Writable=i(122),t.Duplex=i(36),t.Transform=i(123),t.PassThrough=i(220),t.finished=i(74),t.pipeline=i(221)},,function(e,t,i){"use strict";function n(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function r(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){o(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function o(e,t,i){return(t=a(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var c=i(7).Buffer,u=i(217).inspect,d=u&&u.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,i,n;return t=e,(i=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i}},{key:"concat",value:function(e){if(0===this.length)return c.alloc(0);for(var t,i,n,r=c.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,i=r,n=s,c.prototype.copy.call(t,i,n),s+=o.data.length,o=o.next;return r}},{key:"consume",value:function(e,t){var i;return e<this.head.data.length?(i=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):i=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,i=1,n=t.data;for(e-=n.length;t=t.next;){var r=t.data,o=e>r.length?r.length:e;if(o===r.length?n+=r:n+=r.slice(0,e),0===(e-=o)){o===r.length?(++i,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=r.slice(o));break}++i}return this.length-=i,n}},{key:"_getBuffer",value:function(e){var t=c.allocUnsafe(e),i=this.head,n=1;for(i.data.copy(t),e-=i.data.length;i=i.next;){var r=i.data,o=e>r.length?r.length:e;if(r.copy(t,t.length-e,0,o),0===(e-=o)){o===r.length?(++n,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=r.slice(o));break}++n}return this.length-=n,t}},{key:d,value:function(e,t){return u(this,r(r({},t),{},{depth:0,customInspect:!1}))}}])&&s(t.prototype,i),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()},,function(e,t,i){"use strict";(function(t){var n;function r(e,t,i){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var o=i(74),s=Symbol("lastResolve"),a=Symbol("lastReject"),c=Symbol("error"),u=Symbol("ended"),d=Symbol("lastPromise"),l=Symbol("handlePromise"),h=Symbol("stream");function f(e,t){return{value:e,done:t}}function p(e){var t=e[s];if(null!==t){var i=e[h].read();null!==i&&(e[d]=null,e[s]=null,e[a]=null,t(f(i,!1)))}}function m(e){t.nextTick(p,e)}var _=Object.getPrototypeOf((function(){})),g=Object.setPrototypeOf((r(n={get stream(){return this[h]},next:function(){var e=this,i=this[c];if(null!==i)return Promise.reject(i);if(this[u])return Promise.resolve(f(void 0,!0));if(this[h].destroyed)return new Promise((function(i,n){t.nextTick((function(){e[c]?n(e[c]):i(f(void 0,!0))}))}));var n,r=this[d];if(r)n=new Promise(function(e,t){return function(i,n){e.then((function(){t[u]?i(f(void 0,!0)):t[l](i,n)}),n)}}(r,this));else{var o=this[h].read();if(null!==o)return Promise.resolve(f(o,!1));n=new Promise(this[l])}return this[d]=n,n}},Symbol.asyncIterator,(function(){return this})),r(n,"return",(function(){var e=this;return new Promise((function(t,i){e[h].destroy(null,(function(e){e?i(e):t(f(void 0,!0))}))}))})),n),_);e.exports=function(e){var t,i=Object.create(g,(r(t={},h,{value:e,writable:!0}),r(t,s,{value:null,writable:!0}),r(t,a,{value:null,writable:!0}),r(t,c,{value:null,writable:!0}),r(t,u,{value:e._readableState.endEmitted,writable:!0}),r(t,l,{value:function(e,t){var n=i[h].read();n?(i[d]=null,i[s]=null,i[a]=null,e(f(n,!1))):(i[s]=e,i[a]=t)},writable:!0}),t));return i[d]=null,o(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=i[a];return null!==t&&(i[d]=null,i[s]=null,i[a]=null,t(e)),void(i[c]=e)}var n=i[s];null!==n&&(i[d]=null,i[s]=null,i[a]=null,n(f(void 0,!0))),i[u]=!0})),e.on("readable",m.bind(null,i)),i}}).call(this,i(6))},function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}},function(e,t,i){"use strict";e.exports=r;var n=i(123);function r(e){if(!(this instanceof r))return new r(e);n.call(this,e)}i(2)(r,n),r.prototype._transform=function(e,t,i){i(null,e)}},function(e,t,i){"use strict";var n;var r=i(35).codes,o=r.ERR_MISSING_ARGS,s=r.ERR_STREAM_DESTROYED;function a(e){if(e)throw e}function c(e){e()}function u(e,t){return e.pipe(t)}e.exports=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var d,l=function(e){return e.length?"function"!==typeof e[e.length-1]?a:e.pop():a}(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new o("streams");var h=t.map((function(e,r){var o=r<t.length-1;return function(e,t,r,o){o=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(o);var a=!1;e.on("close",(function(){a=!0})),void 0===n&&(n=i(74)),n(e,{readable:t,writable:r},(function(e){if(e)return o(e);a=!0,o()}));var c=!1;return function(t){if(!a&&!c)return c=!0,function(e){return e.setHeader&&"function"===typeof e.abort}(e)?e.abort():"function"===typeof e.destroy?e.destroy():void o(t||new s("pipe"))}}(e,o,r>0,(function(e){d||(d=e),e&&h.forEach(c),o||(h.forEach(c),l(d))}))}));return t.reduce(u)}},function(e,t,i){"use strict";var n=i(3).Buffer,r=i(100),o=i(75),s=i(77).ec,a=i(76),c=i(56),u=i(135);function d(e,t,i,o){if((e=n.from(e.toArray())).length<t.byteLength()){var s=n.alloc(t.byteLength()-e.length);e=n.concat([s,e])}var a=i.length,c=function(e,t){e=l(e,t),e=e.mod(t);var i=n.from(e.toArray());if(i.length<t.byteLength()){var r=n.alloc(t.byteLength()-i.length);i=n.concat([r,i])}return i}(i,t),u=n.alloc(a);u.fill(1);var d=n.alloc(a);return d=r(o,d).update(u).update(n.from([0])).update(e).update(c).digest(),u=r(o,d).update(u).digest(),{k:d=r(o,d).update(u).update(n.from([1])).update(e).update(c).digest(),v:u=r(o,d).update(u).digest()}}function l(e,t){var i=new a(e),n=(e.length<<3)-t.bitLength();return n>0&&i.ishrn(n),i}function h(e,t,i){var o,s;do{for(o=n.alloc(0);8*o.length<e.bitLength();)t.v=r(i,t.k).update(t.v).digest(),o=n.concat([o,t.v]);s=l(o,e),t.k=r(i,t.k).update(t.v).update(n.from([0])).digest(),t.v=r(i,t.k).update(t.v).digest()}while(-1!==s.cmp(e));return s}function f(e,t,i,n){return e.toRed(a.mont(i)).redPow(t).fromRed().mod(n)}e.exports=function(e,t,i,r,p){var m=c(t);if(m.curve){if("ecdsa"!==r&&"ecdsa/rsa"!==r)throw new Error("wrong private key type");return function(e,t){var i=u[t.curve.join(".")];if(!i)throw new Error("unknown curve "+t.curve.join("."));var r=new s(i).keyFromPrivate(t.privateKey),o=r.sign(e);return n.from(o.toDER())}(e,m)}if("dsa"===m.type){if("dsa"!==r)throw new Error("wrong private key type");return function(e,t,i){var r,o=t.params.priv_key,s=t.params.p,c=t.params.q,u=t.params.g,p=new a(0),m=l(e,c).mod(c),_=!1,g=d(o,c,e,i);for(;!1===_;)p=f(u,r=h(c,g,i),s,c),0===(_=r.invm(c).imul(m.add(o.mul(p))).mod(c)).cmpn(0)&&(_=!1,p=new a(0));return function(e,t){e=e.toArray(),t=t.toArray(),128&e[0]&&(e=[0].concat(e));128&t[0]&&(t=[0].concat(t));var i=e.length+t.length+4,r=[48,i,2,e.length];return r=r.concat(e,[2,t.length],t),n.from(r)}(p,_)}(e,m,i)}if("rsa"!==r&&"ecdsa/rsa"!==r)throw new Error("wrong private key type");if(void 0!==t.padding&&1!==t.padding)throw new Error("illegal or unsupported padding mode");e=n.concat([p,e]);for(var _=m.modulus.byteLength(),g=[0,1];e.length+g.length+1<_;)g.push(255);g.push(0);for(var v=-1;++v<e.length;)g.push(e[v]);return o(g,m)},e.exports.getKey=d,e.exports.makeKey=h},,function(e){e.exports=JSON.parse('{"name":"elliptic","version":"6.5.4","description":"EC cryptography","main":"lib/elliptic.js","files":["lib"],"scripts":{"lint":"eslint lib test","lint:fix":"npm run lint -- --fix","unit":"istanbul test _mocha --reporter=spec test/index.js","test":"npm run lint && npm run unit","version":"grunt dist && git add dist/"},"repository":{"type":"git","url":"git@github.com:indutny/elliptic"},"keywords":["EC","Elliptic","curve","Cryptography"],"author":"Fedor Indutny <fedor@indutny.com>","license":"MIT","bugs":{"url":"https://github.com/indutny/elliptic/issues"},"homepage":"https://github.com/indutny/elliptic","devDependencies":{"brfs":"^2.0.2","coveralls":"^3.1.0","eslint":"^7.6.0","grunt":"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1","istanbul":"^0.4.5","mocha":"^8.0.1"},"dependencies":{"bn.js":"^4.11.9","brorand":"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1","inherits":"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}')},,function(e,t,i){"use strict";var n=i(12),r=i(20),o=i(2),s=i(55),a=n.assert;function c(e){s.call(this,"short",e),this.a=new r(e.a,16).toRed(this.red),this.b=new r(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function u(e,t,i,n){s.BasePoint.call(this,e,"affine"),null===t&&null===i?(this.x=null,this.y=null,this.inf=!0):(this.x=new r(t,16),this.y=new r(i,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function d(e,t,i,n){s.BasePoint.call(this,e,"jacobian"),null===t&&null===i&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new r(0)):(this.x=new r(t,16),this.y=new r(i,16),this.z=new r(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}o(c,s),e.exports=c,c.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,i;if(e.beta)t=new r(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=(t=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(e.lambda)i=new r(e.lambda,16);else{var o=this._getEndoRoots(this.n);0===this.g.mul(o[0]).x.cmp(this.g.x.redMul(t))?i=o[0]:(i=o[1],a(0===this.g.mul(i).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:i,basis:e.basis?e.basis.map((function(e){return{a:new r(e.a,16),b:new r(e.b,16)}})):this._getEndoBasis(i)}}},c.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:r.mont(e),i=new r(2).toRed(t).redInvm(),n=i.redNeg(),o=new r(3).toRed(t).redNeg().redSqrt().redMul(i);return[n.redAdd(o).fromRed(),n.redSub(o).fromRed()]},c.prototype._getEndoBasis=function(e){for(var t,i,n,o,s,a,c,u,d,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),h=e,f=this.n.clone(),p=new r(1),m=new r(0),_=new r(0),g=new r(1),v=0;0!==h.cmpn(0);){var E=f.div(h);u=f.sub(E.mul(h)),d=_.sub(E.mul(p));var b=g.sub(E.mul(m));if(!n&&u.cmp(l)<0)t=c.neg(),i=p,n=u.neg(),o=d;else if(n&&2===++v)break;c=u,f=h,h=u,_=p,p=d,g=m,m=b}s=u.neg(),a=d;var y=n.sqr().add(o.sqr());return s.sqr().add(a.sqr()).cmp(y)>=0&&(s=t,a=i),n.negative&&(n=n.neg(),o=o.neg()),s.negative&&(s=s.neg(),a=a.neg()),[{a:n,b:o},{a:s,b:a}]},c.prototype._endoSplit=function(e){var t=this.endo.basis,i=t[0],n=t[1],r=n.b.mul(e).divRound(this.n),o=i.b.neg().mul(e).divRound(this.n),s=r.mul(i.a),a=o.mul(n.a),c=r.mul(i.b),u=o.mul(n.b);return{k1:e.sub(s).sub(a),k2:c.add(u).neg()}},c.prototype.pointFromX=function(e,t){(e=new r(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(0!==n.redSqr().redSub(i).cmp(this.zero))throw new Error("invalid point");var o=n.fromRed().isOdd();return(t&&!o||!t&&o)&&(n=n.redNeg()),this.point(e,n)},c.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,i=e.y,n=this.a.redMul(t),r=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return 0===i.redSqr().redISub(r).cmpn(0)},c.prototype._endoWnafMulAdd=function(e,t,i){for(var n=this._endoWnafT1,r=this._endoWnafT2,o=0;o<e.length;o++){var s=this._endoSplit(t[o]),a=e[o],c=a._getBeta();s.k1.negative&&(s.k1.ineg(),a=a.neg(!0)),s.k2.negative&&(s.k2.ineg(),c=c.neg(!0)),n[2*o]=a,n[2*o+1]=c,r[2*o]=s.k1,r[2*o+1]=s.k2}for(var u=this._wnafMulAdd(1,n,r,2*o,i),d=0;d<2*o;d++)n[d]=null,r[d]=null;return u},o(u,s.BasePoint),c.prototype.point=function(e,t,i){return new u(this,e,t,i)},c.prototype.pointFromJSON=function(e,t){return u.fromJSON(this,e,t)},u.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(e){return i.point(e.x.redMul(i.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}},u.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},u.fromJSON=function(e,t,i){"string"===typeof t&&(t=JSON.parse(t));var n=e.point(t[0],t[1],i);if(!t[2])return n;function r(t){return e.point(t[0],t[1],i)}var o=t[2];return n.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[n].concat(o.doubles.points.map(r))},naf:o.naf&&{wnd:o.naf.wnd,points:[n].concat(o.naf.points.map(r))}},n},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.inf},u.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var i=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)},u.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),r=i.redAdd(i).redIAdd(i).redIAdd(t).redMul(n),o=r.redSqr().redISub(this.x.redAdd(this.x)),s=r.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,s)},u.prototype.getX=function(){return this.x.fromRed()},u.prototype.getY=function(){return this.y.fromRed()},u.prototype.mul=function(e){return e=new r(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},u.prototype.mulAdd=function(e,t,i){var n=[this,t],r=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,r):this.curve._wnafMulAdd(1,n,r,2)},u.prototype.jmulAdd=function(e,t,i){var n=[this,t],r=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,r,!0):this.curve._wnafMulAdd(1,n,r,2,!0)},u.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},u.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(e){return e.neg()};t.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return t},u.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},o(d,s.BasePoint),c.prototype.jpoint=function(e,t,i){return new d(this,e,t,i)},d.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),i=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(i,n)},d.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},d.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(t),r=e.x.redMul(i),o=this.y.redMul(t.redMul(e.z)),s=e.y.redMul(i.redMul(this.z)),a=n.redSub(r),c=o.redSub(s);if(0===a.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),d=u.redMul(a),l=n.redMul(u),h=c.redSqr().redIAdd(d).redISub(l).redISub(l),f=c.redMul(l.redISub(h)).redISub(o.redMul(d)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(h,f,p)},d.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),i=this.x,n=e.x.redMul(t),r=this.y,o=e.y.redMul(t).redMul(this.z),s=i.redSub(n),a=r.redSub(o);if(0===s.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=s.redSqr(),u=c.redMul(s),d=i.redMul(c),l=a.redSqr().redIAdd(u).redISub(d).redISub(d),h=a.redMul(d.redISub(l)).redISub(r.redMul(u)),f=this.z.redMul(s);return this.curve.jpoint(l,h,f)},d.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var i=this;for(t=0;t<e;t++)i=i.dbl();return i}var n=this.curve.a,r=this.curve.tinv,o=this.x,s=this.y,a=this.z,c=a.redSqr().redSqr(),u=s.redAdd(s);for(t=0;t<e;t++){var d=o.redSqr(),l=u.redSqr(),h=l.redSqr(),f=d.redAdd(d).redIAdd(d).redIAdd(n.redMul(c)),p=o.redMul(l),m=f.redSqr().redISub(p.redAdd(p)),_=p.redISub(m),g=f.redMul(_);g=g.redIAdd(g).redISub(h);var v=u.redMul(a);t+1<e&&(c=c.redMul(h)),o=m,a=v,u=g}return this.curve.jpoint(o,u.redMul(r),a)},d.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},d.prototype._zeroDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),r=this.y.redSqr(),o=r.redSqr(),s=this.x.redAdd(r).redSqr().redISub(n).redISub(o);s=s.redIAdd(s);var a=n.redAdd(n).redIAdd(n),c=a.redSqr().redISub(s).redISub(s),u=o.redIAdd(o);u=(u=u.redIAdd(u)).redIAdd(u),e=c,t=a.redMul(s.redISub(c)).redISub(u),i=this.y.redAdd(this.y)}else{var d=this.x.redSqr(),l=this.y.redSqr(),h=l.redSqr(),f=this.x.redAdd(l).redSqr().redISub(d).redISub(h);f=f.redIAdd(f);var p=d.redAdd(d).redIAdd(d),m=p.redSqr(),_=h.redIAdd(h);_=(_=_.redIAdd(_)).redIAdd(_),e=m.redISub(f).redISub(f),t=p.redMul(f.redISub(e)).redISub(_),i=(i=this.y.redMul(this.z)).redIAdd(i)}return this.curve.jpoint(e,t,i)},d.prototype._threeDbl=function(){var e,t,i;if(this.zOne){var n=this.x.redSqr(),r=this.y.redSqr(),o=r.redSqr(),s=this.x.redAdd(r).redSqr().redISub(n).redISub(o);s=s.redIAdd(s);var a=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),c=a.redSqr().redISub(s).redISub(s);e=c;var u=o.redIAdd(o);u=(u=u.redIAdd(u)).redIAdd(u),t=a.redMul(s.redISub(c)).redISub(u),i=this.y.redAdd(this.y)}else{var d=this.z.redSqr(),l=this.y.redSqr(),h=this.x.redMul(l),f=this.x.redSub(d).redMul(this.x.redAdd(d));f=f.redAdd(f).redIAdd(f);var p=h.redIAdd(h),m=(p=p.redIAdd(p)).redAdd(p);e=f.redSqr().redISub(m),i=this.y.redAdd(this.z).redSqr().redISub(l).redISub(d);var _=l.redSqr();_=(_=(_=_.redIAdd(_)).redIAdd(_)).redIAdd(_),t=f.redMul(p.redISub(e)).redISub(_)}return this.curve.jpoint(e,t,i)},d.prototype._dbl=function(){var e=this.curve.a,t=this.x,i=this.y,n=this.z,r=n.redSqr().redSqr(),o=t.redSqr(),s=i.redSqr(),a=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(r)),c=t.redAdd(t),u=(c=c.redIAdd(c)).redMul(s),d=a.redSqr().redISub(u.redAdd(u)),l=u.redISub(d),h=s.redSqr();h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var f=a.redMul(l).redISub(h),p=i.redAdd(i).redMul(n);return this.curve.jpoint(d,f,p)},d.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr(),n=t.redSqr(),r=e.redAdd(e).redIAdd(e),o=r.redSqr(),s=this.x.redAdd(t).redSqr().redISub(e).redISub(n),a=(s=(s=(s=s.redIAdd(s)).redAdd(s).redIAdd(s)).redISub(o)).redSqr(),c=n.redIAdd(n);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var u=r.redIAdd(s).redSqr().redISub(o).redISub(a).redISub(c),d=t.redMul(u);d=(d=d.redIAdd(d)).redIAdd(d);var l=this.x.redMul(a).redISub(d);l=(l=l.redIAdd(l)).redIAdd(l);var h=this.y.redMul(u.redMul(c.redISub(u)).redISub(s.redMul(a)));h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var f=this.z.redAdd(s).redSqr().redISub(i).redISub(a);return this.curve.jpoint(l,h,f)},d.prototype.mul=function(e,t){return e=new r(e,t),this.curve._wnafMul(this,e)},d.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),i=e.z.redSqr();if(0!==this.x.redMul(i).redISub(e.x.redMul(t)).cmpn(0))return!1;var n=t.redMul(this.z),r=i.redMul(e.z);return 0===this.y.redMul(r).redISub(e.y.redMul(n)).cmpn(0)},d.prototype.eqXToP=function(e){var t=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(i))return!0;for(var n=e.clone(),r=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(r),0===this.x.cmp(i))return!0}},d.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},d.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},function(e,t,i){"use strict";var n=i(20),r=i(2),o=i(55),s=i(12);function a(e){o.call(this,"mont",e),this.a=new n(e.a,16).toRed(this.red),this.b=new n(e.b,16).toRed(this.red),this.i4=new n(4).toRed(this.red).redInvm(),this.two=new n(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(e,t,i){o.BasePoint.call(this,e,"projective"),null===t&&null===i?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new n(t,16),this.z=new n(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}r(a,o),e.exports=a,a.prototype.validate=function(e){var t=e.normalize().x,i=t.redSqr(),n=i.redMul(t).redAdd(i.redMul(this.a)).redAdd(t);return 0===n.redSqrt().redSqr().cmp(n)},r(c,o.BasePoint),a.prototype.decodePoint=function(e,t){return this.point(s.toArray(e,t),1)},a.prototype.point=function(e,t){return new c(this,e,t)},a.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(e,t){return new c(e,t[0],t[1]||e.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},c.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),i=e.redSub(t),n=e.redMul(t),r=i.redMul(t.redAdd(this.curve.a24.redMul(i)));return this.curve.point(n,r)},c.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(e,t){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),r=e.x.redAdd(e.z),o=e.x.redSub(e.z).redMul(i),s=r.redMul(n),a=t.z.redMul(o.redAdd(s).redSqr()),c=t.x.redMul(o.redISub(s).redSqr());return this.curve.point(a,c)},c.prototype.mul=function(e){for(var t=e.clone(),i=this,n=this.curve.point(null,null),r=[];0!==t.cmpn(0);t.iushrn(1))r.push(t.andln(1));for(var o=r.length-1;o>=0;o--)0===r[o]?(i=i.diffAdd(n,this),n=n.dbl()):(n=i.diffAdd(n,this),i=i.dbl());return n},c.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},function(e,t,i){"use strict";var n=i(12),r=i(20),o=i(2),s=i(55),a=n.assert;function c(e){this.twisted=1!==(0|e.a),this.mOneA=this.twisted&&-1===(0|e.a),this.extended=this.mOneA,s.call(this,"edwards",e),this.a=new r(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new r(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new r(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1===(0|e.c)}function u(e,t,i,n,o){s.BasePoint.call(this,e,"projective"),null===t&&null===i&&null===n?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new r(t,16),this.y=new r(i,16),this.z=n?new r(n,16):this.curve.one,this.t=o&&new r(o,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}o(c,s),e.exports=c,c.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},c.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},c.prototype.jpoint=function(e,t,i,n){return this.point(e,t,i,n)},c.prototype.pointFromX=function(e,t){(e=new r(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),o=this.one.redSub(this.c2.redMul(this.d).redMul(i)),s=n.redMul(o.redInvm()),a=s.redSqrt();if(0!==a.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");var c=a.fromRed().isOdd();return(t&&!c||!t&&c)&&(a=a.redNeg()),this.point(e,a)},c.prototype.pointFromY=function(e,t){(e=new r(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),o=i.redMul(this.d).redMul(this.c2).redSub(this.a),s=n.redMul(o.redInvm());if(0===s.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=s.redSqrt();if(0!==a.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)},c.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),i=e.y.redSqr(),n=t.redMul(this.a).redAdd(i),r=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(i)));return 0===n.cmp(r)},o(u,s.BasePoint),c.prototype.pointFromJSON=function(e){return u.fromJSON(this,e)},c.prototype.point=function(e,t,i,n){return new u(this,e,t,i,n)},u.fromJSON=function(e,t){return new u(e,t[0],t[1],t[2])},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},u.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),r=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),o=n.redAdd(t),s=o.redSub(i),a=n.redSub(t),c=r.redMul(s),u=o.redMul(a),d=r.redMul(a),l=s.redMul(o);return this.curve.point(c,u,l,d)},u.prototype._projDbl=function(){var e,t,i,n,r,o,s=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),c=this.y.redSqr();if(this.curve.twisted){var u=(n=this.curve._mulA(a)).redAdd(c);this.zOne?(e=s.redSub(a).redSub(c).redMul(u.redSub(this.curve.two)),t=u.redMul(n.redSub(c)),i=u.redSqr().redSub(u).redSub(u)):(r=this.z.redSqr(),o=u.redSub(r).redISub(r),e=s.redSub(a).redISub(c).redMul(o),t=u.redMul(n.redSub(c)),i=u.redMul(o))}else n=a.redAdd(c),r=this.curve._mulC(this.z).redSqr(),o=n.redSub(r).redSub(r),e=this.curve._mulC(s.redISub(n)).redMul(o),t=this.curve._mulC(n).redMul(a.redISub(c)),i=n.redMul(o);return this.curve.point(e,t,i)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},u.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),r=this.z.redMul(e.z.redAdd(e.z)),o=i.redSub(t),s=r.redSub(n),a=r.redAdd(n),c=i.redAdd(t),u=o.redMul(s),d=a.redMul(c),l=o.redMul(c),h=s.redMul(a);return this.curve.point(u,d,h,l)},u.prototype._projAdd=function(e){var t,i,n=this.z.redMul(e.z),r=n.redSqr(),o=this.x.redMul(e.x),s=this.y.redMul(e.y),a=this.curve.d.redMul(o).redMul(s),c=r.redSub(a),u=r.redAdd(a),d=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(o).redISub(s),l=n.redMul(c).redMul(d);return this.curve.twisted?(t=n.redMul(u).redMul(s.redSub(this.curve._mulA(o))),i=c.redMul(u)):(t=n.redMul(u).redMul(s.redSub(o)),i=this.curve._mulC(c).redMul(u)),this.curve.point(l,t,i)},u.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},u.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},u.prototype.mulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!1)},u.prototype.jmulAdd=function(e,t,i){return this.curve._wnafMulAdd(1,[this,t],[e,i],2,!0)},u.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},u.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()},u.prototype.getY=function(){return this.normalize(),this.y.fromRed()},u.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},u.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),0===this.x.cmp(t))return!0}},u.prototype.toP=u.prototype.normalize,u.prototype.mixedAdd=u.prototype.add},function(e,t,i){"use strict";t.sha1=i(230),t.sha224=i(231),t.sha256=i(127),t.sha384=i(232),t.sha512=i(128)},function(e,t,i){"use strict";var n=i(16),r=i(44),o=i(126),s=n.rotl32,a=n.sum32,c=n.sum32_5,u=o.ft_1,d=r.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;d.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}n.inherits(h,d),e.exports=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(e,t){for(var i=this.W,n=0;n<16;n++)i[n]=e[t+n];for(;n<i.length;n++)i[n]=s(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var r=this.h[0],o=this.h[1],d=this.h[2],h=this.h[3],f=this.h[4];for(n=0;n<i.length;n++){var p=~~(n/20),m=c(s(r,5),u(p,o,d,h),f,i[n],l[p]);f=h,h=d,d=s(o,30),o=r,r=m}this.h[0]=a(this.h[0],r),this.h[1]=a(this.h[1],o),this.h[2]=a(this.h[2],d),this.h[3]=a(this.h[3],h),this.h[4]=a(this.h[4],f)},h.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},function(e,t,i){"use strict";var n=i(16),r=i(127);function o(){if(!(this instanceof o))return new o;r.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}n.inherits(o,r),e.exports=o,o.blockSize=512,o.outSize=224,o.hmacStrength=192,o.padLength=64,o.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")}},function(e,t,i){"use strict";var n=i(16),r=i(128);function o(){if(!(this instanceof o))return new o;r.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}n.inherits(o,r),e.exports=o,o.blockSize=1024,o.outSize=384,o.hmacStrength=192,o.padLength=128,o.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")}},function(e,t,i){"use strict";var n=i(16),r=i(44),o=n.rotl32,s=n.sum32,a=n.sum32_3,c=n.sum32_4,u=r.BlockHash;function d(){if(!(this instanceof d))return new d;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function l(e,t,i,n){return e<=15?t^i^n:e<=31?t&i|~t&n:e<=47?(t|~i)^n:e<=63?t&n|i&~n:t^(i|~n)}function h(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function f(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}n.inherits(d,u),t.ripemd160=d,d.blockSize=512,d.outSize=160,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(e,t){for(var i=this.h[0],n=this.h[1],r=this.h[2],u=this.h[3],d=this.h[4],v=i,E=n,b=r,y=u,w=d,S=0;S<80;S++){var T=s(o(c(i,l(S,n,r,u),e[p[S]+t],h(S)),_[S]),d);i=d,d=u,u=o(r,10),r=n,n=T,T=s(o(c(v,l(79-S,E,b,y),e[m[S]+t],f(S)),g[S]),w),v=w,w=y,y=o(b,10),b=E,E=T}T=a(this.h[1],r,y),this.h[1]=a(this.h[2],u,w),this.h[2]=a(this.h[3],d,v),this.h[3]=a(this.h[4],i,E),this.h[4]=a(this.h[0],n,b),this.h[0]=T},d.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"little"):n.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],m=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],_=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},function(e,t,i){"use strict";var n=i(16),r=i(11);function o(e,t,i){if(!(this instanceof o))return new o(e,t,i);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(t,i))}e.exports=o,o.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),r(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},o.prototype.update=function(e,t){return this.inner.update(e,t),this},o.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},function(e,t){e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},function(e,t,i){"use strict";var n=i(20),r=i(237),o=i(12),s=i(78),a=i(73),c=o.assert,u=i(238),d=i(239);function l(e){if(!(this instanceof l))return new l(e);"string"===typeof e&&(c(Object.prototype.hasOwnProperty.call(s,e),"Unknown curve "+e),e=s[e]),e instanceof s.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=l,l.prototype.keyPair=function(e){return new u(this,e)},l.prototype.keyFromPrivate=function(e,t){return u.fromPrivate(this,e,t)},l.prototype.keyFromPublic=function(e,t){return u.fromPublic(this,e,t)},l.prototype.genKeyPair=function(e){e||(e={});for(var t=new r({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||a(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),o=this.n.sub(new n(2));;){var s=new n(t.generate(i));if(!(s.cmp(o)>0))return s.iaddn(1),this.keyFromPrivate(s)}},l.prototype._truncateToN=function(e,t){var i=8*e.byteLength()-this.n.bitLength();return i>0&&(e=e.ushrn(i)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},l.prototype.sign=function(e,t,i,o){"object"===typeof i&&(o=i,i=null),o||(o={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new n(e,16));for(var s=this.n.byteLength(),a=t.getPrivate().toArray("be",s),c=e.toArray("be",s),u=new r({hash:this.hash,entropy:a,nonce:c,pers:o.pers,persEnc:o.persEnc||"utf8"}),l=this.n.sub(new n(1)),h=0;;h++){var f=o.k?o.k(h):new n(u.generate(this.n.byteLength()));if(!((f=this._truncateToN(f,!0)).cmpn(1)<=0||f.cmp(l)>=0)){var p=this.g.mul(f);if(!p.isInfinity()){var m=p.getX(),_=m.umod(this.n);if(0!==_.cmpn(0)){var g=f.invm(this.n).mul(_.mul(t.getPrivate()).iadd(e));if(0!==(g=g.umod(this.n)).cmpn(0)){var v=(p.getY().isOdd()?1:0)|(0!==m.cmp(_)?2:0);return o.canonical&&g.cmp(this.nh)>0&&(g=this.n.sub(g),v^=1),new d({r:_,s:g,recoveryParam:v})}}}}}},l.prototype.verify=function(e,t,i,r){e=this._truncateToN(new n(e,16)),i=this.keyFromPublic(i,r);var o=(t=new d(t,"hex")).r,s=t.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var a,c=s.invm(this.n),u=c.mul(e).umod(this.n),l=c.mul(o).umod(this.n);return this.curve._maxwellTrick?!(a=this.g.jmulAdd(u,i.getPublic(),l)).isInfinity()&&a.eqXToP(o):!(a=this.g.mulAdd(u,i.getPublic(),l)).isInfinity()&&0===a.getX().umod(this.n).cmp(o)},l.prototype.recoverPubKey=function(e,t,i,r){c((3&i)===i,"The recovery param is more than two bits"),t=new d(t,r);var o=this.n,s=new n(e),a=t.r,u=t.s,l=1&i,h=i>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&h)throw new Error("Unable to find sencond key candinate");a=h?this.curve.pointFromX(a.add(this.curve.n),l):this.curve.pointFromX(a,l);var f=t.r.invm(o),p=o.sub(s).mul(f).umod(o),m=u.mul(f).umod(o);return this.g.mulAdd(p,a,m)},l.prototype.getKeyRecoveryParam=function(e,t,i,n){if(null!==(t=new d(t,n)).recoveryParam)return t.recoveryParam;for(var r=0;r<4;r++){var o;try{o=this.recoverPubKey(e,t,r)}catch(e){continue}if(o.eq(i))return r}throw new Error("Unable to find valid recovery factor")}},function(e,t,i){"use strict";var n=i(79),r=i(124),o=i(11);function s(e){if(!(this instanceof s))return new s(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=r.toArray(e.entropy,e.entropyEnc||"hex"),i=r.toArray(e.nonce,e.nonceEnc||"hex"),n=r.toArray(e.pers,e.persEnc||"hex");o(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,i,n)}e.exports=s,s.prototype._init=function(e,t,i){var n=e.concat(t).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var r=0;r<this.V.length;r++)this.K[r]=0,this.V[r]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},s.prototype._hmac=function(){return new n.hmac(this.hash,this.K)},s.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},s.prototype.reseed=function(e,t,i,n){"string"!==typeof t&&(n=i,i=t,t=null),e=r.toArray(e,t),i=r.toArray(i,n),o(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(i||[])),this._reseed=1},s.prototype.generate=function(e,t,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!==typeof t&&(n=i,i=t,t=null),i&&(i=r.toArray(i,n||"hex"),this._update(i));for(var o=[];o.length<e;)this.V=this._hmac().update(this.V).digest(),o=o.concat(this.V);var s=o.slice(0,e);return this._update(i),this._reseed++,r.encode(s,t)}},function(e,t,i){"use strict";var n=i(20),r=i(12).assert;function o(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=o,o.fromPublic=function(e,t,i){return t instanceof o?t:new o(e,{pub:t,pubEnc:i})},o.fromPrivate=function(e,t,i){return t instanceof o?t:new o(e,{priv:t,privEnc:i})},o.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},o.prototype.getPublic=function(e,t){return"string"===typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},o.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},o.prototype._importPrivate=function(e,t){this.priv=new n(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},o.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?r(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||r(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},o.prototype.derive=function(e){return e.validate()||r(e.validate(),"public point not validated"),e.mul(this.priv).getX()},o.prototype.sign=function(e,t,i){return this.ec.sign(e,this,t,i)},o.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},o.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},function(e,t,i){"use strict";var n=i(20),r=i(12),o=r.assert;function s(e,t){if(e instanceof s)return e;this._importDER(e,t)||(o(e.r&&e.s,"Signature without r or s"),this.r=new n(e.r,16),this.s=new n(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function a(){this.place=0}function c(e,t){var i=e[t.place++];if(!(128&i))return i;var n=15&i;if(0===n||n>4)return!1;for(var r=0,o=0,s=t.place;o<n;o++,s++)r<<=8,r|=e[s],r>>>=0;return!(r<=127)&&(t.place=s,r)}function u(e){for(var t=0,i=e.length-1;!e[t]&&!(128&e[t+1])&&t<i;)t++;return 0===t?e:e.slice(t)}function d(e,t){if(t<128)e.push(t);else{var i=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|i);--i;)e.push(t>>>(i<<3)&255);e.push(t)}}e.exports=s,s.prototype._importDER=function(e,t){e=r.toArray(e,t);var i=new a;if(48!==e[i.place++])return!1;var o=c(e,i);if(!1===o)return!1;if(o+i.place!==e.length)return!1;if(2!==e[i.place++])return!1;var s=c(e,i);if(!1===s)return!1;var u=e.slice(i.place,s+i.place);if(i.place+=s,2!==e[i.place++])return!1;var d=c(e,i);if(!1===d)return!1;if(e.length!==d+i.place)return!1;var l=e.slice(i.place,d+i.place);if(0===u[0]){if(!(128&u[1]))return!1;u=u.slice(1)}if(0===l[0]){if(!(128&l[1]))return!1;l=l.slice(1)}return this.r=new n(u),this.s=new n(l),this.recoveryParam=null,!0},s.prototype.toDER=function(e){var t=this.r.toArray(),i=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&i[0]&&(i=[0].concat(i)),t=u(t),i=u(i);!i[0]&&!(128&i[1]);)i=i.slice(1);var n=[2];d(n,t.length),(n=n.concat(t)).push(2),d(n,i.length);var o=n.concat(i),s=[48];return d(s,o.length),s=s.concat(o),r.encode(s,e)}},function(e,t,i){"use strict";var n=i(79),r=i(78),o=i(12),s=o.assert,a=o.parseBytes,c=i(241),u=i(242);function d(e){if(s("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof d))return new d(e);e=r[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=n.sha512}e.exports=d,d.prototype.sign=function(e,t){e=a(e);var i=this.keyFromSecret(t),n=this.hashInt(i.messagePrefix(),e),r=this.g.mul(n),o=this.encodePoint(r),s=this.hashInt(o,i.pubBytes(),e).mul(i.priv()),c=n.add(s).umod(this.curve.n);return this.makeSignature({R:r,S:c,Rencoded:o})},d.prototype.verify=function(e,t,i){e=a(e),t=this.makeSignature(t);var n=this.keyFromPublic(i),r=this.hashInt(t.Rencoded(),n.pubBytes(),e),o=this.g.mul(t.S());return t.R().add(n.pub().mul(r)).eq(o)},d.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return o.intFromLE(e.digest()).umod(this.curve.n)},d.prototype.keyFromPublic=function(e){return c.fromPublic(this,e)},d.prototype.keyFromSecret=function(e){return c.fromSecret(this,e)},d.prototype.makeSignature=function(e){return e instanceof u?e:new u(this,e)},d.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},d.prototype.decodePoint=function(e){var t=(e=o.parseBytes(e)).length-1,i=e.slice(0,t).concat(-129&e[t]),n=0!==(128&e[t]),r=o.intFromLE(i);return this.curve.pointFromY(r,n)},d.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},d.prototype.decodeInt=function(e){return o.intFromLE(e)},d.prototype.isPoint=function(e){return e instanceof this.pointClass}},function(e,t,i){"use strict";var n=i(12),r=n.assert,o=n.parseBytes,s=n.cachedProperty;function a(e,t){this.eddsa=e,this._secret=o(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=o(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret},s(a,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),s(a,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),s(a,"privBytes",(function(){var e=this.eddsa,t=this.hash(),i=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n})),s(a,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),s(a,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),s(a,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),a.prototype.sign=function(e){return r(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},a.prototype.getSecret=function(e){return r(this._secret,"KeyPair is public only"),n.encode(this.secret(),e)},a.prototype.getPublic=function(e){return n.encode(this.pubBytes(),e)},e.exports=a},function(e,t,i){"use strict";var n=i(20),r=i(12),o=r.assert,s=r.cachedProperty,a=r.parseBytes;function c(e,t){this.eddsa=e,"object"!==typeof t&&(t=a(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),o(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof n&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}s(c,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),s(c,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),s(c,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),s(c,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return r.encode(this.toBytes(),"hex").toUpperCase()},e.exports=c},function(e,t,i){"use strict";var n=i(129);t.certificate=i(250);var r=n.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));t.RSAPrivateKey=r;var o=n.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));t.RSAPublicKey=o;var s=n.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())}));t.PublicKey=s;var a=n.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),c=n.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(a),this.key("subjectPrivateKey").octstr())}));t.PrivateKey=c;var u=n.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));t.EncryptedPrivateKey=u;var d=n.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));t.DSAPrivateKey=d,t.DSAparam=n.define("DSAparam",(function(){this.int()}));var l=n.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(h),this.key("publicKey").optional().explicit(1).bitstr())}));t.ECPrivateKey=l;var h=n.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));t.signature=n.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},,function(e,t,i){"use strict";const n=i(131),r=i(133),o=i(2);function s(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}t.define=function(e,t){return new s(e,t)},s.prototype._createNamed=function(e){const t=this.name;function i(e){this._initNamed(e,t)}return o(i,e),i.prototype._initNamed=function(t,i){e.call(this,t,i)},new i(this)},s.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(r[e])),this.decoders[e]},s.prototype.decode=function(e,t,i){return this._getDecoder(t).decode(e,i)},s.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(n[e])),this.encoders[e]},s.prototype.encode=function(e,t,i){return this._getEncoder(t).encode(e,i)}},function(e,t,i){"use strict";const n=i(2),r=i(132);function o(e){r.call(this,e),this.enc="pem"}n(o,r),e.exports=o,o.prototype.encode=function(e,t){const i=r.prototype.encode.call(this,e).toString("base64"),n=["-----BEGIN "+t.label+"-----"];for(let r=0;r<i.length;r+=64)n.push(i.slice(r,r+64));return n.push("-----END "+t.label+"-----"),n.join("\n")}},function(e,t,i){"use strict";const n=i(2),r=i(80).Buffer,o=i(134);function s(e){o.call(this,e),this.enc="pem"}n(s,o),e.exports=s,s.prototype.decode=function(e,t){const i=e.toString().split(/[\r\n]+/g),n=t.label.toUpperCase(),s=/^-----(BEGIN|END) ([^-]+)-----$/;let a=-1,c=-1;for(let r=0;r<i.length;r++){const e=i[r].match(s);if(null!==e&&e[2]===n){if(-1!==a){if("END"!==e[1])break;c=r;break}if("BEGIN"!==e[1])break;a=r}}if(-1===a||-1===c)throw new Error("PEM section not found for: "+n);const u=i.slice(a+1,c).join("");u.replace(/[^a-z0-9+/=]+/gi,"");const d=r.from(u,"base64");return o.prototype.decode.call(this,d,t)}},function(e,t,i){"use strict";const n=t;n.Reporter=i(82).Reporter,n.DecoderBuffer=i(45).DecoderBuffer,n.EncoderBuffer=i(45).EncoderBuffer,n.Node=i(81)},function(e,t,i){"use strict";const n=t;n._reverse=function(e){const t={};return Object.keys(e).forEach((function(i){(0|i)==i&&(i|=0);const n=e[i];t[n]=i})),t},n.der=i(83)},function(e,t,i){"use strict";var n=i(129),r=n.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),o=n.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),s=n.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),a=n.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(s),this.key("subjectPublicKey").bitstr())})),c=n.define("RelativeDistinguishedName",(function(){this.setof(o)})),u=n.define("RDNSequence",(function(){this.seqof(c)})),d=n.define("Name",(function(){this.choice({rdnSequence:this.use(u)})})),l=n.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(r),this.key("notAfter").use(r))})),h=n.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),f=n.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(s),this.key("issuer").use(d),this.key("validity").use(l),this.key("subject").use(d),this.key("subjectPublicKeyInfo").use(a),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(h).optional())})),p=n.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(f),this.key("signatureAlgorithm").use(s),this.key("signatureValue").bitstr())}));e.exports=p},function(e){e.exports=JSON.parse('{"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}')},function(e,t,i){var n=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,r=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,o=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,s=i(54),a=i(71),c=i(3).Buffer;e.exports=function(e,t){var i,u=e.toString(),d=u.match(n);if(d){var l="aes"+d[1],h=c.from(d[2],"hex"),f=c.from(d[3].replace(/[\r\n]/g,""),"base64"),p=s(t,h.slice(0,8),parseInt(d[1],10)).key,m=[],_=a.createDecipheriv(l,p,h);m.push(_.update(f)),m.push(_.final()),i=c.concat(m)}else{var g=u.match(o);i=c.from(g[2].replace(/[\r\n]/g,""),"base64")}return{tag:u.match(r)[1],data:i}}},function(e,t,i){"use strict";var n=i(3).Buffer,r=i(76),o=i(77).ec,s=i(56),a=i(135);function c(e,t){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(t)>=0)throw new Error("invalid sig")}e.exports=function(e,t,i,u,d){var l=s(i);if("ec"===l.type){if("ecdsa"!==u&&"ecdsa/rsa"!==u)throw new Error("wrong public key type");return function(e,t,i){var n=a[i.data.algorithm.curve.join(".")];if(!n)throw new Error("unknown curve "+i.data.algorithm.curve.join("."));var r=new o(n),s=i.data.subjectPrivateKey.data;return r.verify(t,e,s)}(e,t,l)}if("dsa"===l.type){if("dsa"!==u)throw new Error("wrong public key type");return function(e,t,i){var n=i.data.p,o=i.data.q,a=i.data.g,u=i.data.pub_key,d=s.signature.decode(e,"der"),l=d.s,h=d.r;c(l,o),c(h,o);var f=r.mont(n),p=l.invm(o),m=a.toRed(f).redPow(new r(t).mul(p).mod(o)).fromRed().mul(u.toRed(f).redPow(h.mul(p).mod(o)).fromRed()).mod(n).mod(o);return 0===m.cmp(h)}(e,t,l)}if("rsa"!==u&&"ecdsa/rsa"!==u)throw new Error("wrong public key type");t=n.concat([d,t]);for(var h=l.modulus.byteLength(),f=[1],p=0;t.length+f.length+2<h;)f.push(255),p+=1;f.push(0);for(var m=-1;++m<t.length;)f.push(t[m]);f=n.from(f);var _=r.mont(l.modulus);e=(e=new r(e).toRed(_)).redPow(new r(l.publicExponent)),e=n.from(e.fromRed().toArray());var g=p<8?1:0;for(h=Math.min(e.length,f.length),e.length!==f.length&&(g=1),m=-1;++m<h;)g|=e[m]^f[m];return 0===g}},function(e,t,i){(function(t){var n=i(77),r=i(255);e.exports=function(e){return new s(e)};var o={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function s(e){this.curveType=o[e],this.curveType||(this.curveType={name:e}),this.curve=new n.ec(this.curveType.name),this.keys=void 0}function a(e,i,n){Array.isArray(e)||(e=e.toArray());var r=new t(e);if(n&&r.length<n){var o=new t(n-r.length);o.fill(0),r=t.concat([o,r])}return i?r.toString(i):r}o.p224=o.secp224r1,o.p256=o.secp256r1=o.prime256v1,o.p192=o.secp192r1=o.prime192v1,o.p384=o.secp384r1,o.p521=o.secp521r1,s.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},s.prototype.computeSecret=function(e,i,n){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),a(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),n,this.curveType.byteLength)},s.prototype.getPublicKey=function(e,t){var i=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(i[i.length-1]%2?i[0]=7:i[0]=6),a(i,e)},s.prototype.getPrivateKey=function(e){return a(this.keys.getPrivate(),e)},s.prototype.setPublicKey=function(e,i){return i=i||"utf8",t.isBuffer(e)||(e=new t(e,i)),this.keys._importPublic(e),this},s.prototype.setPrivateKey=function(e,i){i=i||"utf8",t.isBuffer(e)||(e=new t(e,i));var n=new r(e);return n=n.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(n),this}}).call(this,i(7).Buffer)},function(e,t,i){(function(e){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}function o(e,t,i){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(i=t,t=10),this._init(e||0,t||10,i||"be"))}var s;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{s="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:i(256).Buffer}catch(R){}function a(e,t){var i=e.charCodeAt(t);return i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:i-48&15}function c(e,t,i){var n=a(e,i);return i-1>=t&&(n|=a(e,i-1)<<4),n}function u(e,t,i,n){for(var r=0,o=Math.min(e.length,i),s=t;s<o;s++){var a=e.charCodeAt(s)-48;r*=n,r+=a>=49?a-49+10:a>=17?a-17+10:a}return r}o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,i){if("number"===typeof e)return this._initNumber(e,t,i);if("object"===typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var r=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(r++,this.negative=1),r<e.length&&(16===t?this._parseHex(e,r,i):(this._parseBase(e,t,r),"le"===i&&this._initArray(this.toArray(),t,i)))},o.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},o.prototype._initArray=function(e,t,i){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var o,s,a=0;if("be"===i)for(r=e.length-1,o=0;r>=0;r-=3)s=e[r]|e[r-1]<<8|e[r-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===i)for(r=0,o=0;r<e.length;r+=3)s=e[r]|e[r+1]<<8|e[r+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},o.prototype._parseHex=function(e,t,i){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var r,o=0,s=0;if("be"===i)for(n=e.length-1;n>=t;n-=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)r=c(e,t,n)<<o,this.words[s]|=67108863&r,o>=18?(o-=18,s+=1,this.words[s]|=r>>>26):o+=8;this.strip()},o.prototype._parseBase=function(e,t,i){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=t)n++;n--,r=r/t|0;for(var o=e.length-i,s=o%n,a=Math.min(o,o-s)+i,c=0,d=i;d<a;d+=n)c=u(e,d,d+n,t),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var l=1;for(c=u(e,d,e.length,t),d=0;d<s;d++)l*=t;this.imuln(l),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this.strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},o.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(e,t,i){i.negative=t.negative^e.negative;var n=e.length+t.length|0;i.length=n,n=n-1|0;var r=0|e.words[0],o=0|t.words[0],s=r*o,a=67108863&s,c=s/67108864|0;i.words[0]=a;for(var u=1;u<n;u++){for(var d=c>>>26,l=67108863&c,h=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=h;f++){var p=u-f|0;d+=(s=(r=0|e.words[p])*(o=0|t.words[f])+l)/67108864|0,l=67108863&s}i.words[u]=0|l,c=0|d}return 0!==c?i.words[u]=0|c:i.length--,i.strip()}o.prototype.toString=function(e,t){var i;if(t=0|t||1,16===(e=e||10)||"hex"===e){i="";for(var r=0,o=0,s=0;s<this.length;s++){var a=this.words[s],c=(16777215&(a<<r|o)).toString(16);i=0!==(o=a>>>24-r&16777215)||s!==this.length-1?d[6-c.length]+c+i:c+i,(r+=2)>=26&&(r-=26,s--)}for(0!==o&&(i=o.toString(16)+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var u=l[e],f=h[e];i="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(f).toString(e);i=(p=p.idivn(f)).isZero()?m+i:d[u-m.length]+m+i}for(this.isZero()&&(i="0"+i);i.length%t!==0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16)},o.prototype.toBuffer=function(e,t){return n("undefined"!==typeof s),this.toArrayLike(s,e,t)},o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},o.prototype.toArrayLike=function(e,t,i){var r=this.byteLength(),o=i||Math.max(1,r);n(r<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,c="le"===t,u=new e(o),d=this.clone();if(c){for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[a]=s;for(;a<o;a++)u[a]=0}else{for(a=0;a<o-r;a++)u[a]=0;for(a=0;!d.isZero();a++)s=d.andln(255),d.iushrn(8),u[o-a-1]=s}return u},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,i=0;return t>=4096&&(i+=13,t>>>=13),t>=64&&(i+=7,t>>>=7),t>=8&&(i+=4,t>>>=4),t>=2&&(i+=2,t>>>=2),i+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,i=0;return 0===(8191&t)&&(i+=13,t>>>=13),0===(127&t)&&(i+=7,t>>>=7),0===(15&t)&&(i+=4,t>>>=4),0===(3&t)&&(i+=2,t>>>=2),0===(1&t)&&i++,i},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var i=this._zeroBits(this.words[t]);if(e+=i,26!==i)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var i=0;i<t.length;i++)this.words[i]=this.words[i]&e.words[i];return this.length=t.length,this.strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,i;this.length>e.length?(t=this,i=e):(t=e,i=this);for(var n=0;n<i.length;n++)this.words[n]=t.words[n]^i.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var r=0;r<t;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this.strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var i=e/26|0,r=e%26;return this._expand(i+1),this.words[i]=t?this.words[i]|1<<r:this.words[i]&~(1<<r),this.strip()},o.prototype.iadd=function(e){var t,i,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(i=this,n=e):(i=e,n=this);for(var r=0,o=0;o<n.length;o++)t=(0|i.words[o])+(0|n.words[o])+r,this.words[o]=67108863&t,r=t>>>26;for(;0!==r&&o<i.length;o++)t=(0|i.words[o])+r,this.words[o]=67108863&t,r=t>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;o<i.length;o++)this.words[o]=i.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var i,n,r=this.cmp(e);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(i=this,n=e):(i=e,n=this);for(var o=0,s=0;s<n.length;s++)o=(t=(0|i.words[s])-(0|n.words[s])+o)>>26,this.words[s]=67108863&t;for(;0!==o&&s<i.length;s++)o=(t=(0|i.words[s])+o)>>26,this.words[s]=67108863&t;if(0===o&&s<i.length&&i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this.length=Math.max(this.length,s),i!==this&&(this.negative=1),this.strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,i){var n,r,o,s=e.words,a=t.words,c=i.words,u=0,d=0|s[0],l=8191&d,h=d>>>13,f=0|s[1],p=8191&f,m=f>>>13,_=0|s[2],g=8191&_,v=_>>>13,E=0|s[3],b=8191&E,y=E>>>13,w=0|s[4],S=8191&w,T=w>>>13,R=0|s[5],C=8191&R,I=R>>>13,A=0|s[6],O=8191&A,M=A>>>13,N=0|s[7],k=8191&N,P=N>>>13,D=0|s[8],L=8191&D,x=D>>>13,U=0|s[9],V=8191&U,B=U>>>13,j=0|a[0],F=8191&j,W=j>>>13,G=0|a[1],H=8191&G,q=G>>>13,K=0|a[2],z=8191&K,Y=K>>>13,J=0|a[3],X=8191&J,Q=J>>>13,Z=0|a[4],$=8191&Z,ee=Z>>>13,te=0|a[5],ie=8191&te,ne=te>>>13,re=0|a[6],oe=8191&re,se=re>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,de=0|a[8],le=8191&de,he=de>>>13,fe=0|a[9],pe=8191&fe,me=fe>>>13;i.negative=e.negative^t.negative,i.length=19;var _e=(u+(n=Math.imul(l,F))|0)+((8191&(r=(r=Math.imul(l,W))+Math.imul(h,F)|0))<<13)|0;u=((o=Math.imul(h,W))+(r>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(p,F),r=(r=Math.imul(p,W))+Math.imul(m,F)|0,o=Math.imul(m,W);var ge=(u+(n=n+Math.imul(l,H)|0)|0)+((8191&(r=(r=r+Math.imul(l,q)|0)+Math.imul(h,H)|0))<<13)|0;u=((o=o+Math.imul(h,q)|0)+(r>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,F),r=(r=Math.imul(g,W))+Math.imul(v,F)|0,o=Math.imul(v,W),n=n+Math.imul(p,H)|0,r=(r=r+Math.imul(p,q)|0)+Math.imul(m,H)|0,o=o+Math.imul(m,q)|0;var ve=(u+(n=n+Math.imul(l,z)|0)|0)+((8191&(r=(r=r+Math.imul(l,Y)|0)+Math.imul(h,z)|0))<<13)|0;u=((o=o+Math.imul(h,Y)|0)+(r>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,F),r=(r=Math.imul(b,W))+Math.imul(y,F)|0,o=Math.imul(y,W),n=n+Math.imul(g,H)|0,r=(r=r+Math.imul(g,q)|0)+Math.imul(v,H)|0,o=o+Math.imul(v,q)|0,n=n+Math.imul(p,z)|0,r=(r=r+Math.imul(p,Y)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,Y)|0;var Ee=(u+(n=n+Math.imul(l,X)|0)|0)+((8191&(r=(r=r+Math.imul(l,Q)|0)+Math.imul(h,X)|0))<<13)|0;u=((o=o+Math.imul(h,Q)|0)+(r>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(S,F),r=(r=Math.imul(S,W))+Math.imul(T,F)|0,o=Math.imul(T,W),n=n+Math.imul(b,H)|0,r=(r=r+Math.imul(b,q)|0)+Math.imul(y,H)|0,o=o+Math.imul(y,q)|0,n=n+Math.imul(g,z)|0,r=(r=r+Math.imul(g,Y)|0)+Math.imul(v,z)|0,o=o+Math.imul(v,Y)|0,n=n+Math.imul(p,X)|0,r=(r=r+Math.imul(p,Q)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,Q)|0;var be=(u+(n=n+Math.imul(l,$)|0)|0)+((8191&(r=(r=r+Math.imul(l,ee)|0)+Math.imul(h,$)|0))<<13)|0;u=((o=o+Math.imul(h,ee)|0)+(r>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(C,F),r=(r=Math.imul(C,W))+Math.imul(I,F)|0,o=Math.imul(I,W),n=n+Math.imul(S,H)|0,r=(r=r+Math.imul(S,q)|0)+Math.imul(T,H)|0,o=o+Math.imul(T,q)|0,n=n+Math.imul(b,z)|0,r=(r=r+Math.imul(b,Y)|0)+Math.imul(y,z)|0,o=o+Math.imul(y,Y)|0,n=n+Math.imul(g,X)|0,r=(r=r+Math.imul(g,Q)|0)+Math.imul(v,X)|0,o=o+Math.imul(v,Q)|0,n=n+Math.imul(p,$)|0,r=(r=r+Math.imul(p,ee)|0)+Math.imul(m,$)|0,o=o+Math.imul(m,ee)|0;var ye=(u+(n=n+Math.imul(l,ie)|0)|0)+((8191&(r=(r=r+Math.imul(l,ne)|0)+Math.imul(h,ie)|0))<<13)|0;u=((o=o+Math.imul(h,ne)|0)+(r>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(O,F),r=(r=Math.imul(O,W))+Math.imul(M,F)|0,o=Math.imul(M,W),n=n+Math.imul(C,H)|0,r=(r=r+Math.imul(C,q)|0)+Math.imul(I,H)|0,o=o+Math.imul(I,q)|0,n=n+Math.imul(S,z)|0,r=(r=r+Math.imul(S,Y)|0)+Math.imul(T,z)|0,o=o+Math.imul(T,Y)|0,n=n+Math.imul(b,X)|0,r=(r=r+Math.imul(b,Q)|0)+Math.imul(y,X)|0,o=o+Math.imul(y,Q)|0,n=n+Math.imul(g,$)|0,r=(r=r+Math.imul(g,ee)|0)+Math.imul(v,$)|0,o=o+Math.imul(v,ee)|0,n=n+Math.imul(p,ie)|0,r=(r=r+Math.imul(p,ne)|0)+Math.imul(m,ie)|0,o=o+Math.imul(m,ne)|0;var we=(u+(n=n+Math.imul(l,oe)|0)|0)+((8191&(r=(r=r+Math.imul(l,se)|0)+Math.imul(h,oe)|0))<<13)|0;u=((o=o+Math.imul(h,se)|0)+(r>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,F),r=(r=Math.imul(k,W))+Math.imul(P,F)|0,o=Math.imul(P,W),n=n+Math.imul(O,H)|0,r=(r=r+Math.imul(O,q)|0)+Math.imul(M,H)|0,o=o+Math.imul(M,q)|0,n=n+Math.imul(C,z)|0,r=(r=r+Math.imul(C,Y)|0)+Math.imul(I,z)|0,o=o+Math.imul(I,Y)|0,n=n+Math.imul(S,X)|0,r=(r=r+Math.imul(S,Q)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,Q)|0,n=n+Math.imul(b,$)|0,r=(r=r+Math.imul(b,ee)|0)+Math.imul(y,$)|0,o=o+Math.imul(y,ee)|0,n=n+Math.imul(g,ie)|0,r=(r=r+Math.imul(g,ne)|0)+Math.imul(v,ie)|0,o=o+Math.imul(v,ne)|0,n=n+Math.imul(p,oe)|0,r=(r=r+Math.imul(p,se)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,se)|0;var Se=(u+(n=n+Math.imul(l,ce)|0)|0)+((8191&(r=(r=r+Math.imul(l,ue)|0)+Math.imul(h,ce)|0))<<13)|0;u=((o=o+Math.imul(h,ue)|0)+(r>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(L,F),r=(r=Math.imul(L,W))+Math.imul(x,F)|0,o=Math.imul(x,W),n=n+Math.imul(k,H)|0,r=(r=r+Math.imul(k,q)|0)+Math.imul(P,H)|0,o=o+Math.imul(P,q)|0,n=n+Math.imul(O,z)|0,r=(r=r+Math.imul(O,Y)|0)+Math.imul(M,z)|0,o=o+Math.imul(M,Y)|0,n=n+Math.imul(C,X)|0,r=(r=r+Math.imul(C,Q)|0)+Math.imul(I,X)|0,o=o+Math.imul(I,Q)|0,n=n+Math.imul(S,$)|0,r=(r=r+Math.imul(S,ee)|0)+Math.imul(T,$)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(b,ie)|0,r=(r=r+Math.imul(b,ne)|0)+Math.imul(y,ie)|0,o=o+Math.imul(y,ne)|0,n=n+Math.imul(g,oe)|0,r=(r=r+Math.imul(g,se)|0)+Math.imul(v,oe)|0,o=o+Math.imul(v,se)|0,n=n+Math.imul(p,ce)|0,r=(r=r+Math.imul(p,ue)|0)+Math.imul(m,ce)|0,o=o+Math.imul(m,ue)|0;var Te=(u+(n=n+Math.imul(l,le)|0)|0)+((8191&(r=(r=r+Math.imul(l,he)|0)+Math.imul(h,le)|0))<<13)|0;u=((o=o+Math.imul(h,he)|0)+(r>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(V,F),r=(r=Math.imul(V,W))+Math.imul(B,F)|0,o=Math.imul(B,W),n=n+Math.imul(L,H)|0,r=(r=r+Math.imul(L,q)|0)+Math.imul(x,H)|0,o=o+Math.imul(x,q)|0,n=n+Math.imul(k,z)|0,r=(r=r+Math.imul(k,Y)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,Y)|0,n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,Q)|0)+Math.imul(M,X)|0,o=o+Math.imul(M,Q)|0,n=n+Math.imul(C,$)|0,r=(r=r+Math.imul(C,ee)|0)+Math.imul(I,$)|0,o=o+Math.imul(I,ee)|0,n=n+Math.imul(S,ie)|0,r=(r=r+Math.imul(S,ne)|0)+Math.imul(T,ie)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(b,oe)|0,r=(r=r+Math.imul(b,se)|0)+Math.imul(y,oe)|0,o=o+Math.imul(y,se)|0,n=n+Math.imul(g,ce)|0,r=(r=r+Math.imul(g,ue)|0)+Math.imul(v,ce)|0,o=o+Math.imul(v,ue)|0,n=n+Math.imul(p,le)|0,r=(r=r+Math.imul(p,he)|0)+Math.imul(m,le)|0,o=o+Math.imul(m,he)|0;var Re=(u+(n=n+Math.imul(l,pe)|0)|0)+((8191&(r=(r=r+Math.imul(l,me)|0)+Math.imul(h,pe)|0))<<13)|0;u=((o=o+Math.imul(h,me)|0)+(r>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(V,H),r=(r=Math.imul(V,q))+Math.imul(B,H)|0,o=Math.imul(B,q),n=n+Math.imul(L,z)|0,r=(r=r+Math.imul(L,Y)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,Y)|0,n=n+Math.imul(k,X)|0,r=(r=r+Math.imul(k,Q)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,Q)|0,n=n+Math.imul(O,$)|0,r=(r=r+Math.imul(O,ee)|0)+Math.imul(M,$)|0,o=o+Math.imul(M,ee)|0,n=n+Math.imul(C,ie)|0,r=(r=r+Math.imul(C,ne)|0)+Math.imul(I,ie)|0,o=o+Math.imul(I,ne)|0,n=n+Math.imul(S,oe)|0,r=(r=r+Math.imul(S,se)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,se)|0,n=n+Math.imul(b,ce)|0,r=(r=r+Math.imul(b,ue)|0)+Math.imul(y,ce)|0,o=o+Math.imul(y,ue)|0,n=n+Math.imul(g,le)|0,r=(r=r+Math.imul(g,he)|0)+Math.imul(v,le)|0,o=o+Math.imul(v,he)|0;var Ce=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(r=(r=r+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;u=((o=o+Math.imul(m,me)|0)+(r>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(V,z),r=(r=Math.imul(V,Y))+Math.imul(B,z)|0,o=Math.imul(B,Y),n=n+Math.imul(L,X)|0,r=(r=r+Math.imul(L,Q)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,Q)|0,n=n+Math.imul(k,$)|0,r=(r=r+Math.imul(k,ee)|0)+Math.imul(P,$)|0,o=o+Math.imul(P,ee)|0,n=n+Math.imul(O,ie)|0,r=(r=r+Math.imul(O,ne)|0)+Math.imul(M,ie)|0,o=o+Math.imul(M,ne)|0,n=n+Math.imul(C,oe)|0,r=(r=r+Math.imul(C,se)|0)+Math.imul(I,oe)|0,o=o+Math.imul(I,se)|0,n=n+Math.imul(S,ce)|0,r=(r=r+Math.imul(S,ue)|0)+Math.imul(T,ce)|0,o=o+Math.imul(T,ue)|0,n=n+Math.imul(b,le)|0,r=(r=r+Math.imul(b,he)|0)+Math.imul(y,le)|0,o=o+Math.imul(y,he)|0;var Ie=(u+(n=n+Math.imul(g,pe)|0)|0)+((8191&(r=(r=r+Math.imul(g,me)|0)+Math.imul(v,pe)|0))<<13)|0;u=((o=o+Math.imul(v,me)|0)+(r>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(V,X),r=(r=Math.imul(V,Q))+Math.imul(B,X)|0,o=Math.imul(B,Q),n=n+Math.imul(L,$)|0,r=(r=r+Math.imul(L,ee)|0)+Math.imul(x,$)|0,o=o+Math.imul(x,ee)|0,n=n+Math.imul(k,ie)|0,r=(r=r+Math.imul(k,ne)|0)+Math.imul(P,ie)|0,o=o+Math.imul(P,ne)|0,n=n+Math.imul(O,oe)|0,r=(r=r+Math.imul(O,se)|0)+Math.imul(M,oe)|0,o=o+Math.imul(M,se)|0,n=n+Math.imul(C,ce)|0,r=(r=r+Math.imul(C,ue)|0)+Math.imul(I,ce)|0,o=o+Math.imul(I,ue)|0,n=n+Math.imul(S,le)|0,r=(r=r+Math.imul(S,he)|0)+Math.imul(T,le)|0,o=o+Math.imul(T,he)|0;var Ae=(u+(n=n+Math.imul(b,pe)|0)|0)+((8191&(r=(r=r+Math.imul(b,me)|0)+Math.imul(y,pe)|0))<<13)|0;u=((o=o+Math.imul(y,me)|0)+(r>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(V,$),r=(r=Math.imul(V,ee))+Math.imul(B,$)|0,o=Math.imul(B,ee),n=n+Math.imul(L,ie)|0,r=(r=r+Math.imul(L,ne)|0)+Math.imul(x,ie)|0,o=o+Math.imul(x,ne)|0,n=n+Math.imul(k,oe)|0,r=(r=r+Math.imul(k,se)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,se)|0,n=n+Math.imul(O,ce)|0,r=(r=r+Math.imul(O,ue)|0)+Math.imul(M,ce)|0,o=o+Math.imul(M,ue)|0,n=n+Math.imul(C,le)|0,r=(r=r+Math.imul(C,he)|0)+Math.imul(I,le)|0,o=o+Math.imul(I,he)|0;var Oe=(u+(n=n+Math.imul(S,pe)|0)|0)+((8191&(r=(r=r+Math.imul(S,me)|0)+Math.imul(T,pe)|0))<<13)|0;u=((o=o+Math.imul(T,me)|0)+(r>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(V,ie),r=(r=Math.imul(V,ne))+Math.imul(B,ie)|0,o=Math.imul(B,ne),n=n+Math.imul(L,oe)|0,r=(r=r+Math.imul(L,se)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,se)|0,n=n+Math.imul(k,ce)|0,r=(r=r+Math.imul(k,ue)|0)+Math.imul(P,ce)|0,o=o+Math.imul(P,ue)|0,n=n+Math.imul(O,le)|0,r=(r=r+Math.imul(O,he)|0)+Math.imul(M,le)|0,o=o+Math.imul(M,he)|0;var Me=(u+(n=n+Math.imul(C,pe)|0)|0)+((8191&(r=(r=r+Math.imul(C,me)|0)+Math.imul(I,pe)|0))<<13)|0;u=((o=o+Math.imul(I,me)|0)+(r>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(V,oe),r=(r=Math.imul(V,se))+Math.imul(B,oe)|0,o=Math.imul(B,se),n=n+Math.imul(L,ce)|0,r=(r=r+Math.imul(L,ue)|0)+Math.imul(x,ce)|0,o=o+Math.imul(x,ue)|0,n=n+Math.imul(k,le)|0,r=(r=r+Math.imul(k,he)|0)+Math.imul(P,le)|0,o=o+Math.imul(P,he)|0;var Ne=(u+(n=n+Math.imul(O,pe)|0)|0)+((8191&(r=(r=r+Math.imul(O,me)|0)+Math.imul(M,pe)|0))<<13)|0;u=((o=o+Math.imul(M,me)|0)+(r>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(V,ce),r=(r=Math.imul(V,ue))+Math.imul(B,ce)|0,o=Math.imul(B,ue),n=n+Math.imul(L,le)|0,r=(r=r+Math.imul(L,he)|0)+Math.imul(x,le)|0,o=o+Math.imul(x,he)|0;var ke=(u+(n=n+Math.imul(k,pe)|0)|0)+((8191&(r=(r=r+Math.imul(k,me)|0)+Math.imul(P,pe)|0))<<13)|0;u=((o=o+Math.imul(P,me)|0)+(r>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(V,le),r=(r=Math.imul(V,he))+Math.imul(B,le)|0,o=Math.imul(B,he);var Pe=(u+(n=n+Math.imul(L,pe)|0)|0)+((8191&(r=(r=r+Math.imul(L,me)|0)+Math.imul(x,pe)|0))<<13)|0;u=((o=o+Math.imul(x,me)|0)+(r>>>13)|0)+(Pe>>>26)|0,Pe&=67108863;var De=(u+(n=Math.imul(V,pe))|0)+((8191&(r=(r=Math.imul(V,me))+Math.imul(B,pe)|0))<<13)|0;return u=((o=Math.imul(B,me))+(r>>>13)|0)+(De>>>26)|0,De&=67108863,c[0]=_e,c[1]=ge,c[2]=ve,c[3]=Ee,c[4]=be,c[5]=ye,c[6]=we,c[7]=Se,c[8]=Te,c[9]=Re,c[10]=Ce,c[11]=Ie,c[12]=Ae,c[13]=Oe,c[14]=Me,c[15]=Ne,c[16]=ke,c[17]=Pe,c[18]=De,0!==u&&(c[19]=u,i.length++),i};function m(e,t,i){return(new _).mulp(e,t,i)}function _(e,t){this.x=e,this.y=t}Math.imul||(p=f),o.prototype.mulTo=function(e,t){var i,n=this.length+e.length;return i=10===this.length&&10===e.length?p(this,e,t):n<63?f(this,e,t):n<1024?function(e,t,i){i.negative=t.negative^e.negative,i.length=e.length+t.length;for(var n=0,r=0,o=0;o<i.length-1;o++){var s=r;r=0;for(var a=67108863&n,c=Math.min(o,t.length-1),u=Math.max(0,o-e.length+1);u<=c;u++){var d=o-u,l=(0|e.words[d])*(0|t.words[u]),h=67108863&l;a=67108863&(h=h+a|0),r+=(s=(s=s+(l/67108864|0)|0)+(h>>>26)|0)>>>26,s&=67108863}i.words[o]=a,n=s,s=r}return 0!==n?i.words[o]=n:i.length--,i.strip()}(this,e,t):m(this,e,t),i},_.prototype.makeRBT=function(e){for(var t=new Array(e),i=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,i,e);return t},_.prototype.revBin=function(e,t,i){if(0===e||e===i-1)return e;for(var n=0,r=0;r<t;r++)n|=(1&e)<<t-r-1,e>>=1;return n},_.prototype.permute=function(e,t,i,n,r,o){for(var s=0;s<o;s++)n[s]=t[e[s]],r[s]=i[e[s]]},_.prototype.transform=function(e,t,i,n,r,o){this.permute(o,e,t,i,n,r);for(var s=1;s<r;s<<=1)for(var a=s<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),d=0;d<r;d+=a)for(var l=c,h=u,f=0;f<s;f++){var p=i[d+f],m=n[d+f],_=i[d+f+s],g=n[d+f+s],v=l*_-h*g;g=l*g+h*_,_=v,i[d+f]=p+_,n[d+f]=m+g,i[d+f+s]=p-_,n[d+f+s]=m-g,f!==a&&(v=c*l-u*h,h=c*h+u*l,l=v)}},_.prototype.guessLen13b=function(e,t){var i=1|Math.max(t,e),n=1&i,r=0;for(i=i/2|0;i;i>>>=1)r++;return 1<<r+1+n},_.prototype.conjugate=function(e,t,i){if(!(i<=1))for(var n=0;n<i/2;n++){var r=e[n];e[n]=e[i-n-1],e[i-n-1]=r,r=t[n],t[n]=-t[i-n-1],t[i-n-1]=-r}},_.prototype.normalize13b=function(e,t){for(var i=0,n=0;n<t/2;n++){var r=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+i;e[n]=67108863&r,i=r<67108864?0:r/67108864|0}return e},_.prototype.convert13b=function(e,t,i,r){for(var o=0,s=0;s<t;s++)o+=0|e[s],i[2*s]=8191&o,o>>>=13,i[2*s+1]=8191&o,o>>>=13;for(s=2*t;s<r;++s)i[s]=0;n(0===o),n(0===(-8192&o))},_.prototype.stub=function(e){for(var t=new Array(e),i=0;i<e;i++)t[i]=0;return t},_.prototype.mulp=function(e,t,i){var n=2*this.guessLen13b(e.length,t.length),r=this.makeRBT(n),o=this.stub(n),s=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),d=new Array(n),l=new Array(n),h=i.words;h.length=n,this.convert13b(e.words,e.length,s,n),this.convert13b(t.words,t.length,u,n),this.transform(s,o,a,c,n,r),this.transform(u,o,d,l,n,r);for(var f=0;f<n;f++){var p=a[f]*d[f]-c[f]*l[f];c[f]=a[f]*l[f]+c[f]*d[f],a[f]=p}return this.conjugate(a,c,n),this.transform(a,c,h,o,n,r),this.conjugate(h,o,n),this.normalize13b(h,n),i.negative=e.negative^t.negative,i.length=e.length+t.length,i.strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),m(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){n("number"===typeof e),n(e<67108864);for(var t=0,i=0;i<this.length;i++){var r=(0|this.words[i])*e,o=(67108863&r)+(67108863&t);t>>=26,t+=r/67108864|0,t+=o>>>26,this.words[i]=67108863&o}return 0!==t&&(this.words[i]=t,this.length++),this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),i=0;i<t.length;i++){var n=i/26|0,r=i%26;t[i]=(e.words[n]&1<<r)>>>r}return t}(e);if(0===t.length)return new o(1);for(var i=this,n=0;n<t.length&&0===t[n];n++,i=i.sqr());if(++n<t.length)for(var r=i.sqr();n<t.length;n++,r=r.sqr())0!==t[n]&&(i=i.mul(r));return i},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,i=e%26,r=(e-i)/26,o=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(t=0;t<this.length;t++){var a=this.words[t]&o,c=(0|this.words[t])-a<<i;this.words[t]=c|s,s=a>>>26-i}s&&(this.words[t]=s,this.length++)}if(0!==r){for(t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(t=0;t<r;t++)this.words[t]=0;this.length+=r}return this.strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,i){var r;n("number"===typeof e&&e>=0),r=t?(t-t%26)/26:0;var o=e%26,s=Math.min((e-o)/26,this.length),a=67108863^67108863>>>o<<o,c=i;if(r-=s,r=Math.max(0,r),c){for(var u=0;u<s;u++)c.words[u]=this.words[u];c.length=s}if(0===s);else if(this.length>s)for(this.length-=s,u=0;u<this.length;u++)this.words[u]=this.words[u+s];else this.words[0]=0,this.length=1;var d=0;for(u=this.length-1;u>=0&&(0!==d||u>=r);u--){var l=0|this.words[u];this.words[u]=d<<26-o|l>>>o,d=l&a}return c&&0!==d&&(c.words[c.length++]=d),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},o.prototype.ishrn=function(e,t,i){return n(0===this.negative),this.iushrn(e,t,i)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26,r=1<<t;return!(this.length<=i)&&!!(this.words[i]&r)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,i=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==t&&i++,this.length=Math.min(i,this.length),0!==t){var r=67108863^67108863>>>t<<t;this.words[this.length-1]&=r}return this.strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,i){var r,o,s=e.length+i;this._expand(s);var a=0;for(r=0;r<e.length;r++){o=(0|this.words[r+i])+a;var c=(0|e.words[r])*t;a=((o-=67108863&c)>>26)-(c/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},o.prototype._wordDiv=function(e,t){var i=(this.length,e.length),n=this.clone(),r=e,s=0|r.words[r.length-1];0!==(i=26-this._countBits(s))&&(r=r.ushln(i),n.iushln(i),s=0|r.words[r.length-1]);var a,c=n.length-r.length;if("mod"!==t){(a=new o(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var d=n.clone()._ishlnsubmul(r,1,c);0===d.negative&&(n=d,a&&(a.words[c]=1));for(var l=c-1;l>=0;l--){var h=67108864*(0|n.words[r.length+l])+(0|n.words[r.length+l-1]);for(h=Math.min(h/s|0,67108863),n._ishlnsubmul(r,h,l);0!==n.negative;)h--,n.negative=0,n._ishlnsubmul(r,1,l),n.isZero()||(n.negative^=1);a&&(a.words[l]=h)}return a&&a.strip(),n.strip(),"div"!==t&&0!==i&&n.iushrn(i),{div:a||null,mod:n}},o.prototype.divmod=function(e,t,i){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(r=a.div.neg()),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.iadd(e)),{div:r,mod:s}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(r=a.div.neg()),{div:r,mod:a.mod}):0!==(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(s=a.mod.neg(),i&&0!==s.negative&&s.isub(e)),{div:a.div,mod:s}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modn(e.words[0]))}:this._wordDiv(e,t);var r,s,a},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var i=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),r=e.andln(1),o=i.cmp(n);return o<0||1===r&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,i=0,r=this.length-1;r>=0;r--)i=(t*i+(0|this.words[r]))%e;return i},o.prototype.idivn=function(e){n(e<=67108863);for(var t=0,i=this.length-1;i>=0;i--){var r=(0|this.words[i])+67108864*t;this.words[i]=r/e|0,t=r%e}return this.strip()},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r=new o(1),s=new o(0),a=new o(0),c=new o(1),u=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++u;for(var d=i.clone(),l=t.clone();!t.isZero();){for(var h=0,f=1;0===(t.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(r.isOdd()||s.isOdd())&&(r.iadd(d),s.isub(l)),r.iushrn(1),s.iushrn(1);for(var p=0,m=1;0===(i.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(d),c.isub(l)),a.iushrn(1),c.iushrn(1);t.cmp(i)>=0?(t.isub(i),r.isub(a),s.isub(c)):(i.isub(t),a.isub(r),c.isub(s))}return{a:a,b:c,gcd:i.iushln(u)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var r,s=new o(1),a=new o(0),c=i.clone();t.cmpn(1)>0&&i.cmpn(1)>0;){for(var u=0,d=1;0===(t.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(t.iushrn(u);u-- >0;)s.isOdd()&&s.iadd(c),s.iushrn(1);for(var l=0,h=1;0===(i.words[0]&h)&&l<26;++l,h<<=1);if(l>0)for(i.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(i)>=0?(t.isub(i),s.isub(a)):(i.isub(t),a.isub(s))}return(r=0===t.cmpn(1)?s:a).cmpn(0)<0&&r.iadd(e),r},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),i=e.clone();t.negative=0,i.negative=0;for(var n=0;t.isEven()&&i.isEven();n++)t.iushrn(1),i.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=t.cmp(i);if(r<0){var o=t;t=i,i=o}else if(0===r||0===i.cmpn(1))break;t.isub(i)}return i.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,i=(e-t)/26,r=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var o=r,s=i;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),n(e<=67108863,"Number is too big");var r=0|this.words[0];t=r===e?0:r<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],r=0|e.words[i];if(n!==r){n<r?t=-1:n>r&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new S(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function b(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function y(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function w(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function T(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,i=e;do{this.split(i,this.tmp),t=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):void 0!==i.strip?i.strip():i._strip(),i},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},r(E,v),E.prototype.split=function(e,t){for(var i=4194303,n=Math.min(e.length,9),r=0;r<n;r++)t.words[r]=e.words[r];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&i,r=10;r<e.length;r++){var s=0|e.words[r];e.words[r-10]=(s&i)<<4|o>>>22,o=s}o>>>=22,e.words[r-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,i=0;i<e.length;i++){var n=0|e.words[i];t+=977*n,e.words[i]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(b,v),r(y,v),r(w,v),w.prototype.imulK=function(e){for(var t=0,i=0;i<e.length;i++){var n=19*(0|e.words[i])+t,r=67108863&n;n>>>=26,e.words[i]=r,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new b;else if("p192"===e)t=new y;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new w}return g[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var i=e.add(t);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var i=e.iadd(t);return i.cmp(this.m)>=0&&i.isub(this.m),i},S.prototype.sub=function(e,t){this._verify2(e,t);var i=e.sub(t);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var i=e.isub(t);return i.cmpn(0)<0&&i.iadd(this.m),i},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var i=this.m.add(new o(1)).iushrn(2);return this.pow(e,i)}for(var r=this.m.subn(1),s=0;!r.isZero()&&0===r.andln(1);)s++,r.iushrn(1);n(!r.isZero());var a=new o(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new o(2*d*d).toRed(this);0!==this.pow(d,u).cmp(c);)d.redIAdd(c);for(var l=this.pow(d,r),h=this.pow(e,r.addn(1).iushrn(1)),f=this.pow(e,r),p=s;0!==f.cmp(a);){for(var m=f,_=0;0!==m.cmp(a);_++)m=m.redSqr();n(_<p);var g=this.pow(l,new o(1).iushln(p-_-1));h=h.redMul(g),l=g.redSqr(),f=f.redMul(l),p=_}return h},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var i=new Array(16);i[0]=new o(1).toRed(this),i[1]=e;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],e);var r=i[0],s=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],d=c-1;d>=0;d--){var l=u>>d&1;r!==i[0]&&(r=this.sqr(r)),0!==l||0!==s?(s<<=1,s|=l,(4===++a||0===n&&0===d)&&(r=this.mul(r,i[s]),a=0,s=0)):a=0}c=26}return r},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new T(e)},r(T,S),T.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},T.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},T.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var i=e.imul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},T.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var i=e.mul(t),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),s=r;return r.cmp(this.m)>=0?s=r.isub(this.m):r.cmpn(0)<0&&(s=r.iadd(this.m)),s._forceRed(this)},T.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}).call(this,i(27)(e))},,function(e,t,i){t.publicEncrypt=i(258),t.privateDecrypt=i(260),t.privateEncrypt=function(e,i){return t.publicEncrypt(e,i,!0)},t.publicDecrypt=function(e,i){return t.privateDecrypt(e,i,!0)}},function(e,t,i){var n=i(56),r=i(31),o=i(41),s=i(136),a=i(137),c=i(84),u=i(138),d=i(75),l=i(3).Buffer;e.exports=function(e,t,i){var h;h=e.padding?e.padding:i?1:4;var f,p=n(e);if(4===h)f=function(e,t){var i=e.modulus.byteLength(),n=t.length,u=o("sha1").update(l.alloc(0)).digest(),d=u.length,h=2*d;if(n>i-h-2)throw new Error("message too long");var f=l.alloc(i-n-h-2),p=i-d-1,m=r(d),_=a(l.concat([u,f,l.alloc(1,1),t],p),s(m,p)),g=a(m,s(_,d));return new c(l.concat([l.alloc(1),g,_],i))}(p,t);else if(1===h)f=function(e,t,i){var n,o=t.length,s=e.modulus.byteLength();if(o>s-11)throw new Error("message too long");n=i?l.alloc(s-o-3,255):function(e){var t,i=l.allocUnsafe(e),n=0,o=r(2*e),s=0;for(;n<e;)s===o.length&&(o=r(2*e),s=0),(t=o[s++])&&(i[n++]=t);return i}(s-o-3);return new c(l.concat([l.from([0,i?1:2]),n,l.alloc(1),t],s))}(p,t,i);else{if(3!==h)throw new Error("unknown padding");if((f=new c(t)).cmp(p.modulus)>=0)throw new Error("data too long for modulus")}return i?d(f,p):u(f,p)}},,function(e,t,i){var n=i(56),r=i(136),o=i(137),s=i(84),a=i(75),c=i(41),u=i(138),d=i(3).Buffer;e.exports=function(e,t,i){var l;l=e.padding?e.padding:i?1:4;var h,f=n(e),p=f.modulus.byteLength();if(t.length>p||new s(t).cmp(f.modulus)>=0)throw new Error("decryption error");h=i?u(new s(t),f):a(t,f);var m=d.alloc(p-h.length);if(h=d.concat([m,h],p),4===l)return function(e,t){var i=e.modulus.byteLength(),n=c("sha1").update(d.alloc(0)).digest(),s=n.length;if(0!==t[0])throw new Error("decryption error");var a=t.slice(1,s+1),u=t.slice(s+1),l=o(a,r(u,s)),h=o(u,r(l,i-s-1));if(function(e,t){e=d.from(e),t=d.from(t);var i=0,n=e.length;e.length!==t.length&&(i++,n=Math.min(e.length,t.length));var r=-1;for(;++r<n;)i+=e[r]^t[r];return i}(n,h.slice(0,s)))throw new Error("decryption error");var f=s;for(;0===h[f];)f++;if(1!==h[f++])throw new Error("decryption error");return h.slice(f)}(f,h);if(1===l)return function(e,t,i){var n=t.slice(0,2),r=2,o=0;for(;0!==t[r++];)if(r>=t.length){o++;break}var s=t.slice(2,r-1);("0002"!==n.toString("hex")&&!i||"0001"!==n.toString("hex")&&i)&&o++;s.length<8&&o++;if(o)throw new Error("decryption error");return t.slice(r)}(0,h,i);if(3===l)return h;throw new Error("unknown padding")}},function(e,t,i){"use strict";(function(e,n){function r(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var o=i(3),s=i(31),a=o.Buffer,c=o.kMaxLength,u=e.crypto||e.msCrypto,d=Math.pow(2,32)-1;function l(e,t){if("number"!==typeof e||e!==e)throw new TypeError("offset must be a number");if(e>d||e<0)throw new TypeError("offset must be a uint32");if(e>c||e>t)throw new RangeError("offset out of range")}function h(e,t,i){if("number"!==typeof e||e!==e)throw new TypeError("size must be a number");if(e>d||e<0)throw new TypeError("size must be a uint32");if(e+t>i||e>c)throw new RangeError("buffer too small")}function f(e,t,i,r){if(n.browser){var o=e.buffer,a=new Uint8Array(o,t,i);return u.getRandomValues(a),r?void n.nextTick((function(){r(null,e)})):e}if(!r)return s(i).copy(e,t),e;s(i,(function(i,n){if(i)return r(i);n.copy(e,t),r(null,e)}))}u&&u.getRandomValues||!n.browser?(t.randomFill=function(t,i,n,r){if(!a.isBuffer(t)&&!(t instanceof e.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"===typeof i)r=i,i=0,n=t.length;else if("function"===typeof n)r=n,n=t.length-i;else if("function"!==typeof r)throw new TypeError('"cb" argument must be a function');return l(i,t.length),h(n,i,t.length),f(t,i,n,r)},t.randomFillSync=function(t,i,n){"undefined"===typeof i&&(i=0);if(!a.isBuffer(t)&&!(t instanceof e.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');l(i,t.length),void 0===n&&(n=t.length-i);return h(n,i,t.length),f(t,i,n)}):(t.randomFill=r,t.randomFillSync=r)}).call(this,i(9),i(6))},function(e,t,i){var n;n=function(e){e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),i=0;256!=i;++i)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=i)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[i]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();e.table=t,e.bstr=function(e,i){for(var n=-1^i,r=e.length-1,o=0;o<r;)n=(n=n>>>8^t[255&(n^e.charCodeAt(o++))])>>>8^t[255&(n^e.charCodeAt(o++))];return o===r&&(n=n>>>8^t[255&(n^e.charCodeAt(o))]),-1^n},e.buf=function(e,i){if(e.length>1e4)return function(e,i){for(var n=-1^i,r=e.length-7,o=0;o<r;)n=(n=(n=(n=(n=(n=(n=(n=n>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])];for(;o<r+7;)n=n>>>8^t[255&(n^e[o++])];return-1^n}(e,i);for(var n=-1^i,r=e.length-3,o=0;o<r;)n=(n=(n=(n=n>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])])>>>8^t[255&(n^e[o++])];for(;o<r+3;)n=n>>>8^t[255&(n^e[o++])];return-1^n},e.str=function(e,i){for(var n,r,o=-1^i,s=0,a=e.length;s<a;)(n=e.charCodeAt(s++))<128?o=o>>>8^t[255&(o^n)]:n<2048?o=(o=o>>>8^t[255&(o^(192|n>>6&31))])>>>8^t[255&(o^(128|63&n))]:n>=55296&&n<57344?(n=64+(1023&n),r=1023&e.charCodeAt(s++),o=(o=(o=(o=o>>>8^t[255&(o^(240|n>>8&7))])>>>8^t[255&(o^(128|n>>2&63))])>>>8^t[255&(o^(128|r>>6&15|(3&n)<<4))])>>>8^t[255&(o^(128|63&r))]):o=(o=(o=o>>>8^t[255&(o^(224|n>>12&15))])>>>8^t[255&(o^(128|n>>6&63))])>>>8^t[255&(o^(128|63&n))];return-1^o}},"undefined"===typeof DO_NOT_EXPORT_CRC?n(t):n({})},function(e,t,i){t.UINT32=i(264),t.UINT64=i(265)},function(e,t,i){var n;!function(i){r(Math.pow(36,5)),r(Math.pow(16,7)),r(Math.pow(10,9)),r(Math.pow(2,30)),r(36),r(16),r(10),r(2);function r(e,t){return this instanceof r?(this._low=0,this._high=0,this.remainder=null,"undefined"==typeof t?s.call(this,e):"string"==typeof e?a.call(this,e,t):void o.call(this,e,t)):new r(e,t)}function o(e,t){return this._low=0|e,this._high=0|t,this}function s(e){return this._low=65535&e,this._high=e>>>16,this}function a(e,t){var i=parseInt(e,t||10);return this._low=65535&i,this._high=i>>>16,this}r.prototype.fromBits=o,r.prototype.fromNumber=s,r.prototype.fromString=a,r.prototype.toNumber=function(){return 65536*this._high+this._low},r.prototype.toString=function(e){return this.toNumber().toString(e||10)},r.prototype.add=function(e){var t=this._low+e._low,i=t>>>16;return i+=this._high+e._high,this._low=65535&t,this._high=65535&i,this},r.prototype.subtract=function(e){return this.add(e.clone().negate())},r.prototype.multiply=function(e){var t,i,n=this._high,r=this._low,o=e._high,s=e._low;return t=(i=r*s)>>>16,t+=n*s,t&=65535,t+=r*o,this._low=65535&i,this._high=65535&t,this},r.prototype.div=function(e){if(0==e._low&&0==e._high)throw Error("division by zero");if(0==e._high&&1==e._low)return this.remainder=new r(0),this;if(e.gt(this))return this.remainder=this.clone(),this._low=0,this._high=0,this;if(this.eq(e))return this.remainder=new r(0),this._low=1,this._high=0,this;for(var t=e.clone(),i=-1;!this.lt(t);)t.shiftLeft(1,!0),i++;for(this.remainder=this.clone(),this._low=0,this._high=0;i>=0;i--)t.shiftRight(1),this.remainder.lt(t)||(this.remainder.subtract(t),i>=16?this._high|=1<<i-16:this._low|=1<<i);return this},r.prototype.negate=function(){var e=1+(65535&~this._low);return this._low=65535&e,this._high=~this._high+(e>>>16)&65535,this},r.prototype.equals=r.prototype.eq=function(e){return this._low==e._low&&this._high==e._high},r.prototype.greaterThan=r.prototype.gt=function(e){return this._high>e._high||!(this._high<e._high)&&this._low>e._low},r.prototype.lessThan=r.prototype.lt=function(e){return this._high<e._high||!(this._high>e._high)&&this._low<e._low},r.prototype.or=function(e){return this._low|=e._low,this._high|=e._high,this},r.prototype.and=function(e){return this._low&=e._low,this._high&=e._high,this},r.prototype.not=function(){return this._low=65535&~this._low,this._high=65535&~this._high,this},r.prototype.xor=function(e){return this._low^=e._low,this._high^=e._high,this},r.prototype.shiftRight=r.prototype.shiftr=function(e){return e>16?(this._low=this._high>>e-16,this._high=0):16==e?(this._low=this._high,this._high=0):(this._low=this._low>>e|this._high<<16-e&65535,this._high>>=e),this},r.prototype.shiftLeft=r.prototype.shiftl=function(e,t){return e>16?(this._high=this._low<<e-16,this._low=0,t||(this._high&=65535)):16==e?(this._high=this._low,this._low=0):(this._high=this._high<<e|this._low>>16-e,this._low=this._low<<e&65535,t||(this._high&=65535)),this},r.prototype.rotateLeft=r.prototype.rotl=function(e){var t=this._high<<16|this._low;return t=t<<e|t>>>32-e,this._low=65535&t,this._high=t>>>16,this},r.prototype.rotateRight=r.prototype.rotr=function(e){var t=this._high<<16|this._low;return t=t>>>e|t<<32-e,this._low=65535&t,this._high=t>>>16,this},r.prototype.clone=function(){return new r(this._low,this._high)},void 0===(n=function(){return r}.apply(t,[]))||(e.exports=n)}()},function(e,t,i){var n;!function(i){var r={16:s(Math.pow(16,5)),10:s(Math.pow(10,5)),2:s(Math.pow(2,5))},o={16:s(16),10:s(10),2:s(2)};function s(e,t,i,n){return this instanceof s?(this.remainder=null,"string"==typeof e?u.call(this,e,t):"undefined"==typeof t?c.call(this,e):void a.apply(this,arguments)):new s(e,t,i,n)}function a(e,t,i,n){return"undefined"==typeof i?(this._a00=65535&e,this._a16=e>>>16,this._a32=65535&t,this._a48=t>>>16,this):(this._a00=0|e,this._a16=0|t,this._a32=0|i,this._a48=0|n,this)}function c(e){return this._a00=65535&e,this._a16=e>>>16,this._a32=0,this._a48=0,this}function u(e,t){t=t||10,this._a00=0,this._a16=0,this._a32=0,this._a48=0;for(var i=r[t]||new s(Math.pow(t,5)),n=0,o=e.length;n<o;n+=5){var a=Math.min(5,o-n),c=parseInt(e.slice(n,n+a),t);this.multiply(a<5?new s(Math.pow(t,a)):i).add(new s(c))}return this}s.prototype.fromBits=a,s.prototype.fromNumber=c,s.prototype.fromString=u,s.prototype.toNumber=function(){return 65536*this._a16+this._a00},s.prototype.toString=function(e){var t=o[e=e||10]||new s(e);if(!this.gt(t))return this.toNumber().toString(e);for(var i=this.clone(),n=new Array(64),r=63;r>=0&&(i.div(t),n[r]=i.remainder.toNumber().toString(e),i.gt(t));r--);return n[r-1]=i.toNumber().toString(e),n.join("")},s.prototype.add=function(e){var t=this._a00+e._a00,i=t>>>16,n=(i+=this._a16+e._a16)>>>16,r=(n+=this._a32+e._a32)>>>16;return r+=this._a48+e._a48,this._a00=65535&t,this._a16=65535&i,this._a32=65535&n,this._a48=65535&r,this},s.prototype.subtract=function(e){return this.add(e.clone().negate())},s.prototype.multiply=function(e){var t=this._a00,i=this._a16,n=this._a32,r=this._a48,o=e._a00,s=e._a16,a=e._a32,c=t*o,u=c>>>16,d=(u+=t*s)>>>16;u&=65535,d+=(u+=i*o)>>>16;var l=(d+=t*a)>>>16;return d&=65535,l+=(d+=i*s)>>>16,d&=65535,l+=(d+=n*o)>>>16,l+=t*e._a48,l&=65535,l+=i*a,l&=65535,l+=n*s,l&=65535,l+=r*o,this._a00=65535&c,this._a16=65535&u,this._a32=65535&d,this._a48=65535&l,this},s.prototype.div=function(e){if(0==e._a16&&0==e._a32&&0==e._a48){if(0==e._a00)throw Error("division by zero");if(1==e._a00)return this.remainder=new s(0),this}if(e.gt(this))return this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0,this;if(this.eq(e))return this.remainder=new s(0),this._a00=1,this._a16=0,this._a32=0,this._a48=0,this;for(var t=e.clone(),i=-1;!this.lt(t);)t.shiftLeft(1,!0),i++;for(this.remainder=this.clone(),this._a00=0,this._a16=0,this._a32=0,this._a48=0;i>=0;i--)t.shiftRight(1),this.remainder.lt(t)||(this.remainder.subtract(t),i>=48?this._a48|=1<<i-48:i>=32?this._a32|=1<<i-32:i>=16?this._a16|=1<<i-16:this._a00|=1<<i);return this},s.prototype.negate=function(){var e=1+(65535&~this._a00);return this._a00=65535&e,e=(65535&~this._a16)+(e>>>16),this._a16=65535&e,e=(65535&~this._a32)+(e>>>16),this._a32=65535&e,this._a48=~this._a48+(e>>>16)&65535,this},s.prototype.equals=s.prototype.eq=function(e){return this._a48==e._a48&&this._a00==e._a00&&this._a32==e._a32&&this._a16==e._a16},s.prototype.greaterThan=s.prototype.gt=function(e){return this._a48>e._a48||!(this._a48<e._a48)&&(this._a32>e._a32||!(this._a32<e._a32)&&(this._a16>e._a16||!(this._a16<e._a16)&&this._a00>e._a00))},s.prototype.lessThan=s.prototype.lt=function(e){return this._a48<e._a48||!(this._a48>e._a48)&&(this._a32<e._a32||!(this._a32>e._a32)&&(this._a16<e._a16||!(this._a16>e._a16)&&this._a00<e._a00))},s.prototype.or=function(e){return this._a00|=e._a00,this._a16|=e._a16,this._a32|=e._a32,this._a48|=e._a48,this},s.prototype.and=function(e){return this._a00&=e._a00,this._a16&=e._a16,this._a32&=e._a32,this._a48&=e._a48,this},s.prototype.xor=function(e){return this._a00^=e._a00,this._a16^=e._a16,this._a32^=e._a32,this._a48^=e._a48,this},s.prototype.not=function(){return this._a00=65535&~this._a00,this._a16=65535&~this._a16,this._a32=65535&~this._a32,this._a48=65535&~this._a48,this},s.prototype.shiftRight=s.prototype.shiftr=function(e){return(e%=64)>=48?(this._a00=this._a48>>e-48,this._a16=0,this._a32=0,this._a48=0):e>=32?(e-=32,this._a00=65535&(this._a32>>e|this._a48<<16-e),this._a16=this._a48>>e&65535,this._a32=0,this._a48=0):e>=16?(e-=16,this._a00=65535&(this._a16>>e|this._a32<<16-e),this._a16=65535&(this._a32>>e|this._a48<<16-e),this._a32=this._a48>>e&65535,this._a48=0):(this._a00=65535&(this._a00>>e|this._a16<<16-e),this._a16=65535&(this._a16>>e|this._a32<<16-e),this._a32=65535&(this._a32>>e|this._a48<<16-e),this._a48=this._a48>>e&65535),this},s.prototype.shiftLeft=s.prototype.shiftl=function(e,t){return(e%=64)>=48?(this._a48=this._a00<<e-48,this._a32=0,this._a16=0,this._a00=0):e>=32?(e-=32,this._a48=this._a16<<e|this._a00>>16-e,this._a32=this._a00<<e&65535,this._a16=0,this._a00=0):e>=16?(e-=16,this._a48=this._a32<<e|this._a16>>16-e,this._a32=65535&(this._a16<<e|this._a00>>16-e),this._a16=this._a00<<e&65535,this._a00=0):(this._a48=this._a48<<e|this._a32>>16-e,this._a32=65535&(this._a32<<e|this._a16>>16-e),this._a16=65535&(this._a16<<e|this._a00>>16-e),this._a00=this._a00<<e&65535),t||(this._a48&=65535),this},s.prototype.rotateLeft=s.prototype.rotl=function(e){if(0==(e%=64))return this;if(e>=32){var t=this._a00;if(this._a00=this._a32,this._a32=t,t=this._a48,this._a48=this._a16,this._a16=t,32==e)return this;e-=32}var i=this._a48<<16|this._a32,n=this._a16<<16|this._a00,r=i<<e|n>>>32-e,o=n<<e|i>>>32-e;return this._a00=65535&o,this._a16=o>>>16,this._a32=65535&r,this._a48=r>>>16,this},s.prototype.rotateRight=s.prototype.rotr=function(e){if(0==(e%=64))return this;if(e>=32){var t=this._a00;if(this._a00=this._a32,this._a32=t,t=this._a48,this._a48=this._a16,this._a16=t,32==e)return this;e-=32}var i=this._a48<<16|this._a32,n=this._a16<<16|this._a00,r=i>>>e|n<<32-e,o=n>>>e|i<<32-e;return this._a00=65535&o,this._a16=o>>>16,this._a32=65535&r,this._a48=r>>>16,this},s.prototype.clone=function(){return new s(this._a00,this._a16,this._a32,this._a48)},void 0===(n=function(){return s}.apply(t,[]))||(e.exports=n)}()},function(e,t,i){var n;!function(r,o){"use strict";var s="function",a="undefined",c="object",u="string",d="major",l="model",h="name",f="type",p="vendor",m="version",_="architecture",g="console",v="mobile",E="tablet",b="smarttv",y="wearable",w="embedded",S="Amazon",T="Apple",R="ASUS",C="BlackBerry",I="Browser",A="Chrome",O="Firefox",M="Google",N="Huawei",k="LG",P="Microsoft",D="Motorola",L="Opera",x="Samsung",U="Sharp",V="Sony",B="Xiaomi",j="Zebra",F="Facebook",W="Chromium OS",G="Mac OS",H=function(e){for(var t={},i=0;i<e.length;i++)t[e[i].toUpperCase()]=e[i];return t},q=function(e,t){return typeof e===u&&-1!==K(t).indexOf(K(e))},K=function(e){return e.toLowerCase()},z=function(e,t){if(typeof e===u)return e=e.replace(/^\s\s*/,""),typeof t===a?e:e.substring(0,500)},Y=function(e,t){for(var i,n,r,a,u,d,l=0;l<t.length&&!u;){var h=t[l],f=t[l+1];for(i=n=0;i<h.length&&!u&&h[i];)if(u=h[i++].exec(e))for(r=0;r<f.length;r++)d=u[++n],typeof(a=f[r])===c&&a.length>0?2===a.length?typeof a[1]==s?this[a[0]]=a[1].call(this,d):this[a[0]]=a[1]:3===a.length?typeof a[1]!==s||a[1].exec&&a[1].test?this[a[0]]=d?d.replace(a[1],a[2]):o:this[a[0]]=d?a[1].call(this,d,a[2]):o:4===a.length&&(this[a[0]]=d?a[3].call(this,d.replace(a[1],a[2])):o):this[a]=d||o;l+=2}},J=function(e,t){for(var i in t)if(typeof t[i]===c&&t[i].length>0){for(var n=0;n<t[i].length;n++)if(q(t[i][n],e))return"?"===i?o:i}else if(q(t[i],e))return"?"===i?o:i;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Q={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[h,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[h,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[h,m],[/opios[\/ ]+([\w\.]+)/i],[m,[h,L+" Mini"]],[/\bopr\/([\w\.]+)/i],[m,[h,L]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[m,[h,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[h,m],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[h,"UC"+I]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[m,[h,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[h,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[h,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[m,[h,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[m,[h,"Smart Lenovo "+I]],[/(avast|avg)\/([\w\.]+)/i],[[h,/(.+)/,"$1 Secure "+I],m],[/\bfocus\/([\w\.]+)/i],[m,[h,O+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[h,L+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[h,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[h,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[h,L+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[h,"MIUI "+I]],[/fxios\/([-\w\.]+)/i],[m,[h,O]],[/\bqihu|(qi?ho?o?|360)browser/i],[[h,"360 "+I]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[h,/(.+)/,"$1 "+I],m],[/samsungbrowser\/([\w\.]+)/i],[m,[h,x+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[h,/_/g," "],m],[/metasr[\/ ]?([\d\.]+)/i],[m,[h,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[h,"Sogou Mobile"],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[h,m],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[h],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[h,F],m],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[h,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[h,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[m,[h,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[h,A+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[h,A+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[h,"Android "+I]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[h,m],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[m,[h,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[m,h],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[h,[m,J,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[h,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[h,"Netscape"],m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[h,O+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[h,m],[/(cobalt)\/([\w\.]+)/i],[h,[m,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[_,"amd64"]],[/(ia32(?=;))/i],[[_,K]],[/((?:i[346]|x)86)[;\)]/i],[[_,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[_,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[_,"armhf"]],[/windows (ce|mobile); ppc;/i],[[_,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[_,/ower/,"",K]],[/(sun4\w)[;\)]/i],[[_,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[_,K]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[l,[p,x],[f,E]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[l,[p,x],[f,v]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[l,[p,T],[f,v]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[l,[p,T],[f,E]],[/(macintosh);/i],[l,[p,T]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[l,[p,U],[f,v]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[l,[p,N],[f,E]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[l,[p,N],[f,v]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[l,/_/g," "],[p,B],[f,v]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[l,/_/g," "],[p,B],[f,E]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[l,[p,"OPPO"],[f,v]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[l,[p,"Vivo"],[f,v]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[l,[p,"Realme"],[f,v]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[l,[p,D],[f,v]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[l,[p,D],[f,E]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[l,[p,k],[f,E]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[l,[p,k],[f,v]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[l,[p,"Lenovo"],[f,E]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[l,/_/g," "],[p,"Nokia"],[f,v]],[/(pixel c)\b/i],[l,[p,M],[f,E]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[l,[p,M],[f,v]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[l,[p,V],[f,v]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[l,"Xperia Tablet"],[p,V],[f,E]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[l,[p,"OnePlus"],[f,v]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[l,[p,S],[f,E]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[l,/(.+)/g,"Fire Phone $1"],[p,S],[f,v]],[/(playbook);[-\w\),; ]+(rim)/i],[l,p,[f,E]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[l,[p,C],[f,v]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[l,[p,R],[f,E]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[l,[p,R],[f,v]],[/(nexus 9)/i],[l,[p,"HTC"],[f,E]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[p,[l,/_/g," "],[f,v]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[l,[p,"Acer"],[f,E]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[l,[p,"Meizu"],[f,v]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[l,[p,"Ulefone"],[f,v]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[p,l,[f,v]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[p,l,[f,E]],[/(surface duo)/i],[l,[p,P],[f,E]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[l,[p,"Fairphone"],[f,v]],[/(u304aa)/i],[l,[p,"AT&T"],[f,v]],[/\bsie-(\w*)/i],[l,[p,"Siemens"],[f,v]],[/\b(rct\w+) b/i],[l,[p,"RCA"],[f,E]],[/\b(venue[\d ]{2,7}) b/i],[l,[p,"Dell"],[f,E]],[/\b(q(?:mv|ta)\w+) b/i],[l,[p,"Verizon"],[f,E]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[l,[p,"Barnes & Noble"],[f,E]],[/\b(tm\d{3}\w+) b/i],[l,[p,"NuVision"],[f,E]],[/\b(k88) b/i],[l,[p,"ZTE"],[f,E]],[/\b(nx\d{3}j) b/i],[l,[p,"ZTE"],[f,v]],[/\b(gen\d{3}) b.+49h/i],[l,[p,"Swiss"],[f,v]],[/\b(zur\d{3}) b/i],[l,[p,"Swiss"],[f,E]],[/\b((zeki)?tb.*\b) b/i],[l,[p,"Zeki"],[f,E]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[p,"Dragon Touch"],l,[f,E]],[/\b(ns-?\w{0,9}) b/i],[l,[p,"Insignia"],[f,E]],[/\b((nxa|next)-?\w{0,9}) b/i],[l,[p,"NextBook"],[f,E]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[p,"Voice"],l,[f,v]],[/\b(lvtel\-)?(v1[12]) b/i],[[p,"LvTel"],l,[f,v]],[/\b(ph-1) /i],[l,[p,"Essential"],[f,v]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[l,[p,"Envizen"],[f,E]],[/\b(trio[-\w\. ]+) b/i],[l,[p,"MachSpeed"],[f,E]],[/\btu_(1491) b/i],[l,[p,"Rotor"],[f,E]],[/(shield[\w ]+) b/i],[l,[p,"Nvidia"],[f,E]],[/(sprint) (\w+)/i],[p,l,[f,v]],[/(kin\.[onetw]{3})/i],[[l,/\./g," "],[p,P],[f,v]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[l,[p,j],[f,E]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[l,[p,j],[f,v]],[/smart-tv.+(samsung)/i],[p,[f,b]],[/hbbtv.+maple;(\d+)/i],[[l,/^/,"SmartTV"],[p,x],[f,b]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[p,k],[f,b]],[/(apple) ?tv/i],[p,[l,T+" TV"],[f,b]],[/crkey/i],[[l,A+"cast"],[p,M],[f,b]],[/droid.+aft(\w+)( bui|\))/i],[l,[p,S],[f,b]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[l,[p,U],[f,b]],[/(bravia[\w ]+)( bui|\))/i],[l,[p,V],[f,b]],[/(mitv-\w{5}) bui/i],[l,[p,B],[f,b]],[/Hbbtv.*(technisat) (.*);/i],[p,l,[f,b]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[p,z],[l,z],[f,b]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[f,b]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[p,l,[f,g]],[/droid.+; (shield) bui/i],[l,[p,"Nvidia"],[f,g]],[/(playstation [345portablevi]+)/i],[l,[p,V],[f,g]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[l,[p,P],[f,g]],[/((pebble))app/i],[p,l,[f,y]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[l,[p,T],[f,y]],[/droid.+; (glass) \d/i],[l,[p,M],[f,y]],[/droid.+; (wt63?0{2,3})\)/i],[l,[p,j],[f,y]],[/(quest( 2| pro)?)/i],[l,[p,F],[f,y]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[p,[f,w]],[/(aeobc)\b/i],[l,[p,S],[f,w]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[l,[f,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[l,[f,E]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[f,E]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[f,v]],[/(android[-\w\. ]{0,9});.+buil/i],[l,[p,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[h,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[h,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[h,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,h]],os:[[/microsoft (windows) (vista|xp)/i],[h,m],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[h,[m,J,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[m,J,X],[h,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[h,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[h,G],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[m,h],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[h,m],[/\(bb(10);/i],[m,[h,C]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[h,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[h,O+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[h,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[m,[h,"watchOS"]],[/crkey\/([\d\.]+)/i],[m,[h,A+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[h,W],m],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[h,m],[/(sunos) ?([\w\.\d]*)/i],[[h,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[h,m]]},Z=function(e,t){if(typeof e===c&&(t=e,e=o),!(this instanceof Z))return new Z(e,t).getResult();var i=typeof r!==a&&r.navigator?r.navigator:o,n=e||(i&&i.userAgent?i.userAgent:""),g=i&&i.userAgentData?i.userAgentData:o,b=t?function(e,t){var i={};for(var n in e)t[n]&&t[n].length%2===0?i[n]=t[n].concat(e[n]):i[n]=e[n];return i}(Q,t):Q,y=i&&i.userAgent==n;return this.getBrowser=function(){var e,t={};return t[h]=o,t[m]=o,Y.call(t,n,b.browser),t[d]=typeof(e=t[m])===u?e.replace(/[^\d\.]/g,"").split(".")[0]:o,y&&i&&i.brave&&typeof i.brave.isBrave==s&&(t[h]="Brave"),t},this.getCPU=function(){var e={};return e[_]=o,Y.call(e,n,b.cpu),e},this.getDevice=function(){var e={};return e[p]=o,e[l]=o,e[f]=o,Y.call(e,n,b.device),y&&!e[f]&&g&&g.mobile&&(e[f]=v),y&&"Macintosh"==e[l]&&i&&typeof i.standalone!==a&&i.maxTouchPoints&&i.maxTouchPoints>2&&(e[l]="iPad",e[f]=E),e},this.getEngine=function(){var e={};return e[h]=o,e[m]=o,Y.call(e,n,b.engine),e},this.getOS=function(){var e={};return e[h]=o,e[m]=o,Y.call(e,n,b.os),y&&!e[h]&&g&&"Unknown"!=g.platform&&(e[h]=g.platform.replace(/chrome os/i,W).replace(/macos/i,G)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===u&&e.length>500?z(e,500):e,this},this.setUA(n),this};Z.VERSION="1.0.37",Z.BROWSER=H([h,m,d]),Z.CPU=H([_]),Z.DEVICE=H([l,p,f,g,v,b,E,y,w]),Z.ENGINE=Z.OS=H([h,m]),typeof t!==a?(typeof e!==a&&e.exports&&(t=e.exports=Z),t.UAParser=Z):i(267)?(n=function(){return Z}.call(t,i,t,e))===o||(e.exports=n):typeof r!==a&&(r.UAParser=Z);var $=typeof r!==a&&(r.jQuery||r.Zepto);if($&&!$.ua){var ee=new Z;$.ua=ee.getResult(),$.ua.get=function(){return ee.getUA()},$.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var i in t)$.ua[i]=t[i]}}}("object"===typeof window?window:this)},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,i){"use strict";i(61);var n=i(0),r=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var o=Symbol.for;r=o("react.element"),t.Fragment=o("react.fragment")}var s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,i){var n,o={},u=null,d=null;for(n in void 0!==i&&(u=""+i),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,n)&&!c.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:r,type:e,key:u,ref:d,props:o,_owner:s.current}}t.jsx=u,t.jsxs=u},function(e,t,i){"use strict";e.exports=i(270)},function(e,t,i){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,s=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,c=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,d=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,m=n?Symbol.for("react.suspense_list"):60120,_=n?Symbol.for("react.memo"):60115,g=n?Symbol.for("react.lazy"):60116,v=n?Symbol.for("react.block"):60121,E=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,y=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case h:case s:case c:case a:case p:return e;default:switch(e=e&&e.$$typeof){case d:case f:case g:case _:case u:return e;default:return t}}case o:return t}}}function S(e){return w(e)===h}t.AsyncMode=l,t.ConcurrentMode=h,t.ContextConsumer=d,t.ContextProvider=u,t.Element=r,t.ForwardRef=f,t.Fragment=s,t.Lazy=g,t.Memo=_,t.Portal=o,t.Profiler=c,t.StrictMode=a,t.Suspense=p,t.isAsyncMode=function(e){return S(e)||w(e)===l},t.isConcurrentMode=S,t.isContextConsumer=function(e){return w(e)===d},t.isContextProvider=function(e){return w(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===f},t.isFragment=function(e){return w(e)===s},t.isLazy=function(e){return w(e)===g},t.isMemo=function(e){return w(e)===_},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===c},t.isStrictMode=function(e){return w(e)===a},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===s||e===h||e===c||e===a||e===p||e===m||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===_||e.$$typeof===u||e.$$typeof===d||e.$$typeof===f||e.$$typeof===E||e.$$typeof===b||e.$$typeof===y||e.$$typeof===v)},t.typeOf=w},function(e,t){function i(t){return e.exports=i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,i(t)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},function(e,t,i){"use strict";i.r(t),i.d(t,"capitalize",(function(){return n.a})),i.d(t,"createChainedFunction",(function(){return r})),i.d(t,"createSvgIcon",(function(){return f})),i.d(t,"debounce",(function(){return p})),i.d(t,"deprecatedPropType",(function(){return m.a})),i.d(t,"isMuiElement",(function(){return _})),i.d(t,"ownerDocument",(function(){return g})),i.d(t,"ownerWindow",(function(){return v})),i.d(t,"requirePropFactory",(function(){return E.a})),i.d(t,"setRef",(function(){return b.a})),i.d(t,"unsupportedProp",(function(){return y})),i.d(t,"useControlled",(function(){return w})),i.d(t,"useEventCallback",(function(){return S.a})),i.d(t,"useForkRef",(function(){return T.a})),i.d(t,"unstable_useId",(function(){return R})),i.d(t,"useIsFocusVisible",(function(){return C.a}));var n=i(15);function r(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.reduce((function(e,t){return null==t?e:function(){for(var i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];e.apply(this,n),t.apply(this,n)}}),(function(){}))}var o=i(1),s=i(0),a=i.n(s),c=i(5),u=i(8),d=i(18),l=s.forwardRef((function(e,t){var i=e.children,r=e.classes,a=e.className,d=e.color,l=void 0===d?"inherit":d,h=e.component,f=void 0===h?"svg":h,p=e.fontSize,m=void 0===p?"medium":p,_=e.htmlColor,g=e.titleAccess,v=e.viewBox,E=void 0===v?"0 0 24 24":v,b=Object(c.a)(e,["children","classes","className","color","component","fontSize","htmlColor","titleAccess","viewBox"]);return s.createElement(f,Object(o.a)({className:Object(u.a)(r.root,a,"inherit"!==l&&r["color".concat(Object(n.a)(l))],"default"!==m&&"medium"!==m&&r["fontSize".concat(Object(n.a)(m))]),focusable:"false",viewBox:E,color:_,"aria-hidden":!g||void 0,role:g?"img":void 0,ref:t},b),i,g?s.createElement("title",null,g):null)}));l.muiName="SvgIcon";var h=Object(d.a)((function(e){return{root:{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:"currentColor",flexShrink:0,fontSize:e.typography.pxToRem(24),transition:e.transitions.create("fill",{duration:e.transitions.duration.shorter})},colorPrimary:{color:e.palette.primary.main},colorSecondary:{color:e.palette.secondary.main},colorAction:{color:e.palette.action.active},colorError:{color:e.palette.error.main},colorDisabled:{color:e.palette.action.disabled},fontSizeInherit:{fontSize:"inherit"},fontSizeSmall:{fontSize:e.typography.pxToRem(20)},fontSizeLarge:{fontSize:e.typography.pxToRem(35)}}}),{name:"MuiSvgIcon"})(l);function f(e,t){var i=function(t,i){return a.a.createElement(h,Object(o.a)({ref:i},t),e)};return i.muiName=h.muiName,a.a.memo(a.a.forwardRef(i))}function p(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function n(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];var s=this;clearTimeout(t),t=setTimeout((function(){e.apply(s,r)}),i)}return n.clear=function(){clearTimeout(t)},n}var m=i(57);function _(e,t){return s.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}function g(e){return e&&e.ownerDocument||document}function v(e){return g(e).defaultView||window}var E=i(85),b=i(46);function y(e,t,i,n,r){return null}function w(e){var t=e.controlled,i=e.default,n=(e.name,e.state,s.useRef(void 0!==t).current),r=s.useState(i),o=r[0],a=r[1];return[n?t:o,s.useCallback((function(e){n||a(e)}),[])]}var S=i(21),T=i(39);function R(e){var t=s.useState(e),i=t[0],n=t[1],r=e||i;return s.useEffect((function(){null==i&&n("mui-".concat(Math.round(1e5*Math.random())))}),[i]),r}var C=i(58)},,,,,,,,,,,,,,,function(e,t,i){"use strict";var n=i(5),r=i(1),o=i(0),s=i(8),a=i(18),c=[0,1,2,3,4,5,6,7,8,9,10],u=["auto",!0,1,2,3,4,5,6,7,8,9,10,11,12];function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=parseFloat(e);return"".concat(i/t).concat(String(e).replace(String(i),"")||"px")}var l=o.forwardRef((function(e,t){var i=e.alignContent,a=void 0===i?"stretch":i,c=e.alignItems,u=void 0===c?"stretch":c,d=e.classes,l=e.className,h=e.component,f=void 0===h?"div":h,p=e.container,m=void 0!==p&&p,_=e.direction,g=void 0===_?"row":_,v=e.item,E=void 0!==v&&v,b=e.justify,y=e.justifyContent,w=void 0===y?"flex-start":y,S=e.lg,T=void 0!==S&&S,R=e.md,C=void 0!==R&&R,I=e.sm,A=void 0!==I&&I,O=e.spacing,M=void 0===O?0:O,N=e.wrap,k=void 0===N?"wrap":N,P=e.xl,D=void 0!==P&&P,L=e.xs,x=void 0!==L&&L,U=e.zeroMinWidth,V=void 0!==U&&U,B=Object(n.a)(e,["alignContent","alignItems","classes","className","component","container","direction","item","justify","justifyContent","lg","md","sm","spacing","wrap","xl","xs","zeroMinWidth"]),j=Object(s.a)(d.root,l,m&&[d.container,0!==M&&d["spacing-xs-".concat(String(M))]],E&&d.item,V&&d.zeroMinWidth,"row"!==g&&d["direction-xs-".concat(String(g))],"wrap"!==k&&d["wrap-xs-".concat(String(k))],"stretch"!==u&&d["align-items-xs-".concat(String(u))],"stretch"!==a&&d["align-content-xs-".concat(String(a))],"flex-start"!==(b||w)&&d["justify-content-xs-".concat(String(b||w))],!1!==x&&d["grid-xs-".concat(String(x))],!1!==A&&d["grid-sm-".concat(String(A))],!1!==C&&d["grid-md-".concat(String(C))],!1!==T&&d["grid-lg-".concat(String(T))],!1!==D&&d["grid-xl-".concat(String(D))]);return o.createElement(f,Object(r.a)({className:j,ref:t},B))})),h=Object(a.a)((function(e){return Object(r.a)({root:{},container:{boxSizing:"border-box",display:"flex",flexWrap:"wrap",width:"100%"},item:{boxSizing:"border-box",margin:"0"},zeroMinWidth:{minWidth:0},"direction-xs-column":{flexDirection:"column"},"direction-xs-column-reverse":{flexDirection:"column-reverse"},"direction-xs-row-reverse":{flexDirection:"row-reverse"},"wrap-xs-nowrap":{flexWrap:"nowrap"},"wrap-xs-wrap-reverse":{flexWrap:"wrap-reverse"},"align-items-xs-center":{alignItems:"center"},"align-items-xs-flex-start":{alignItems:"flex-start"},"align-items-xs-flex-end":{alignItems:"flex-end"},"align-items-xs-baseline":{alignItems:"baseline"},"align-content-xs-center":{alignContent:"center"},"align-content-xs-flex-start":{alignContent:"flex-start"},"align-content-xs-flex-end":{alignContent:"flex-end"},"align-content-xs-space-between":{alignContent:"space-between"},"align-content-xs-space-around":{alignContent:"space-around"},"justify-content-xs-center":{justifyContent:"center"},"justify-content-xs-flex-end":{justifyContent:"flex-end"},"justify-content-xs-space-between":{justifyContent:"space-between"},"justify-content-xs-space-around":{justifyContent:"space-around"},"justify-content-xs-space-evenly":{justifyContent:"space-evenly"}},function(e,t){var i={};return c.forEach((function(n){var r=e.spacing(n);0!==r&&(i["spacing-".concat(t,"-").concat(n)]={margin:"-".concat(d(r,2)),width:"calc(100% + ".concat(d(r),")"),"& > $item":{padding:d(r,2)}})})),i}(e,"xs"),e.breakpoints.keys.reduce((function(t,i){return function(e,t,i){var n={};u.forEach((function(e){var t="grid-".concat(i,"-").concat(e);if(!0!==e)if("auto"!==e){var r="".concat(Math.round(e/12*1e8)/1e6,"%");n[t]={flexBasis:r,flexGrow:0,maxWidth:r}}else n[t]={flexBasis:"auto",flexGrow:0,maxWidth:"none"};else n[t]={flexBasis:0,flexGrow:1,maxWidth:"100%"}})),"xs"===i?Object(r.a)(e,n):e[t.breakpoints.up(i)]=n}(t,e,i),t}),{}))}),{name:"MuiGrid"})(l);t.a=h},function(e,t,i){"use strict";var n=i(5),r=i(1),o=i(0),s=i.n(o),a=i(8),c=i(18),u=i(14),d=i(37),l=i(39),h=i(21),f=i(58),p=i(40),m=i(38),_=i(49),g=i(48),v=s.a.createContext(null);function E(e,t){var i=Object.create(null);return e&&o.Children.map(e,(function(e){return e})).forEach((function(e){i[e.key]=function(e){return t&&Object(o.isValidElement)(e)?t(e):e}(e)})),i}function b(e,t,i){return null!=i[t]?i[t]:e.props[t]}function y(e,t,i){var n=E(e.children),r=function(e,t){function i(i){return i in t?t[i]:e[i]}e=e||{},t=t||{};var n,r=Object.create(null),o=[];for(var s in e)s in t?o.length&&(r[s]=o,o=[]):o.push(s);var a={};for(var c in t){if(r[c])for(n=0;n<r[c].length;n++){var u=r[c][n];a[r[c][n]]=i(u)}a[c]=i(c)}for(n=0;n<o.length;n++)a[o[n]]=i(o[n]);return a}(t,n);return Object.keys(r).forEach((function(s){var a=r[s];if(Object(o.isValidElement)(a)){var c=s in t,u=s in n,d=t[s],l=Object(o.isValidElement)(d)&&!d.props.in;!u||c&&!l?u||!c||l?u&&c&&Object(o.isValidElement)(d)&&(r[s]=Object(o.cloneElement)(a,{onExited:i.bind(null,a),in:d.props.in,exit:b(a,"exit",e),enter:b(a,"enter",e)})):r[s]=Object(o.cloneElement)(a,{in:!1}):r[s]=Object(o.cloneElement)(a,{onExited:i.bind(null,a),in:!0,exit:b(a,"exit",e),enter:b(a,"enter",e)})}})),r}var w=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},S=function(e){function t(t,i){var n,r=(n=e.call(this,t,i)||this).handleExited.bind(Object(_.a)(n));return n.state={contextValue:{isMounting:!0},handleExited:r,firstRender:!0},n}Object(g.a)(t,e);var i=t.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var i,n,r=t.children,s=t.handleExited;return{children:t.firstRender?(i=e,n=s,E(i.children,(function(e){return Object(o.cloneElement)(e,{onExited:n.bind(null,e),in:!0,appear:b(e,"appear",i),enter:b(e,"enter",i),exit:b(e,"exit",i)})}))):y(e,r,s),firstRender:!1}},i.handleExited=function(e,t){var i=E(this.props.children);e.key in i||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var i=Object(r.a)({},t.children);return delete i[e.key],{children:i}})))},i.render=function(){var e=this.props,t=e.component,i=e.childFactory,n=Object(m.a)(e,["component","childFactory"]),r=this.state.contextValue,o=w(this.state.children).map(i);return delete n.appear,delete n.enter,delete n.exit,null===t?s.a.createElement(v.Provider,{value:r},o):s.a.createElement(v.Provider,{value:r},s.a.createElement(t,n,o))},t}(s.a.Component);S.propTypes={},S.defaultProps={component:"div",childFactory:function(e){return e}};var T=S,R="undefined"===typeof window?o.useEffect:o.useLayoutEffect;var C=function(e){var t=e.classes,i=e.pulsate,n=void 0!==i&&i,r=e.rippleX,s=e.rippleY,c=e.rippleSize,u=e.in,d=e.onExited,l=void 0===d?function(){}:d,f=e.timeout,p=o.useState(!1),m=p[0],_=p[1],g=Object(a.a)(t.ripple,t.rippleVisible,n&&t.ripplePulsate),v={width:c,height:c,top:-c/2+s,left:-c/2+r},E=Object(a.a)(t.child,m&&t.childLeaving,n&&t.childPulsate),b=Object(h.a)(l);return R((function(){if(!u){_(!0);var e=setTimeout(b,f);return function(){clearTimeout(e)}}}),[b,u,f]),o.createElement("span",{className:g,style:v},o.createElement("span",{className:E}))},I=o.forwardRef((function(e,t){var i=e.center,s=void 0!==i&&i,c=e.classes,u=e.className,d=Object(n.a)(e,["center","classes","className"]),l=o.useState([]),h=l[0],f=l[1],m=o.useRef(0),_=o.useRef(null);o.useEffect((function(){_.current&&(_.current(),_.current=null)}),[h]);var g=o.useRef(!1),v=o.useRef(null),E=o.useRef(null),b=o.useRef(null);o.useEffect((function(){return function(){clearTimeout(v.current)}}),[]);var y=o.useCallback((function(e){var t=e.pulsate,i=e.rippleX,n=e.rippleY,r=e.rippleSize,s=e.cb;f((function(e){return[].concat(Object(p.a)(e),[o.createElement(C,{key:m.current,classes:c,timeout:550,pulsate:t,rippleX:i,rippleY:n,rippleSize:r})])})),m.current+=1,_.current=s}),[c]),w=o.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,n=t.pulsate,r=void 0!==n&&n,o=t.center,a=void 0===o?s||t.pulsate:o,c=t.fakeElement,u=void 0!==c&&c;if("mousedown"===e.type&&g.current)g.current=!1;else{"touchstart"===e.type&&(g.current=!0);var d,l,h,f=u?null:b.current,p=f?f.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(a||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)d=Math.round(p.width/2),l=Math.round(p.height/2);else{var m=e.touches?e.touches[0]:e,_=m.clientX,w=m.clientY;d=Math.round(_-p.left),l=Math.round(w-p.top)}if(a)(h=Math.sqrt((2*Math.pow(p.width,2)+Math.pow(p.height,2))/3))%2===0&&(h+=1);else{var S=2*Math.max(Math.abs((f?f.clientWidth:0)-d),d)+2,T=2*Math.max(Math.abs((f?f.clientHeight:0)-l),l)+2;h=Math.sqrt(Math.pow(S,2)+Math.pow(T,2))}e.touches?null===E.current&&(E.current=function(){y({pulsate:r,rippleX:d,rippleY:l,rippleSize:h,cb:i})},v.current=setTimeout((function(){E.current&&(E.current(),E.current=null)}),80)):y({pulsate:r,rippleX:d,rippleY:l,rippleSize:h,cb:i})}}),[s,y]),S=o.useCallback((function(){w({},{pulsate:!0})}),[w]),R=o.useCallback((function(e,t){if(clearTimeout(v.current),"touchend"===e.type&&E.current)return e.persist(),E.current(),E.current=null,void(v.current=setTimeout((function(){R(e,t)})));E.current=null,f((function(e){return e.length>0?e.slice(1):e})),_.current=t}),[]);return o.useImperativeHandle(t,(function(){return{pulsate:S,start:w,stop:R}}),[S,w,R]),o.createElement("span",Object(r.a)({className:Object(a.a)(c.root,u),ref:b},d),o.createElement(T,{component:null,exit:!0},h))})),A=Object(c.a)((function(e){return{root:{overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"},ripple:{opacity:0,position:"absolute"},rippleVisible:{opacity:.3,transform:"scale(1)",animation:"$enter ".concat(550,"ms ").concat(e.transitions.easing.easeInOut)},ripplePulsate:{animationDuration:"".concat(e.transitions.duration.shorter,"ms")},child:{opacity:1,display:"block",width:"100%",height:"100%",borderRadius:"50%",backgroundColor:"currentColor"},childLeaving:{opacity:0,animation:"$exit ".concat(550,"ms ").concat(e.transitions.easing.easeInOut)},childPulsate:{position:"absolute",left:0,top:0,animation:"$pulsate 2500ms ".concat(e.transitions.easing.easeInOut," 200ms infinite")},"@keyframes enter":{"0%":{transform:"scale(0)",opacity:.1},"100%":{transform:"scale(1)",opacity:.3}},"@keyframes exit":{"0%":{opacity:1},"100%":{opacity:0}},"@keyframes pulsate":{"0%":{transform:"scale(1)"},"50%":{transform:"scale(0.92)"},"100%":{transform:"scale(1)"}}}}),{flip:!1,name:"MuiTouchRipple"})(o.memo(I)),O=o.forwardRef((function(e,t){var i=e.action,s=e.buttonRef,c=e.centerRipple,u=void 0!==c&&c,p=e.children,m=e.classes,_=e.className,g=e.component,v=void 0===g?"button":g,E=e.disabled,b=void 0!==E&&E,y=e.disableRipple,w=void 0!==y&&y,S=e.disableTouchRipple,T=void 0!==S&&S,R=e.focusRipple,C=void 0!==R&&R,I=e.focusVisibleClassName,O=e.onBlur,M=e.onClick,N=e.onFocus,k=e.onFocusVisible,P=e.onKeyDown,D=e.onKeyUp,L=e.onMouseDown,x=e.onMouseLeave,U=e.onMouseUp,V=e.onTouchEnd,B=e.onTouchMove,j=e.onTouchStart,F=e.onDragLeave,W=e.tabIndex,G=void 0===W?0:W,H=e.TouchRippleProps,q=e.type,K=void 0===q?"button":q,z=Object(n.a)(e,["action","buttonRef","centerRipple","children","classes","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","onBlur","onClick","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","onDragLeave","tabIndex","TouchRippleProps","type"]),Y=o.useRef(null);var J=o.useRef(null),X=o.useState(!1),Q=X[0],Z=X[1];b&&Q&&Z(!1);var $=Object(f.a)(),ee=$.isFocusVisible,te=$.onBlurVisible,ie=$.ref;function ne(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:T;return Object(h.a)((function(n){return t&&t(n),!i&&J.current&&J.current[e](n),!0}))}o.useImperativeHandle(i,(function(){return{focusVisible:function(){Z(!0),Y.current.focus()}}}),[]),o.useEffect((function(){Q&&C&&!w&&J.current.pulsate()}),[w,C,Q]);var re=ne("start",L),oe=ne("stop",F),se=ne("stop",U),ae=ne("stop",(function(e){Q&&e.preventDefault(),x&&x(e)})),ce=ne("start",j),ue=ne("stop",V),de=ne("stop",B),le=ne("stop",(function(e){Q&&(te(e),Z(!1)),O&&O(e)}),!1),he=Object(h.a)((function(e){Y.current||(Y.current=e.currentTarget),ee(e)&&(Z(!0),k&&k(e)),N&&N(e)})),fe=function(){var e=d.findDOMNode(Y.current);return v&&"button"!==v&&!("A"===e.tagName&&e.href)},pe=o.useRef(!1),me=Object(h.a)((function(e){C&&!pe.current&&Q&&J.current&&" "===e.key&&(pe.current=!0,e.persist(),J.current.stop(e,(function(){J.current.start(e)}))),e.target===e.currentTarget&&fe()&&" "===e.key&&e.preventDefault(),P&&P(e),e.target===e.currentTarget&&fe()&&"Enter"===e.key&&!b&&(e.preventDefault(),M&&M(e))})),_e=Object(h.a)((function(e){C&&" "===e.key&&J.current&&Q&&!e.defaultPrevented&&(pe.current=!1,e.persist(),J.current.stop(e,(function(){J.current.pulsate(e)}))),D&&D(e),M&&e.target===e.currentTarget&&fe()&&" "===e.key&&!e.defaultPrevented&&M(e)})),ge=v;"button"===ge&&z.href&&(ge="a");var ve={};"button"===ge?(ve.type=K,ve.disabled=b):("a"===ge&&z.href||(ve.role="button"),ve["aria-disabled"]=b);var Ee=Object(l.a)(s,t),be=Object(l.a)(ie,Y),ye=Object(l.a)(Ee,be),we=o.useState(!1),Se=we[0],Te=we[1];o.useEffect((function(){Te(!0)}),[]);var Re=Se&&!w&&!b;return o.createElement(ge,Object(r.a)({className:Object(a.a)(m.root,_,Q&&[m.focusVisible,I],b&&m.disabled),onBlur:le,onClick:M,onFocus:he,onKeyDown:me,onKeyUp:_e,onMouseDown:re,onMouseLeave:ae,onMouseUp:se,onDragLeave:oe,onTouchEnd:ue,onTouchMove:de,onTouchStart:ce,ref:ye,tabIndex:b?-1:G},ve,z),p,Re?o.createElement(A,Object(r.a)({ref:J,center:u},H)):null)})),M=Object(c.a)({root:{display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},"&$disabled":{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}},disabled:{},focusVisible:{}},{name:"MuiButtonBase"})(O),N=i(15),k=o.forwardRef((function(e,t){var i=e.children,s=e.classes,c=e.className,u=e.color,d=void 0===u?"default":u,l=e.component,h=void 0===l?"button":l,f=e.disabled,p=void 0!==f&&f,m=e.disableElevation,_=void 0!==m&&m,g=e.disableFocusRipple,v=void 0!==g&&g,E=e.endIcon,b=e.focusVisibleClassName,y=e.fullWidth,w=void 0!==y&&y,S=e.size,T=void 0===S?"medium":S,R=e.startIcon,C=e.type,I=void 0===C?"button":C,A=e.variant,O=void 0===A?"text":A,k=Object(n.a)(e,["children","classes","className","color","component","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"]),P=R&&o.createElement("span",{className:Object(a.a)(s.startIcon,s["iconSize".concat(Object(N.a)(T))])},R),D=E&&o.createElement("span",{className:Object(a.a)(s.endIcon,s["iconSize".concat(Object(N.a)(T))])},E);return o.createElement(M,Object(r.a)({className:Object(a.a)(s.root,s[O],c,"inherit"===d?s.colorInherit:"default"!==d&&s["".concat(O).concat(Object(N.a)(d))],"medium"!==T&&[s["".concat(O,"Size").concat(Object(N.a)(T))],s["size".concat(Object(N.a)(T))]],_&&s.disableElevation,p&&s.disabled,w&&s.fullWidth),component:h,disabled:p,focusRipple:!v,focusVisibleClassName:Object(a.a)(s.focusVisible,b),ref:t,type:I},k),o.createElement("span",{className:s.label},P,i,D))}));t.a=Object(c.a)((function(e){return{root:Object(r.a)({},e.typography.button,{boxSizing:"border-box",minWidth:64,padding:"6px 16px",borderRadius:e.shape.borderRadius,color:e.palette.text.primary,transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none",backgroundColor:Object(u.a)(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"},"&$disabled":{backgroundColor:"transparent"}},"&$disabled":{color:e.palette.action.disabled}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},text:{padding:"6px 8px"},textPrimary:{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(u.a)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},textSecondary:{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(u.a)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlined:{padding:"5px 15px",border:"1px solid ".concat("light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"&$disabled":{border:"1px solid ".concat(e.palette.action.disabledBackground)}},outlinedPrimary:{color:e.palette.primary.main,border:"1px solid ".concat(Object(u.a)(e.palette.primary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.primary.main),backgroundColor:Object(u.a)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlinedSecondary:{color:e.palette.secondary.main,border:"1px solid ".concat(Object(u.a)(e.palette.secondary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.secondary.main),backgroundColor:Object(u.a)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{border:"1px solid ".concat(e.palette.action.disabled)}},contained:{color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],boxShadow:e.shadows[2],"&:hover":{backgroundColor:e.palette.grey.A100,boxShadow:e.shadows[4],"@media (hover: none)":{boxShadow:e.shadows[2],backgroundColor:e.palette.grey[300]},"&$disabled":{backgroundColor:e.palette.action.disabledBackground}},"&$focusVisible":{boxShadow:e.shadows[6]},"&:active":{boxShadow:e.shadows[8]},"&$disabled":{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground}},containedPrimary:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark,"@media (hover: none)":{backgroundColor:e.palette.primary.main}}},containedSecondary:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main}}},disableElevation:{boxShadow:"none","&:hover":{boxShadow:"none"},"&$focusVisible":{boxShadow:"none"},"&:active":{boxShadow:"none"},"&$disabled":{boxShadow:"none"}},focusVisible:{},disabled:{},colorInherit:{color:"inherit",borderColor:"currentColor"},textSizeSmall:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},textSizeLarge:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},outlinedSizeSmall:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},outlinedSizeLarge:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},containedSizeSmall:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},containedSizeLarge:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},sizeSmall:{},sizeLarge:{},fullWidth:{width:"100%"},startIcon:{display:"inherit",marginRight:8,marginLeft:-4,"&$iconSizeSmall":{marginLeft:-2}},endIcon:{display:"inherit",marginRight:-4,marginLeft:8,"&$iconSizeSmall":{marginRight:-2}},iconSizeSmall:{"& > *:first-child":{fontSize:18}},iconSizeMedium:{"& > *:first-child":{fontSize:20}},iconSizeLarge:{"& > *:first-child":{fontSize:22}}}}),{name:"MuiButton"})(k)}]]);
//# sourceMappingURL=2.77777690.chunk.js.map